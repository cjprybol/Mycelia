<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Complete API Reference · Mycelia</title><meta name="title" content="Complete API Reference · Mycelia"/><meta property="og:title" content="Complete API Reference · Mycelia"/><meta property="twitter:title" content="Complete API Reference · Mycelia"/><meta name="description" content="Documentation for Mycelia."/><meta property="og:description" content="Documentation for Mycelia."/><meta property="twitter:description" content="Documentation for Mycelia."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">Mycelia</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../installation/">Installation</a></li><li><a class="tocitem" href="../getting-started/">Getting Started</a></li><li><a class="tocitem" href="../concepts/">Concepts</a></li><li><a class="tocitem" href="../probabilistic-assembly-hub/">Probabilistic Assembly</a></li><li><span class="tocitem">Documentation</span><ul><li><a class="tocitem" href="../architecture/">Architecture Overview</a></li><li><a class="tocitem" href="../assembly-method-selection/">Assembly Method Selection</a></li><li><a class="tocitem" href="../performance/">Performance Guide</a></li><li><a class="tocitem" href="../faq/">FAQ</a></li></ul></li><li><span class="tocitem">API Reference</span><ul><li class="is-active"><a class="tocitem" href>Complete API Reference</a><ul class="internal"><li><a class="tocitem" href="#Table-of-Contents"><span>Table of Contents</span></a></li><li><a class="tocitem" href="#Assembly-Functions"><span>Assembly Functions</span></a></li><li><a class="tocitem" href="#Qualmer-Analysis"><span>Qualmer Analysis</span></a></li><li><a class="tocitem" href="#String-Graphs"><span>String Graphs</span></a></li><li><a class="tocitem" href="#Sequence-I/O"><span>Sequence I/O</span></a></li><li><a class="tocitem" href="#K-mer-Analysis"><span>K-mer Analysis</span></a></li><li><a class="tocitem" href="#Simulation-and-Testing"><span>Simulation and Testing</span></a></li><li><a class="tocitem" href="#Quality-Control"><span>Quality Control</span></a></li><li><a class="tocitem" href="#Assembly-Validation"><span>Assembly Validation</span></a></li><li><a class="tocitem" href="#Annotation"><span>Annotation</span></a></li><li><a class="tocitem" href="#Comparative-Genomics"><span>Comparative Genomics</span></a></li><li><a class="tocitem" href="#Visualization"><span>Visualization</span></a></li><li><a class="tocitem" href="#Utility-Functions"><span>Utility Functions</span></a></li><li><a class="tocitem" href="#Graph-Types-and-Enums"><span>Graph Types and Enums</span></a></li><li><a class="tocitem" href="#Data-Structures"><span>Data Structures</span></a></li><li><a class="tocitem" href="#Function-Categories"><span>Function Categories</span></a></li><li><a class="tocitem" href="#Type-System"><span>Type System</span></a></li><li><a class="tocitem" href="#Performance-Characteristics"><span>Performance Characteristics</span></a></li><li><a class="tocitem" href="#Error-Handling"><span>Error Handling</span></a></li><li><a class="tocitem" href="#Integration-Points"><span>Integration Points</span></a></li><li><a class="tocitem" href="#Version-Compatibility"><span>Version Compatibility</span></a></li></ul></li><li><input class="collapse-toggle" id="menuitem-7-2" type="checkbox"/><label class="tocitem" for="menuitem-7-2"><span class="docs-label">Workflows</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../api/workflows/assembly-suite/">Assembly Suite</a></li><li><a class="tocitem" href="../api/workflows/data-acquisition/">Data Acquisition</a></li><li><a class="tocitem" href="../api/workflows/quality-control/">Quality Control</a></li><li><a class="tocitem" href="../api/workflows/sequence-analysis/">Sequence Analysis</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-7-3" type="checkbox"/><label class="tocitem" for="menuitem-7-3"><span class="docs-label">Quick Reference</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../api/quick-reference/function-index/">Function Index</a></li><li><a class="tocitem" href="../api/quick-reference/parameter-guide/">Parameter Guide</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-7-4" type="checkbox"/><label class="tocitem" for="menuitem-7-4"><span class="docs-label">Examples</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../api/examples/basic-workflows/">Basic Workflows</a></li></ul></li><li><a class="tocitem" href="../api/">Legacy API Documentation</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">API Reference</a></li><li class="is-active"><a href>Complete API Reference</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Complete API Reference</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/cjprybol/Mycelia" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/cjprybol/Mycelia/blob/master/docs/src/api-reference.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="API-Reference"><a class="docs-heading-anchor" href="#API-Reference">API Reference</a><a id="API-Reference-1"></a><a class="docs-heading-anchor-permalink" href="#API-Reference" title="Permalink"></a></h1><p>This page provides comprehensive documentation for all public functions in Mycelia, automatically generated from docstrings.</p><h2 id="Table-of-Contents"><a class="docs-heading-anchor" href="#Table-of-Contents">Table of Contents</a><a id="Table-of-Contents-1"></a><a class="docs-heading-anchor-permalink" href="#Table-of-Contents" title="Permalink"></a></h2><ul><li><a href="#API-Reference">API Reference</a></li><li class="no-marker"><ul><li><a href="#Table-of-Contents">Table of Contents</a></li><li><a href="#Assembly-Functions">Assembly Functions</a></li><li class="no-marker"><ul><li><a href="#Main-Assembly-Interface">Main Assembly Interface</a></li><li><a href="#Third-Party-Assembly-Tool-Wrappers">Third-Party Assembly Tool Wrappers</a></li><li><a href="#Experimental-Assembly-Algorithms">Experimental Assembly Algorithms</a></li></ul></li><li><a href="#Qualmer-Analysis">Qualmer Analysis</a></li><li class="no-marker"><ul><li><a href="#Core-Qualmer-Types">Core Qualmer Types</a></li><li><a href="#Qualmer-Generation">Qualmer Generation</a></li><li><a href="#Quality-Analysis">Quality Analysis</a></li><li><a href="#Graph-Construction">Graph Construction</a></li></ul></li><li><a href="#String-Graphs">String Graphs</a></li><li class="no-marker"><ul><li><a href="#N-gram-Analysis">N-gram Analysis</a></li><li><a href="#Graph-Simplification">Graph Simplification</a></li></ul></li><li><a href="#Sequence-I/O">Sequence I/O</a></li><li class="no-marker"><ul><li><a href="#File-Handling">File Handling</a></li><li><a href="#Format-Conversion">Format Conversion</a></li></ul></li><li><a href="#K-mer-Analysis">K-mer Analysis</a></li><li class="no-marker"><ul><li><a href="#K-mer-Counting">K-mer Counting</a></li><li><a href="#Distance-Metrics">Distance Metrics</a></li><li><a href="#Genome-Size-Estimation">Genome Size Estimation</a></li><li><a href="#K-mer-Result-Storage">K-mer Result Storage</a></li></ul></li><li><a href="#Simulation-and-Testing">Simulation and Testing</a></li><li class="no-marker"><ul><li><a href="#Sequence-Generation">Sequence Generation</a></li><li><a href="#Read-Simulation">Read Simulation</a></li><li><a href="#Assembly-Testing-(Experimental)">Assembly Testing (Experimental)</a></li></ul></li><li><a href="#Quality-Control">Quality Control</a></li><li class="no-marker"><ul><li><a href="#FASTQ-Analysis">FASTQ Analysis</a></li><li><a href="#External-Tool-Integration">External Tool Integration</a></li></ul></li><li><a href="#Assembly-Validation">Assembly Validation</a></li><li class="no-marker"><ul><li><a href="#Quality-Assessment">Quality Assessment</a></li><li><a href="#External-Validators">External Validators</a></li></ul></li><li><a href="#Annotation">Annotation</a></li><li class="no-marker"><ul><li><a href="#Gene-Prediction">Gene Prediction</a></li></ul></li><li><a href="#Comparative-Genomics">Comparative Genomics</a></li><li><a href="#Visualization">Visualization</a></li><li class="no-marker"><ul><li><a href="#Plotting-Functions">Plotting Functions</a></li></ul></li><li><a href="#Utility-Functions">Utility Functions</a></li><li class="no-marker"><ul><li><a href="#Memory-Management-(Experimental)">Memory Management (Experimental)</a></li><li><a href="#File-Operations">File Operations</a></li><li><a href="#Progress-Tracking">Progress Tracking</a></li></ul></li><li><a href="#Graph-Types-and-Enums">Graph Types and Enums</a></li><li class="no-marker"><ul><li><a href="#Graph-Modes">Graph Modes</a></li></ul></li><li><a href="#Data-Structures">Data Structures</a></li><li class="no-marker"><ul><li><a href="#Assembly-Results">Assembly Results</a></li><li><a href="#Quality-Metrics">Quality Metrics</a></li></ul></li><li><a href="#Function-Categories">Function Categories</a></li><li class="no-marker"><ul><li><a href="#Core-Assembly-Pipeline">Core Assembly Pipeline</a></li><li><a href="#Supporting-Workflows">Supporting Workflows</a></li></ul></li><li><a href="#Type-System">Type System</a></li><li class="no-marker"><ul><li><a href="#Quality-Aware-Types">Quality-Aware Types</a></li></ul></li><li><a href="#Performance-Characteristics">Performance Characteristics</a></li><li class="no-marker"><ul><li><a href="#Scalability">Scalability</a></li><li><a href="#Memory-Usage">Memory Usage</a></li><li><a href="#Parallelization">Parallelization</a></li></ul></li><li><a href="#Error-Handling">Error Handling</a></li><li class="no-marker"><ul><li><a href="#Common-Exceptions">Common Exceptions</a></li><li><a href="#Debugging-Tips">Debugging Tips</a></li></ul></li><li><a href="#Integration-Points">Integration Points</a></li><li class="no-marker"><ul><li><a href="#External-Tools">External Tools</a></li><li><a href="#File-Formats">File Formats</a></li></ul></li><li><a href="#Version-Compatibility">Version Compatibility</a></li></ul></li></ul><h2 id="Assembly-Functions"><a class="docs-heading-anchor" href="#Assembly-Functions">Assembly Functions</a><a id="Assembly-Functions-1"></a><a class="docs-heading-anchor-permalink" href="#Assembly-Functions" title="Permalink"></a></h2><h3 id="Main-Assembly-Interface"><a class="docs-heading-anchor" href="#Main-Assembly-Interface">Main Assembly Interface</a><a id="Main-Assembly-Interface-1"></a><a class="docs-heading-anchor-permalink" href="#Main-Assembly-Interface" title="Permalink"></a></h3><article><details class="docstring" open="true"><summary id="Mycelia.assemble_genome"><a class="docstring-binding" href="#Mycelia.assemble_genome"><code>Mycelia.assemble_genome</code></a> — <span class="docstring-category">Function</span></summary><div><pre><code class="language-julia hljs">assemble_genome(reads; k=31, kwargs...) -&gt; AssemblyResult
assemble_genome(reads, config::AssemblyConfig) -&gt; AssemblyResult</code></pre><p>Unified genome assembly interface with auto-detection and type-stable dispatch.</p><p><strong>Auto-Detection Convenience Method</strong></p><pre><code class="language-julia hljs"># Auto-detect sequence type and format, use k-mer approach
result = assemble_genome(fasta_records; k=25)

# Auto-detect sequence type and format, use overlap approach
result = assemble_genome(fasta_records; min_overlap=100)

# Override auto-detected parameters
result = assemble_genome(reads; k=31, graph_mode=SingleStrand, error_rate=0.005)</code></pre><p><strong>Type-Stable Direct Method</strong></p><pre><code class="language-julia hljs"># Explicit configuration for maximum performance
config = AssemblyConfig(k=25, sequence_type=BioSequences.LongDNA{4},
                       graph_mode=DoubleStrand, use_quality_scores=true)
result = assemble_genome(reads, config)</code></pre><p><strong>Arguments</strong></p><ul><li><code>reads</code>: Vector of FASTA/FASTQ records or file paths</li><li><code>config</code>: Assembly configuration (for type-stable version)</li></ul><p><strong>Keyword Arguments (auto-detection version)</strong></p><ul><li><code>k</code>: k-mer size (mutually exclusive with min_overlap)</li><li><code>min_overlap</code>: Minimum overlap length (mutually exclusive with k)</li><li><code>graph_mode</code>: SingleStrand or DoubleStrand (auto-detected if not specified)</li><li><code>error_rate</code>, <code>min_coverage</code>, etc.: Assembly parameters</li></ul><p><strong>Returns</strong></p><ul><li><code>AssemblyResult</code>: Structure containing contigs, names, and assembly metadata</li></ul><p><strong>Details</strong></p><p>This interface automatically:</p><ol><li><strong>Detects sequence type</strong>: DNA, RNA, AA, or String from input</li><li><strong>Chooses assembly method</strong>: k-mer vs overlap-based on parameters</li><li><strong>Validates compatibility</strong>: AA/String sequences → SingleStrand only</li><li><strong>Dispatches optimally</strong>: Based on input type and quality scores</li></ol><p><strong>Method Selection Logic:</strong></p><ul><li>String input + k → N-gram graph</li><li>String input + min_overlap → String graph</li><li>BioSequence input + k + quality → Qualmer graph</li><li>BioSequence input + k → K-mer graph</li><li>BioSequence input + min_overlap + quality → Quality BioSequence graph</li><li>BioSequence input + min_overlap → BioSequence graph</li></ul><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/d3d05bab5a5f88de4585ed603be6c515412f752e/src/assembly.jl#L837-L890">source</a></div><div><p>Type-stable main assembly function that dispatches based on configuration.</p><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/d3d05bab5a5f88de4585ed603be6c515412f752e/src/assembly.jl#L897-L899">source</a></div></details></article><h3 id="Third-Party-Assembly-Tool-Wrappers"><a class="docs-heading-anchor" href="#Third-Party-Assembly-Tool-Wrappers">Third-Party Assembly Tool Wrappers</a><a id="Third-Party-Assembly-Tool-Wrappers-1"></a><a class="docs-heading-anchor-permalink" href="#Third-Party-Assembly-Tool-Wrappers" title="Permalink"></a></h3><p>See <a href="../api/workflows/assembly-suite/">Assembly Suite</a> for comprehensive documentation of production-ready assembly wrappers including:</p><ul><li>Short-read assemblers: MEGAHIT, SPAdes, metaSPAdes, SKESA, Velvet</li><li>Long-read assemblers: Flye, metaFlye, Canu, hifiasm, MetaMDBG</li><li>Hybrid assemblers: Unicycler</li><li>Polishing tools: Apollo, HyPo, Strainy</li></ul><h3 id="Experimental-Assembly-Algorithms"><a class="docs-heading-anchor" href="#Experimental-Assembly-Algorithms">Experimental Assembly Algorithms</a><a id="Experimental-Assembly-Algorithms-1"></a><a class="docs-heading-anchor-permalink" href="#Experimental-Assembly-Algorithms" title="Permalink"></a></h3><p>Mycelia includes experimental assembly algorithms in <code>src/development/</code> that are not currently part of the public API:</p><ul><li><strong>Intelligent Assembly</strong>: <code>mycelia_assemble</code> - Self-optimizing k-mer progression</li><li><strong>Assembly Utilities</strong>: <code>dynamic_k_prime_pattern</code>, <code>error_optimized_k_sequence</code>, <code>calculate_assembly_reward</code></li></ul><p>These are research implementations subject to change. For production use, see the third-party assembler wrappers above.</p><h2 id="Qualmer-Analysis"><a class="docs-heading-anchor" href="#Qualmer-Analysis">Qualmer Analysis</a><a id="Qualmer-Analysis-1"></a><a class="docs-heading-anchor-permalink" href="#Qualmer-Analysis" title="Permalink"></a></h2><h3 id="Core-Qualmer-Types"><a class="docs-heading-anchor" href="#Core-Qualmer-Types">Core Qualmer Types</a><a id="Core-Qualmer-Types-1"></a><a class="docs-heading-anchor-permalink" href="#Core-Qualmer-Types" title="Permalink"></a></h3><article><details class="docstring" open="true"><summary id="Mycelia.Qualmer"><a class="docstring-binding" href="#Mycelia.Qualmer"><code>Mycelia.Qualmer</code></a> — <span class="docstring-category">Type</span></summary><div><pre><code class="language-julia hljs">struct Qualmer{KmerT, K}</code></pre><p>A quality-aware k-mer that pairs sequence k-mers with their corresponding quality scores.</p><p><strong>Fields</strong></p><ul><li><p><code>kmer::Any</code></p></li><li><p><code>qualities::Tuple{Vararg{UInt8, K}} where K</code></p></li></ul><p><strong>Examples</strong></p><pre><code class="language-julia hljs">using Mycelia
using Kmers

# Create a DNA k-mer with quality scores
kmer = DNAKmer(&quot;ATCG&quot;)
qualities = [30, 35, 32, 28]  # Phred quality scores
qmer = Qualmer(kmer, qualities)

# Access individual bases and qualities
base, quality = qmer[1]  # Returns (&#39;A&#39;, 30)</code></pre><p>This structure is essential for quality-aware sequence analysis and assembly algorithms that consider both sequence content and sequencing quality information.</p><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/d3d05bab5a5f88de4585ed603be6c515412f752e/src/qualmer-analysis.jl#L1">source</a></div></details></article><article><details class="docstring" open="true"><summary id="Mycelia.QualmerVertexData"><a class="docstring-binding" href="#Mycelia.QualmerVertexData"><code>Mycelia.QualmerVertexData</code></a> — <span class="docstring-category">Type</span></summary><div><pre><code class="language-julia hljs">struct QualmerVertexData{QualmerT&lt;:Mycelia.Qualmer}</code></pre><p>Vertex data for quality-aware k-mer graphs that stores k-mer observations with quality scores.</p><p><strong>Fields</strong></p><ul><li><p><code>canonical_qualmer::Mycelia.Qualmer</code></p></li><li><p><code>observations::Array{Mycelia.QualmerObservation{QualmerT}, 1} where QualmerT&lt;:Mycelia.Qualmer</code></p></li><li><p><code>joint_probability::Float64</code></p></li><li><p><code>coverage::Int64</code></p></li><li><p><code>mean_quality::Float64</code></p></li></ul><p>This structure aggregates multiple observations of the same k-mer and computes quality-based statistics for use in quality-aware assembly algorithms.</p><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/d3d05bab5a5f88de4585ed603be6c515412f752e/src/qualmer-analysis.jl#L483">source</a></div></details></article><article><details class="docstring" open="true"><summary id="Mycelia.QualmerEdgeData"><a class="docstring-binding" href="#Mycelia.QualmerEdgeData"><code>Mycelia.QualmerEdgeData</code></a> — <span class="docstring-category">Type</span></summary><div><pre><code class="language-julia hljs">struct QualmerEdgeData</code></pre><p>Edge data for quality-aware k-mer graphs that connects k-mer vertices with strand information.</p><p><strong>Fields</strong></p><ul><li><p><code>observations::Vector{Tuple{Int64, Int64}}</code></p></li><li><p><code>src_strand::Mycelia.StrandOrientation</code></p></li><li><p><code>dst_strand::Mycelia.StrandOrientation</code></p></li><li><p><code>weight::Float64</code></p></li><li><p><code>quality_weight::Float64</code></p></li></ul><p>This structure represents connections between k-mers in quality-aware graphs, including strand orientation and quality-weighted edge weights for assembly algorithms.</p><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/d3d05bab5a5f88de4585ed603be6c515412f752e/src/qualmer-analysis.jl#L527">source</a></div></details></article><h3 id="Qualmer-Generation"><a class="docs-heading-anchor" href="#Qualmer-Generation">Qualmer Generation</a><a id="Qualmer-Generation-1"></a><a class="docs-heading-anchor-permalink" href="#Qualmer-Generation" title="Permalink"></a></h3><article><details class="docstring" open="true"><summary id="Mycelia.qualmers_fw"><a class="docstring-binding" href="#Mycelia.qualmers_fw"><code>Mycelia.qualmers_fw</code></a> — <span class="docstring-category">Function</span></summary><div><pre><code class="language-julia hljs">qualmers_fw(
    sequence::BioSequences.LongSequence{A},
    quality::AbstractVector{&lt;:Integer},
    _::Val{K}
) -&gt; Base.Generator{I, F} where {I&lt;:(Base.Iterators.Enumerate{I} where I&lt;:(Kmers.FwKmers{A, _A, S} where {A&lt;:BioSequences.Alphabet, _A, S&lt;:(BioSequences.LongSequence{A} where A)})), F&lt;:(Mycelia.var&quot;#289#290&quot;{_A, &lt;:AbstractVector{var&quot;#s34&quot;}} where {_A, var&quot;#s34&quot;&lt;:Integer})}
</code></pre><p>Create an iterator that yields DNA qualmers from the given sequence and quality scores.</p><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/d3d05bab5a5f88de4585ed603be6c515412f752e/src/qualmer-analysis.jl#L107">source</a></div><div><pre><code class="language-julia hljs">qualmers_fw(
    record::FASTX.FASTQ.Record,
    k::Int64
) -&gt; Base.Generator
</code></pre><p>Generate forward qualmers from a FASTQ record. Extracts all k-mers in the forward direction with their associated quality scores from the FASTQ record.</p><p><strong>Arguments</strong></p><ul><li><code>record</code>: FASTQ record containing sequence and quality data</li><li><code>k</code>: K-mer size</li></ul><p><strong>Returns</strong></p><ul><li>Iterator yielding (Qualmer, position) tuples for each k-mer</li></ul><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/d3d05bab5a5f88de4585ed603be6c515412f752e/src/qualmer-analysis.jl#L231">source</a></div></details></article><article><details class="docstring" open="true"><summary id="Mycelia.qualmers_canonical"><a class="docstring-binding" href="#Mycelia.qualmers_canonical"><code>Mycelia.qualmers_canonical</code></a> — <span class="docstring-category">Function</span></summary><div><pre><code class="language-julia hljs">qualmers_canonical(
    sequence::BioSequences.LongSequence{BioSequences.DNAAlphabet{N}},
    quality::AbstractVector{&lt;:Integer},
    _::Val{K}
) -&gt; Base.Generator{I, F} where {I&lt;:(Base.Iterators.Enumerate{I} where I&lt;:(Kmers.FwKmers{A, _A, S} where {A&lt;:(BioSequences.DNAAlphabet), _A, S&lt;:(BioSequences.LongDNA)})), F&lt;:(Mycelia.var&quot;#295#296&quot;{_A, &lt;:AbstractVector{var&quot;#s34&quot;}} where {_A, var&quot;#s34&quot;&lt;:Integer})}
</code></pre><p>Generate canonical DNA qualmers from sequence and quality scores. For each k-mer, returns the lexicographically smaller of the k-mer and its reverse complement, ensuring consistent representation regardless of strand.</p><p><strong>Arguments</strong></p><ul><li><code>sequence</code>: DNA sequence as LongDNA</li><li><code>quality</code>: Vector of quality scores corresponding to each base</li><li><code>::Val{K}</code>: K-mer size as a type parameter</li></ul><p><strong>Returns</strong></p><ul><li>Iterator yielding (Qualmer, position) tuples with canonical k-mer representation</li></ul><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/d3d05bab5a5f88de4585ed603be6c515412f752e/src/qualmer-analysis.jl#L188">source</a></div><div><pre><code class="language-julia hljs">qualmers_canonical(
    sequence::BioSequences.LongAA,
    quality::AbstractVector{&lt;:Integer},
    _::Val{K}
) -&gt; Base.Generator{I, F} where {I&lt;:(Base.Iterators.Enumerate{I} where I&lt;:(Kmers.FwAAMers{_A, BioSequences.LongAA} where _A)), F&lt;:(Mycelia.var&quot;#289#290&quot;{_A, &lt;:AbstractVector{var&quot;#s36&quot;}} where {_A, var&quot;#s36&quot;&lt;:Integer})}
</code></pre><p>Generate canonical amino acid qualmers from protein sequence and quality scores. For amino acid sequences, canonical representation is the same as forward representation since proteins don&#39;t have reverse complements.</p><p><strong>Arguments</strong></p><ul><li><code>sequence</code>: Protein sequence as LongAA</li><li><code>quality</code>: Vector of quality scores corresponding to each amino acid</li><li><code>::Val{K}</code>: K-mer size as a type parameter</li></ul><p><strong>Returns</strong></p><ul><li>Iterator yielding (Qualmer, position) tuples for each k-mer</li></ul><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/d3d05bab5a5f88de4585ed603be6c515412f752e/src/qualmer-analysis.jl#L212">source</a></div><div><pre><code class="language-julia hljs">qualmers_canonical(
    record::FASTX.FASTQ.Record,
    k::Int64
) -&gt; Base.Generator
</code></pre><p>Generate canonical qualmers from a FASTQ record. Extracts k-mers in canonical representation (lexicographically smaller of forward and reverse complement) with their associated quality scores.</p><p><strong>Arguments</strong></p><ul><li><code>record</code>: FASTQ record containing sequence and quality data</li><li><code>k</code>: K-mer size</li></ul><p><strong>Returns</strong></p><ul><li>Iterator yielding (Qualmer, position) tuples with canonical k-mer representation</li></ul><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/d3d05bab5a5f88de4585ed603be6c515412f752e/src/qualmer-analysis.jl#L251">source</a></div></details></article><article><details class="docstring" open="true"><summary id="Mycelia.qualmers_unambiguous"><a class="docstring-binding" href="#Mycelia.qualmers_unambiguous"><code>Mycelia.qualmers_unambiguous</code></a> — <span class="docstring-category">Function</span></summary><div><pre><code class="language-julia hljs">qualmers_unambiguous(
    sequence::BioSequences.LongSequence{BioSequences.DNAAlphabet{N}},
    quality::AbstractVector{&lt;:Integer},
    _::Val{K}
) -&gt; Base.Generator{I, F} where {I&lt;:(Kmers.UnambiguousDNAMers{_A, S} where {_A, S&lt;:(BioSequences.LongDNA)}), F&lt;:(Mycelia.var&quot;#291#292&quot;{_A, &lt;:AbstractVector{var&quot;#s34&quot;}} where {_A, var&quot;#s34&quot;&lt;:Integer})}
</code></pre><p>Generate unambiguous DNA qualmers from sequence and quality scores. Only includes k-mers that contain unambiguous nucleotides (A, T, G, C). Skips k-mers containing ambiguous bases like N.</p><p><strong>Arguments</strong></p><ul><li><code>sequence</code>: DNA sequence as LongDNA</li><li><code>quality</code>: Vector of quality scores corresponding to each base</li><li><code>::Val{K}</code>: K-mer size as a type parameter</li></ul><p><strong>Returns</strong></p><ul><li>Iterator yielding (Qualmer, position) tuples for each unambiguous k-mer</li></ul><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/d3d05bab5a5f88de4585ed603be6c515412f752e/src/qualmer-analysis.jl#L121">source</a></div><div><pre><code class="language-julia hljs">qualmers_unambiguous(
    sequence::BioSequences.LongSequence{BioSequences.RNAAlphabet{N}},
    quality::AbstractVector{&lt;:Integer},
    _::Val{K}
) -&gt; Base.Generator{I, F} where {I&lt;:(Kmers.UnambiguousRNAMers{_A, S} where {_A, S&lt;:(BioSequences.LongRNA)}), F&lt;:(Mycelia.var&quot;#293#294&quot;{_A, &lt;:AbstractVector{var&quot;#s34&quot;}} where {_A, var&quot;#s34&quot;&lt;:Integer})}
</code></pre><p>Generate unambiguous RNA qualmers from sequence and quality scores. Only includes k-mers that contain unambiguous nucleotides (A, U, G, C). Skips k-mers containing ambiguous bases like N.</p><p><strong>Arguments</strong></p><ul><li><code>sequence</code>: RNA sequence as LongRNA</li><li><code>quality</code>: Vector of quality scores corresponding to each base</li><li><code>::Val{K}</code>: K-mer size as a type parameter</li></ul><p><strong>Returns</strong></p><ul><li>Iterator yielding (Qualmer, position) tuples for each unambiguous k-mer</li></ul><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/d3d05bab5a5f88de4585ed603be6c515412f752e/src/qualmer-analysis.jl#L145">source</a></div><div><pre><code class="language-julia hljs">qualmers_unambiguous(
    sequence::BioSequences.LongAA,
    quality::AbstractVector{&lt;:Integer},
    _::Val{K}
) -&gt; Base.Generator{I, F} where {I&lt;:(Base.Iterators.Enumerate{I} where I&lt;:(Kmers.FwAAMers{_A, BioSequences.LongAA} where _A)), F&lt;:(Mycelia.var&quot;#289#290&quot;{_A, &lt;:AbstractVector{var&quot;#s36&quot;}} where {_A, var&quot;#s36&quot;&lt;:Integer})}
</code></pre><p>Generate amino acid qualmers from protein sequence and quality scores. For amino acid sequences, all k-mers are considered unambiguous, so this falls back to the forward qualmer generation.</p><p><strong>Arguments</strong></p><ul><li><code>sequence</code>: Protein sequence as LongAA</li><li><code>quality</code>: Vector of quality scores corresponding to each amino acid</li><li><code>::Val{K}</code>: K-mer size as a type parameter</li></ul><p><strong>Returns</strong></p><ul><li>Iterator yielding (Qualmer, position) tuples for each k-mer</li></ul><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/d3d05bab5a5f88de4585ed603be6c515412f752e/src/qualmer-analysis.jl#L169">source</a></div><div><pre><code class="language-julia hljs">qualmers_unambiguous(
    record::FASTX.FASTQ.Record,
    k::Int64
) -&gt; Base.Generator
</code></pre><p>Generate unambiguous qualmers from a FASTQ record. Extracts only k-mers that contain unambiguous nucleotides (no N bases) with their associated quality scores.</p><p><strong>Arguments</strong></p><ul><li><code>record</code>: FASTQ record containing sequence and quality data</li><li><code>k</code>: K-mer size</li></ul><p><strong>Returns</strong></p><ul><li>Iterator yielding (Qualmer, position) tuples for each unambiguous k-mer</li></ul><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/d3d05bab5a5f88de4585ed603be6c515412f752e/src/qualmer-analysis.jl#L271">source</a></div></details></article><article><details class="docstring" open="true"><summary id="Mycelia.qualmers_unambiguous_canonical"><a class="docstring-binding" href="#Mycelia.qualmers_unambiguous_canonical"><code>Mycelia.qualmers_unambiguous_canonical</code></a> — <span class="docstring-category">Function</span></summary><div><pre><code class="language-julia hljs">qualmers_unambiguous_canonical(
    record::FASTX.FASTQ.Record,
    k::Int64
) -&gt; Base.Generator{I, Mycelia.var&quot;#297#298&quot;} where I
</code></pre><p>Generate unambiguous canonical qualmers from the given FASTQ record.</p><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/d3d05bab5a5f88de4585ed603be6c515412f752e/src/qualmer-analysis.jl#L304">source</a></div></details></article><h3 id="Quality-Analysis"><a class="docs-heading-anchor" href="#Quality-Analysis">Quality Analysis</a><a id="Quality-Analysis-1"></a><a class="docs-heading-anchor-permalink" href="#Quality-Analysis" title="Permalink"></a></h3><article><details class="docstring" open="true"><summary id="Mycelia.phred_to_probability"><a class="docstring-binding" href="#Mycelia.phred_to_probability"><code>Mycelia.phred_to_probability</code></a> — <span class="docstring-category">Function</span></summary><div><pre><code class="language-julia hljs">phred_to_probability(phred_score::UInt8) -&gt; Float64
</code></pre><p>Convert PHRED quality score to probability of correctness. PHRED score Q relates to error probability P by: Q = -10 * log10(P) Therefore, correctness probability = 1 - P = 1 - 10^(-Q/10)</p><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/d3d05bab5a5f88de4585ed603be6c515412f752e/src/qualmer-analysis.jl#L319">source</a></div></details></article><article><details class="docstring" open="true"><summary id="Mycelia.qualmer_correctness_probability"><a class="docstring-binding" href="#Mycelia.qualmer_correctness_probability"><code>Mycelia.qualmer_correctness_probability</code></a> — <span class="docstring-category">Function</span></summary><div><pre><code class="language-julia hljs">qualmer_correctness_probability(
    qmer::Mycelia.Qualmer
) -&gt; Float64
</code></pre><p>Calculate joint probability that a single qualmer is correct. For a k-mer with quality scores [q1, q2, ..., qk], the joint probability that all positions are correct is: ∏(1 - 10^(-qi/10))</p><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/d3d05bab5a5f88de4585ed603be6c515412f752e/src/qualmer-analysis.jl#L347">source</a></div></details></article><article><details class="docstring" open="true"><summary id="Mycelia.joint_qualmer_probability"><a class="docstring-binding" href="#Mycelia.joint_qualmer_probability"><code>Mycelia.joint_qualmer_probability</code></a> — <span class="docstring-category">Function</span></summary><div><pre><code class="language-julia hljs">joint_qualmer_probability(
    qualmers::Vector{&lt;:Mycelia.Qualmer};
    use_log_space
) -&gt; Float64
</code></pre><p>Calculate joint probability that multiple observations of the same k-mer are all correct. For independent observations of the same k-mer sequence, this represents our confidence that the k-mer truly exists in the data.</p><p><strong>Arguments</strong></p><ul><li><code>qualmers</code>: Vector of Qualmer observations of the same k-mer sequence</li><li><code>use_log_space</code>: Use log-space arithmetic for numerical stability (default: true)</li></ul><p><strong>Returns</strong></p><ul><li>Float64: Joint probability that all observations are correct</li></ul><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/d3d05bab5a5f88de4585ed603be6c515412f752e/src/qualmer-analysis.jl#L363">source</a></div></details></article><article><details class="docstring" open="true"><summary id="Mycelia.position_wise_joint_probability"><a class="docstring-binding" href="#Mycelia.position_wise_joint_probability"><code>Mycelia.position_wise_joint_probability</code></a> — <span class="docstring-category">Function</span></summary><div><pre><code class="language-julia hljs">position_wise_joint_probability(
    qualmers::Vector{&lt;:Mycelia.Qualmer};
    use_log_space
) -&gt; Float64
</code></pre><p>Calculate position-wise joint probability for multiple qualmer observations. This is more sophisticated than <code>joint_qualmer_probability</code> as it considers the quality at each position across all observations.</p><p><strong>Arguments</strong></p><ul><li><code>qualmers</code>: Vector of Qualmer observations of the same k-mer sequence</li><li><code>use_log_space</code>: Use log-space arithmetic for numerical stability (default: true)</li></ul><p><strong>Returns</strong></p><ul><li>Float64: Position-wise joint probability</li></ul><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/d3d05bab5a5f88de4585ed603be6c515412f752e/src/qualmer-analysis.jl#L406">source</a></div></details></article><h3 id="Graph-Construction"><a class="docs-heading-anchor" href="#Graph-Construction">Graph Construction</a><a id="Graph-Construction-1"></a><a class="docs-heading-anchor-permalink" href="#Graph-Construction" title="Permalink"></a></h3><article><details class="docstring" open="true"><summary id="Mycelia.build_qualmer_graph"><a class="docstring-binding" href="#Mycelia.build_qualmer_graph"><code>Mycelia.build_qualmer_graph</code></a> — <span class="docstring-category">Function</span></summary><div><pre><code class="language-julia hljs">build_qualmer_graph(
    fastq_records::Vector{FASTX.FASTQ.Record};
    k,
    graph_mode,
    min_quality,
    min_coverage
) -&gt; MetaGraphsNext.MetaGraph{Int64, Graphs.SimpleGraphs.SimpleDiGraph{Int64}, Label, VertexData, EdgeData, Nothing, WeightFunction, Float64} where {Label, VertexData, EdgeData, WeightFunction}
</code></pre><p>Build a quality-aware k-mer graph from FASTQ records using existing Qualmer functionality. This function leverages the existing qualmer extraction functions and adds graph construction.</p><p><strong>Arguments</strong></p><ul><li><code>fastq_records</code>: Vector of FASTQ records with quality scores</li><li><code>k</code>: K-mer size</li><li><code>graph_mode</code>: SingleStrand or DoubleStrand mode (default: DoubleStrand)</li><li><code>min_quality</code>: Minimum average PHRED quality to include k-mer (default: 10)</li><li><code>min_coverage</code>: Minimum coverage (observations) to include k-mer (default: 1)</li></ul><p><strong>Returns</strong></p><ul><li>MetaGraphsNext.MetaGraph with QualmerVertexData and QualmerEdgeData</li></ul><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/d3d05bab5a5f88de4585ed603be6c515412f752e/src/qualmer-analysis.jl#L567">source</a></div></details></article><article><details class="docstring" open="true"><summary id="Mycelia.get_qualmer_statistics"><a class="docstring-binding" href="#Mycelia.get_qualmer_statistics"><code>Mycelia.get_qualmer_statistics</code></a> — <span class="docstring-category">Function</span></summary><div><pre><code class="language-julia hljs">get_qualmer_statistics(
    graph::MetaGraphsNext.MetaGraph
) -&gt; Dict{String, Any}
</code></pre><p>Get comprehensive statistics about a qualmer graph.</p><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/d3d05bab5a5f88de4585ed603be6c515412f752e/src/qualmer-analysis.jl#L766">source</a></div></details></article><h2 id="String-Graphs"><a class="docs-heading-anchor" href="#String-Graphs">String Graphs</a><a id="String-Graphs-1"></a><a class="docs-heading-anchor-permalink" href="#String-Graphs" title="Permalink"></a></h2><h3 id="N-gram-Analysis"><a class="docs-heading-anchor" href="#N-gram-Analysis">N-gram Analysis</a><a id="N-gram-Analysis-1"></a><a class="docs-heading-anchor-permalink" href="#N-gram-Analysis" title="Permalink"></a></h3><article><details class="docstring" open="true"><summary id="Mycelia.ngrams"><a class="docstring-binding" href="#Mycelia.ngrams"><code>Mycelia.ngrams</code></a> — <span class="docstring-category">Function</span></summary><div><pre><code class="language-julia hljs">ngrams(s::AbstractString, n::Int64) -&gt; Vector{String}
</code></pre><p>Extract all n-grams from a string. Returns a vector containing all contiguous substrings of length <code>n</code> from the input string.</p><p><strong>Arguments</strong></p><ul><li><code>s</code>: Input string to extract n-grams from</li><li><code>n</code>: Length of each n-gram (must be positive)</li></ul><p><strong>Returns</strong></p><ul><li><code>Vector{String}</code>: All n-grams of length <code>n</code> from the string</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia hljs">ngrams(&quot;hello&quot;, 3)  # Returns [&quot;hel&quot;, &quot;ell&quot;, &quot;llo&quot;]
ngrams(&quot;abcd&quot;, 2)   # Returns [&quot;ab&quot;, &quot;bc&quot;, &quot;cd&quot;]</code></pre><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/d3d05bab5a5f88de4585ed603be6c515412f752e/src/string-graphs.jl#L4">source</a></div></details></article><article><details class="docstring" open="true"><summary id="Mycelia.string_to_ngram_graph"><a class="docstring-binding" href="#Mycelia.string_to_ngram_graph"><code>Mycelia.string_to_ngram_graph</code></a> — <span class="docstring-category">Function</span></summary><div><pre><code class="language-julia hljs">string_to_ngram_graph(; s, n)
</code></pre><p>Build a directed graph from string n-grams with edge and vertex weights. Creates a MetaGraph where vertices represent unique n-grams and edges represent transitions between consecutive n-grams in the original string.</p><p><strong>Arguments</strong></p><ul><li><code>s</code>: Input string to build graph from</li><li><code>n</code>: N-gram size (length of each substring)</li></ul><p><strong>Returns</strong></p><ul><li><code>MetaGraphsNext.MetaGraph</code>: Directed graph with:<ul><li>Vertex labels: String n-grams</li><li>Vertex data: Integer counts of n-gram occurrences</li><li>Edge data: Integer counts of n-gram transitions</li></ul></li></ul><p><strong>Details</strong></p><p>Backward compatibility function - now delegates to the multi-string version. The graph construction process:</p><ol><li>Extract all n-grams from the string</li><li>Count occurrences of each unique n-gram (stored as vertex data)</li><li>Count transitions between consecutive n-grams (stored as edge data)</li><li>Build a directed graph representing the n-gram sequence structure</li></ol><p><strong>Examples</strong></p><pre><code class="language-julia hljs">graph = string_to_ngram_graph(s=&quot;abcabc&quot;, n=2)
# Creates graph with vertices &quot;ab&quot;, &quot;bc&quot;, &quot;ca&quot; and weighted edges</code></pre><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/d3d05bab5a5f88de4585ed603be6c515412f752e/src/string-graphs.jl#L129">source</a></div></details></article><article><details class="docstring" open="true"><summary id="Mycelia.plot_ngram_graph"><a class="docstring-binding" href="#Mycelia.plot_ngram_graph"><code>Mycelia.plot_ngram_graph</code></a> — <span class="docstring-category">Function</span></summary><div><pre><code class="language-julia hljs">plot_ngram_graph(g) -&gt; Any
</code></pre><p>Create a visual plot of an n-gram graph using GraphPlot.jl. Displays the graph structure with vertex labels showing the n-grams.</p><p><strong>Arguments</strong></p><ul><li><code>g</code>: MetaGraph containing n-gram data (typically from <code>string_to_ngram_graph</code>)</li></ul><p><strong>Returns</strong></p><ul><li>Plot object showing the graph layout with labeled vertices</li></ul><p><strong>Details</strong></p><p>Uses a spring layout algorithm to position vertices and displays n-gram strings as vertex labels for easy interpretation of the graph structure.</p><p><strong>Examples</strong></p><pre><code class="language-julia hljs">graph = string_to_ngram_graph(s=&quot;hello&quot;, n=2)
plot_ngram_graph(graph)  # Shows visual representation</code></pre><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/d3d05bab5a5f88de4585ed603be6c515412f752e/src/string-graphs.jl#L164">source</a></div></details></article><h3 id="Graph-Simplification"><a class="docs-heading-anchor" href="#Graph-Simplification">Graph Simplification</a><a id="Graph-Simplification-1"></a><a class="docs-heading-anchor-permalink" href="#Graph-Simplification" title="Permalink"></a></h3><article><details class="docstring" open="true"><summary id="Mycelia.collapse_unbranching_paths"><a class="docstring-binding" href="#Mycelia.collapse_unbranching_paths"><code>Mycelia.collapse_unbranching_paths</code></a> — <span class="docstring-category">Function</span></summary><div><p>Collapse linear paths (vertices with one incoming and one outgoing edge) into a simpler graph where sequences are concatenated.</p><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/d3d05bab5a5f88de4585ed603be6c515412f752e/src/string-graphs.jl#L211-L214">source</a></div></details></article><article><details class="docstring" open="true"><summary id="Mycelia.find_connected_components"><a class="docstring-binding" href="#Mycelia.find_connected_components"><code>Mycelia.find_connected_components</code></a> — <span class="docstring-category">Function</span></summary><div><p>Find all connected components in the graph. Returns a vector of vectors of vertex indices.</p><p>For directed graphs, uses weakly connected components. For undirected graphs, uses standard connected components.</p><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/d3d05bab5a5f88de4585ed603be6c515412f752e/src/string-graphs.jl#L195-L201">source</a></div></details></article><p><strong>Note</strong>: Additional graph simplification function <code>assemble_strings</code> is available but currently lacks documentation.</p><h2 id="Sequence-I/O"><a class="docs-heading-anchor" href="#Sequence-I/O">Sequence I/O</a><a id="Sequence-I/O-1"></a><a class="docs-heading-anchor-permalink" href="#Sequence-I/O" title="Permalink"></a></h2><h3 id="File-Handling"><a class="docs-heading-anchor" href="#File-Handling">File Handling</a><a id="File-Handling-1"></a><a class="docs-heading-anchor-permalink" href="#File-Handling" title="Permalink"></a></h3><article><details class="docstring" open="true"><summary id="Mycelia.open_fastx"><a class="docstring-binding" href="#Mycelia.open_fastx"><code>Mycelia.open_fastx</code></a> — <span class="docstring-category">Function</span></summary><div><pre><code class="language-julia hljs">open_fastx(path::AbstractString) -&gt; Any
</code></pre><p>Open and return a reader for FASTA or FASTQ format files.</p><p><strong>Arguments</strong></p><ul><li><code>path::AbstractString</code>: Path to input file. Can be:<ul><li>Local file path</li><li>HTTP/FTP URL</li><li>Gzip compressed (.gz extension)</li></ul></li></ul><p><strong>Supported formats</strong></p><ul><li>FASTA (.fasta, .fna, .faa, .fa)</li><li>FASTQ (.fastq, .fq)</li></ul><p><strong>Returns</strong></p><ul><li><code>FASTX.FASTA.Reader</code> for FASTA files</li><li><code>FASTX.FASTQ.Reader</code> for FASTQ files</li></ul><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/d3d05bab5a5f88de4585ed603be6c515412f752e/src/fastx.jl#L1888">source</a></div></details></article><article><details class="docstring" open="true"><summary id="Mycelia.write_fastq"><a class="docstring-binding" href="#Mycelia.write_fastq"><code>Mycelia.write_fastq</code></a> — <span class="docstring-category">Function</span></summary><div><pre><code class="language-julia hljs">write_fastq(;records, filename, gzip=false)</code></pre><pre><code class="language-julia hljs">write_fastq(; records, filename, gzip)
</code></pre><p>Write FASTQ records to file using FASTX.jl. Validates extension: .fastq, .fq, .fastq.gz, or .fq.gz. If <code>gzip</code> is true or filename endswith .gz, output is gzipped. <code>records</code> must be an iterable of FASTX.FASTQ.Record.</p><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/d3d05bab5a5f88de4585ed603be6c515412f752e/src/fastx.jl#L1359-L1368">source</a></div></details></article><article><details class="docstring" open="true"><summary id="Mycelia.write_fasta"><a class="docstring-binding" href="#Mycelia.write_fasta"><code>Mycelia.write_fasta</code></a> — <span class="docstring-category">Function</span></summary><div><pre><code class="language-julia hljs">write_fasta(
;
    outfile,
    records,
    gzip,
    show_progress,
    use_pigz,
    pigz_threads
)
</code></pre><p>Writes FASTA records to a file, optionally gzipped.</p><p><strong>Arguments</strong></p><ul><li><code>outfile::AbstractString</code>: Path to the output FASTA file.  Will append &quot;.gz&quot; if <code>gzip</code> is true and &quot;.gz&quot; isn&#39;t already the extension.</li><li><code>records::Vector{FASTX.FASTA.Record}</code>: A vector of FASTA records.</li><li><code>gzip::Bool</code>: Optionally force compression of the output with gzip. By default will use the file name to infer.</li><li><code>show_progress::Union{Bool,Nothing}</code>: Whether to show a progress meter. If <code>nothing</code> (default), automatically shows progress for ≥1000 records.</li><li><code>use_pigz::Union{Bool,Nothing}</code>: If <code>true</code>, uses external pigz for compression (faster for large files). If <code>nothing</code> (default), automatically uses pigz for files estimated to be ≥50 MB if pigz is available. Requires pigz to be installed and in PATH.</li><li><code>pigz_threads::Int</code>: Number of threads for pigz to use. Defaults to all available cores.</li></ul><p><strong>Returns</strong></p><ul><li><code>outfile::String</code>: The path to the output FASTA file (including &quot;.gz&quot; if applicable).</li></ul><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/d3d05bab5a5f88de4585ed603be6c515412f752e/src/fastx.jl#L1931">source</a></div></details></article><h3 id="Format-Conversion"><a class="docs-heading-anchor" href="#Format-Conversion">Format Conversion</a><a id="Format-Conversion-1"></a><a class="docs-heading-anchor-permalink" href="#Format-Conversion" title="Permalink"></a></h3><article><details class="docstring" open="true"><summary id="Mycelia.convert_sequence"><a class="docstring-binding" href="#Mycelia.convert_sequence"><code>Mycelia.convert_sequence</code></a> — <span class="docstring-category">Function</span></summary><div><pre><code class="language-julia hljs">convert_sequence(seq::AbstractString) -&gt; Any
</code></pre><p>Converts the given sequence (output from FASTX.sequence) into the appropriate BioSequence type:</p><ul><li>DNA sequences are converted using <code>BioSequences.LongDNA</code></li><li>RNA sequences are converted using <code>BioSequences.LongRNA</code></li><li>AA sequences are converted using <code>BioSequences.LongAA</code></li></ul><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/d3d05bab5a5f88de4585ed603be6c515412f752e/src/alphabets.jl#L127">source</a></div></details></article><h2 id="K-mer-Analysis"><a class="docs-heading-anchor" href="#K-mer-Analysis">K-mer Analysis</a><a id="K-mer-Analysis-1"></a><a class="docs-heading-anchor-permalink" href="#K-mer-Analysis" title="Permalink"></a></h2><h3 id="K-mer-Counting"><a class="docs-heading-anchor" href="#K-mer-Counting">K-mer Counting</a><a id="K-mer-Counting-1"></a><a class="docs-heading-anchor-permalink" href="#K-mer-Counting" title="Permalink"></a></h3><p>For k-mer counting functions, see <a href="../api/workflows/sequence-analysis/">Sequence Analysis Workflow</a>.</p><h3 id="Distance-Metrics"><a class="docs-heading-anchor" href="#Distance-Metrics">Distance Metrics</a><a id="Distance-Metrics-1"></a><a class="docs-heading-anchor-permalink" href="#Distance-Metrics" title="Permalink"></a></h3><article><details class="docstring" open="true"><summary id="Mycelia.jaccard_distance"><a class="docstring-binding" href="#Mycelia.jaccard_distance"><code>Mycelia.jaccard_distance</code></a> — <span class="docstring-category">Function</span></summary><div><p>Compute the Jaccard distance between columns of a binary matrix.</p><p><strong>Arguments</strong></p><ul><li><code>M::AbstractMatrix{&lt;:Integer}</code>: Binary matrix where rows are features and columns are samples</li></ul><p><strong>Returns</strong></p><ul><li><code>Matrix{Float64}</code>: Symmetric distance matrix with Jaccard distances</li></ul><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/d3d05bab5a5f88de4585ed603be6c515412f752e/src/distance-metrics.jl#L55-L63">source</a></div><div><pre><code class="language-julia hljs">jaccard_distance(set1, set2) -&gt; Any
</code></pre><p>Calculate the Jaccard distance between two sets, which is the complement of the Jaccard similarity.</p><p>The Jaccard distance is defined as: <span>$J_d(A,B) = 1 - J_s(A,B) = 1 - \frac{|A ∩ B|}{|A ∪ B|}$</span></p><p><strong>Arguments</strong></p><ul><li><code>set1</code>: First set to compare</li><li><code>set2</code>: Second set to compare</li></ul><p><strong>Returns</strong></p><ul><li><code>Float64</code>: A value in [0,1] where 0 indicates identical sets and 1 indicates disjoint sets</li></ul><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/d3d05bab5a5f88de4585ed603be6c515412f752e/src/distance-metrics.jl#L180">source</a></div></details></article><article><details class="docstring" open="true"><summary id="Mycelia.kmer_counts_to_js_divergence"><a class="docstring-binding" href="#Mycelia.kmer_counts_to_js_divergence"><code>Mycelia.kmer_counts_to_js_divergence</code></a> — <span class="docstring-category">Function</span></summary><div><pre><code class="language-julia hljs">kmer_counts_to_js_divergence(
    kmer_counts_1,
    kmer_counts_2
) -&gt; Any
</code></pre><p>Calculate the Jensen-Shannon divergence between two k-mer frequency distributions.</p><p><strong>Arguments</strong></p><ul><li><code>kmer_counts_1</code>: Dictionary mapping k-mers to their counts in first sequence</li><li><code>kmer_counts_2</code>: Dictionary mapping k-mers to their counts in second sequence</li></ul><p><strong>Returns</strong></p><ul><li>Normalized Jensen-Shannon divergence score between 0 and 1, where:<ul><li>0 indicates identical distributions</li><li>1 indicates maximally different distributions</li></ul></li></ul><p><strong>Notes</strong></p><ul><li>The measure is symmetric: JS(P||Q) = JS(Q||P)</li><li>Counts are automatically normalized to probability distributions</li></ul><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/d3d05bab5a5f88de4585ed603be6c515412f752e/src/distance-metrics.jl#L127">source</a></div></details></article><h3 id="Genome-Size-Estimation"><a class="docs-heading-anchor" href="#Genome-Size-Estimation">Genome Size Estimation</a><a id="Genome-Size-Estimation-1"></a><a class="docs-heading-anchor-permalink" href="#Genome-Size-Estimation" title="Permalink"></a></h3><article><details class="docstring" open="true"><summary id="Mycelia.estimate_genome_size_from_kmers"><a class="docstring-binding" href="#Mycelia.estimate_genome_size_from_kmers"><code>Mycelia.estimate_genome_size_from_kmers</code></a> — <span class="docstring-category">Function</span></summary><div><pre><code class="language-julia hljs">estimate_genome_size_from_kmers(
    sequence::Union{AbstractString, BioSequences.LongSequence},
    k::Integer
) -&gt; Dict
</code></pre><p>Estimate genome size from k-mer analysis using total k-mer count.</p><p>This function estimates genome size using the basic relationship:  genome<em>size ≈ total</em>kmers - k + 1, where total_kmers is the sum of all k-mer  counts. This is a simple estimation method; more sophisticated approaches  accounting for sequencing depth, repeats, and errors may be more accurate.</p><p><strong>Arguments</strong></p><ul><li><code>sequence::Union{BioSequences.LongSequence, AbstractString}</code>: Input sequence or string</li><li><code>k::Integer</code>: K-mer size for analysis</li></ul><p><strong>Returns</strong></p><ul><li><code>Dict{String, Any}</code>: Dictionary containing:<ul><li>&quot;unique_kmers&quot;: Number of unique k-mers observed</li><li>&quot;total_kmers&quot;: Total k-mer count (sum of all frequencies)</li><li>&quot;estimated<em>genome</em>size&quot;: Estimated genome size</li><li>&quot;actual_size&quot;: Length of input sequence (if provided)</li></ul></li></ul><p><strong>Examples</strong></p><pre><code class="language-julia hljs"># Estimate genome size from a sequence
sequence = &quot;ATCGATCGATCGATCG&quot;
result = estimate_genome_size_from_kmers(sequence, 5)</code></pre><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/d3d05bab5a5f88de4585ed603be6c515412f752e/src/kmer-analysis.jl#L2426">source</a></div><div><pre><code class="language-julia hljs">estimate_genome_size_from_kmers(
    records::AbstractArray{T&lt;:Union{FASTX.FASTA.Record, FASTX.FASTQ.Record}, 1},
    k::Integer
) -&gt; Dict
</code></pre><p>Estimate genome size from FASTQ/FASTA records using k-mer analysis.</p><p>Overload for processing FASTQ or FASTA records directly.</p><p><strong>Arguments</strong></p><ul><li><code>records::AbstractVector{T}</code> where T &lt;: Union{FASTX.FASTA.Record, FASTX.FASTQ.Record}`: Input records</li><li><code>k::Integer</code>: K-mer size for analysis</li></ul><p><strong>Returns</strong></p><ul><li><code>Dict{String, Any}</code>: Dictionary with k-mer statistics and genome size estimate</li></ul><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/d3d05bab5a5f88de4585ed603be6c515412f752e/src/kmer-analysis.jl#L2488">source</a></div></details></article><h3 id="K-mer-Result-Storage"><a class="docs-heading-anchor" href="#K-mer-Result-Storage">K-mer Result Storage</a><a id="K-mer-Result-Storage-1"></a><a class="docs-heading-anchor-permalink" href="#K-mer-Result-Storage" title="Permalink"></a></h3><article><details class="docstring" open="true"><summary id="Mycelia.save_kmer_results"><a class="docstring-binding" href="#Mycelia.save_kmer_results"><code>Mycelia.save_kmer_results</code></a> — <span class="docstring-category">Function</span></summary><div><pre><code class="language-julia hljs">save_kmer_results(
;
    filename,
    kmers,
    counts,
    fasta_list,
    k,
    alphabet
)
</code></pre><p>Save the kmer counting results (kmers vector, counts sparse matrix) and the input FASTA file list to a JLD2 file for long-term storage and reproducibility.</p><p><strong>Arguments</strong></p><ul><li><code>filename::AbstractString</code>: Path to the output JLD2 file.</li><li><code>kmers::AbstractVector{&lt;:Kmers.Kmer}</code>: The sorted vector of unique kmer objects.</li><li><code>counts::AbstractMatrix</code>: The (sparse or dense) matrix of kmer counts.</li><li><code>fasta_list::AbstractVector{&lt;:AbstractString}</code>: The list of FASTA file paths used as input.</li><li><code>k::Integer</code>: The kmer size used.</li><li><code>alphabet::Symbol</code>: The alphabet used (:AA, :DNA, :RNA).</li></ul><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/d3d05bab5a5f88de4585ed603be6c515412f752e/src/kmer-analysis.jl#L1">source</a></div></details></article><article><details class="docstring" open="true"><summary id="Mycelia.load_kmer_results"><a class="docstring-binding" href="#Mycelia.load_kmer_results"><code>Mycelia.load_kmer_results</code></a> — <span class="docstring-category">Function</span></summary><div><pre><code class="language-julia hljs">load_kmer_results(
    filename::AbstractString
) -&gt; Union{Nothing, NamedTuple{(:kmers, :counts, :fasta_list, :metadata), &lt;:Tuple{Any, Any, Any, Dict{String, Any}}}}
</code></pre><p>Load kmer counting results previously saved with <code>save_kmer_results</code>.</p><p><strong>Arguments</strong></p><ul><li><code>filename::AbstractString</code>: Path to the input JLD2 file.</li></ul><p><strong>Returns</strong></p><ul><li><code>NamedTuple</code>: Contains the loaded <code>kmers</code>, <code>counts</code>, <code>fasta_list</code>, and <code>metadata</code>. Returns <code>nothing</code> if the file cannot be loaded or essential keys are missing.</li></ul><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/d3d05bab5a5f88de4585ed603be6c515412f752e/src/kmer-analysis.jl#L54">source</a></div></details></article><h2 id="Simulation-and-Testing"><a class="docs-heading-anchor" href="#Simulation-and-Testing">Simulation and Testing</a><a id="Simulation-and-Testing-1"></a><a class="docs-heading-anchor-permalink" href="#Simulation-and-Testing" title="Permalink"></a></h2><h3 id="Sequence-Generation"><a class="docs-heading-anchor" href="#Sequence-Generation">Sequence Generation</a><a id="Sequence-Generation-1"></a><a class="docs-heading-anchor-permalink" href="#Sequence-Generation" title="Permalink"></a></h3><article><details class="docstring" open="true"><summary id="Mycelia.generate_test_sequences"><a class="docstring-binding" href="#Mycelia.generate_test_sequences"><code>Mycelia.generate_test_sequences</code></a> — <span class="docstring-category">Function</span></summary><div><pre><code class="language-julia hljs">generate_test_sequences(
    genome_size::Int64
) -&gt; Vector{BioSequences.LongSequence{BioSequences.DNAAlphabet{4}}}
generate_test_sequences(
    genome_size::Int64,
    n_sequences::Int64
) -&gt; Vector{BioSequences.LongSequence{BioSequences.DNAAlphabet{4}}}
</code></pre><p>Generate test DNA sequences for k-mer analysis benchmarking.</p><p>Creates random DNA sequences suitable for k-mer counting and analysis performance testing.</p><p><strong>Arguments</strong></p><ul><li><code>genome_size::Int</code>: Size of each generated sequence in base pairs</li><li><code>n_sequences::Int</code>: Number of sequences to generate (default: 1)</li></ul><p><strong>Returns</strong></p><ul><li>Vector of <code>BioSequences.LongDNA{4}</code> sequences</li></ul><p><strong>See Also</strong></p><ul><li><code>random_fasta_record</code>: For generating FASTA records with random sequences</li><li><code>BioSequences.randdnaseq</code>: For generating random DNA sequences</li></ul><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/d3d05bab5a5f88de4585ed603be6c515412f752e/src/simulation.jl#L1339">source</a></div></details></article><h3 id="Read-Simulation"><a class="docs-heading-anchor" href="#Read-Simulation">Read Simulation</a><a id="Read-Simulation-1"></a><a class="docs-heading-anchor-permalink" href="#Read-Simulation" title="Permalink"></a></h3><p>See <a href="../api/workflows/data-acquisition/">Data Acquisition Workflow</a> for read simulation functions.</p><h3 id="Assembly-Testing-(Experimental)"><a class="docs-heading-anchor" href="#Assembly-Testing-(Experimental)">Assembly Testing (Experimental)</a><a id="Assembly-Testing-(Experimental)-1"></a><a class="docs-heading-anchor-permalink" href="#Assembly-Testing-(Experimental)" title="Permalink"></a></h3><p>Experimental assembly testing function <code>test_intelligent_assembly</code> is available in <code>src/development/</code> but not currently part of the public API.</p><h2 id="Quality-Control"><a class="docs-heading-anchor" href="#Quality-Control">Quality Control</a><a id="Quality-Control-1"></a><a class="docs-heading-anchor-permalink" href="#Quality-Control" title="Permalink"></a></h2><h3 id="FASTQ-Analysis"><a class="docs-heading-anchor" href="#FASTQ-Analysis">FASTQ Analysis</a><a id="FASTQ-Analysis-1"></a><a class="docs-heading-anchor-permalink" href="#FASTQ-Analysis" title="Permalink"></a></h3><article><details class="docstring" open="true"><summary id="Mycelia.calculate_gc_content"><a class="docstring-binding" href="#Mycelia.calculate_gc_content"><code>Mycelia.calculate_gc_content</code></a> — <span class="docstring-category">Function</span></summary><div><pre><code class="language-julia hljs">calculate_gc_content(
    sequence::BioSequences.LongSequence
) -&gt; Float64
</code></pre><p>Calculate GC content (percentage of G and C bases) from a BioSequence.</p><p>This function calculates the percentage of guanine (G) and cytosine (C) bases in a nucleotide sequence. Works with both DNA and RNA sequences.</p><p><strong>Arguments</strong></p><ul><li><code>sequence::BioSequences.LongSequence</code>: Input DNA or RNA sequence</li></ul><p><strong>Returns</strong></p><ul><li><code>Float64</code>: GC content as a percentage (0.0-100.0)</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia hljs"># Calculate GC content for DNA
dna_seq = BioSequences.LongDNA{4}(&quot;ATCGATCGATCG&quot;)
gc_percent = calculate_gc_content(dna_seq)

# Calculate GC content for RNA
rna_seq = BioSequences.LongRNA{4}(&quot;AUCGAUCGAUCG&quot;) 
gc_percent = calculate_gc_content(rna_seq)</code></pre><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/d3d05bab5a5f88de4585ed603be6c515412f752e/src/utility-functions.jl#L2597">source</a></div><div><pre><code class="language-julia hljs">calculate_gc_content(sequence::AbstractString) -&gt; Float64
</code></pre><p>Calculate GC content from a string sequence.</p><p>Convenience function that accepts string input and converts to appropriate BioSequence. Automatically detects DNA/RNA based on presence of T/U.</p><p><strong>Arguments</strong></p><ul><li><code>sequence::AbstractString</code>: Input DNA or RNA sequence as string</li></ul><p><strong>Returns</strong></p><ul><li><code>Float64</code>: GC content as a percentage (0.0-100.0)</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia hljs"># Calculate GC content from string
gc_percent = calculate_gc_content(&quot;ATCGATCGATCG&quot;)</code></pre><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/d3d05bab5a5f88de4585ed603be6c515412f752e/src/utility-functions.jl#L2648">source</a></div><div><pre><code class="language-julia hljs">calculate_gc_content(
    records::AbstractArray{T&lt;:Union{FASTX.FASTA.Record, FASTX.FASTQ.Record}, 1}
) -&gt; Float64
</code></pre><p>Calculate GC content from FASTA/FASTQ records.</p><p>Processes multiple records and calculates overall GC content across all sequences.</p><p><strong>Arguments</strong></p><ul><li><code>records::AbstractVector{T}</code> where T &lt;: Union{FASTX.FASTA.Record, FASTX.FASTQ.Record}`: Input records</li></ul><p><strong>Returns</strong></p><ul><li><code>Float64</code>: Overall GC content as a percentage (0.0-100.0)</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia hljs"># Calculate GC content from FASTA records
records = collect(FASTX.FASTA.Reader(open(&quot;sequences.fasta&quot;)))
gc_percent = calculate_gc_content(records)</code></pre><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/d3d05bab5a5f88de4585ed603be6c515412f752e/src/utility-functions.jl#L2687">source</a></div></details></article><article><details class="docstring" open="true"><summary id="Mycelia.assess_duplication_rates"><a class="docstring-binding" href="#Mycelia.assess_duplication_rates"><code>Mycelia.assess_duplication_rates</code></a> — <span class="docstring-category">Function</span></summary><div><pre><code class="language-julia hljs">assess_duplication_rates(fastq; results_table) -&gt; Any
</code></pre><p>Analyze sequence duplication rates in a FASTQ file.</p><p>This function processes a FASTQ file to quantify both exact sequence duplications and  canonical duplications (considering sequences and their reverse complements as equivalent). The function makes two passes through the file: first to count total records, then to analyze unique sequences.</p><p><strong>Arguments</strong></p><ul><li><code>fastq::String</code>: Path to the input FASTQ file to analyze</li><li><code>results_table::String</code>: Optional. Path where the results will be saved as a tab-separated file. Defaults to the same path as the input file but with extension changed to &quot;.duplication_rates.tsv&quot;</li></ul><p><strong>Returns</strong></p><ul><li><code>String</code>: Path to the results table file</li></ul><p><strong>Output</strong></p><p>Generates a tab-separated file containing the following metrics:</p><ul><li><code>total_records</code>: Total number of sequence records in the file</li><li><code>total_unique_observations</code>: Count of unique sequence strings</li><li><code>total_unique_canonical_observations</code>: Count of unique canonical sequences  (after normalizing for reverse complements)</li><li><code>percent_unique_observations</code>: Percentage of sequences that are unique</li><li><code>percent_unique_canonical_observations</code>: Percentage of sequences that are unique after canonicalization</li><li><code>percent_duplication_rate</code>: Percentage of sequences that are duplicates (100 - percent<em>unique</em>observations)</li><li><code>percent_canonical_duplication_rate</code>: Percentage of sequences that are duplicates after canonicalization</li></ul><p><strong>Notes</strong></p><ul><li>If the specified results file already exists and is not empty, the function will return early without recomputing.</li><li>Progress is displayed during processing with a progress bar showing speed.</li></ul><p><strong>Example</strong></p><pre><code class="language-julia hljs"># Analyze a FASTQ file and save results to default location
result_path = assess_duplication_rates(&quot;data/sample.fastq&quot;)

# Specify custom output path
result_path = assess_duplication_rates(&quot;data/sample.fastq&quot;, results_table=&quot;results/duplication_analysis.tsv&quot;)</code></pre><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/d3d05bab5a5f88de4585ed603be6c515412f752e/src/fastx.jl#L810">source</a></div></details></article><p>For FASTQ quality analysis functions, see <a href="../api/workflows/quality-control/">Quality Control Workflow</a>.</p><h3 id="External-Tool-Integration"><a class="docs-heading-anchor" href="#External-Tool-Integration">External Tool Integration</a><a id="External-Tool-Integration-1"></a><a class="docs-heading-anchor-permalink" href="#External-Tool-Integration" title="Permalink"></a></h3><p>For quality control and filtering functions, see <a href="../api/workflows/quality-control/">Quality Control Workflow</a>.</p><h2 id="Assembly-Validation"><a class="docs-heading-anchor" href="#Assembly-Validation">Assembly Validation</a><a id="Assembly-Validation-1"></a><a class="docs-heading-anchor-permalink" href="#Assembly-Validation" title="Permalink"></a></h2><h3 id="Quality-Assessment"><a class="docs-heading-anchor" href="#Quality-Assessment">Quality Assessment</a><a id="Quality-Assessment-1"></a><a class="docs-heading-anchor-permalink" href="#Quality-Assessment" title="Permalink"></a></h3><article><details class="docstring" open="true"><summary id="Mycelia.assess_assembly_quality"><a class="docstring-binding" href="#Mycelia.assess_assembly_quality"><code>Mycelia.assess_assembly_quality</code></a> — <span class="docstring-category">Function</span></summary><div><pre><code class="language-julia hljs">assess_assembly_quality(contigs_file)</code></pre><p>Assess basic assembly quality metrics from a FASTA file.</p><p>Calculates standard assembly quality metrics including contig count, total length, and N50 statistic for assembly evaluation.</p><p><strong>Arguments</strong></p><ul><li><code>contigs_file</code>: Path to FASTA file containing assembly contigs</li></ul><p><strong>Returns</strong></p><ul><li>Tuple of (n<em>contigs, total</em>length, n50, l50)<ul><li><code>n_contigs</code>: Number of contigs in the assembly</li><li><code>total_length</code>: Total length of all contigs in base pairs</li><li><code>n50</code>: N50 statistic (length of shortest contig in the set covering 50% of assembly)</li><li><code>l50</code>: L50 statistic (number of contigs needed to reach 50% of assembly length)</li></ul></li></ul><p><strong>Example</strong></p><pre><code class="language-julia hljs">n_contigs, total_length, n50, l50 = assess_assembly_quality(&quot;assembly.fasta&quot;)
println(&quot;Assembly has $n_contigs contigs, $total_length bp total, N50=$n50, L50=$l50&quot;)</code></pre><p><strong>See Also</strong></p><ul><li><code>assess_assembly_kmer_quality</code>: For k-mer based assembly quality assessment</li></ul><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/d3d05bab5a5f88de4585ed603be6c515412f752e/src/quality-control-and-benchmarking.jl#L413-L439">source</a></div><div><pre><code class="language-julia hljs">assess_assembly_quality(; assembly, observations, ks)
</code></pre><p>Assess assembly quality using k-mer based metrics including QV scores.</p><p>This function provides a comprehensive quality assessment of genome assemblies by comparing k-mer distributions between the assembly and source sequencing data. It calculates multiple quality metrics across different k-mer sizes, with the  QV (Quality Value) score being the primary measure of assembly accuracy.</p><p><strong>Arguments</strong></p><ul><li><code>assembly</code>: Path to assembly file (FASTA format) or assembly sequences</li><li><code>observations</code>: Path to sequencing data file(s) (FASTQ format) or sequence observations</li><li><code>ks::Vector{Int}</code>: K-mer sizes to analyze (default: 11,13,17,19,23,31,53 for comprehensive evaluation)</li></ul><p><strong>Returns</strong></p><p>DataFrame containing quality metrics for each k-mer size:</p><ul><li><code>k::Int</code>: K-mer length used</li><li><code>cosine_distance::Float64</code>: Cosine similarity between k-mer distributions  </li><li><code>js_divergence::Float64</code>: Jensen-Shannon divergence between distributions</li><li><code>qv::Float64</code>: Merqury-style Quality Value score (primary assembly accuracy metric)</li></ul><p><strong>QV Score Interpretation</strong></p><ul><li><strong>QV ≥ 40</strong>: High quality assembly (&gt;99.99% base accuracy)</li><li><strong>QV 30-40</strong>: Good quality assembly (99.9-99.99% base accuracy) </li><li><strong>QV 20-30</strong>: Moderate quality assembly (99-99.9% base accuracy)</li><li><strong>QV &lt; 20</strong>: Lower quality assembly (&lt;99% base accuracy)</li></ul><p><strong>Implementation Details</strong></p><p>The QV score follows the Merqury methodology:</p><ol><li>Count k-mers in both assembly and sequencing data</li><li>Calculate shared k-mers between datasets</li><li>Estimate base-level accuracy: P = (Kshared/Ktotal)^(1/k)</li><li>Convert to Phred scale: QV = -10log₁₀(1-P)</li></ol><p><strong>Performance Notes</strong></p><ul><li>Uses multiple k-mer sizes for robust quality assessment</li><li>Larger k-mer sizes provide more discriminative power</li><li>Parallel k-mer counting for computational efficiency</li><li>Progress tracking for long-running analyses</li></ul><p><strong>References</strong></p><p>Rhie, A. et al. &quot;Merqury: reference-free quality, completeness, and phasing  assessment for genome assemblies.&quot; Genome Biology 21, 245 (2020).</p><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/d3d05bab5a5f88de4585ed603be6c515412f752e/src/quality-control-and-benchmarking.jl#L1362">source</a></div></details></article><article><details class="docstring" open="true"><summary id="Mycelia.validate_assembly"><a class="docstring-binding" href="#Mycelia.validate_assembly"><code>Mycelia.validate_assembly</code></a> — <span class="docstring-category">Function</span></summary><div><pre><code class="language-julia hljs">validate_assembly(assembly::AssemblyResult; reference=nothing) -&gt; Dict{String, Any}</code></pre><p>Validate assembly quality using various metrics and optional reference comparison.</p><p><strong>Arguments</strong></p><ul><li><code>assembly</code>: Assembly result to validate</li><li><code>reference</code>: Optional reference sequence for comparison</li></ul><p><strong>Returns</strong></p><ul><li><code>Dict{String, Any}</code>: Comprehensive validation metrics</li></ul><p><strong>Details</strong></p><p>Computes assembly quality metrics including:</p><ul><li>N50, N90 statistics</li><li>Total assembly length and number of contigs</li><li>Coverage uniformity (if reference provided)</li><li>Structural variant detection (if reference provided)</li><li>Gap analysis and repeat characterization</li></ul><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/d3d05bab5a5f88de4585ed603be6c515412f752e/src/assembly.jl#L985-L1004">source</a></div></details></article><h3 id="External-Validators"><a class="docs-heading-anchor" href="#External-Validators">External Validators</a><a id="External-Validators-1"></a><a class="docs-heading-anchor-permalink" href="#External-Validators" title="Permalink"></a></h3><article><details class="docstring" open="true"><summary id="Mycelia.run_quast"><a class="docstring-binding" href="#Mycelia.run_quast"><code>Mycelia.run_quast</code></a> — <span class="docstring-category">Function</span></summary><div><pre><code class="language-julia hljs">run_quast(assembly_files::Vector{String}; outdir::String=&quot;quast_results&quot;, reference::Union{String,Nothing}=nothing, threads::Int=Sys.CPU_THREADS, min_contig::Int=500, gene_finding::Bool=false)</code></pre><p>Run QUAST (Quality Assessment Tool for Genome Assemblies) to evaluate assembly quality.</p><p><strong>Arguments</strong></p><ul><li><code>assembly_files::Vector{String}</code>: Vector of paths to assembly FASTA files to evaluate</li><li><code>outdir::String=&quot;quast_results&quot;</code>: Output directory for QUAST results</li><li><code>reference::Union{String,Nothing}=nothing</code>: Optional reference genome for reference-based metrics</li><li><code>threads::Int=Sys.CPU_THREADS</code>: Number of threads to use</li><li><code>min_contig::Int=500</code>: Minimum contig length to consider</li><li><code>gene_finding::Bool=false</code>: Whether to run gene finding (requires GeneMark-ES/ET)</li></ul><p><strong>Returns</strong></p><ul><li><code>String</code>: Path to the output directory containing QUAST results</li></ul><p><strong>Output Files</strong></p><ul><li><code>report.html</code>: Interactive HTML report</li><li><code>report.txt</code>: Text summary report</li><li><code>report.tsv</code>: Tab-separated values report for programmatic access</li><li><code>transposed_report.tsv</code>: Transposed TSV format</li><li><code>icarus.html</code>: Icarus contig browser (if reference provided)</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia hljs"># Basic assembly evaluation
assemblies = [&quot;assembly1.fasta&quot;, &quot;assembly2.fasta&quot;]
quast_dir = Mycelia.run_quast(assemblies)

# With reference genome
ref_genome = &quot;reference.fasta&quot;
quast_dir = Mycelia.run_quast(assemblies, reference=ref_genome)

# Custom parameters
quast_dir = Mycelia.run_quast(assemblies, 
                             outdir=&quot;my_quast_results&quot;,
                             min_contig=1000,
                             threads=8)</code></pre><p><strong>Notes</strong></p><ul><li>Requires QUAST to be installed via Bioconda</li><li>Without reference: provides basic metrics (N50, total length, # contigs, etc.)</li><li>With reference: adds reference-based metrics (genome fraction, misassemblies, etc.)</li><li>Gene finding requires additional dependencies and is disabled by default</li></ul><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/d3d05bab5a5f88de4585ed603be6c515412f752e/src/quality-control-and-benchmarking.jl#L909-L954">source</a></div><div><pre><code class="language-julia hljs">run_quast(assembly_file::String; kwargs...)</code></pre><p>Run QUAST on a single assembly file. See <code>run_quast(::Vector{String})</code> for details.</p><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/d3d05bab5a5f88de4585ed603be6c515412f752e/src/quality-control-and-benchmarking.jl#L1029-L1033">source</a></div></details></article><article><details class="docstring" open="true"><summary id="Mycelia.run_busco"><a class="docstring-binding" href="#Mycelia.run_busco"><code>Mycelia.run_busco</code></a> — <span class="docstring-category">Function</span></summary><div><pre><code class="language-julia hljs">run_busco(assembly_files::Vector{String}; outdir::String=&quot;busco_results&quot;, lineage::String=&quot;auto&quot;, mode::String=&quot;genome&quot;, threads::Int=Sys.CPU_THREADS, force::Bool=false)</code></pre><p>Run BUSCO (Benchmarking Universal Single-Copy Orthologs) to assess genome assembly completeness.</p><p><strong>Arguments</strong></p><ul><li><code>assembly_files::Vector{String}</code>: Vector of paths to assembly FASTA files to evaluate</li><li><code>outdir::String=&quot;busco_results&quot;</code>: Output directory for BUSCO results</li><li><code>lineage::String=&quot;auto&quot;</code>: BUSCO lineage dataset to use (e.g., &quot;bacteria<em>odb10&quot;, &quot;eukaryota</em>odb10&quot;, &quot;auto&quot;)</li><li><code>mode::String=&quot;genome&quot;</code>: BUSCO mode (&quot;genome&quot;, &quot;transcriptome&quot;, &quot;proteins&quot;)</li><li><code>threads::Int=Sys.CPU_THREADS</code>: Number of threads to use</li><li><code>force::Bool=false</code>: Force overwrite existing results</li></ul><p><strong>Returns</strong></p><ul><li><code>String</code>: Path to the output directory containing BUSCO results</li></ul><p><strong>Output Files</strong></p><ul><li><code>short_summary.specific.lineage.txt</code>: Summary statistics</li><li><code>full_table.tsv</code>: Complete BUSCO results table</li><li><code>missing_busco_list.tsv</code>: List of missing BUSCOs</li><li><code>run_lineage/</code>: Detailed results directory</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia hljs"># Basic completeness assessment
assemblies = [&quot;assembly1.fasta&quot;, &quot;assembly2.fasta&quot;]
busco_dir = Mycelia.run_busco(assemblies)

# Specific lineage
busco_dir = Mycelia.run_busco(assemblies, lineage=&quot;bacteria_odb10&quot;)

# Custom parameters
busco_dir = Mycelia.run_busco(assemblies,
                             outdir=&quot;my_busco_results&quot;,
                             lineage=&quot;enterobacterales_odb10&quot;,
                             threads=8)</code></pre><p><strong>Notes</strong></p><ul><li>Requires BUSCO to be installed via Bioconda</li><li>Auto lineage detection requires internet connection for first run</li><li>Available lineages: bacteria<em>odb10, archaea</em>odb10, eukaryota<em>odb10, fungi</em>odb10, etc.</li><li>Results provide Complete, Fragmented, and Missing BUSCO counts</li></ul><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/d3d05bab5a5f88de4585ed603be6c515412f752e/src/quality-control-and-benchmarking.jl#L1038-L1081">source</a></div><div><pre><code class="language-julia hljs">run_busco(assembly_file::String; kwargs...)</code></pre><p>Run BUSCO on a single assembly file. See <code>run_busco(::Vector{String})</code> for details.</p><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/d3d05bab5a5f88de4585ed603be6c515412f752e/src/quality-control-and-benchmarking.jl#L1168-L1172">source</a></div></details></article><article><details class="docstring" open="true"><summary id="Mycelia.run_mummer"><a class="docstring-binding" href="#Mycelia.run_mummer"><code>Mycelia.run_mummer</code></a> — <span class="docstring-category">Function</span></summary><div><pre><code class="language-julia hljs">run_mummer(reference::String, query::String; outdir::String=&quot;mummer_results&quot;, prefix::String=&quot;out&quot;, mincluster::Int=65, minmatch::Int=20, threads::Int=1)</code></pre><p>Run MUMmer for genome comparison and alignment between reference and query sequences.</p><p><strong>Arguments</strong></p><ul><li><code>reference::String</code>: Path to reference genome FASTA file</li><li><code>query::String</code>: Path to query genome FASTA file  </li><li><code>outdir::String=&quot;mummer_results&quot;</code>: Output directory for MUMmer results</li><li><code>prefix::String=&quot;out&quot;</code>: Prefix for output files</li><li><code>mincluster::Int=65</code>: Minimum cluster length for nucmer</li><li><code>minmatch::Int=20</code>: Minimum match length for nucmer</li><li><code>threads::Int=1</code>: Number of threads (note: MUMmer has limited multithreading)</li></ul><p><strong>Returns</strong></p><ul><li><code>String</code>: Path to the output directory containing MUMmer results</li></ul><p><strong>Output Files</strong></p><ul><li><code>prefix.delta</code>: Delta alignment file (main output)</li><li><code>prefix.coords</code>: Human-readable coordinates file</li><li><code>prefix.snps</code>: SNP/indel report (if show-snps is run)</li><li><code>prefix.plot.png</code>: Dot plot visualization (if mummerplot is run)</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia hljs"># Basic genome comparison
ref_genome = &quot;reference.fasta&quot;
query_genome = &quot;assembly.fasta&quot;
mummer_dir = Mycelia.run_mummer(ref_genome, query_genome)

# Custom parameters
mummer_dir = Mycelia.run_mummer(ref_genome, query_genome,
                               outdir=&quot;comparison_results&quot;,
                               prefix=&quot;comparison&quot;,
                               mincluster=100,
                               minmatch=30)</code></pre><p><strong>Notes</strong></p><ul><li>Requires MUMmer to be installed via Bioconda</li><li>nucmer is used for DNA sequence alignment</li><li>show-coords generates human-readable coordinate output</li><li>Results include alignment coordinates, percent identity, and coverage</li><li>For visualization, use mummerplot (requires gnuplot)</li></ul><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/d3d05bab5a5f88de4585ed603be6c515412f752e/src/quality-control-and-benchmarking.jl#L1177-L1221">source</a></div></details></article><h2 id="Annotation"><a class="docs-heading-anchor" href="#Annotation">Annotation</a><a id="Annotation-1"></a><a class="docs-heading-anchor-permalink" href="#Annotation" title="Permalink"></a></h2><h3 id="Gene-Prediction"><a class="docs-heading-anchor" href="#Gene-Prediction">Gene Prediction</a><a id="Gene-Prediction-1"></a><a class="docs-heading-anchor-permalink" href="#Gene-Prediction" title="Permalink"></a></h3><p>Functions for gene prediction and annotation (using external tools):</p><ul><li>Pyrodigal integration</li><li>BLAST+ searches</li><li>MMSeqs2 searches</li><li>TransTerm terminator prediction</li><li>tRNAscan-SE tRNA detection</li><li>MLST typing</li></ul><h2 id="Comparative-Genomics"><a class="docs-heading-anchor" href="#Comparative-Genomics">Comparative Genomics</a><a id="Comparative-Genomics-1"></a><a class="docs-heading-anchor-permalink" href="#Comparative-Genomics" title="Permalink"></a></h2><h2 id="Visualization"><a class="docs-heading-anchor" href="#Visualization">Visualization</a><a id="Visualization-1"></a><a class="docs-heading-anchor-permalink" href="#Visualization" title="Permalink"></a></h2><h3 id="Plotting-Functions"><a class="docs-heading-anchor" href="#Plotting-Functions">Plotting Functions</a><a id="Plotting-Functions-1"></a><a class="docs-heading-anchor-permalink" href="#Plotting-Functions" title="Permalink"></a></h3><article><details class="docstring" open="true"><summary id="Mycelia.visualize_genome_coverage"><a class="docstring-binding" href="#Mycelia.visualize_genome_coverage"><code>Mycelia.visualize_genome_coverage</code></a> — <span class="docstring-category">Function</span></summary><div><pre><code class="language-julia hljs">visualize_genome_coverage(
    coverage_table::DataFrames.AbstractDataFrame;
    entity
) -&gt; Makie.Figure
</code></pre><p>Creates a multi-panel visualization of genome coverage across chromosomes.</p><p><strong>Arguments</strong></p><ul><li><code>coverage_table</code>: DataFrame containing columns &quot;chromosome&quot; and &quot;coverage&quot; with genomic coverage data</li></ul><p><strong>Keyword Arguments</strong></p><ul><li><code>entity</code>: Optional string to specify the entity being analyzed. If provided, chromosome titles become &quot;<span>$(entity): $(chromosome)&quot;, otherwise just &quot;$</span>(chromosome)&quot;</li></ul><p><strong>Returns</strong></p><ul><li><code>CairoMakie.Figure</code>: A composite figure with coverage plots for each chromosome</li></ul><p><strong>Details</strong></p><p>Generates one subplot per chromosome, arranged vertically. Each subplot shows the coverage  distribution across genomic positions for that chromosome.</p><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/d3d05bab5a5f88de4585ed603be6c515412f752e/src/plotting-and-visualization.jl#L1736">source</a></div></details></article><article><details class="docstring" open="true"><summary id="Mycelia.plot_embeddings"><a class="docstring-binding" href="#Mycelia.plot_embeddings"><code>Mycelia.plot_embeddings</code></a> — <span class="docstring-category">Function</span></summary><div><p>Plot embeddings with optional true and fitted cluster labels using Makie.jl,  with legend outside, and color by fit labels, shape by true labels.</p><p><strong>Arguments</strong></p><ul><li><code>embeddings::Matrix{&lt;:Real}</code>: 2D embedding matrix where each column is a data point</li><li><code>title::String</code>: Title of the plot</li><li><code>xlabel::String</code>: Label for the x-axis</li><li><code>ylabel::String</code>: Label for the y-axis</li><li><code>true_labels::Vector{&lt;:Integer}</code>: Vector of true cluster labels (optional)</li><li><code>fit_labels::Vector{&lt;:Integer}</code>: Vector of fitted cluster labels (optional)</li></ul><p><strong>Returns</strong></p><ul><li><code>Makie.Figure</code>: Figure object that can be displayed or saved</li></ul><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/d3d05bab5a5f88de4585ed603be6c515412f752e/src/plotting-and-visualization.jl#L390-L404">source</a></div></details></article><article><details class="docstring" open="true"><summary id="Mycelia.plot_taxa_abundances"><a class="docstring-binding" href="#Mycelia.plot_taxa_abundances"><code>Mycelia.plot_taxa_abundances</code></a> — <span class="docstring-category">Function</span></summary><div><pre><code class="language-julia hljs">plot_taxa_abundances(
    df::DataFrames.DataFrame, 
    taxa_level::String; 
    top_n::Int = 10,
    sample_id_col::String = &quot;sample_id&quot;,
    filter_taxa::Union{Vector{Union{String, Missing}}, Nothing} = nothing,
    figure_width::Int = 1500,
    figure_height::Int = 1000,
    bar_width::Float64 = 0.7,
    x_rotation::Int = 45,
    sort_samples::Bool = true,
    color_seed::Union{Int, Nothing} = nothing,
    legend_fontsize::Float64 = 12.0,
    legend_itemsize::Float64 = 12.0,
    legend_padding::Float64 = 5.0,
    legend_rowgap::Float64 = 1.0,
    legend_labelwidth::Union{Nothing, Float64} = nothing,
    legend_titlesize::Float64 = 15.0,
    legend_nbanks::Int = 1
)</code></pre><p>Create a stacked bar chart showing taxa relative abundances for each sample.</p><p><strong>Arguments</strong></p><ul><li><code>df</code>: DataFrame with sample_id and taxonomic assignments at different levels</li><li><code>taxa_level</code>: Taxonomic level to analyze (e.g., &quot;genus&quot;, &quot;species&quot;)</li><li><code>top_n</code>: Number of top taxa to display individually, remainder grouped as &quot;Other&quot;</li><li><code>sample_id_col</code>: Column name containing sample identifiers</li><li><code>filter_taxa</code>: Taxa to exclude from visualization (default: nothing - no filtering)</li><li><code>figure_width</code>: Width of the figure in pixels</li><li><code>figure_height</code>: Height of the figure in pixels</li><li><code>bar_width</code>: Width of each bar (between 0 and 1)</li><li><code>x_rotation</code>: Rotation angle for x-axis labels in degrees</li><li><code>sort_samples</code>: Whether to sort samples alphabetically</li><li><code>color_seed</code>: Seed for reproducible color generation</li><li><code>legend_fontsize</code>: Font size for legend entries</li><li><code>legend_itemsize</code>: Size of the colored marker/icon in the legend</li><li><code>legend_padding</code>: Padding around legend elements</li><li><code>legend_rowgap</code>: Space between legend rows</li><li><code>legend_labelwidth</code>: Maximum width for legend labels (truncation)</li><li><code>legend_titlesize</code>: Font size for legend title</li><li><code>legend_nbanks</code>: Number of legend columns</li></ul><p><strong>Returns</strong></p><ul><li><code>fig</code>: CairoMakie figure object</li><li><code>ax</code>: CairoMakie axis object</li><li><code>taxa_colors</code>: Dictionary mapping taxa to their assigned colors</li></ul><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/d3d05bab5a5f88de4585ed603be6c515412f752e/src/plotting-and-visualization.jl#L443-L491">source</a></div></details></article><p>For k-mer frequency plotting, see <a href="../api/workflows/sequence-analysis/">Sequence Analysis Workflow</a>.</p><h2 id="Utility-Functions"><a class="docs-heading-anchor" href="#Utility-Functions">Utility Functions</a><a id="Utility-Functions-1"></a><a class="docs-heading-anchor-permalink" href="#Utility-Functions" title="Permalink"></a></h2><h3 id="Memory-Management-(Experimental)"><a class="docs-heading-anchor" href="#Memory-Management-(Experimental)">Memory Management (Experimental)</a><a id="Memory-Management-(Experimental)-1"></a><a class="docs-heading-anchor-permalink" href="#Memory-Management-(Experimental)" title="Permalink"></a></h3><p>Experimental memory management functions (<code>estimate_memory_usage</code>, <code>check_memory_limits</code>) are available in <code>src/development/</code> but not currently part of the public API.</p><h3 id="File-Operations"><a class="docs-heading-anchor" href="#File-Operations">File Operations</a><a id="File-Operations-1"></a><a class="docs-heading-anchor-permalink" href="#File-Operations" title="Permalink"></a></h3><p>Helper functions for robust file handling and data validation.</p><h3 id="Progress-Tracking"><a class="docs-heading-anchor" href="#Progress-Tracking">Progress Tracking</a><a id="Progress-Tracking-1"></a><a class="docs-heading-anchor-permalink" href="#Progress-Tracking" title="Permalink"></a></h3><p>Functions for user feedback during long-running operations.</p><h2 id="Graph-Types-and-Enums"><a class="docs-heading-anchor" href="#Graph-Types-and-Enums">Graph Types and Enums</a><a id="Graph-Types-and-Enums-1"></a><a class="docs-heading-anchor-permalink" href="#Graph-Types-and-Enums" title="Permalink"></a></h2><h3 id="Graph-Modes"><a class="docs-heading-anchor" href="#Graph-Modes">Graph Modes</a><a id="Graph-Modes-1"></a><a class="docs-heading-anchor-permalink" href="#Graph-Modes" title="Permalink"></a></h3><article><details class="docstring" open="true"><summary id="Mycelia.GraphMode"><a class="docstring-binding" href="#Mycelia.GraphMode"><code>Mycelia.GraphMode</code></a> — <span class="docstring-category">Type</span></summary><div><p>Graph mode for handling strand information.</p><ul><li><code>SingleStrand</code>: Sequences are single-stranded (RNA, amino acids, or directional DNA)</li><li><code>DoubleStrand</code>: Sequences are double-stranded DNA/RNA with canonical representation</li></ul><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/d3d05bab5a5f88de4585ed603be6c515412f752e/src/sequence-graphs-next.jl#L19-L23">source</a></div></details></article><article><details class="docstring" open="true"><summary id="Mycelia.StrandOrientation"><a class="docstring-binding" href="#Mycelia.StrandOrientation"><code>Mycelia.StrandOrientation</code></a> — <span class="docstring-category">Type</span></summary><div><p>Strand orientation for k-mer observations and transitions.</p><ul><li><code>Forward</code>: k-mer as observed (5&#39; to 3&#39;)</li><li><code>Reverse</code>: reverse complement of k-mer (3&#39; to 5&#39;)</li></ul><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/d3d05bab5a5f88de4585ed603be6c515412f752e/src/sequence-graphs-next.jl#L12-L16">source</a></div></details></article><p>Used to control how graphs are constructed and oriented.</p><h2 id="Data-Structures"><a class="docs-heading-anchor" href="#Data-Structures">Data Structures</a><a id="Data-Structures-1"></a><a class="docs-heading-anchor-permalink" href="#Data-Structures" title="Permalink"></a></h2><h3 id="Assembly-Results"><a class="docs-heading-anchor" href="#Assembly-Results">Assembly Results</a><a id="Assembly-Results-1"></a><a class="docs-heading-anchor-permalink" href="#Assembly-Results" title="Permalink"></a></h3><p>The result of assembly operations typically includes:</p><ul><li><code>:final_assembly</code>: Vector of assembled sequences</li><li><code>:k_progression</code>: K-mer sizes used</li><li><code>:metadata</code>: Assembly statistics and parameters</li></ul><h3 id="Quality-Metrics"><a class="docs-heading-anchor" href="#Quality-Metrics">Quality Metrics</a><a id="Quality-Metrics-1"></a><a class="docs-heading-anchor-permalink" href="#Quality-Metrics" title="Permalink"></a></h3><p>Standard quality metrics returned by analysis functions:</p><ul><li>Coverage statistics</li><li>Quality score distributions  </li><li>Joint probability calculations</li><li>Assembly completeness measures</li></ul><h2 id="Function-Categories"><a class="docs-heading-anchor" href="#Function-Categories">Function Categories</a><a id="Function-Categories-1"></a><a class="docs-heading-anchor-permalink" href="#Function-Categories" title="Permalink"></a></h2><h3 id="Core-Assembly-Pipeline"><a class="docs-heading-anchor" href="#Core-Assembly-Pipeline">Core Assembly Pipeline</a><a id="Core-Assembly-Pipeline-1"></a><a class="docs-heading-anchor-permalink" href="#Core-Assembly-Pipeline" title="Permalink"></a></h3><ol><li><strong>Input Processing</strong>: <code>open_fastx</code>, <code>convert_sequence</code></li><li><strong>Quality Analysis</strong>: <code>analyze_fastq_quality</code>, qualmer functions</li><li><strong>Assembly</strong>: <code>mycelia_assemble</code>, graph construction</li><li><strong>Validation</strong>: <code>assess_assembly_quality</code>, <code>validate_assembly</code></li><li><strong>Output</strong>: Assembly statistics and final sequences</li></ol><h3 id="Supporting-Workflows"><a class="docs-heading-anchor" href="#Supporting-Workflows">Supporting Workflows</a><a id="Supporting-Workflows-1"></a><a class="docs-heading-anchor-permalink" href="#Supporting-Workflows" title="Permalink"></a></h3><ul><li><strong>Data Acquisition</strong>: Download and simulation functions</li><li><strong>Quality Control</strong>: Filtering and trimming tools</li><li><strong>Analysis</strong>: K-mer analysis and distance calculations</li><li><strong>Visualization</strong>: Plotting and reporting functions</li></ul><h2 id="Type-System"><a class="docs-heading-anchor" href="#Type-System">Type System</a><a id="Type-System-1"></a><a class="docs-heading-anchor-permalink" href="#Type-System" title="Permalink"></a></h2><p>Mycelia uses a strict type system based on BioSequences.jl:</p><ul><li><strong>DNA sequences</strong>: <code>BioSequences.LongDNA{4}</code></li><li><strong>RNA sequences</strong>: <code>BioSequences.LongRNA{4}</code>  </li><li><strong>Protein sequences</strong>: <code>BioSequences.LongAA</code></li><li><strong>K-mers</strong>: <code>Kmers.DNAKmer{K}</code>, <code>Kmers.RNAKmer{K}</code>, <code>Kmers.AAKmer{K}</code></li></ul><h3 id="Quality-Aware-Types"><a class="docs-heading-anchor" href="#Quality-Aware-Types">Quality-Aware Types</a><a id="Quality-Aware-Types-1"></a><a class="docs-heading-anchor-permalink" href="#Quality-Aware-Types" title="Permalink"></a></h3><ul><li><strong>Qualmer</strong>: Combines k-mer with quality scores</li><li><strong>QualmerVertexData</strong>: Graph vertex with quality metadata</li><li><strong>QualmerEdgeData</strong>: Graph edge with transition weights</li></ul><h2 id="Performance-Characteristics"><a class="docs-heading-anchor" href="#Performance-Characteristics">Performance Characteristics</a><a id="Performance-Characteristics-1"></a><a class="docs-heading-anchor-permalink" href="#Performance-Characteristics" title="Permalink"></a></h2><h3 id="Scalability"><a class="docs-heading-anchor" href="#Scalability">Scalability</a><a id="Scalability-1"></a><a class="docs-heading-anchor-permalink" href="#Scalability" title="Permalink"></a></h3><p>Most functions scale as follows with input size:</p><ul><li><strong>Linear</strong>: File I/O, k-mer counting</li><li><strong>Quadratic</strong>: Distance matrix calculations</li><li><strong>Variable</strong>: Assembly (depends on complexity)</li></ul><h3 id="Memory-Usage"><a class="docs-heading-anchor" href="#Memory-Usage">Memory Usage</a><a id="Memory-Usage-1"></a><a class="docs-heading-anchor-permalink" href="#Memory-Usage" title="Permalink"></a></h3><p>Typical memory requirements:</p><ul><li><strong>Small genomes</strong> (&lt; 10 Mb): 1-4 GB RAM</li><li><strong>Bacterial genomes</strong> (1-10 Mb): 4-16 GB RAM  </li><li><strong>Large genomes</strong> (&gt; 100 Mb): 32-128 GB RAM</li></ul><p>Use <code>memory_limit</code> parameters to control usage.</p><h3 id="Parallelization"><a class="docs-heading-anchor" href="#Parallelization">Parallelization</a><a id="Parallelization-1"></a><a class="docs-heading-anchor-permalink" href="#Parallelization" title="Permalink"></a></h3><p>Functions that support parallel execution:</p><ul><li>K-mer counting (automatic)</li><li>Assembly (multi-threaded)</li><li>Quality analysis (vectorized)</li></ul><p>Set <code>JULIA_NUM_THREADS</code> environment variable for best performance.</p><h2 id="Error-Handling"><a class="docs-heading-anchor" href="#Error-Handling">Error Handling</a><a id="Error-Handling-1"></a><a class="docs-heading-anchor-permalink" href="#Error-Handling" title="Permalink"></a></h2><h3 id="Common-Exceptions"><a class="docs-heading-anchor" href="#Common-Exceptions">Common Exceptions</a><a id="Common-Exceptions-1"></a><a class="docs-heading-anchor-permalink" href="#Common-Exceptions" title="Permalink"></a></h3><ul><li><code>ArgumentError</code>: Invalid parameters</li><li><code>MethodError</code>: Wrong types</li><li><code>OutOfMemoryError</code>: Insufficient RAM</li><li><code>SystemError</code>: File I/O issues</li></ul><h3 id="Debugging-Tips"><a class="docs-heading-anchor" href="#Debugging-Tips">Debugging Tips</a><a id="Debugging-Tips-1"></a><a class="docs-heading-anchor-permalink" href="#Debugging-Tips" title="Permalink"></a></h3><ol><li><strong>Check inputs</strong>: Use <code>typeof()</code> and <code>length()</code> </li><li><strong>Monitor memory</strong>: Use <code>memory_limit</code> parameters</li><li><strong>Enable logging</strong>: Set <code>verbose=true</code> in functions where applicable</li><li><strong>Test subset</strong>: Use smaller datasets for debugging</li></ol><h2 id="Integration-Points"><a class="docs-heading-anchor" href="#Integration-Points">Integration Points</a><a id="Integration-Points-1"></a><a class="docs-heading-anchor-permalink" href="#Integration-Points" title="Permalink"></a></h2><h3 id="External-Tools"><a class="docs-heading-anchor" href="#External-Tools">External Tools</a><a id="External-Tools-1"></a><a class="docs-heading-anchor-permalink" href="#External-Tools" title="Permalink"></a></h3><p>Mycelia integrates with numerous bioinformatics tools via Bioconda:</p><ul><li><strong>Assemblers</strong>: SPAdes, Megahit, Miniasm, Raven</li><li><strong>QC Tools</strong>: FastP, Filtlong, Trim Galore</li><li><strong>Validators</strong>: QUAST, BUSCO, MUMmer</li><li><strong>Annotators</strong>: Pyrodigal, BLAST+, MMSeqs2</li></ul><h3 id="File-Formats"><a class="docs-heading-anchor" href="#File-Formats">File Formats</a><a id="File-Formats-1"></a><a class="docs-heading-anchor-permalink" href="#File-Formats" title="Permalink"></a></h3><p>Supported formats:</p><ul><li><strong>Input</strong>: FASTA, FASTQ (including gzipped)</li><li><strong>Output</strong>: FASTA, CSV, JSON, JLD2</li><li><strong>Intermediate</strong>: Graph formats, quality scores</li></ul><h2 id="Version-Compatibility"><a class="docs-heading-anchor" href="#Version-Compatibility">Version Compatibility</a><a id="Version-Compatibility-1"></a><a class="docs-heading-anchor-permalink" href="#Version-Compatibility" title="Permalink"></a></h2><p>This documentation corresponds to Mycelia version 0.1.0+. </p><ul><li><strong>Breaking changes</strong> will be noted in release notes</li><li><strong>Deprecated functions</strong> include migration guidance</li><li><strong>Experimental features</strong> are clearly marked</li></ul><p>For the latest updates, see the <a href="https://github.com/cjprybol/Mycelia/blob/main/CHANGELOG.md">CHANGELOG</a>.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../faq/">« FAQ</a><a class="docs-footer-nextpage" href="../api/workflows/assembly-suite/">Assembly Suite »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.0 on <span class="colophon-date" title="Monday 17 November 2025 14:40">Monday 17 November 2025</span>. Using Julia version 1.10.10.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
