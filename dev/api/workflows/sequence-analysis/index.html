<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Sequence Analysis &amp; K-mers · Mycelia</title><meta name="title" content="Sequence Analysis &amp; K-mers · Mycelia"/><meta property="og:title" content="Sequence Analysis &amp; K-mers · Mycelia"/><meta property="twitter:title" content="Sequence Analysis &amp; K-mers · Mycelia"/><meta name="description" content="Documentation for Mycelia."/><meta property="og:description" content="Documentation for Mycelia."/><meta property="twitter:description" content="Documentation for Mycelia."/><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../search_index.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../../">Mycelia</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../../">Home</a></li><li><a class="tocitem" href="../../../installation/">Installation</a></li><li><a class="tocitem" href="../../../getting-started/">Getting Started</a></li><li><a class="tocitem" href="../../../concepts/">Concepts</a></li><li><a class="tocitem" href="../../../probabilistic-assembly-hub/">Probabilistic Assembly</a></li><li><span class="tocitem">Documentation</span><ul><li><a class="tocitem" href="../../../architecture/">Architecture Overview</a></li><li><a class="tocitem" href="../../../assembly-method-selection/">Assembly Method Selection</a></li><li><a class="tocitem" href="../../../performance/">Performance Guide</a></li><li><a class="tocitem" href="../../../faq/">FAQ</a></li></ul></li><li><span class="tocitem">API Reference</span><ul><li><a class="tocitem" href="../../../api-reference/">Complete API Reference</a></li><li><input class="collapse-toggle" id="menuitem-7-2" type="checkbox"/><label class="tocitem" for="menuitem-7-2"><span class="docs-label">Workflows</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../assembly-suite/">Assembly Suite</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-7-3" type="checkbox"/><label class="tocitem" for="menuitem-7-3"><span class="docs-label">Quick Reference</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../quick-reference/parameter-guide/">Parameter Guide</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-7-4" type="checkbox"/><label class="tocitem" for="menuitem-7-4"><span class="docs-label">Examples</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../examples/basic-workflows/">Basic Workflows</a></li></ul></li><li><a class="tocitem" href="../../">Legacy API Documentation</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Sequence Analysis &amp; K-mers</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Sequence Analysis &amp; K-mers</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/cjprybol/Mycelia/blob/master/docs/src/api/workflows/sequence-analysis.md#L" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Sequence-Analysis-and-K-mers"><a class="docs-heading-anchor" href="#Sequence-Analysis-and-K-mers">Sequence Analysis &amp; K-mers</a><a id="Sequence-Analysis-and-K-mers-1"></a><a class="docs-heading-anchor-permalink" href="#Sequence-Analysis-and-K-mers" title="Permalink"></a></h1><p>Functions for analyzing sequence composition, counting k-mers, and extracting genomic features from sequencing data.</p><h2 id="Overview"><a class="docs-heading-anchor" href="#Overview">Overview</a><a id="Overview-1"></a><a class="docs-heading-anchor-permalink" href="#Overview" title="Permalink"></a></h2><p>Sequence analysis forms the foundation of many bioinformatics algorithms. Mycelia provides comprehensive tools for:</p><ul><li><strong>K-mer counting and analysis</strong> using efficient algorithms</li><li><strong>Genome size estimation</strong> from k-mer frequency spectra</li><li><strong>Error detection and correction</strong> using k-mer patterns</li><li><strong>Sequence composition analysis</strong> and bias detection</li><li><strong>Memory-efficient processing</strong> of large datasets</li></ul><h2 id="Common-Workflows"><a class="docs-heading-anchor" href="#Common-Workflows">Common Workflows</a><a id="Common-Workflows-1"></a><a class="docs-heading-anchor-permalink" href="#Common-Workflows" title="Permalink"></a></h2><h3 id="1.-Basic-K-mer-Analysis"><a class="docs-heading-anchor" href="#1.-Basic-K-mer-Analysis">1. Basic K-mer Analysis</a><a id="1.-Basic-K-mer-Analysis-1"></a><a class="docs-heading-anchor-permalink" href="#1.-Basic-K-mer-Analysis" title="Permalink"></a></h3><pre><code class="language-julia hljs"># Count k-mers in sequencing reads
kmer_counts = Mycelia.count_kmers(&quot;reads.fastq&quot;, k=21)

# Analyze k-mer frequency spectrum
spectrum = Mycelia.kmer_frequency_spectrum(kmer_counts)</code></pre><h3 id="2.-Genome-Size-Estimation"><a class="docs-heading-anchor" href="#2.-Genome-Size-Estimation">2. Genome Size Estimation</a><a id="2.-Genome-Size-Estimation-1"></a><a class="docs-heading-anchor-permalink" href="#2.-Genome-Size-Estimation" title="Permalink"></a></h3><pre><code class="language-julia hljs"># Estimate genome size from k-mer spectrum
genome_size = Mycelia.estimate_genome_size_from_kmers(kmer_counts, coverage_peak=30)</code></pre><h3 id="3.-Contamination-Detection"><a class="docs-heading-anchor" href="#3.-Contamination-Detection">3. Contamination Detection</a><a id="3.-Contamination-Detection-1"></a><a class="docs-heading-anchor-permalink" href="#3.-Contamination-Detection" title="Permalink"></a></h3><pre><code class="language-julia hljs"># Detect contamination using k-mer profiles
contamination = Mycelia.detect_contamination_kmers(&quot;reads.fastq&quot;, expected_profile)</code></pre><h2 id="K-mer-Counting"><a class="docs-heading-anchor" href="#K-mer-Counting">K-mer Counting</a><a id="K-mer-Counting-1"></a><a class="docs-heading-anchor-permalink" href="#K-mer-Counting" title="Permalink"></a></h2><h3 id="Basic-K-mer-Counting"><a class="docs-heading-anchor" href="#Basic-K-mer-Counting">Basic K-mer Counting</a><a id="Basic-K-mer-Counting-1"></a><a class="docs-heading-anchor-permalink" href="#Basic-K-mer-Counting" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.count_kmers" href="#Mycelia.count_kmers"><code>Mycelia.count_kmers</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">count_kmers(
    _::Type{Kmers.Kmer{A&lt;:BioSequences.DNAAlphabet, K}},
    sequence::BioSequences.LongSequence
) -&gt; Any
</code></pre><p>Count the frequency of each k-mer in a DNA sequence.</p><p><strong>Arguments</strong></p><ul><li><code>::Type{Kmers.Kmer{A,K}}</code>: K-mer type with alphabet A and length K</li><li><code>sequence::BioSequences.LongSequence</code>: Input DNA sequence to analyze</li></ul><p><strong>Returns</strong></p><p>A sorted dictionary mapping each k-mer to its frequency count in the sequence.</p><p><strong>Type Parameters</strong></p><ul><li><code>A &lt;: BioSequences.DNAAlphabet</code>: DNA alphabet type</li><li><code>K</code>: Length of k-mers</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/e16be08966fe44045f5442a9fabac9a063f5015f/src/kmer-analysis.jl#LL1488">source</a></section><section><div><pre><code class="language-julia hljs">count_kmers(
    _::Type{Kmers.Kmer{A&lt;:BioSequences.RNAAlphabet, K}},
    sequence::BioSequences.LongSequence
) -&gt; Any
</code></pre><p>Count the frequency of each k-mer in an RNA sequence.</p><p><strong>Arguments</strong></p><ul><li><code>Kmer</code>: Type parameter specifying the k-mer length K and RNA alphabet</li><li><code>sequence</code>: Input RNA sequence to analyze</li></ul><p><strong>Returns</strong></p><ul><li><code>Dict{Kmers.Kmer, Int}</code>: Sorted dictionary mapping each k-mer to its frequency count</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/e16be08966fe44045f5442a9fabac9a063f5015f/src/kmer-analysis.jl#LL1509">source</a></section><section><div><pre><code class="language-julia hljs">count_kmers(
    _::Type{Kmers.Kmer{A&lt;:BioSequences.AminoAcidAlphabet, K}},
    sequence::BioSequences.LongSequence
) -&gt; OrderedCollections.OrderedDict{K, Int64} where K&lt;:(Kmers.Kmer{BioSequences.AminoAcidAlphabet, _A, _B} where {_B, _A})
</code></pre><p>Count the frequency of amino acid k-mers in a biological sequence.</p><p><strong>Arguments</strong></p><ul><li><code>Kmers.Kmer{A,K}</code>: Type parameter specifying amino acid alphabet (A) and k-mer length (K)</li><li><code>sequence</code>: Input biological sequence to analyze</li></ul><p><strong>Returns</strong></p><p>A sorted dictionary mapping each k-mer to its frequency count in the sequence.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/e16be08966fe44045f5442a9fabac9a063f5015f/src/kmer-analysis.jl#LL1526">source</a></section><section><div><pre><code class="language-julia hljs">count_kmers(
    _::Type{KMER_TYPE},
    record::Union{FASTX.FASTA.Record, FASTX.FASTQ.Record}
) -&gt; Any
</code></pre><p>Count the frequency of amino acid k-mers in a biological sequence.</p><p><strong>Arguments</strong></p><ul><li><code>Kmers.Kmer{A,K}</code>: Type parameter specifying amino acid alphabet (A) and k-mer length (K)</li><li><code>sequence</code>: Input biological sequence to analyze</li></ul><p><strong>Returns</strong></p><p>A sorted dictionary mapping each k-mer to its frequency count in the sequence.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/e16be08966fe44045f5442a9fabac9a063f5015f/src/kmer-analysis.jl#LL1543">source</a></section><section><div><pre><code class="language-julia hljs">count_kmers(
    _::Type{KMER_TYPE},
    records::AbstractArray{T&lt;:Union{FASTX.FASTA.Record, FASTX.FASTQ.Record}, 1}
) -&gt; Any
</code></pre><p>Count k-mers across multiple sequence records and return a sorted frequency table.</p><p><strong>Arguments</strong></p><ul><li><code>KMER_TYPE</code>: Type parameter specifying the k-mer length (e.g., <code>DNAKmer{3}</code> for 3-mers)</li><li><code>records</code>: Vector of FASTA/FASTQ records to analyze</li></ul><p><strong>Returns</strong></p><ul><li><code>Dict{KMER_TYPE, Int}</code>: Sorted dictionary mapping k-mers to their frequencies</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/e16be08966fe44045f5442a9fabac9a063f5015f/src/kmer-analysis.jl#LL1568">source</a></section><section><div><pre><code class="language-julia hljs">count_kmers(
    _::Type{KMER_TYPE},
    sequences::Union{FASTX.FASTA.Reader, FASTX.FASTQ.Reader}
) -&gt; Any
</code></pre><p>Counts k-mer occurrences in biological sequences from a FASTA/FASTQ reader.</p><p><strong>Arguments</strong></p><ul><li><code>KMER_TYPE</code>: Type parameter specifying the k-mer length and encoding (e.g., <code>DNAKmer{4}</code> for 4-mers)</li><li><code>sequences</code>: A FASTA or FASTQ reader containing the biological sequences to analyze</li></ul><p><strong>Returns</strong></p><p>A dictionary mapping k-mers to their counts in the input sequences</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/e16be08966fe44045f5442a9fabac9a063f5015f/src/kmer-analysis.jl#LL1589">source</a></section><section><div><pre><code class="language-julia hljs">count_kmers(
    _::Type{KMER_TYPE},
    fastx_files::AbstractArray{T&lt;:AbstractString, 1}
) -&gt; Any
</code></pre><p>Count k-mers across multiple FASTA/FASTQ files and merge the results.</p><p><strong>Arguments</strong></p><ul><li><code>KMER_TYPE</code>: Type parameter specifying the k-mer length (e.g., <code>DNAKmer{4}</code> for 4-mers)</li><li><code>fastx_files</code>: Vector of paths to FASTA/FASTQ files</li></ul><p><strong>Returns</strong></p><ul><li><code>Dict{KMER_TYPE, Int}</code>: Dictionary mapping k-mers to their total counts across all files</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/e16be08966fe44045f5442a9fabac9a063f5015f/src/kmer-analysis.jl#LL1605">source</a></section><section><div><pre><code class="language-julia hljs">count_kmers(
    _::Type{KMER_TYPE},
    fastx_file::AbstractString
) -&gt; Any
</code></pre><p>Count k-mers in a FASTA/FASTQ file and return their frequencies.</p><p><strong>Arguments</strong></p><ul><li><code>KMER_TYPE</code>: Type parameter specifying the k-mer type (e.g., <code>DNAKmer{K}</code>)</li><li><code>fastx_file</code>: Path to input FASTA/FASTQ file</li></ul><p><strong>Returns</strong></p><ul><li><code>Dict{KMER_TYPE, Int}</code>: Dictionary mapping each k-mer to its frequency</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/e16be08966fe44045f5442a9fabac9a063f5015f/src/kmer-analysis.jl#LL1626">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.count_canonical_kmers" href="#Mycelia.count_canonical_kmers"><code>Mycelia.count_canonical_kmers</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">count_canonical_kmers(_::Type{KMER_TYPE}, sequences) -&gt; Any
</code></pre><p>Count canonical k-mers in biological sequences. A canonical k-mer is the lexicographically  smaller of a DNA sequence and its reverse complement, ensuring strand-independent counting.</p><p><strong>Arguments</strong></p><ul><li><code>KMER_TYPE</code>: Type parameter specifying the k-mer size and structure</li><li><code>sequences</code>: Iterator of biological sequences to analyze</li></ul><p><strong>Returns</strong></p><ul><li><code>Dict{KMER_TYPE,Int}</code>: Dictionary mapping canonical k-mers to their counts</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/e16be08966fe44045f5442a9fabac9a063f5015f/src/kmer-analysis.jl#LL1470">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.fasta_list_to_dense_kmer_counts" href="#Mycelia.fasta_list_to_dense_kmer_counts"><code>Mycelia.fasta_list_to_dense_kmer_counts</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">fasta_list_to_dense_kmer_counts(
;
    fasta_list,
    k,
    alphabet,
    temp_dir_parent,
    count_element_type,
    result_file,
    force,
    cleanup_temp,
    force_threading,
    force_temp_files,
    force_progress_bars,
    threading_file_threshold,
    threading_size_threshold,
    memory_safety_factor,
    progress_time_threshold
)
</code></pre><p>Create a dense k-mer counts table for a set of FASTA files, with disk-backed temporary storage,  custom element type, robust error handling, and optional output file caching.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/e16be08966fe44045f5442a9fabac9a063f5015f/src/kmer-analysis.jl#LL1763">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.fasta_list_to_sparse_kmer_counts" href="#Mycelia.fasta_list_to_sparse_kmer_counts"><code>Mycelia.fasta_list_to_sparse_kmer_counts</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">fasta_list_to_sparse_kmer_counts(
;
    fasta_list,
    k,
    alphabet,
    temp_dir_parent,
    count_element_type,
    rarefaction_data_filename,
    rarefaction_plot_basename,
    show_rarefaction_plot,
    skip_rarefaction_plot,
    result_file,
    out_dir,
    force,
    force_threading,
    force_temp_files,
    force_progress_bars,
    skip_rarefaction_data,
    threading_file_threshold,
    threading_size_threshold,
    memory_safety_factor,
    progress_time_threshold,
    rarefaction_plot_kwargs...
)
</code></pre><p>Create a sparse kmer counts table (SparseMatrixCSC) from a list of FASTA files using a 3-pass approach. Pass 1 (Parallel): Counts kmers per file and writes to temporary JLD2 files. Pass 2 (Serial): Aggregates unique kmers, max count, nnz per file, and rarefaction data from temp files.                  Generates and saves a k-mer rarefaction plot. Pass 3 (Parallel): Reads temporary counts again to construct the final sparse matrix.</p><p>Optionally, a results filename can be provided to save/load the output. If the file exists and <code>force</code> is false, the result is loaded and returned. If <code>force</code> is true or the file does not exist, results are computed and saved.</p><p><strong>Output Directory Behavior</strong></p><ul><li>All auxiliary output files (e.g., rarefaction data, plots) are written to a common output directory.</li><li>By default, this is:<ul><li>The value of <code>out_dir</code> if provided.</li><li>Otherwise, the directory containing <code>result_file</code> (if provided and has a directory component).</li><li>Otherwise, the current working directory (<code>pwd()</code>).</li></ul></li><li>If you provide an absolute path for an output file (e.g. <code>rarefaction_data_filename</code>), that path is used directly.</li><li>If both <code>out_dir</code> and a relative filename are given, the file is written to <code>out_dir</code>.</li></ul><p><strong>Arguments</strong></p><ul><li><code>fasta_list::AbstractVector{&lt;:AbstractString}</code>: A list of paths to FASTA files.</li><li><code>k::Integer</code>: The length of the kmer.</li><li><code>alphabet::Symbol</code>: The alphabet type (:AA, :DNA, :RNA).</li><li><code>temp_dir_parent::AbstractString</code>: Parent directory for creating the temporary working directory. Defaults to <code>Base.tempdir()</code>.</li><li><code>count_element_type::Union{Type{&lt;:Unsigned}, Nothing}</code>: Optional. Specifies the unsigned integer type for the counts. If <code>nothing</code> (default), the smallest <code>UInt</code> type capable of holding the maximum observed count is used.</li><li><code>rarefaction_data_filename::AbstractString</code>: Filename for the TSV output of rarefaction data. If a relative path, will be written to <code>out_dir</code>.</li><li><code>rarefaction_plot_basename::AbstractString</code>: Basename for the output rarefaction plots. If a relative path, will be written to <code>out_dir</code>.</li><li><code>show_rarefaction_plot::Bool</code>: Whether to display the rarefaction plot after generation. Defaults to <code>true</code>.</li><li><code>skip_rarefaction_plot::Bool</code>: If true, completely skip rarefaction plot generation (including loading plotting libraries). Defaults to <code>false</code>.</li><li><code>result_file::Union{Nothing, AbstractString}</code>: Optional. If provided, path to a file to save/load the full results (kmers, counts, etc) as a JLD2 file.</li><li><code>out_dir::Union{Nothing, AbstractString}</code>: Optional. Output directory for auxiliary outputs. Defaults as described above.</li><li><code>force::Bool</code>: If true, recompute and overwrite the output file even if it exists. Defaults to <code>false</code>.</li><li><code>rarefaction_plot_kwargs...</code>: Keyword arguments to pass to <code>plot_kmer_rarefaction</code> for plot customization.</li></ul><p><strong>Returns</strong></p><ul><li><code>NamedTuple{(:kmers, :counts, :rarefaction_data_path)}</code>:<ul><li><code>kmers</code>: A sorted <code>Vector</code> of unique kmer objects.</li><li><code>counts</code>: A <code>SparseArrays.SparseMatrixCSC{V, Int}</code> storing kmer counts.</li><li><code>rarefaction_data_path</code>: Path to the saved TSV file with rarefaction data.</li></ul></li></ul><p><strong>Raises</strong></p><ul><li><code>ErrorException</code>: If input <code>fasta_list</code> is empty, alphabet is invalid, or required Kmer/counting functions are not found.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/e16be08966fe44045f5442a9fabac9a063f5015f/src/kmer-analysis.jl#LL922">source</a></section></article><h4 id="Example:-K-mer-Counting-Comparison"><a class="docs-heading-anchor" href="#Example:-K-mer-Counting-Comparison">Example: K-mer Counting Comparison</a><a id="Example:-K-mer-Counting-Comparison-1"></a><a class="docs-heading-anchor-permalink" href="#Example:-K-mer-Counting-Comparison" title="Permalink"></a></h4><pre><code class="language-julia hljs"># Compare different k-mer counting approaches
reads_file = &quot;reads.fastq&quot;

# Dense counting (stores all possible k-mers)
dense_counts = Mycelia.count_kmers(reads_file, k=15, method=&quot;dense&quot;)
println(&quot;Dense matrix size: $(size(dense_counts))&quot;)

# Sparse counting (only observed k-mers)
sparse_counts = Mycelia.count_kmers(reads_file, k=21, method=&quot;sparse&quot;)
println(&quot;Unique k-mers: $(length(sparse_counts))&quot;)

# Canonical k-mers (combines forward and reverse complement)
canonical_counts = Mycelia.count_canonical_kmers(reads_file, k=21)
println(&quot;Canonical k-mers: $(length(canonical_counts))&quot;)</code></pre><h3 id="Advanced-K-mer-Analysis"><a class="docs-heading-anchor" href="#Advanced-K-mer-Analysis">Advanced K-mer Analysis</a><a id="Advanced-K-mer-Analysis-1"></a><a class="docs-heading-anchor-permalink" href="#Advanced-K-mer-Analysis" title="Permalink"></a></h3><p>&lt;!– build<em>kmer</em>graph, find<em>kmer</em>overlaps, extract<em>kmer</em>paths, analyze<em>kmer</em>connectivity not yet implemented as documented –&gt;</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.build_kmer_graph_next" href="#Mycelia.build_kmer_graph_next"><code>Mycelia.build_kmer_graph_next</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">build_kmer_graph_next(
    kmer_type,
    observations::AbstractVector{&lt;:Union{FASTX.FASTA.Record, FASTX.FASTQ.Record}};
    graph_mode
) -&gt; MetaGraphsNext.MetaGraph{Int64, Graphs.SimpleGraphs.SimpleDiGraph{Int64}, Label, VertexData, EdgeData, Nothing, WeightFunction, Float64} where {Label, VertexData, EdgeData, WeightFunction}
</code></pre><p>Create a next-generation, type-stable k-mer graph using MetaGraphsNext.</p><p>This implementation uses canonical k-mers as vertices with strand-aware edges that respect biological transition constraints for both single-strand and double-strand sequences.</p><p><strong>Arguments</strong></p><ul><li><code>kmer_type</code>: Type of k-mer (e.g., DNAKmer{K})</li><li><code>observations</code>: Vector of FASTA/FASTQ records</li><li><code>graph_mode</code>: <code>SingleStrand</code> for directional sequences, <code>DoubleStrand</code> for DNA (default)</li></ul><p><strong>Returns</strong></p><ul><li><code>MetaGraphsNext.MetaGraph</code> with canonical vertices and strand-aware edges</li></ul><p><strong>Details</strong></p><ul><li><strong>Vertices</strong>: Always canonical k-mers (lexicographically smaller of kmer/reverse_complement)</li><li><strong>Edges</strong>: Strand-aware transitions that respect biological constraints</li><li><strong>SingleStrand mode</strong>: Only forward-strand transitions allowed</li><li><strong>DoubleStrand mode</strong>: Both forward and reverse-complement transitions allowed</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/e16be08966fe44045f5442a9fabac9a063f5015f/src/sequence-graphs-next.jl#LL74">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.build_stranded_kmer_graph" href="#Mycelia.build_stranded_kmer_graph"><code>Mycelia.build_stranded_kmer_graph</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">build_stranded_kmer_graph(
    kmer_type,
    observations::AbstractVector{&lt;:Union{FASTX.FASTA.Record, FASTX.FASTQ.Record}}
) -&gt; MetaGraphs.MetaDiGraph{T, Float64} where T&lt;:Integer
</code></pre><p>Create a weighted, strand-specific kmer (de bruijn) graph from a set of kmers and a series of sequence observations in FASTA format.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/e16be08966fe44045f5442a9fabac9a063f5015f/src/sequence-graphs.jl#LL1">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.build_directed_kmer_graph" href="#Mycelia.build_directed_kmer_graph"><code>Mycelia.build_directed_kmer_graph</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">build_directed_kmer_graph(; fastq, k, plot)
</code></pre><p>Constructs a directed graph representation of k-mer transitions from FASTQ sequencing data.</p><p><strong>Arguments</strong></p><ul><li><code>fastq</code>: Path to input FASTQ file</li><li><code>k</code>: K-mer size (default: 1). Must be odd and prime. If k=1, optimal size is auto-determined</li><li><code>plot</code>: Boolean to display quality distribution plot (default: false)</li></ul><p><strong>Returns</strong></p><p>MetaDiGraph with properties:</p><ul><li>assembly_k: k-mer size used</li><li>kmer_counts: frequency of each k-mer</li><li>transition_likelihoods: edge weights between k-mers</li><li>kmer<em>mean</em>quality, kmer<em>total</em>quality: quality metrics</li><li>branching<em>nodes, unbranching</em>nodes: topological classification</li><li>likely<em>valid</em>kmer_indices: k-mers above mean quality threshold</li><li>likely<em>sequencing</em>artifact_indices: potential erroneous k-mers</li></ul><p><strong>Note</strong></p><p>For DNA assembly, quality scores are normalized across both strands.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/e16be08966fe44045f5442a9fabac9a063f5015f/src/sequence-graphs.jl#LL382">source</a></section></article><h4 id="Example:-K-mer-Graph-Construction"><a class="docs-heading-anchor" href="#Example:-K-mer-Graph-Construction">Example: K-mer Graph Construction</a><a id="Example:-K-mer-Graph-Construction-1"></a><a class="docs-heading-anchor-permalink" href="#Example:-K-mer-Graph-Construction" title="Permalink"></a></h4><pre><code class="language-julia hljs"># Build k-mer overlap graph
kmer_graph = Mycelia.build_kmer_graph(
    sequences,
    k=31,
    min_overlap=20,
    min_coverage=5
)

# Analyze graph properties
graph_stats = Mycelia.analyze_kmer_connectivity(kmer_graph)
println(&quot;Graph nodes: $(graph_stats.n_nodes)&quot;)
println(&quot;Graph edges: $(graph_stats.n_edges)&quot;)
println(&quot;Connected components: $(graph_stats.n_components)&quot;)</code></pre><h2 id="K-mer-Frequency-Analysis"><a class="docs-heading-anchor" href="#K-mer-Frequency-Analysis">K-mer Frequency Analysis</a><a id="K-mer-Frequency-Analysis-1"></a><a class="docs-heading-anchor-permalink" href="#K-mer-Frequency-Analysis" title="Permalink"></a></h2><h3 id="Frequency-Spectra"><a class="docs-heading-anchor" href="#Frequency-Spectra">Frequency Spectra</a><a id="Frequency-Spectra-1"></a><a class="docs-heading-anchor-permalink" href="#Frequency-Spectra" title="Permalink"></a></h3><p>&lt;!– kmer<em>frequency</em>spectrum, analyze<em>spectrum</em>peaks, fit<em>spectrum</em>model not yet implemented as documented –&gt;</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.jellyfish_counts_to_kmer_frequency_histogram" href="#Mycelia.jellyfish_counts_to_kmer_frequency_histogram"><code>Mycelia.jellyfish_counts_to_kmer_frequency_histogram</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">jellyfish_counts_to_kmer_frequency_histogram(
    jellyfish_counts_file
) -&gt; Any
jellyfish_counts_to_kmer_frequency_histogram(
    jellyfish_counts_file,
    outfile
) -&gt; Any
</code></pre><p>Convert a Jellyfish k-mer count file into a frequency histogram.</p><p><strong>Arguments</strong></p><ul><li><code>jellyfish_counts_file::String</code>: Path to the gzipped TSV file containing Jellyfish k-mer counts</li><li><code>outfile::String=replace(jellyfish_counts_file, r&quot;\.tsv\.gz$&quot; =&gt; &quot;.count_histogram.tsv&quot;)</code>: Optional output file path</li></ul><p><strong>Returns</strong></p><ul><li><code>String</code>: Path to the generated histogram file</li></ul><p><strong>Description</strong></p><p>Processes a Jellyfish k-mer count file to create a frequency histogram where:</p><ul><li>Column 1: Number of k-mers that share the same count</li><li>Column 2: The count they share</li></ul><p>Uses system sorting with LC_ALL=C for optimal performance on large files.</p><p>Notes</p><ul><li>Requires gzip, sort, uniq, and sed command line tools</li><li>Uses intermediate disk storage for sorting large files</li><li>Skips processing if output file already exists</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/e16be08966fe44045f5442a9fabac9a063f5015f/src/kmer-analysis.jl#LL285">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.plot_kmer_frequency_spectra" href="#Mycelia.plot_kmer_frequency_spectra"><code>Mycelia.plot_kmer_frequency_spectra</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">plot_kmer_frequency_spectra(
    counts;
    log_scale,
    kwargs...
) -&gt; Plots.Plot
</code></pre><p>Plots a histogram of kmer counts against # of kmers with those counts</p><p>Returns the plot object for adding additional layers and saving</p><p>Creates a scatter plot visualizing the k-mer frequency spectrum - the relationship between k-mer frequencies and how many k-mers occur at each frequency.</p><p><strong>Arguments</strong></p><ul><li><code>counts::AbstractVector{&lt;:Integer}</code>: Vector of k-mer counts/frequencies</li><li><code>log_scale::Union{Function,Nothing} = log2</code>: Function to apply logarithmic scaling to both axes. Set to <code>nothing</code> to use linear scaling.</li><li><code>kwargs...</code>: Additional keyword arguments passed to <code>StatsPlots.plot()</code></li></ul><p><strong>Returns</strong></p><ul><li><code>Plots.Plot</code>: A scatter plot object that can be further modified or saved</li></ul><p><strong>Details</strong></p><p>The x-axis shows k-mer frequencies (how many times each k-mer appears), while the y-axis shows how many distinct k-mers appear at each frequency. Both axes are log-scaled by default using log2.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/e16be08966fe44045f5442a9fabac9a063f5015f/src/plotting-and-visualization.jl#LL2618">source</a></section></article><h4 id="Example:-K-mer-Spectrum-Analysis"><a class="docs-heading-anchor" href="#Example:-K-mer-Spectrum-Analysis">Example: K-mer Spectrum Analysis</a><a id="Example:-K-mer-Spectrum-Analysis-1"></a><a class="docs-heading-anchor-permalink" href="#Example:-K-mer-Spectrum-Analysis" title="Permalink"></a></h4><pre><code class="language-julia hljs"># Generate and analyze k-mer frequency spectrum
kmer_counts = Mycelia.count_kmers(&quot;reads.fastq&quot;, k=21)
spectrum = Mycelia.kmer_frequency_spectrum(kmer_counts)

# Identify characteristic peaks
peaks = Mycelia.analyze_spectrum_peaks(spectrum)
println(&quot;Coverage peak at frequency: $(peaks.main_peak)&quot;)
println(&quot;Error peak at frequency: $(peaks.error_peak)&quot;)

# Fit mathematical model to spectrum
model = Mycelia.fit_spectrum_model(spectrum, model_type=&quot;negative_binomial&quot;)
println(&quot;Model fit R²: $(model.r_squared)&quot;)</code></pre><h3 id="Genome-Characteristics-from-K-mers"><a class="docs-heading-anchor" href="#Genome-Characteristics-from-K-mers">Genome Characteristics from K-mers</a><a id="Genome-Characteristics-from-K-mers-1"></a><a class="docs-heading-anchor-permalink" href="#Genome-Characteristics-from-K-mers" title="Permalink"></a></h3><p>&lt;!– estimate<em>genome</em>size<em>from</em>kmers, estimate<em>coverage</em>from<em>kmers, detect</em>repetitive<em>kmers, calculate</em>genome_complexity not yet implemented as documented –&gt;</p><h4 id="Example:-Genome-Size-Estimation"><a class="docs-heading-anchor" href="#Example:-Genome-Size-Estimation">Example: Genome Size Estimation</a><a id="Example:-Genome-Size-Estimation-1"></a><a class="docs-heading-anchor-permalink" href="#Example:-Genome-Size-Estimation" title="Permalink"></a></h4><pre><code class="language-julia hljs"># Estimate genome size using k-mer spectrum
kmer_counts = Mycelia.count_kmers(&quot;reads.fastq&quot;, k=21)
spectrum = Mycelia.kmer_frequency_spectrum(kmer_counts)

# Find coverage peak
coverage_peak = Mycelia.find_coverage_peak(spectrum)
println(&quot;Estimated coverage: $(coverage_peak)x&quot;)

# Calculate genome size
total_kmers = sum(spectrum.frequencies .* spectrum.counts)
genome_size = total_kmers ÷ coverage_peak
println(&quot;Estimated genome size: $(genome_size) bp&quot;)

# Alternative method with error correction
corrected_estimate = Mycelia.estimate_genome_size_from_kmers(
    kmer_counts,
    error_correction=true,
    ploidy=1
)
println(&quot;Corrected genome size: $(corrected_estimate.size) bp&quot;)
println(&quot;Confidence interval: $(corrected_estimate.confidence_interval)&quot;)</code></pre><h2 id="Error-Detection-and-Correction"><a class="docs-heading-anchor" href="#Error-Detection-and-Correction">Error Detection and Correction</a><a id="Error-Detection-and-Correction-1"></a><a class="docs-heading-anchor-permalink" href="#Error-Detection-and-Correction" title="Permalink"></a></h2><h3 id="K-mer-Based-Error-Detection"><a class="docs-heading-anchor" href="#K-mer-Based-Error-Detection">K-mer Based Error Detection</a><a id="K-mer-Based-Error-Detection-1"></a><a class="docs-heading-anchor-permalink" href="#K-mer-Based-Error-Detection" title="Permalink"></a></h3><p>&lt;!– identify<em>error</em>kmers, correct<em>sequencing</em>errors, validate<em>error</em>correction not yet implemented as documented –&gt;</p><h4 id="Example:-Error-Detection"><a class="docs-heading-anchor" href="#Example:-Error-Detection">Example: Error Detection</a><a id="Example:-Error-Detection-1"></a><a class="docs-heading-anchor-permalink" href="#Example:-Error-Detection" title="Permalink"></a></h4><pre><code class="language-julia hljs"># Identify likely error k-mers
error_kmers = Mycelia.identify_error_kmers(
    kmer_counts,
    min_coverage=3,
    max_coverage=100
)

println(&quot;Potential error k-mers: $(length(error_kmers))&quot;)
println(&quot;Error rate estimate: $(length(error_kmers) / length(kmer_counts) * 100)%&quot;)

# Correct errors in reads
corrected_reads = Mycelia.correct_sequencing_errors(
    &quot;reads.fastq&quot;,
    error_kmers,
    correction_method=&quot;consensus&quot;
)

# Validate correction effectiveness
validation = Mycelia.validate_error_correction(
    &quot;reads.fastq&quot;,
    corrected_reads,
    reference_genome=&quot;reference.fasta&quot;
)
println(&quot;Error reduction: $(validation.error_reduction_percent)%&quot;)</code></pre><h2 id="Sequence-Composition-Analysis"><a class="docs-heading-anchor" href="#Sequence-Composition-Analysis">Sequence Composition Analysis</a><a id="Sequence-Composition-Analysis-1"></a><a class="docs-heading-anchor-permalink" href="#Sequence-Composition-Analysis" title="Permalink"></a></h2><h3 id="Nucleotide-Composition"><a class="docs-heading-anchor" href="#Nucleotide-Composition">Nucleotide Composition</a><a id="Nucleotide-Composition-1"></a><a class="docs-heading-anchor-permalink" href="#Nucleotide-Composition" title="Permalink"></a></h3><p>&lt;!– calculate<em>nucleotide</em>frequencies, analyze<em>dinucleotide</em>frequencies, calculate<em>codon</em>usage, detect<em>sequence</em>bias not yet implemented as documented –&gt;</p><h4 id="Example:-Comprehensive-Composition-Analysis"><a class="docs-heading-anchor" href="#Example:-Comprehensive-Composition-Analysis">Example: Comprehensive Composition Analysis</a><a id="Example:-Comprehensive-Composition-Analysis-1"></a><a class="docs-heading-anchor-permalink" href="#Example:-Comprehensive-Composition-Analysis" title="Permalink"></a></h4><pre><code class="language-julia hljs"># Analyze nucleotide composition
composition = Mycelia.calculate_nucleotide_frequencies(&quot;sequences.fasta&quot;)
println(&quot;GC content: $(composition.gc_content)%&quot;)
println(&quot;AT content: $(composition.at_content)%&quot;)

# Dinucleotide analysis
dinuc_freq = Mycelia.analyze_dinucleotide_frequencies(&quot;sequences.fasta&quot;)
println(&quot;CpG frequency: $(dinuc_freq.CG)&quot;)
println(&quot;Expected CpG: $(dinuc_freq.expected_CG)&quot;)
println(&quot;CpG O/E ratio: $(dinuc_freq.CG_oe_ratio)&quot;)

# Detect composition bias
bias_analysis = Mycelia.detect_sequence_bias(composition)
if bias_analysis.bias_detected
    println(&quot;Sequence bias detected:&quot;)
    println(&quot;  Type: $(bias_analysis.bias_type)&quot;)
    println(&quot;  Strength: $(bias_analysis.bias_strength)&quot;)
end</code></pre><h3 id="Codon-Usage-Analysis"><a class="docs-heading-anchor" href="#Codon-Usage-Analysis">Codon Usage Analysis</a><a id="Codon-Usage-Analysis-1"></a><a class="docs-heading-anchor-permalink" href="#Codon-Usage-Analysis" title="Permalink"></a></h3><p>&lt;!– calculate<em>codon</em>usage, analyze<em>codon</em>bias, compare<em>codon</em>usage, optimize<em>codon</em>usage not yet implemented as documented –&gt;</p><h4 id="Example:-Codon-Usage-Analysis"><a class="docs-heading-anchor" href="#Example:-Codon-Usage-Analysis">Example: Codon Usage Analysis</a><a id="Example:-Codon-Usage-Analysis-1"></a><a class="docs-heading-anchor-permalink" href="#Example:-Codon-Usage-Analysis" title="Permalink"></a></h4><pre><code class="language-julia hljs"># Analyze codon usage in coding sequences
cds_file = &quot;coding_sequences.fasta&quot;
codon_usage = Mycelia.calculate_codon_usage(cds_file, genetic_code=&quot;standard&quot;)

# Calculate codon bias metrics
bias_metrics = Mycelia.analyze_codon_bias(codon_usage)
println(&quot;Effective Number of Codons (ENC): $(bias_metrics.enc)&quot;)
println(&quot;Codon Adaptation Index (CAI): $(bias_metrics.cai)&quot;)
println(&quot;Frequency of Optimal Codons (FOP): $(bias_metrics.fop)&quot;)

# Compare with reference organism
reference_usage = Mycelia.load_reference_codon_usage(&quot;escherichia_coli&quot;)
comparison = Mycelia.compare_codon_usage(codon_usage, reference_usage)
println(&quot;Similarity to E. coli: $(comparison.similarity_score)&quot;)</code></pre><h2 id="Memory-Efficient-Processing"><a class="docs-heading-anchor" href="#Memory-Efficient-Processing">Memory-Efficient Processing</a><a id="Memory-Efficient-Processing-1"></a><a class="docs-heading-anchor-permalink" href="#Memory-Efficient-Processing" title="Permalink"></a></h2><h3 id="Large-Dataset-Handling"><a class="docs-heading-anchor" href="#Large-Dataset-Handling">Large Dataset Handling</a><a id="Large-Dataset-Handling-1"></a><a class="docs-heading-anchor-permalink" href="#Large-Dataset-Handling" title="Permalink"></a></h3><p>&lt;!– stream<em>kmer</em>counting, process<em>kmers</em>in<em>chunks, parallel</em>kmer<em>analysis, memory</em>efficient_counting not yet implemented as documented –&gt;</p><h4 id="Example:-Large-File-Processing"><a class="docs-heading-anchor" href="#Example:-Large-File-Processing">Example: Large File Processing</a><a id="Example:-Large-File-Processing-1"></a><a class="docs-heading-anchor-permalink" href="#Example:-Large-File-Processing" title="Permalink"></a></h4><pre><code class="language-julia hljs"># Process large files with memory constraints
large_file = &quot;large_dataset.fastq&quot;

# Stream processing for memory efficiency
kmer_counts = Mycelia.stream_kmer_counting(
    large_file,
    k=21,
    chunk_size=100000,
    memory_limit_gb=8
)

# Parallel processing for speed
parallel_counts = Mycelia.parallel_kmer_analysis(
    large_file,
    k=21,
    n_workers=8,
    merge_strategy=&quot;sum&quot;
)</code></pre><h3 id="Optimized-Data-Structures"><a class="docs-heading-anchor" href="#Optimized-Data-Structures">Optimized Data Structures</a><a id="Optimized-Data-Structures-1"></a><a class="docs-heading-anchor-permalink" href="#Optimized-Data-Structures" title="Permalink"></a></h3><p>&lt;!– create<em>sparse</em>kmer<em>matrix, build</em>compressed<em>kmer</em>index, use<em>bloom</em>filter<em>counting, implement</em>count<em>min</em>sketch not yet implemented as documented –&gt;</p><h4 id="Example:-Memory-Optimization"><a class="docs-heading-anchor" href="#Example:-Memory-Optimization">Example: Memory Optimization</a><a id="Example:-Memory-Optimization-1"></a><a class="docs-heading-anchor-permalink" href="#Example:-Memory-Optimization" title="Permalink"></a></h4><pre><code class="language-julia hljs"># Use probabilistic data structures for very large datasets
bloom_filter = Mycelia.create_kmer_bloom_filter(
    estimated_kmers=1_000_000_000,
    false_positive_rate=0.01
)

# Streaming k-mer presence testing
for read in Mycelia.stream_fastq(&quot;huge_dataset.fastq&quot;)
    for kmer in Mycelia.extract_kmers(read, k=21)
        if Mycelia.probably_present(bloom_filter, kmer)
            # Process likely present k-mer
            Mycelia.process_kmer(kmer)
        end
    end
end</code></pre><h2 id="Comparative-K-mer-Analysis"><a class="docs-heading-anchor" href="#Comparative-K-mer-Analysis">Comparative K-mer Analysis</a><a id="Comparative-K-mer-Analysis-1"></a><a class="docs-heading-anchor-permalink" href="#Comparative-K-mer-Analysis" title="Permalink"></a></h2><h3 id="Multi-Sample-Analysis"><a class="docs-heading-anchor" href="#Multi-Sample-Analysis">Multi-Sample Analysis</a><a id="Multi-Sample-Analysis-1"></a><a class="docs-heading-anchor-permalink" href="#Multi-Sample-Analysis" title="Permalink"></a></h3><p>&lt;!– compare<em>kmer</em>profiles, build<em>kmer</em>distance<em>matrix, cluster</em>by<em>kmer</em>similarity, identify<em>sample</em>specific_kmers not yet implemented as documented –&gt;</p><h4 id="Example:-Multi-Sample-K-mer-Comparison"><a class="docs-heading-anchor" href="#Example:-Multi-Sample-K-mer-Comparison">Example: Multi-Sample K-mer Comparison</a><a id="Example:-Multi-Sample-K-mer-Comparison-1"></a><a class="docs-heading-anchor-permalink" href="#Example:-Multi-Sample-K-mer-Comparison" title="Permalink"></a></h4><pre><code class="language-julia hljs"># Compare k-mer profiles across multiple samples
sample_files = [&quot;sample1.fastq&quot;, &quot;sample2.fastq&quot;, &quot;sample3.fastq&quot;]

# Build k-mer profiles for each sample
profiles = [Mycelia.count_kmers(file, k=21) for file in sample_files]

# Calculate pairwise distances
distance_matrix = Mycelia.build_kmer_distance_matrix(profiles, metric=&quot;jaccard&quot;)
println(&quot;Pairwise k-mer distances:&quot;)
display(distance_matrix)

# Cluster samples by k-mer similarity
clusters = Mycelia.cluster_by_kmer_similarity(profiles, method=&quot;hierarchical&quot;)
println(&quot;Sample clusters: $(clusters)&quot;)</code></pre><h3 id="Contamination-Detection"><a class="docs-heading-anchor" href="#Contamination-Detection">Contamination Detection</a><a id="Contamination-Detection-1"></a><a class="docs-heading-anchor-permalink" href="#Contamination-Detection" title="Permalink"></a></h3><p>&lt;!– detect<em>contamination</em>kmers, identify<em>foreign</em>kmers, classify<em>kmer</em>sources, remove<em>contaminating</em>kmers not yet implemented as documented –&gt;</p><h4 id="Example:-Contamination-Detection"><a class="docs-heading-anchor" href="#Example:-Contamination-Detection">Example: Contamination Detection</a><a id="Example:-Contamination-Detection-1"></a><a class="docs-heading-anchor-permalink" href="#Example:-Contamination-Detection" title="Permalink"></a></h4><pre><code class="language-julia hljs"># Detect contamination using k-mer profiles
sample_kmers = Mycelia.count_kmers(&quot;sample.fastq&quot;, k=21)
reference_kmers = Mycelia.count_kmers(&quot;reference_genome.fasta&quot;, k=21)

# Identify foreign k-mers
foreign_kmers = Mycelia.identify_foreign_kmers(
    sample_kmers,
    reference_kmers,
    min_abundance=5
)

contamination_rate = length(foreign_kmers) / length(sample_kmers)
println(&quot;Contamination rate: $(contamination_rate * 100)%&quot;)

# Classify contamination sources
contamination_sources = Mycelia.classify_kmer_sources(
    foreign_kmers,
    database_kmers=[&quot;human&quot;, &quot;bacterial&quot;, &quot;viral&quot;]
)

for (source, proportion) in contamination_sources
    println(&quot;$(source): $(proportion * 100)%&quot;)
end</code></pre><h2 id="Visualization-and-Reporting"><a class="docs-heading-anchor" href="#Visualization-and-Reporting">Visualization and Reporting</a><a id="Visualization-and-Reporting-1"></a><a class="docs-heading-anchor-permalink" href="#Visualization-and-Reporting" title="Permalink"></a></h2><h3 id="K-mer-Plots"><a class="docs-heading-anchor" href="#K-mer-Plots">K-mer Plots</a><a id="K-mer-Plots-1"></a><a class="docs-heading-anchor-permalink" href="#K-mer-Plots" title="Permalink"></a></h3><p>&lt;!– plot<em>kmer</em>spectrum, plot<em>kmer</em>composition, plot<em>genome</em>size<em>estimation, create</em>kmer_dashboard not yet implemented as individual functions –&gt;</p><h4 id="Example:-K-mer-Visualization"><a class="docs-heading-anchor" href="#Example:-K-mer-Visualization">Example: K-mer Visualization</a><a id="Example:-K-mer-Visualization-1"></a><a class="docs-heading-anchor-permalink" href="#Example:-K-mer-Visualization" title="Permalink"></a></h4><pre><code class="language-julia hljs"># Create comprehensive k-mer analysis plots
kmer_counts = Mycelia.count_kmers(&quot;reads.fastq&quot;, k=21)

# K-mer frequency spectrum
spectrum_plot = Mycelia.plot_kmer_spectrum(kmer_counts, 
                                  title=&quot;21-mer Frequency Spectrum&quot;,
                                  log_scale=true)

# Genome size estimation plot
size_plot = Mycelia.plot_genome_size_estimation(kmer_counts,
                                       show_confidence_interval=true)

# Combined dashboard
kmer_dashboard = Mycelia.create_kmer_dashboard(kmer_counts)
Mycelia.save_plot(kmer_dashboard, &quot;kmer_analysis.png&quot;)</code></pre><h2 id="Performance-Considerations"><a class="docs-heading-anchor" href="#Performance-Considerations">Performance Considerations</a><a id="Performance-Considerations-1"></a><a class="docs-heading-anchor-permalink" href="#Performance-Considerations" title="Permalink"></a></h2><h3 id="Algorithm-Selection"><a class="docs-heading-anchor" href="#Algorithm-Selection">Algorithm Selection</a><a id="Algorithm-Selection-1"></a><a class="docs-heading-anchor-permalink" href="#Algorithm-Selection" title="Permalink"></a></h3><ul><li><strong>Dense matrices</strong>: Use for small k (k ≤ 12) or small genomes</li><li><strong>Sparse matrices</strong>: Use for large k (k ≥ 15) or large genomes</li><li><strong>Streaming</strong>: Use for memory-constrained environments</li><li><strong>Parallel processing</strong>: Use for time-critical applications</li></ul><h3 id="Memory-Usage"><a class="docs-heading-anchor" href="#Memory-Usage">Memory Usage</a><a id="Memory-Usage-1"></a><a class="docs-heading-anchor-permalink" href="#Memory-Usage" title="Permalink"></a></h3><ul><li><strong>k=15</strong>: ~1 GB for dense counting</li><li><strong>k=21</strong>: ~17 GB for dense counting (use sparse)</li><li><strong>k=31</strong>: Sparse counting only</li><li><strong>Large genomes</strong>: Consider streaming or chunked processing</li></ul><h3 id="Computational-Complexity"><a class="docs-heading-anchor" href="#Computational-Complexity">Computational Complexity</a><a id="Computational-Complexity-1"></a><a class="docs-heading-anchor-permalink" href="#Computational-Complexity" title="Permalink"></a></h3><ul><li><strong>Time</strong>: O(n) for sequence length n</li><li><strong>Space</strong>: O(4^k) for dense, O(unique k-mers) for sparse</li><li><strong>Parallel</strong>: Near-linear speedup for independent samples</li></ul><h2 id="Common-Issues-and-Solutions"><a class="docs-heading-anchor" href="#Common-Issues-and-Solutions">Common Issues and Solutions</a><a id="Common-Issues-and-Solutions-1"></a><a class="docs-heading-anchor-permalink" href="#Common-Issues-and-Solutions" title="Permalink"></a></h2><h3 id="Memory-Limitations"><a class="docs-heading-anchor" href="#Memory-Limitations">Memory Limitations</a><a id="Memory-Limitations-1"></a><a class="docs-heading-anchor-permalink" href="#Memory-Limitations" title="Permalink"></a></h3><pre><code class="language-julia hljs"># Handle memory constraints
if Mycelia.estimate_memory_usage(file, k=21) &gt; Mycelia.available_memory()
    # Use streaming approach
    kmer_counts = Mycelia.stream_kmer_counting(file, k=21, chunk_size=50000)
else
    # Use standard approach
    kmer_counts = Mycelia.count_kmers(file, k=21)
end</code></pre><h3 id="Parameter-Selection"><a class="docs-heading-anchor" href="#Parameter-Selection">Parameter Selection</a><a id="Parameter-Selection-1"></a><a class="docs-heading-anchor-permalink" href="#Parameter-Selection" title="Permalink"></a></h3><pre><code class="language-julia hljs"># Choose optimal k-mer size
optimal_k = Mycelia.select_optimal_k(
    genome_size_estimate=5_000_000,
    error_rate=0.01,
    coverage=30
)
println(&quot;Recommended k-mer size: $(optimal_k)&quot;)</code></pre><h2 id="Related-Functions"><a class="docs-heading-anchor" href="#Related-Functions">Related Functions</a><a id="Related-Functions-1"></a><a class="docs-heading-anchor-permalink" href="#Related-Functions" title="Permalink"></a></h2><h3 id="Data-Structures"><a class="docs-heading-anchor" href="#Data-Structures">Data Structures</a><a id="Data-Structures-1"></a><a class="docs-heading-anchor-permalink" href="#Data-Structures" title="Permalink"></a></h3><ul><li><a href="@ref"><code>KmerCounts</code></a> - K-mer count data structure</li><li><a href="@ref"><code>KmerSpectrum</code></a> - Frequency spectrum representation</li><li><a href="@ref"><code>KmerGraph</code></a> - K-mer overlap graph</li></ul><h3 id="File-I/O"><a class="docs-heading-anchor" href="#File-I/O">File I/O</a><a id="File-I/O-1"></a><a class="docs-heading-anchor-permalink" href="#File-I/O" title="Permalink"></a></h3><ul><li><a href="@ref"><code>read_fastq</code></a> - Read sequence files</li><li><a href="@ref"><code>save_kmer_counts</code></a> - Save k-mer counts</li><li><a href="@ref"><code>load_kmer_counts</code></a> - Load saved counts</li></ul><h3 id="Related-Workflows"><a class="docs-heading-anchor" href="#Related-Workflows">Related Workflows</a><a id="Related-Workflows-1"></a><a class="docs-heading-anchor-permalink" href="#Related-Workflows" title="Permalink"></a></h3><h3 id="Previous-Steps"><a class="docs-heading-anchor" href="#Previous-Steps">Previous Steps</a><a id="Previous-Steps-1"></a><a class="docs-heading-anchor-permalink" href="#Previous-Steps" title="Permalink"></a></h3><ul><li><a href="../quality-control/">Quality Control</a> - Preprocess reads before k-mer analysis</li></ul><h3 id="Next-Steps"><a class="docs-heading-anchor" href="#Next-Steps">Next Steps</a><a id="Next-Steps-1"></a><a class="docs-heading-anchor-permalink" href="#Next-Steps" title="Permalink"></a></h3><ul><li>Genome Assembly <em>(planned)</em> - Use k-mer analysis for assembly</li><li>Comparative Genomics <em>(planned)</em> - Compare k-mer profiles</li></ul><h2 id="See-Also"><a class="docs-heading-anchor" href="#See-Also">See Also</a><a id="See-Also-1"></a><a class="docs-heading-anchor-permalink" href="#See-Also" title="Permalink"></a></h2><ul><li><a href="../../tutorials/03_kmer_analysis.md">Tutorial 3: K-mer Analysis</a></li><li>Assembly Workflows <em>(planned)</em></li><li><a href="../examples/advanced-usage.md">Performance Optimization</a></li></ul></article><nav class="docs-footer"><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Tuesday 16 September 2025 21:03">Tuesday 16 September 2025</span>. Using Julia version 1.10.10.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
