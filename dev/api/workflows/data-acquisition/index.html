<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Data Acquisition &amp; Simulation · Mycelia</title><meta name="title" content="Data Acquisition &amp; Simulation · Mycelia"/><meta property="og:title" content="Data Acquisition &amp; Simulation · Mycelia"/><meta property="twitter:title" content="Data Acquisition &amp; Simulation · Mycelia"/><meta name="description" content="Documentation for Mycelia."/><meta property="og:description" content="Documentation for Mycelia."/><meta property="twitter:description" content="Documentation for Mycelia."/><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../search_index.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../../">Mycelia</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../../">Home</a></li><li><a class="tocitem" href="../../../installation/">Installation</a></li><li><a class="tocitem" href="../../../getting-started/">Getting Started</a></li><li><a class="tocitem" href="../../../concepts/">Concepts</a></li><li><a class="tocitem" href="../../../probabilistic-assembly-hub/">Probabilistic Assembly</a></li><li><span class="tocitem">Documentation</span><ul><li><a class="tocitem" href="../../../architecture/">Architecture Overview</a></li><li><a class="tocitem" href="../../../assembly-method-selection/">Assembly Method Selection</a></li><li><a class="tocitem" href="../../../performance/">Performance Guide</a></li><li><a class="tocitem" href="../../../faq/">FAQ</a></li></ul></li><li><span class="tocitem">API Reference</span><ul><li><a class="tocitem" href="../../../api-reference/">Complete API Reference</a></li><li><input class="collapse-toggle" id="menuitem-7-2" type="checkbox"/><label class="tocitem" for="menuitem-7-2"><span class="docs-label">Workflows</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../assembly-suite/">Assembly Suite</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-7-3" type="checkbox"/><label class="tocitem" for="menuitem-7-3"><span class="docs-label">Quick Reference</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../quick-reference/parameter-guide/">Parameter Guide</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-7-4" type="checkbox"/><label class="tocitem" for="menuitem-7-4"><span class="docs-label">Examples</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../examples/basic-workflows/">Basic Workflows</a></li></ul></li><li><a class="tocitem" href="../../">Legacy API Documentation</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Data Acquisition &amp; Simulation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Data Acquisition &amp; Simulation</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/cjprybol/Mycelia/blob/master/docs/src/api/workflows/data-acquisition.md#L" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Data-Acquisition-and-Simulation"><a class="docs-heading-anchor" href="#Data-Acquisition-and-Simulation">Data Acquisition &amp; Simulation</a><a id="Data-Acquisition-and-Simulation-1"></a><a class="docs-heading-anchor-permalink" href="#Data-Acquisition-and-Simulation" title="Permalink"></a></h1><p>Functions for downloading genomic data from public databases and simulating synthetic datasets for testing and benchmarking.</p><h2 id="Overview"><a class="docs-heading-anchor" href="#Overview">Overview</a><a id="Overview-1"></a><a class="docs-heading-anchor-permalink" href="#Overview" title="Permalink"></a></h2><p>Data acquisition is the first step in any bioinformatics analysis. Mycelia provides tools for:</p><ul><li><strong>Downloading reference genomes</strong> from NCBI databases</li><li><strong>Simulating realistic sequencing data</strong> for testing</li><li><strong>Managing data provenance</strong> and metadata</li><li><strong>Handling multiple data formats</strong> and sources</li></ul><h2 id="Common-Workflows"><a class="docs-heading-anchor" href="#Common-Workflows">Common Workflows</a><a id="Common-Workflows-1"></a><a class="docs-heading-anchor-permalink" href="#Common-Workflows" title="Permalink"></a></h2><h3 id="1.-Download-Reference-Genome"><a class="docs-heading-anchor" href="#1.-Download-Reference-Genome">1. Download Reference Genome</a><a id="1.-Download-Reference-Genome-1"></a><a class="docs-heading-anchor-permalink" href="#1.-Download-Reference-Genome" title="Permalink"></a></h3><pre><code class="language-julia hljs"># Download a specific genome by accession
genome_file = Mycelia.download_genome_by_accession(&quot;NC_001422.1&quot;)

# Download complete assembly with annotations
assembly_data = Mycelia.ncbi_genome_download_accession(&quot;GCF_000819615.1&quot;)</code></pre><h3 id="2.-Simulate-Test-Data"><a class="docs-heading-anchor" href="#2.-Simulate-Test-Data">2. Simulate Test Data</a><a id="2.-Simulate-Test-Data-1"></a><a class="docs-heading-anchor-permalink" href="#2.-Simulate-Test-Data" title="Permalink"></a></h3><pre><code class="language-julia hljs"># Create synthetic genome
reference = Mycelia.simulate_random_genome(length=100000, gc_content=0.45)

# Generate HiFi reads
reads = Mycelia.simulate_hifi_reads(reference, coverage=30, error_rate=0.001)</code></pre><h3 id="3.-Batch-Download"><a class="docs-heading-anchor" href="#3.-Batch-Download">3. Batch Download</a><a id="3.-Batch-Download-1"></a><a class="docs-heading-anchor-permalink" href="#3.-Batch-Download" title="Permalink"></a></h3><pre><code class="language-julia hljs"># Download multiple genomes
accessions = [&quot;GCF_000005825.2&quot;, &quot;GCF_000009605.1&quot;, &quot;GCF_000027325.1&quot;]
genomes = Mycelia.download_genomes_batch(accessions, output_dir=&quot;genomes/&quot;)</code></pre><h2 id="Public-Database-Downloads"><a class="docs-heading-anchor" href="#Public-Database-Downloads">Public Database Downloads</a><a id="Public-Database-Downloads-1"></a><a class="docs-heading-anchor-permalink" href="#Public-Database-Downloads" title="Permalink"></a></h2><h3 id="NCBI-Genome-Downloads"><a class="docs-heading-anchor" href="#NCBI-Genome-Downloads">NCBI Genome Downloads</a><a id="NCBI-Genome-Downloads-1"></a><a class="docs-heading-anchor-permalink" href="#NCBI-Genome-Downloads" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.download_genome_by_accession" href="#Mycelia.download_genome_by_accession"><code>Mycelia.download_genome_by_accession</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">download_genome_by_accession(
;
    accession,
    outdir,
    compressed
)
</code></pre><p>Downloads a genomic sequence from NCBI&#39;s nucleotide database by its accession number.</p><p><strong>Arguments</strong></p><ul><li><code>accession::String</code>: NCBI nucleotide accession number (e.g. &quot;NC_045512&quot;)</li><li><code>outdir::String</code>: Output directory path. Defaults to current directory</li><li><code>compressed::Bool</code>: If true, compresses output file with gzip. Defaults to true</li></ul><p><strong>Returns</strong></p><ul><li><code>String</code>: Path to the downloaded file (.fna or .fna.gz)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/3f1dcfeb91dacc50609c697d0b538d43bbabaaa6/src/reference-databases.jl#LL1130">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.ncbi_genome_download_accession" href="#Mycelia.ncbi_genome_download_accession"><code>Mycelia.ncbi_genome_download_accession</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ncbi_genome_download_accession(
;
    accession,
    outdir,
    outpath,
    include_string
)
</code></pre><p>Download an accession using NCBI datasets command line tool</p><p>the .zip download output to outpath will be unzipped</p><p>returns the outfolder</p><p>ncbi&#39;s default include string is  include_string = &quot;gff3,rna,cds,protein,genome,seq-report&quot;</p><p>Downloads and extracts a genome from NCBI using the datasets command line tool.</p><p><strong>Arguments</strong></p><ul><li><code>accession</code>: NCBI accession number for the genome</li><li><code>outdir</code>: Directory where files will be downloaded (defaults to current directory)</li><li><code>outpath</code>: Full path for the temporary zip file (defaults to <code>outdir/accession.zip</code>)</li><li><code>include_string</code>: Data types to download (defaults to all &quot;gff3,rna,cds,protein,genome,seq-report&quot;).</li></ul><p><strong>Returns</strong></p><ul><li>Path to the extracted genome data directory</li></ul><p><strong>Notes</strong></p><ul><li>Requires the ncbi-datasets-cli conda package (automatically installed if missing)</li><li>Downloaded zip file is automatically removed after extraction</li><li>If output folder already exists, download is skipped</li><li>Data is extracted to <code>outdir/accession/ncbi_dataset/data/accession</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/3f1dcfeb91dacc50609c697d0b538d43bbabaaa6/src/reference-databases.jl#LL2229">source</a></section></article><p>&lt;!– download<em>genomes</em>batch not yet implemented, use download<em>genomes</em>by_ftp –&gt;</p><h4 id="Example:-Download-phiX174-Genome"><a class="docs-heading-anchor" href="#Example:-Download-phiX174-Genome">Example: Download phiX174 Genome</a><a id="Example:-Download-phiX174-Genome-1"></a><a class="docs-heading-anchor-permalink" href="#Example:-Download-phiX174-Genome" title="Permalink"></a></h4><pre><code class="language-julia hljs"># Download the classic phiX174 bacteriophage genome
phix_file = Mycelia.download_genome_by_accession(&quot;NC_001422.1&quot;)

# Verify download
@assert isfile(phix_file)
@assert endswith(phix_file, &quot;.fna.gz&quot;)

# Read the genome
genome_record = first(Mycelia.read_fasta(phix_file))
sequence = String(FASTX.sequence(genome_record))
println(&quot;Downloaded genome: $(length(sequence)) bp&quot;)</code></pre><h4 id="Example:-Complete-Assembly-Package"><a class="docs-heading-anchor" href="#Example:-Complete-Assembly-Package">Example: Complete Assembly Package</a><a id="Example:-Complete-Assembly-Package-1"></a><a class="docs-heading-anchor-permalink" href="#Example:-Complete-Assembly-Package" title="Permalink"></a></h4><pre><code class="language-julia hljs"># Download complete E. coli assembly with all associated files
assembly = Mycelia.ncbi_genome_download_accession(&quot;GCF_000005825.2&quot;)

# Available files
println(&quot;Genome: $(assembly.genome)&quot;)
println(&quot;Proteins: $(assembly.protein)&quot;)
println(&quot;Annotations: $(assembly.gff3)&quot;)
println(&quot;CDS: $(assembly.cds)&quot;)</code></pre><h3 id="SRA-Data-Downloads"><a class="docs-heading-anchor" href="#SRA-Data-Downloads">SRA Data Downloads</a><a id="SRA-Data-Downloads-1"></a><a class="docs-heading-anchor-permalink" href="#SRA-Data-Downloads" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.download_sra_data" href="#Mycelia.download_sra_data"><code>Mycelia.download_sra_data</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Downloads sequencing reads from NCBI&#39;s Sequence Read Archive (SRA).</p><p>Downloads reads using fasterq-dump. The function automatically detects whether the data is single-end or paired-end and returns appropriate file paths. Users should apply quality control based on their knowledge of the data type.</p><p><strong>Arguments</strong></p><ul><li><code>srr_identifier</code>: SRA run identifier (e.g., &quot;SRR1234567&quot;)</li><li><code>outdir</code>: Output directory for downloaded files (default: current directory)</li></ul><p><strong>Returns</strong></p><p>Named tuple with:</p><ul><li><code>srr_id</code>: The SRA identifier</li><li><code>outdir</code>: Output directory path</li><li><code>files</code>: Vector of downloaded file paths (1 file for single-end, 2 for paired-end)</li><li><code>is_paired</code>: Boolean indicating if data is paired-end</li></ul><p><strong>Example</strong></p><pre><code class="language-julia hljs"># Download SRA data
result = Mycelia.download_sra_data(&quot;SRR1234567&quot;, outdir=&quot;./data&quot;)

# Apply appropriate QC based on data type
if result.is_paired
    # Paired-end data - use paired-end QC
    Mycelia.trim_galore_paired(forward_reads=result.files[1], reverse_reads=result.files[2])
else
    # Single-end data - use single-end QC
    Mycelia.qc_filter_short_reads_fastp(input=result.files[1])
end</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/3f1dcfeb91dacc50609c697d0b538d43bbabaaa6/src/reference-databases.jl#LL945-L977">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.prefetch_sra_runs" href="#Mycelia.prefetch_sra_runs"><code>Mycelia.prefetch_sra_runs</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Prefetches multiple SRA runs in parallel.</p><p>Downloads SRA run files (.sra) to local storage without converting to FASTQ. Useful for batch downloading before processing with fasterq-dump.</p><p><strong>Arguments</strong></p><ul><li><code>srr_identifiers</code>: Vector of SRA run identifiers</li><li><code>outdir</code>: Output directory for prefetched files (default: current directory)</li><li><code>max_parallel</code>: Maximum number of parallel downloads (default: 4)</li></ul><p><strong>Returns</strong></p><p>Vector of named tuples with prefetch results for each SRA run</p><p><strong>Example</strong></p><pre><code class="language-julia hljs">runs = [&quot;SRR1234567&quot;, &quot;SRR1234568&quot;, &quot;SRR1234569&quot;]
results = Mycelia.prefetch_sra_runs(runs, outdir=&quot;./sra_data&quot;)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/3f1dcfeb91dacc50609c697d0b538d43bbabaaa6/src/reference-databases.jl#LL1012-L1031">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.fasterq_dump_parallel" href="#Mycelia.fasterq_dump_parallel"><code>Mycelia.fasterq_dump_parallel</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Parallel FASTQ dump for multiple SRA files.</p><p>Converts multiple SRA files to FASTQ format in parallel. More efficient than sequential processing for large batches.</p><p><strong>Arguments</strong></p><ul><li><code>srr_identifiers</code>: Vector of SRA run identifiers</li><li><code>outdir</code>: Output directory for FASTQ files (default: current directory)</li><li><code>max_parallel</code>: Maximum number of parallel conversions (default: 2)</li></ul><p><strong>Returns</strong></p><p>Vector of named tuples with conversion results</p><p><strong>Example</strong></p><pre><code class="language-julia hljs">runs = [&quot;SRR1234567&quot;, &quot;SRR1234568&quot;]
results = Mycelia.fasterq_dump_parallel(runs, outdir=&quot;./fastq_data&quot;)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/3f1dcfeb91dacc50609c697d0b538d43bbabaaa6/src/reference-databases.jl#LL1071-L1090">source</a></section></article><h4 id="Example:-Download-Sequencing-Reads"><a class="docs-heading-anchor" href="#Example:-Download-Sequencing-Reads">Example: Download Sequencing Reads</a><a id="Example:-Download-Sequencing-Reads-1"></a><a class="docs-heading-anchor-permalink" href="#Example:-Download-Sequencing-Reads" title="Permalink"></a></h4><pre><code class="language-julia hljs"># Download reads from SRA
sra_run = &quot;SRR1234567&quot;
fastq_files = Mycelia.download_sra_data(sra_run, output_dir=&quot;reads/&quot;)

# Process paired-end reads
if length(fastq_files) == 2
    read1, read2 = fastq_files
    println(&quot;Downloaded paired-end reads:&quot;)
    println(&quot;  R1: $read1&quot;)
    println(&quot;  R2: $read2&quot;)
end</code></pre><h2 id="Data-Simulation"><a class="docs-heading-anchor" href="#Data-Simulation">Data Simulation</a><a id="Data-Simulation-1"></a><a class="docs-heading-anchor-permalink" href="#Data-Simulation" title="Permalink"></a></h2><h3 id="Genome-Simulation"><a class="docs-heading-anchor" href="#Genome-Simulation">Genome Simulation</a><a id="Genome-Simulation-1"></a><a class="docs-heading-anchor-permalink" href="#Genome-Simulation" title="Permalink"></a></h3><p>&lt;!– Genome simulation functions not yet implemented –&gt;</p><h4 id="Example:-Create-Test-Genome"><a class="docs-heading-anchor" href="#Example:-Create-Test-Genome">Example: Create Test Genome</a><a id="Example:-Create-Test-Genome-1"></a><a class="docs-heading-anchor-permalink" href="#Example:-Create-Test-Genome" title="Permalink"></a></h4><pre><code class="language-julia hljs"># Generate random genome with realistic GC content
test_genome = Mycelia.simulate_random_genome(
    length=50000,
    gc_content=0.42,
    seed=123  # for reproducibility
)

# Add realistic features
genome_with_genes = Mycelia.simulate_genome_with_features(
    test_genome,
    n_genes=50,
    gene_length_dist=(500, 2000),
    intergenic_length_dist=(100, 1000)
)</code></pre><h3 id="Sequencing-Read-Simulation"><a class="docs-heading-anchor" href="#Sequencing-Read-Simulation">Sequencing Read Simulation</a><a id="Sequencing-Read-Simulation-1"></a><a class="docs-heading-anchor-permalink" href="#Sequencing-Read-Simulation" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.simulate_illumina_reads" href="#Mycelia.simulate_illumina_reads"><code>Mycelia.simulate_illumina_reads</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">simulate_illumina_reads(
;
    fasta,
    coverage,
    read_count,
    outbase,
    read_length,
    mflen,
    sdev,
    seqSys,
    amplicon,
    errfree,
    paired,
    rndSeed
)
</code></pre><p>Simulate Illumina short reads from a FASTA file using the ART Illumina simulator.</p><p>This function wraps ART (installed via Bioconda) to simulate reads from an input reference FASTA. It supports paired-end (or optionally single-end/mate-pair) simulation, with options to choose either fold coverage (<code>--fcov</code>) or an absolute read count (<code>--rcount</code>), to enable amplicon mode, and to optionally generate a zero-error SAM file.</p><p><strong>Arguments</strong></p><ul><li><code>in_fasta::String</code>: Path to the input FASTA file.</li><li><code>coverage::Union{Nothing,Number}</code>: Desired fold coverage (used with <code>--fcov</code>); if <code>nothing</code> and <code>read_count</code> is provided then fold coverage is ignored. (Default: 20)</li><li><code>read_count::Union{Nothing,Number}</code>: Total number of reads (or read pairs) to generate (used with <code>--rcount</code> instead of fold coverage). (Default: <code>nothing</code>)</li><li><code>outbase::String</code>: Output file prefix (default: &quot;<span>$(in_fasta).art.$</span>(coverage)x.&quot;).</li><li><code>read_length::Int</code>: Length of reads to simulate (default: 150).</li><li><code>mflen::Int</code>: Mean fragment length for paired-end simulations (default: 500).</li><li><code>sdev::Int</code>: Standard deviation of fragment lengths (default: 10).</li><li><code>seqSys::String</code>: Illumina sequencing system ID (default: &quot;HS25&quot;). Available ART profiles:<ul><li><code>&quot;GA1&quot;</code>: Genome Analyzer I (max length: 36bp or 44bp)</li><li><code>&quot;GA2&quot;</code>: Genome Analyzer II (max length: 50bp or 75bp)  </li><li><code>&quot;HS10&quot;</code>: HiSeq 1000 (max length: 100bp)</li><li><code>&quot;HS20&quot;</code>: HiSeq 2000 (max length: 100bp)</li><li><code>&quot;HS25&quot;</code>: HiSeq 2500 (max length: 125bp or 150bp)</li><li><code>&quot;HSXn&quot;</code>: HiSeqX v2.5 PCR free (max length: 150bp)</li><li><code>&quot;HSXt&quot;</code>: HiSeqX v2.5 TruSeq (max length: 150bp)</li><li><code>&quot;MSv1&quot;</code>: MiSeq v1 (max length: 250bp)</li><li><code>&quot;MSv3&quot;</code>: MiSeq v3 (max length: 250bp)</li><li><code>&quot;MinS&quot;</code>: MiniSeq TruSeq (max length: 50bp)</li><li><code>&quot;NS50&quot;</code>: NextSeq 500 v2 (max length: 75bp)</li></ul></li><li><code>paired::Bool</code>: Whether to simulate paired-end reads (default: true). Some systems like MinS only support single-end.</li><li><code>amplicon::Bool</code>: Enable amplicon sequencing simulation mode (default: false).</li><li><code>errfree::Bool</code>: Generate an extra SAM file with zero sequencing errors (default: false).</li><li><code>rndSeed::Union{Nothing,Int}</code>: Optional seed for reproducibility (default: nothing).</li></ul><p><strong>Outputs</strong></p><p>Generates gzipped FASTQ files in the working directory:</p><ul><li>For paired-end: <code>$(outbase)1.fq.gz</code> (forward) and <code>$(outbase)2.fq.gz</code> (reverse).</li><li>For single-end: <code>$(outbase)1.fq.gz</code>.</li></ul><p>Additional SAM files may be produced if <code>--errfree</code> is enabled and/or if the ART <code>--samout</code> option is specified.</p><p><strong>Details</strong></p><p>This function calls ART with the provided options. Note that if <code>read_count</code> is supplied, the function uses the <code>--rcount</code> option; otherwise, it uses <code>--fcov</code> with the given coverage. Amplicon mode (via <code>--amplicon</code>) restricts the simulation to the amplicon regions, which is important for targeted sequencing studies.</p><p><strong>Dependencies</strong></p><p>Requires ART simulator (installed via Bioconda) and the Mycelia environment helper.</p><p>See also: <code>simulate_nanopore_reads</code>, <code>simulate_nearly_perfect_long_reads</code>, <code>simulate_pacbio_reads</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/3f1dcfeb91dacc50609c697d0b538d43bbabaaa6/src/simulation.jl#LL123">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.simulate_pacbio_reads" href="#Mycelia.simulate_pacbio_reads"><code>Mycelia.simulate_pacbio_reads</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">simulate_pacbio_reads(; fasta, quantity, outfile)
</code></pre><p>Simulate PacBio HiFi reads using optimized Badread settings.</p><p>Uses PacBio 2021 error and quality score models with identity settings optimized for HiFi reads. Follows the recommended PacBio HiFi simulation parameters from the Badread documentation.</p><p><strong>Arguments</strong></p><ul><li><code>fasta::String</code>: Path to input FASTA file containing reference sequence</li><li><code>quantity::String</code>: Coverage depth (e.g. &quot;50x&quot;) or total bases (e.g. &quot;1000000&quot;)</li><li><code>outfile::String</code>: Output filepath for simulated reads. Defaults to input filename with PacBio HiFi suffix</li></ul><p><strong>Returns</strong></p><ul><li><code>String</code>: Path to the generated output file</li></ul><p><strong>Notes</strong></p><ul><li>Uses pacbio2021 error and quality score models</li><li>Sets identity to 30,3 for HiFi-appropriate accuracy</li><li>Average read length ~15kb</li><li>Output is gzipped FASTQ format</li></ul><p>See also: <code>simulate_nanopore_reads</code>, <code>simulate_nearly_perfect_long_reads</code>, <code>simulate_badread_reads</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/3f1dcfeb91dacc50609c697d0b538d43bbabaaa6/src/simulation.jl#LL556">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.simulate_nanopore_reads" href="#Mycelia.simulate_nanopore_reads"><code>Mycelia.simulate_nanopore_reads</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">simulate_nanopore_reads(; fasta, quantity, outfile)
</code></pre><p>Simulate Oxford Nanopore R10.4.1 sequencing reads using Badread&#39;s default settings.</p><p>Badread&#39;s default settings correspond to Oxford Nanopore R10.4.1 reads of mediocre quality. Uses nanopore2023 error and quality models with default identity and length distributions.</p><p><strong>Arguments</strong></p><ul><li><code>fasta::String</code>: Path to input reference FASTA file</li><li><code>quantity::String</code>: Either fold coverage (e.g. &quot;50x&quot;) or total bases to sequence (e.g. &quot;1000000&quot;)</li><li><code>outfile::String</code>: Output path for gzipped FASTQ file. Defaults to input filename with modified extension</li></ul><p><strong>Returns</strong></p><ul><li><code>String</code>: Path to the generated output FASTQ file</li></ul><p>See also: <code>simulate_pacbio_reads</code>, <code>simulate_nanopore_r941_reads</code>, <code>simulate_badread_reads</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/3f1dcfeb91dacc50609c697d0b538d43bbabaaa6/src/simulation.jl#LL591">source</a></section></article><p>&lt;!– Note: simulate<em>hifi</em>reads maps to simulate<em>pacbio</em>reads add<em>sequencing</em>errors not yet implemented as standalone function –&gt;</p><h4 id="Example:-HiFi-Read-Simulation"><a class="docs-heading-anchor" href="#Example:-HiFi-Read-Simulation">Example: HiFi Read Simulation</a><a id="Example:-HiFi-Read-Simulation-1"></a><a class="docs-heading-anchor-permalink" href="#Example:-HiFi-Read-Simulation" title="Permalink"></a></h4><pre><code class="language-julia hljs"># Simulate high-quality HiFi reads
hifi_reads = Mycelia.simulate_hifi_reads(
    reference_genome,
    coverage=25,
    read_length_mean=15000,
    read_length_std=3000,
    error_rate=0.001
)

# Write to FASTQ
Mycelia.write_fastq(&quot;hifi_reads.fastq&quot;, hifi_reads)</code></pre><h4 id="Example:-Illumina-Read-Simulation"><a class="docs-heading-anchor" href="#Example:-Illumina-Read-Simulation">Example: Illumina Read Simulation</a><a id="Example:-Illumina-Read-Simulation-1"></a><a class="docs-heading-anchor-permalink" href="#Example:-Illumina-Read-Simulation" title="Permalink"></a></h4><pre><code class="language-julia hljs"># Simulate paired-end Illumina reads
illumina_reads = Mycelia.simulate_illumina_reads(
    reference_genome,
    coverage=50,
    read_length=150,
    fragment_size_mean=300,
    fragment_size_std=50,
    error_rate=0.01
)

# Write paired-end files
Mycelia.write_fastq(&quot;illumina_R1.fastq&quot;, illumina_reads.read1)
Mycelia.write_fastq(&quot;illumina_R2.fastq&quot;, illumina_reads.read2)</code></pre><h2 id="Data-Validation"><a class="docs-heading-anchor" href="#Data-Validation">Data Validation</a><a id="Data-Validation-1"></a><a class="docs-heading-anchor-permalink" href="#Data-Validation" title="Permalink"></a></h2><h3 id="Download-Validation"><a class="docs-heading-anchor" href="#Download-Validation">Download Validation</a><a id="Download-Validation-1"></a><a class="docs-heading-anchor-permalink" href="#Download-Validation" title="Permalink"></a></h3><p>&lt;!– Download validation functions not yet implemented –&gt;</p><h4 id="Example:-Validate-Downloaded-Data"><a class="docs-heading-anchor" href="#Example:-Validate-Downloaded-Data">Example: Validate Downloaded Data</a><a id="Example:-Validate-Downloaded-Data-1"></a><a class="docs-heading-anchor-permalink" href="#Example:-Validate-Downloaded-Data" title="Permalink"></a></h4><pre><code class="language-julia hljs"># Check file integrity
integrity_ok = Mycelia.validate_download_integrity(&quot;genome.fna.gz&quot;)

# Verify file format
format_ok = Mycelia.check_file_format(&quot;genome.fna.gz&quot;, expected_format=&quot;fasta&quot;)

# Check genome completeness
completeness = Mycelia.verify_genome_completeness(&quot;genome.fna.gz&quot;)
println(&quot;Genome completeness: $(completeness.complete_sequences)/$(completeness.total_sequences)&quot;)</code></pre><h3 id="Simulation-Validation"><a class="docs-heading-anchor" href="#Simulation-Validation">Simulation Validation</a><a id="Simulation-Validation-1"></a><a class="docs-heading-anchor-permalink" href="#Simulation-Validation" title="Permalink"></a></h3><p>&lt;!– Simulation validation functions not yet implemented –&gt;</p><h4 id="Example:-Validate-Simulated-Data"><a class="docs-heading-anchor" href="#Example:-Validate-Simulated-Data">Example: Validate Simulated Data</a><a id="Example:-Validate-Simulated-Data-1"></a><a class="docs-heading-anchor-permalink" href="#Example:-Validate-Simulated-Data" title="Permalink"></a></h4><pre><code class="language-julia hljs"># Check simulation statistics
sim_stats = Mycelia.calculate_simulation_statistics(simulated_reads)
println(&quot;Simulated reads: $(sim_stats.n_reads)&quot;)
println(&quot;Mean length: $(sim_stats.mean_length)&quot;)
println(&quot;Coverage: $(sim_stats.coverage)x&quot;)

# Compare with real data characteristics
comparison = Mycelia.compare_simulated_vs_real(simulated_reads, real_reads)
println(&quot;Length distribution similarity: $(comparison.length_similarity)&quot;)
println(&quot;Quality distribution similarity: $(comparison.quality_similarity)&quot;)</code></pre><h2 id="Metadata-Management"><a class="docs-heading-anchor" href="#Metadata-Management">Metadata Management</a><a id="Metadata-Management-1"></a><a class="docs-heading-anchor-permalink" href="#Metadata-Management" title="Permalink"></a></h2><h3 id="Data-Provenance"><a class="docs-heading-anchor" href="#Data-Provenance">Data Provenance</a><a id="Data-Provenance-1"></a><a class="docs-heading-anchor-permalink" href="#Data-Provenance" title="Permalink"></a></h3><p>&lt;!– Metadata management functions not yet implemented –&gt;</p><h4 id="Example:-Track-Data-Sources"><a class="docs-heading-anchor" href="#Example:-Track-Data-Sources">Example: Track Data Sources</a><a id="Example:-Track-Data-Sources-1"></a><a class="docs-heading-anchor-permalink" href="#Example:-Track-Data-Sources" title="Permalink"></a></h4><pre><code class="language-julia hljs"># Create manifest for downloaded data
manifest = Mycelia.create_data_manifest(
    files=[&quot;genome.fna.gz&quot;, &quot;annotations.gff3&quot;],
    sources=[&quot;NCBI:NC_001422.1&quot;, &quot;NCBI:GCF_000819615.1&quot;],
    download_date=now(),
    version=&quot;1.0&quot;
)

# Save manifest
Mycelia.save_manifest(manifest, &quot;data_manifest.json&quot;)</code></pre><h3 id="Batch-Processing"><a class="docs-heading-anchor" href="#Batch-Processing">Batch Processing</a><a id="Batch-Processing-1"></a><a class="docs-heading-anchor-permalink" href="#Batch-Processing" title="Permalink"></a></h3><p>&lt;!– Batch processing functions not yet implemented Available: Mycelia.download<em>genomes</em>by_ftp for batch downloads –&gt;</p><h4 id="Example:-Batch-Download-with-Error-Handling"><a class="docs-heading-anchor" href="#Example:-Batch-Download-with-Error-Handling">Example: Batch Download with Error Handling</a><a id="Example:-Batch-Download-with-Error-Handling-1"></a><a class="docs-heading-anchor-permalink" href="#Example:-Batch-Download-with-Error-Handling" title="Permalink"></a></h4><pre><code class="language-julia hljs"># Download multiple genomes with retry logic
accession_list = [&quot;GCF_000005825.2&quot;, &quot;GCF_000009605.1&quot;, &quot;GCF_000027325.1&quot;]

results = Mycelia.parallel_download(
    accession_list,
    max_retries=3,
    delay_between_retries=30,
    max_concurrent=5
)

# Check results
successful = [r for r in results if r.success]
failed = [r for r in results if !r.success]

println(&quot;Downloaded: $(length(successful))/$(length(accession_list))&quot;)
if !isempty(failed)
    println(&quot;Failed downloads: $(length(failed))&quot;)
    for failure in failed
        println(&quot;  $(failure.accession): $(failure.error)&quot;)
    end
end</code></pre><h2 id="Performance-Considerations"><a class="docs-heading-anchor" href="#Performance-Considerations">Performance Considerations</a><a id="Performance-Considerations-1"></a><a class="docs-heading-anchor-permalink" href="#Performance-Considerations" title="Permalink"></a></h2><h3 id="Memory-Usage"><a class="docs-heading-anchor" href="#Memory-Usage">Memory Usage</a><a id="Memory-Usage-1"></a><a class="docs-heading-anchor-permalink" href="#Memory-Usage" title="Permalink"></a></h3><ul><li><strong>Genome downloads</strong>: Minimal memory usage (streaming)</li><li><strong>Large simulations</strong>: Memory scales with genome size</li><li><strong>Batch operations</strong>: Consider parallel processing limits</li></ul><h3 id="Network-Considerations"><a class="docs-heading-anchor" href="#Network-Considerations">Network Considerations</a><a id="Network-Considerations-1"></a><a class="docs-heading-anchor-permalink" href="#Network-Considerations" title="Permalink"></a></h3><ul><li><strong>NCBI rate limits</strong>: Respect API rate limits</li><li><strong>Retry logic</strong>: Implement exponential backoff</li><li><strong>Parallel downloads</strong>: Limit concurrent connections</li></ul><h3 id="Storage-Requirements"><a class="docs-heading-anchor" href="#Storage-Requirements">Storage Requirements</a><a id="Storage-Requirements-1"></a><a class="docs-heading-anchor-permalink" href="#Storage-Requirements" title="Permalink"></a></h3><ul><li><strong>Compressed files</strong>: Use .gz compression by default</li><li><strong>Temporary files</strong>: Clean up intermediate files</li><li><strong>Disk space</strong>: Monitor available space for large datasets</li></ul><h2 id="Common-Issues-and-Solutions"><a class="docs-heading-anchor" href="#Common-Issues-and-Solutions">Common Issues and Solutions</a><a id="Common-Issues-and-Solutions-1"></a><a class="docs-heading-anchor-permalink" href="#Common-Issues-and-Solutions" title="Permalink"></a></h2><h3 id="Download-Failures"><a class="docs-heading-anchor" href="#Download-Failures">Download Failures</a><a id="Download-Failures-1"></a><a class="docs-heading-anchor-permalink" href="#Download-Failures" title="Permalink"></a></h3><pre><code class="language-julia hljs"># Handle network timeouts
try
    genome = Mycelia.download_genome_by_accession(&quot;NC_001422.1&quot;, timeout=300)
catch NetworkError
    println(&quot;Download failed - retrying with longer timeout&quot;)
    genome = Mycelia.download_genome_by_accession(&quot;NC_001422.1&quot;, timeout=600)
end</code></pre><h3 id="Simulation-Validation-2"><a class="docs-heading-anchor" href="#Simulation-Validation-2">Simulation Validation</a><a class="docs-heading-anchor-permalink" href="#Simulation-Validation-2" title="Permalink"></a></h3><pre><code class="language-julia hljs"># Validate simulation parameters before large runs
Mycelia.validate_simulation_parameters(
    genome_size=1000000,
    coverage=30,
    read_length=15000
)</code></pre><h2 id="Related-Functions"><a class="docs-heading-anchor" href="#Related-Functions">Related Functions</a><a id="Related-Functions-1"></a><a class="docs-heading-anchor-permalink" href="#Related-Functions" title="Permalink"></a></h2><h3 id="File-I/O"><a class="docs-heading-anchor" href="#File-I/O">File I/O</a><a id="File-I/O-1"></a><a class="docs-heading-anchor-permalink" href="#File-I/O" title="Permalink"></a></h3><ul><li><a href="@ref"><code>read_fasta</code></a> - Read FASTA files</li><li><a href="@ref"><code>write_fastq</code></a> - Write FASTQ files</li><li><a href="@ref"><code>compress_file</code></a> - Compress downloaded files</li></ul><h3 id="Quality-Control"><a class="docs-heading-anchor" href="#Quality-Control">Quality Control</a><a id="Quality-Control-1"></a><a class="docs-heading-anchor-permalink" href="#Quality-Control" title="Permalink"></a></h3><ul><li><a href="@ref"><code>analyze_fastq_quality</code></a> - Assess downloaded read quality</li><li><a href="@ref"><code>calculate_genome_stats</code></a> - Analyze genome characteristics</li></ul><h3 id="Next-Steps"><a class="docs-heading-anchor" href="#Next-Steps">Next Steps</a><a id="Next-Steps-1"></a><a class="docs-heading-anchor-permalink" href="#Next-Steps" title="Permalink"></a></h3><ul><li><a href="../quality-control/">Quality Control</a> - Assess data quality</li><li><a href="../sequence-analysis/">Sequence Analysis</a> - Analyze sequence composition</li></ul><h2 id="See-Also"><a class="docs-heading-anchor" href="#See-Also">See Also</a><a id="See-Also-1"></a><a class="docs-heading-anchor-permalink" href="#See-Also" title="Permalink"></a></h2><ul><li><a href="../../tutorials/01_data_acquisition.md">Tutorial 1: Data Acquisition</a></li><li>FASTA/FASTQ Data Types <em>(planned)</em></li><li><a href="../../examples/basic-workflows/">Basic Workflows</a></li></ul></article><nav class="docs-footer"><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Monday 8 September 2025 20:58">Monday 8 September 2025</span>. Using Julia version 1.10.10.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
