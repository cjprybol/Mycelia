<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Home · Mycelia</title><meta name="title" content="Home · Mycelia"/><meta property="og:title" content="Home · Mycelia"/><meta property="twitter:title" content="Home · Mycelia"/><meta name="description" content="Documentation for Mycelia."/><meta property="og:description" content="Documentation for Mycelia."/><meta property="twitter:description" content="Documentation for Mycelia."/><script data-outdated-warner src="assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="search_index.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href>Mycelia</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li class="is-active"><a class="tocitem" href>Home</a><ul class="internal"><li><a class="tocitem" href="#Installation"><span>Installation</span></a></li><li><a class="tocitem" href="#Function-Docstrings"><span>Function Docstrings</span></a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Home</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Home</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/cjprybol/Mycelia/blob/master/docs/src/index.md#L" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Mycelia-Documentation"><a class="docs-heading-anchor" href="#Mycelia-Documentation">Mycelia Documentation</a><a id="Mycelia-Documentation-1"></a><a class="docs-heading-anchor-permalink" href="#Mycelia-Documentation" title="Permalink"></a></h1><p>Welcome to the Mycelia documentation.</p><h2 id="Installation"><a class="docs-heading-anchor" href="#Installation">Installation</a><a id="Installation-1"></a><a class="docs-heading-anchor-permalink" href="#Installation" title="Permalink"></a></h2><p><a href="https://github.com/JuliaLang/juliaup">Install Julia (if not already installed)</a></p><p>I have had trouble getting the visualization libraries Plots.jl and Makie.jl (and associated packages) to load correctly on HPC due to the complexities of the default <code>LD_LIBRARY_PATH</code></p><p>I imagine other research supercomputer users may have similar issues, although I don&#39;t have these issues on cloud vendors like GCP or AWS</p><p>To enable Julia to install all of it&#39;s own necessary dependencies independent of the system, I reset the <code>LD_LIBRARY_PATH</code> variable prior to launching Julia !!</p><p>This can be done easily when launching Julia from the command line by</p><pre><code class="language-bash hljs">export LD_LIBRARY_PATH=&quot;&quot; &amp;&amp; julia</code></pre><p><a href="https://stackoverflow.com/a/53595397">And can be done for Julia jupyter kernels by setting the <code>env</code> key =&gt; value pair in the appropriate kernel.json file</a></p><p>Clone the repo as a Julia package</p><pre><code class="language-julia hljs">import Pkg
# for production usage
Pkg.add(url=&quot;https://github.com/cjprybol/Mycelia.git&quot;)
# for development
Pkg.develop(url=&quot;git@github.com:cjprybol/Mycelia.git&quot;)</code></pre><h2 id="Function-Docstrings"><a class="docs-heading-anchor" href="#Function-Docstrings">Function Docstrings</a><a id="Function-Docstrings-1"></a><a class="docs-heading-anchor-permalink" href="#Function-Docstrings" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia._detect_sequence_extension-Tuple{Symbol}" href="#Mycelia._detect_sequence_extension-Tuple{Symbol}"><code>Mycelia._detect_sequence_extension</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">_detect_sequence_extension(sequence_type::Symbol) -&gt; String
</code></pre><p>Internal helper function to convert sequence type to file extension.</p><p>Arguments</p><ul><li>sequence_type: Symbol representing sequence type (:DNA, :RNA, or :AA)</li></ul><p>Returns</p><ul><li>String: Appropriate file extensions</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL16303">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.add_bioconda_env-Tuple{Any}" href="#Mycelia.add_bioconda_env-Tuple{Any}"><code>Mycelia.add_bioconda_env</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">add_bioconda_env(pkg; force) -&gt; Union{Nothing, Base.Process}
</code></pre><p>Create a new Conda environment with a specified Bioconda package.</p><p><strong>Arguments</strong></p><ul><li><code>pkg::String</code>: Package name to install. Can include channel specification using  the format &quot;channel::package&quot;</li></ul><p><strong>Keywords</strong></p><ul><li><code>force::Bool=false</code>: If true, recreates the environment even if it already exists</li></ul><p><strong>Details</strong></p><p>The function creates a new Conda environment named after the package and installs the package into it. It uses channel priority: conda-forge &gt; bioconda &gt; defaults. If CONDA_RUNNER is set to &#39;mamba&#39;, it will ensure mamba is installed first.</p><p><strong>Examples</strong></p><pre><code class="language-julia hljs"># Install basic package
add_bioconda_env(&quot;blast&quot;)

# Install from specific channel
add_bioconda_env(&quot;bioconda::blast&quot;)

# Force reinstallation
add_bioconda_env(&quot;blast&quot;, force=true)</code></pre><p><strong>Notes</strong></p><ul><li>Requires Conda.jl to be installed and configured</li><li>Uses CONDA_RUNNER global variable to determine whether to use conda or mamba</li><li>Cleans conda cache after installation</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL105">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.add_edgemer_to_graph!-NTuple{4, Any}" href="#Mycelia.add_edgemer_to_graph!-NTuple{4, Any}"><code>Mycelia.add_edgemer_to_graph!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">add_edgemer_to_graph!(
    graph,
    record_identifier,
    index,
    observed_edgemer
) -&gt; Any
</code></pre><p>Add an observed edgemer to a graph with its associated metadata.</p><p><strong>Arguments</strong></p><ul><li><code>graph::MetaGraph</code>: The graph to modify</li><li><code>record_identifier</code>: Identifier for the source record</li><li><code>index</code>: Position where edgemer was observed</li><li><code>observed_edgemer</code>: The biological sequence representing the edgemer</li></ul><p><strong>Details</strong></p><p>Processes the edgemer by:</p><ol><li>Splitting it into source and destination kmers</li><li>Converting kmers to their canonical forms</li><li>Creating or updating an edge with orientation metadata</li><li>Storing observation details (record, position, orientation)</li></ol><p><strong>Returns</strong></p><p>Modified graph with the new edge and metadata</p><p><strong>Note</strong></p><p>If the edge already exists, the observation is added to the existing metadata.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL8582">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.add_fastx_records_to_graph!-Tuple{Any, Any}" href="#Mycelia.add_fastx_records_to_graph!-Tuple{Any, Any}"><code>Mycelia.add_fastx_records_to_graph!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">add_fastx_records_to_graph!(graph, fastxs) -&gt; Any
</code></pre><p>Add FASTX records from multiple files as a graph property.</p><p><strong>Arguments</strong></p><ul><li><code>graph</code>: A MetaGraph that will store the FASTX records</li><li><code>fastxs</code>: Collection of FASTA/FASTQ file paths to process</li></ul><p><strong>Details</strong></p><p>Creates a dictionary mapping sequence descriptions to their corresponding FASTX records, then stores this dictionary as a graph property under the key <code>:records</code>. Multiple input files are merged, with later files overwriting records with duplicate descriptions.</p><p><strong>Returns</strong></p><p>The modified graph with added records property.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL8505">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.add_record_edgemers_to_graph!-Tuple{Any}" href="#Mycelia.add_record_edgemers_to_graph!-Tuple{Any}"><code>Mycelia.add_record_edgemers_to_graph!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">add_record_edgemers_to_graph!(graph) -&gt; Any
</code></pre><p>Processes DNA sequence records stored in the graph and adds their edgemers (k+1 length subsequences)  to build the graph structure.</p><p><strong>Arguments</strong></p><ul><li><code>graph</code>: A Mycelia graph object containing DNA sequence records and graph properties</li></ul><p><strong>Details</strong></p><ul><li>Uses the k-mer size specified in <code>graph.gprops[:k]</code> to generate k+1 length edgemers</li><li>Iterates through each record in <code>graph.gprops[:records]</code></li><li>For each record, generates all possible overlapping edgemers</li><li>Adds each edgemer to the graph with its position and record information</li></ul><p><strong>Returns</strong></p><ul><li>The modified graph object with added edgemer information</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL8533">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.amino_acids_to_codons-Tuple{}" href="#Mycelia.amino_acids_to_codons-Tuple{}"><code>Mycelia.amino_acids_to_codons</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">amino_acids_to_codons(

) -&gt; Dict{BioSymbols.AminoAcid, DataType}
</code></pre><p>Creates a mapping from amino acids to representative DNA codons using the standard genetic code.</p><p><strong>Returns</strong></p><ul><li>Dictionary mapping each amino acid (including stop codon <code>AA_Term</code>) to a valid DNA codon that encodes it</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL12433">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.annotate_aa_fasta-Tuple{}" href="#Mycelia.annotate_aa_fasta-Tuple{}"><code>Mycelia.annotate_aa_fasta</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">annotate_aa_fasta(
;
    fasta,
    identifier,
    basedir,
    mmseqsdb,
    threads
)
</code></pre><p>Annotate amino acid sequences in a FASTA file using MMseqs2 search against UniRef50 database.</p><p><strong>Arguments</strong></p><ul><li><code>fasta</code>: Path to input FASTA file containing amino acid sequences</li><li><code>identifier</code>: Name for the output directory (defaults to FASTA filename without extension)</li><li><code>basedir</code>: Base directory for output (defaults to current directory)</li><li><code>mmseqsdb</code>: Path to MMseqs2 formatted UniRef50 database (defaults to ~/workspace/mmseqs/UniRef50)</li><li><code>threads</code>: Number of CPU threads to use (defaults to system thread count)</li></ul><p><strong>Returns</strong></p><ul><li>Path to the output directory containing MMseqs2 search results</li></ul><p>The function creates a new directory named by <code>identifier</code> under <code>basedir</code>, copies the input FASTA file, and runs MMseqs2 easy-search against the specified database. If the output directory already exists, the function skips processing and returns the directory path.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL808">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.annotate_fasta-Tuple{}" href="#Mycelia.annotate_fasta-Tuple{}"><code>Mycelia.annotate_fasta</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">annotate_fasta(
;
    fasta,
    identifier,
    basedir,
    mmseqsdb,
    threads
)
</code></pre><p>Perform comprehensive annotation of a FASTA file including gene prediction, protein homology search, and terminator prediction.</p><p><strong>Arguments</strong></p><ul><li><code>fasta::String</code>: Path to input FASTA file</li><li><code>identifier::String</code>: Unique identifier for output directory (default: FASTA filename without extension)</li><li><code>basedir::String</code>: Base directory for output (default: current working directory)</li><li><code>mmseqsdb::String</code>: Path to MMseqs2 UniRef50 database (default: &quot;~/workspace/mmseqs/UniRef50&quot;)</li><li><code>threads::Int</code>: Number of CPU threads to use (default: all available)</li></ul><p><strong>Processing Steps</strong></p><ol><li>Creates output directory and copies input FASTA</li><li>Runs Prodigal for gene prediction (nucleotide, amino acid, and GFF output)</li><li>Performs MMseqs2 homology search against UniRef50</li><li>Predicts terminators using TransTerm</li><li>Combines annotations into a unified GFF file</li><li>Generates GenBank format output</li></ol><p><strong>Returns</strong></p><ul><li><code>String</code>: Path to the output directory containing all generated files</li></ul><p><strong>Files Generated</strong></p><ul><li><code>.prodigal.fna</code>: Predicted genes (nucleotide)</li><li><code>.prodigal.faa</code>: Predicted proteins</li><li><code>.prodigal.gff</code>: Prodigal GFF annotations</li><li><code>.gff</code>: Combined annotations</li><li><code>.gff.genbank</code>: Final GenBank format</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL736">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.assess_alignment-Tuple{Any, Any}" href="#Mycelia.assess_alignment-Tuple{Any, Any}"><code>Mycelia.assess_alignment</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">assess_alignment(
    a,
    b
) -&gt; @NamedTuple{total_matches::Int64, total_edits::Int64}
</code></pre><p>Aligns two sequences using the Levenshtein distance and returns the total number of matches and edits.</p><p><strong>Arguments</strong></p><ul><li><code>a::AbstractString</code>: The first sequence to be aligned.</li><li><code>b::AbstractString</code>: The second sequence to be aligned.</li></ul><p><strong>Returns</strong></p><ul><li><code>NamedTuple{(:total_matches, :total_edits), Tuple{Int, Int}}</code>: A named tuple containing:<ul><li><code>total_matches::Int</code>: The total number of matching bases in the alignment.</li><li><code>total_edits::Int</code>: The total number of edits (insertions, deletions, substitutions) in the alignment.</li></ul></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL13738">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.assess_alignment_accuracy-Tuple{Any}" href="#Mycelia.assess_alignment_accuracy-Tuple{Any}"><code>Mycelia.assess_alignment_accuracy</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">assess_alignment_accuracy(alignment_result) -&gt; Any
</code></pre><p>Return proportion of matched bases in alignment to total matches + edits.</p><p>Calculate the accuracy of a sequence alignment by computing the ratio of matched bases  to total alignment operations (matches + edits).</p><p><strong>Arguments</strong></p><ul><li><code>alignment_result</code>: Alignment result object containing <code>total_matches</code> and <code>total_edits</code> fields</li></ul><p><strong>Returns</strong></p><p>Float64 between 0.0 and 1.0 representing alignment accuracy, where:</p><ul><li>1.0 indicates perfect alignment (all matches)</li><li>0.0 indicates no matches</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL13674">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.assess_assembly_quality-Tuple{}" href="#Mycelia.assess_assembly_quality-Tuple{}"><code>Mycelia.assess_assembly_quality</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">assess_assembly_quality(; assembly, observations, ks)
</code></pre><p>Evaluate genome assembly quality by comparing k-mer distributions between assembled sequences and raw observations.</p><p><strong>Arguments</strong></p><ul><li><code>assembly</code>: Input assembled sequences to evaluate</li><li><code>observations</code>: Raw sequencing data for comparison</li><li><code>ks::Vector{Int}</code>: Vector of k-mer sizes to analyze (default: k=17 to 23)</li></ul><p><strong>Returns</strong></p><p>DataFrame containing quality metrics for each k-mer size:</p><ul><li><code>k</code>: K-mer length used</li><li><code>cosine_distance</code>: Cosine similarity between k-mer distributions</li><li><code>js_divergence</code>: Jensen-Shannon divergence between distributions  </li><li><code>qv</code>: MerQury-style quality value score</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL2594">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.assess_dnamer_saturation-Tuple{AbstractString}" href="#Mycelia.assess_dnamer_saturation-Tuple{AbstractString}"><code>Mycelia.assess_dnamer_saturation</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">assess_dnamer_saturation(
    fastx::AbstractString;
    power,
    outdir,
    min_k,
    max_k,
    threshold,
    kmers_to_assess
)
</code></pre><p>Analyzes k-mer saturation in a FASTA/FASTQ file to determine optimal k-mer size.</p><p><strong>Arguments</strong></p><ul><li><code>fastx::AbstractString</code>: Path to input FASTA/FASTQ file</li><li><code>power::Int=10</code>: Exponent for downsampling k-mers (2^power)</li><li><code>outdir::String=&quot;&quot;</code>: Output directory for results. Uses current directory if empty</li><li><code>min_k::Int=3</code>: Minimum k-mer size to evaluate</li><li><code>max_k::Int=17</code>: Maximum k-mer size to evaluate</li><li><code>threshold::Float64=0.1</code>: Saturation threshold for k-mer assessment</li><li><code>kmers_to_assess::Int=10_000_000</code>: Maximum number of k-mers to sample</li></ul><p><strong>Returns</strong></p><p><code>Dict{Int,Float64}</code>: Dictionary mapping k-mer sizes to their saturation scores</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL8412">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.assess_dnamer_saturation-Tuple{AbstractVector{&lt;:AbstractString}, Any}" href="#Mycelia.assess_dnamer_saturation-Tuple{AbstractVector{&lt;:AbstractString}, Any}"><code>Mycelia.assess_dnamer_saturation</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">assess_dnamer_saturation(
    fastxs::AbstractVector{&lt;:AbstractString},
    kmer_type;
    kmers_to_assess,
    power,
    min_count
) -&gt; Union{@NamedTuple{sampling_points::Vector{Int64}, unique_kmer_counts::Vector{Int64}}, NamedTuple{(:sampling_points, :unique_kmer_counts, :eof), &lt;:Tuple{Vector, Vector{Int64}, Bool}}}
</code></pre><p>Assess k-mer saturation in DNA sequences from FASTX files.</p><p><strong>Arguments</strong></p><ul><li><code>fastxs::AbstractVector{&lt;:AbstractString}</code>: Vector of paths to FASTA/FASTQ files</li><li><code>kmer_type</code>: Type of k-mer to analyze (e.g., DNAKmer{21})</li><li><code>kmers_to_assess=Inf</code>: Maximum number of k-mers to process</li><li><code>power=10</code>: Base for exponential sampling intervals</li><li><code>min_count=1</code>: Minimum count threshold for considering a k-mer</li></ul><p><strong>Returns</strong></p><p>Named tuple containing:</p><ul><li><code>sampling_points::Vector{Int}</code>: K-mer counts at which samples were taken</li><li><code>unique_kmer_counts::Vector{Int}</code>: Number of unique canonical k-mers at each sampling point</li><li><code>eof::Bool</code>: Whether the entire input was processed</li></ul><p><strong>Details</strong></p><p>Analyzes k-mer saturation by counting unique canonical k-mers at exponentially spaced  intervals (powers of <code>power</code>). Useful for assessing sequence complexity and coverage. Returns early if all possible k-mers are observed.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL8211">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.assess_dnamer_saturation-Tuple{AbstractVector{&lt;:AbstractString}}" href="#Mycelia.assess_dnamer_saturation-Tuple{AbstractVector{&lt;:AbstractString}}"><code>Mycelia.assess_dnamer_saturation</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">assess_dnamer_saturation(
    fastxs::AbstractVector{&lt;:AbstractString};
    power,
    outdir,
    min_k,
    max_k,
    threshold,
    kmers_to_assess,
    plot
)
</code></pre><p>Analyze k-mer saturation in DNA sequences to determine optimal k value.</p><p><strong>Arguments</strong></p><ul><li><code>fastxs</code>: Vector of paths to FASTA/FASTQ files to analyze</li><li><code>power</code>: Base of logarithmic sampling points (default: 10)</li><li><code>outdir</code>: Optional output directory for plots and results</li><li><code>min_k</code>: Minimum k-mer size to test (default: 7)</li><li><code>max_k</code>: Maximum k-mer size to test (default: 17)</li><li><code>threshold</code>: Saturation threshold to determine optimal k (default: 0.1)</li><li><code>kmers_to_assess</code>: Maximum number of k-mers to sample (default: 10M)</li><li><code>plot</code>: Whether to generate saturation curves (default: true)</li></ul><p><strong>Returns</strong></p><p>Integer representing the first k value that achieves saturation below threshold. If no k value meets the threshold, returns the k with minimum saturation.</p><p><strong>Details</strong></p><ul><li>Tests only prime k values between min<em>k and max</em>k</li><li>Generates saturation curves using logarithmic sampling</li><li>Fits curves to estimate maximum unique k-mers</li><li>If outdir is provided, saves plots as SVG and chosen k value to text file</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL8298">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.assess_optimal_kmer_alignment-Tuple{Any, Any}" href="#Mycelia.assess_optimal_kmer_alignment-Tuple{Any, Any}"><code>Mycelia.assess_optimal_kmer_alignment</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">assess_optimal_kmer_alignment(
    kmer,
    observed_kmer
) -&gt; Tuple{@NamedTuple{total_matches::Int64, total_edits::Int64}, Union{Missing, Bool}}
</code></pre><p>Used to determine which orientation provides an optimal alignment for initiating path likelihood analyses in viterbi analysis</p><p>Compare alignment scores between a query k-mer and an observed k-mer in both forward and reverse complement orientations to determine optimal alignment.</p><p><strong>Arguments</strong></p><ul><li><code>kmer</code>: Query k-mer sequence to align</li><li><code>observed_kmer</code>: Target k-mer sequence to align against</li></ul><p><strong>Returns</strong></p><p>A tuple containing:</p><ul><li><code>alignment_result</code>: The alignment result object for the optimal orientation</li><li><code>orientation</code>: Boolean indicating orientation (<code>true</code> = forward, <code>false</code> = reverse complement, <code>missing</code> = tied scores)</li></ul><p><strong>Details</strong></p><ul><li>Performs pairwise alignment in both orientations using <code>assess_alignment()</code></li><li>Calculates accuracy scores using <code>assess_alignment_accuracy()</code></li><li>For tied alignment scores, randomly selects one orientation</li><li>Uses BioSequences.reverse_complement for reverse orientation comparison</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL13694">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.bam_to_fastq-Tuple{}" href="#Mycelia.bam_to_fastq-Tuple{}"><code>Mycelia.bam_to_fastq</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">bam_to_fastq(; bam, fastq)
</code></pre><p>Convert a BAM file to FASTQ format with gzip compression.</p><p><strong>Arguments</strong></p><ul><li><code>bam</code>: Path to input BAM file</li><li><code>fastq</code>: Optional output path. Defaults to input path with &quot;.fq.gz&quot; extension</li></ul><p><strong>Returns</strong></p><ul><li>Path to the generated FASTQ file</li></ul><p><strong>Details</strong></p><ul><li>Uses samtools through conda environment</li><li>Automatically skips if output file exists</li><li>Output is gzip compressed</li><li>Requires samtools to be available via conda</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL3131">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.bandage_visualize-Tuple{}" href="#Mycelia.bandage_visualize-Tuple{}"><code>Mycelia.bandage_visualize</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">bandage_visualize(; gfa, img)
</code></pre><p>Generate a visualization of a genome assembly graph using Bandage.</p><p><strong>Arguments</strong></p><ul><li><code>gfa</code>: Path to input GFA (Graphical Fragment Assembly) file</li><li><code>img</code>: Optional output image path. Defaults to GFA filename with .png extension</li></ul><p><strong>Returns</strong></p><ul><li>Path to the generated image file</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL3213">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.biosequences_to_counts_table-Tuple{}" href="#Mycelia.biosequences_to_counts_table-Tuple{}"><code>Mycelia.biosequences_to_counts_table</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">biosequences_to_counts_table(; biosequences, k)
</code></pre><p>Convert a collection of biological sequences into a k-mer count matrix.</p><p><strong>Arguments</strong></p><ul><li><code>biosequences</code>: Vector of biological sequences (DNA, RNA, or Amino Acids)</li><li><code>k</code>: Length of k-mers to count</li></ul><p><strong>Returns</strong></p><p>Named tuple with:</p><ul><li><code>sorted_kmers</code>: Vector of all unique k-mers found, lexicographically sorted</li><li><code>kmer_counts_matrix</code>: Sparse matrix where rows are k-mers and columns are sequences</li></ul><p><strong>Details</strong></p><ul><li>For DNA sequences, counts canonical k-mers (both strands)</li><li>Uses parallel processing with Thread-safe progress tracking</li><li>Memory efficient sparse matrix representation</li><li>Supports DNA, RNA and Amino Acid sequences</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL12917">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.biosequences_to_dense_counts_table-Tuple{}" href="#Mycelia.biosequences_to_dense_counts_table-Tuple{}"><code>Mycelia.biosequences_to_dense_counts_table</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">biosequences_to_dense_counts_table(; biosequences, k)
</code></pre><p>Convert a collection of biological sequences into a dense k-mer count matrix.</p><p><strong>Arguments</strong></p><ul><li><code>biosequences</code>: Collection of DNA, RNA, or amino acid sequences (BioSequence types)</li><li><code>k::Integer</code>: Length of k-mers to count (must be ≤ 13)</li></ul><p><strong>Returns</strong></p><p>Named tuple containing:</p><ul><li><code>sorted_kmers</code>: Vector of all possible k-mers in sorted order</li><li><code>kmer_counts_matrix</code>: Dense matrix where rows are k-mers and columns are sequences</li></ul><p><strong>Details</strong></p><ul><li>For DNA sequences, counts canonical k-mers (both strands)</li><li>For RNA and protein sequences, counts exact k-mers</li><li>Uses parallel processing with threads</li><li>For k &gt; 13, use <code>fasta_list_to_sparse_counts_table</code> instead</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL12821">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.blastdb2table-Tuple{}" href="#Mycelia.blastdb2table-Tuple{}"><code>Mycelia.blastdb2table</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">blastdb2table(; blastdb, outfile, force)
</code></pre><p>Convert a BLAST database to a tabular format with sequence and taxonomy information.</p><p><strong>Arguments</strong></p><ul><li><code>blastdb::String</code>: Path to the BLAST database</li><li><code>outfile::String=&quot;&quot;</code>: Output file path. If empty, generates name based on input database</li><li><code>force::Bool=false</code>: Whether to overwrite existing output file</li></ul><p><strong>Returns</strong></p><ul><li><code>String</code>: Path to the generated output file (.tsv.gz)</li></ul><p><strong>Output Format</strong></p><p>Tab-separated file containing columns:</p><ul><li>sequence SHA256</li><li>sequence</li><li>accession</li><li>gi</li><li>ordinal id</li><li>sequence id</li><li>sequence title</li><li>sequence length</li><li>sequence hash</li><li>taxid</li><li>leaf-node taxids</li><li>membership integer</li><li>common taxonomic name</li><li>common taxonomic names for leaf-node taxids</li><li>scientific name</li><li>scientific names for leaf-node taxids</li><li>BLAST name</li><li>taxonomic super kingdom</li><li>PIG</li></ul><p><strong>Dependencies</strong></p><p>Requires NCBI BLAST+ and perl-doc packages. May need sudo privileges for installation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL6401">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.blastdb_to_fasta-Tuple{}" href="#Mycelia.blastdb_to_fasta-Tuple{}"><code>Mycelia.blastdb_to_fasta</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">blastdb_to_fasta(; db, dbdir, compressed, outfile)
</code></pre><p>Convert a BLAST database to FASTA format.</p><p><strong>Arguments</strong></p><ul><li><code>db::String</code>: Name of the BLAST database to convert (e.g. &quot;nr&quot;, &quot;nt&quot;)</li><li><code>dbdir::String</code>: Directory containing the BLAST database files</li><li><code>compressed::Bool</code>: Whether to gzip compress the output file</li><li><code>outfile::String</code>: Path for the output FASTA file</li></ul><p><strong>Returns</strong></p><ul><li>Path to the generated FASTA file as String</li></ul><p><strong>Notes</strong></p><ul><li>For &quot;nr&quot; database, output extension will be .faa.gz (protein)</li><li>For &quot;nt&quot; database, output extension will be .fna.gz (nucleotide)</li><li>Requires ncbi-blast+ and perl-doc packages to be installed</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL6569">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.build_directed_kmer_graph-Tuple{}" href="#Mycelia.build_directed_kmer_graph-Tuple{}"><code>Mycelia.build_directed_kmer_graph</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">build_directed_kmer_graph(; fastq, k, plot)
</code></pre><p>Constructs a directed graph representation of k-mer transitions from FASTQ sequencing data.</p><p><strong>Arguments</strong></p><ul><li><code>fastq</code>: Path to input FASTQ file</li><li><code>k</code>: K-mer size (default: 1). Must be odd and prime. If k=1, optimal size is auto-determined</li><li><code>plot</code>: Boolean to display quality distribution plot (default: false)</li></ul><p><strong>Returns</strong></p><p>MetaDiGraph with properties:</p><ul><li>assembly_k: k-mer size used</li><li>kmer_counts: frequency of each k-mer</li><li>transition_likelihoods: edge weights between k-mers</li><li>kmer<em>mean</em>quality, kmer<em>total</em>quality: quality metrics</li><li>branching<em>nodes, unbranching</em>nodes: topological classification</li><li>likely<em>valid</em>kmer_indices: k-mers above mean quality threshold</li><li>likely<em>sequencing</em>artifact_indices: potential erroneous k-mers</li></ul><p><strong>Note</strong></p><p>For DNA assembly, quality scores are normalized across both strands.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL2139">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.build_stranded_kmer_graph-Tuple{Any, AbstractVector{&lt;:Union{FASTX.FASTA.Record, FASTX.FASTQ.Record}}}" href="#Mycelia.build_stranded_kmer_graph-Tuple{Any, AbstractVector{&lt;:Union{FASTX.FASTA.Record, FASTX.FASTQ.Record}}}"><code>Mycelia.build_stranded_kmer_graph</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">build_stranded_kmer_graph(
    kmer_type,
    observations::AbstractVector{&lt;:Union{FASTX.FASTA.Record, FASTX.FASTQ.Record}}
) -&gt; MetaGraphs.MetaDiGraph{T, Float64} where T&lt;:Integer
</code></pre><p>Create a weighted, strand-specific kmer (de bruijn) graph from a set of kmers and a series of sequence observations in FASTA format.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL16203">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.canonicalize_kmer_counts!-Tuple{Any}" href="#Mycelia.canonicalize_kmer_counts!-Tuple{Any}"><code>Mycelia.canonicalize_kmer_counts!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">canonicalize_kmer_counts!(kmer_counts) -&gt; Any
</code></pre><p>Canonicalizes the k-mer counts in the given dictionary.</p><p>This function iterates over the provided dictionary <code>kmer_counts</code>, which maps k-mers to their respective counts. For each k-mer that is not in its canonical form, it converts the k-mer to its canonical form and updates the count in the dictionary accordingly. If the canonical form of the k-mer already exists in the dictionary, their counts are summed. The original non-canonical k-mer is then removed from the dictionary.</p><p><strong>Arguments</strong></p><ul><li><code>kmer_counts::Dict{BioSequences.Kmer, Int}</code>: A dictionary where keys are k-mers and values are their counts.</li></ul><p><strong>Returns</strong></p><ul><li>The input dictionary <code>kmer_counts</code> with all k-mers in their canonical form, sorted by k-mers.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL13761">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.canonicalize_kmer_counts-Tuple{Any}" href="#Mycelia.canonicalize_kmer_counts-Tuple{Any}"><code>Mycelia.canonicalize_kmer_counts</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">canonicalize_kmer_counts(kmer_counts) -&gt; Any
</code></pre><p>Normalize k-mer counts into a canonical form by creating a non-mutating copy.</p><p><strong>Arguments</strong></p><ul><li><code>kmer_counts</code>: Dictionary or collection of k-mer count data</li></ul><p><strong>Returns</strong></p><ul><li>A new normalized k-mer count collection</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL13789">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.chromosome_coverage_table_to_plot-Tuple{Any}" href="#Mycelia.chromosome_coverage_table_to_plot-Tuple{Any}"><code>Mycelia.chromosome_coverage_table_to_plot</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">chromosome_coverage_table_to_plot(cdf) -&gt; Plots.Plot
</code></pre><p>Creates a visualization of chromosome coverage data with statistical thresholds.</p><p><strong>Arguments</strong></p><ul><li><code>cdf::DataFrame</code>: Coverage data frame containing columns:<ul><li><code>index</code>: Chromosome position indices</li><li><code>depth</code>: Coverage depth values</li><li><code>chromosome</code>: Chromosome identifier</li><li><code>mean_coverage</code>: Mean coverage value</li><li><code>std_coverage</code>: Standard deviation of coverage</li><li><code>3σ</code>: Boolean vector indicating +3 sigma regions</li><li><code>-3σ</code>: Boolean vector indicating -3 sigma regions</li></ul></li></ul><p><strong>Returns</strong></p><ul><li>A StatsPlots plot object showing:<ul><li>Raw coverage data (black line)</li><li>Mean coverage and ±1,2,3σ thresholds (rainbow colors)</li><li>Highlighted regions exceeding ±3σ thresholds (red vertical lines)</li></ul></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL4570">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.codon_optimize-Tuple{}" href="#Mycelia.codon_optimize-Tuple{}"><code>Mycelia.codon_optimize</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">codon_optimize(
;
    normalized_codon_frequencies,
    protein_sequence,
    n_iterations
)
</code></pre><p>Optimizes the DNA sequence encoding for a given protein sequence using codon usage frequencies.</p><p><strong>Arguments</strong></p><ul><li><code>normalized_codon_frequencies</code>: Dictionary mapping amino acids to their codon frequencies</li><li><code>protein_sequence::BioSequences.LongAA</code>: Target protein sequence to optimize</li><li><code>n_iterations::Integer</code>: Number of optimization iterations to perform</li></ul><p><strong>Algorithm</strong></p><ol><li>Creates initial DNA sequence through reverse translation</li><li>Iteratively generates new sequences by sampling codons based on their frequencies</li><li>Keeps track of the sequence with highest codon usage likelihood</li></ol><p><strong>Returns</strong></p><ul><li><code>BioSequences.LongDNA{2}</code>: Optimized DNA sequence encoding the input protein</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL12599">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.codons_to_amino_acids-Tuple{}" href="#Mycelia.codons_to_amino_acids-Tuple{}"><code>Mycelia.codons_to_amino_acids</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">codons_to_amino_acids(

) -&gt; Union{Dict{_A, BioSequences.LongAA} where _A, Dict{_A, V} where {_A, V&lt;:(Kmers.Kmer{BioSequences.AminoAcidAlphabet, _A, _B} where {_B, _A})}}
</code></pre><p>Creates a mapping between DNA codons and their corresponding amino acids using the standard genetic code.</p><p>Returns a dictionary where:</p><ul><li>Keys are 3-letter DNA codons (e.g., &quot;ATG&quot;)</li><li>Values are the corresponding amino acids from BioSequences.jl</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL12450">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.concatenate_files-Tuple{}" href="#Mycelia.concatenate_files-Tuple{}"><code>Mycelia.concatenate_files</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">concatenate_files(; files, file)
</code></pre><p>Join fasta files without any regard to record uniqueness.</p><p>A cross-platform version of <code>cat *.fasta &gt; joint.fasta</code></p><p>See merge<em>fasta</em>files</p><p>Concatenate multiple FASTA files into a single output file by simple appending.</p><p><strong>Arguments</strong></p><ul><li><code>files</code>: Vector of paths to input FASTA files</li><li><code>file</code>: Path where the concatenated output will be written</li></ul><p><strong>Returns</strong></p><ul><li>Path to the output concatenated file</li></ul><p><strong>Details</strong></p><p>Platform-independent implementation of <code>cat *.fasta &gt; combined.fasta</code>. Files are processed sequentially with a progress indicator.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL14336">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.contig_is_circular-Tuple{String, String}" href="#Mycelia.contig_is_circular-Tuple{String, String}"><code>Mycelia.contig_is_circular</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">contig_is_circular(
    graph_file::String,
    contig_name::String
) -&gt; Any
</code></pre><p>Returns bool indicating whether the contig is a circle</p><p>graph<em>file = path to assembly graph.gfa file contig</em>name = name of the contig</p><p>Determine if a contig represents a circular structure in the assembly graph.</p><p>A circular contig is one where the sequence forms a complete loop in the assembly graph, typically representing structures like plasmids, circular chromosomes, or other circular DNA elements.</p><p><strong>Arguments</strong></p><ul><li><code>graph_file::String</code>: Path to the assembly graph in GFA format</li><li><code>contig_name::String</code>: Name/identifier of the contig to check</li></ul><p><strong>Returns</strong></p><ul><li><code>Bool</code>: <code>true</code> if the contig forms a circular structure, <code>false</code> otherwise</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL7918">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.contig_is_cleanly_assembled-Tuple{String, String}" href="#Mycelia.contig_is_cleanly_assembled-Tuple{String, String}"><code>Mycelia.contig_is_cleanly_assembled</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">contig_is_cleanly_assembled(
    graph_file::String,
    contig_name::String
) -&gt; Bool
</code></pre><p>Returns bool indicating whether the contig is cleanly assembled.</p><p>By cleanly assembled we mean that the contig does not have other contigs attached in the same connected component.</p><p>graph<em>file = path to assembly graph.gfa file contig</em>name = name of the contig</p><p>Check if a contig exists in isolation within its connected component in an assembly graph.</p><p><strong>Arguments</strong></p><ul><li><code>graph_file::String</code>: Path to the assembly graph file in GFA format</li><li><code>contig_name::String</code>: Name/identifier of the contig to check</li></ul><p><strong>Returns</strong></p><ul><li><code>Bool</code>: <code>true</code> if the contig exists alone in its connected component, <code>false</code> otherwise</li></ul><p><strong>Details</strong></p><p>A contig is considered &quot;cleanly assembled&quot; if it appears as a single entry in the  assembly graph&#39;s connected components. This function parses the GFA file and checks the contig&#39;s isolation status using the graph structure.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL7867">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.convert-Tuple{Any}" href="#Mycelia.convert-Tuple{Any}"><code>Mycelia.convert</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">convert(args)
</code></pre><p>Convert between different graph file formats.</p><p><strong>Arguments</strong></p><ul><li><code>args</code>: Dictionary with required keys:<ul><li><code>&quot;in&quot;</code>: Input filepath (supported: .jld2, .gfa, .neo4j)</li><li><code>&quot;out&quot;</code>: Output filepath (supported: .jld2, .gfa, .neo4j)</li></ul></li></ul><p><strong>Details</strong></p><p>Performs format conversion based on file extensions. For non-JLD2 to non-JLD2 conversions, uses JLD2 as an intermediate format.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL12137">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.convert_sequence-Tuple{AbstractString}" href="#Mycelia.convert_sequence-Tuple{AbstractString}"><code>Mycelia.convert_sequence</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">convert_sequence(seq::AbstractString) -&gt; Any
</code></pre><p>Converts the given sequence (output from FASTX.sequence) into the appropriate BioSequence type:</p><ul><li>DNA sequences are converted using <code>BioSequences.LongDNA</code></li><li>RNA sequences are converted using <code>BioSequences.LongRNA</code></li><li>AA sequences are converted using <code>BioSequences.LongAA</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL13581">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.copy_to_tempdir-Tuple{String}" href="#Mycelia.copy_to_tempdir-Tuple{String}"><code>Mycelia.copy_to_tempdir</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">copy_to_tempdir(file_path::String) -&gt; String
</code></pre><p>Create a copy of a file in a temporary directory while preserving the original filename.</p><p><strong>Arguments</strong></p><ul><li><code>file_path::String</code>: Path to the source file to be copied</li></ul><p><strong>Returns</strong></p><ul><li><code>String</code>: Path to the newly created temporary file</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL1100">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.copy_with_unique_identifier-Tuple{Any, Any, Any}" href="#Mycelia.copy_with_unique_identifier-Tuple{Any, Any, Any}"><code>Mycelia.copy_with_unique_identifier</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">copy_with_unique_identifier(
    infile,
    out_directory,
    unique_identifier;
    force
) -&gt; Any
</code></pre><p>Copy a file to a new location with a unique identifier prepended to the filename.</p><p><strong>Arguments</strong></p><ul><li><code>infile::AbstractString</code>: Path to the source file to copy</li><li><code>out_directory::AbstractString</code>: Destination directory for the copied file</li><li><code>unique_identifier::AbstractString</code>: String to prepend to the filename</li><li><code>force::Bool=true</code>: If true, overwrite existing files</li></ul><p><strong>Returns</strong></p><ul><li><code>String</code>: Path to the newly created file</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL3503">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.count_canonical_kmers-Union{Tuple{KMER_TYPE}, Tuple{Type{KMER_TYPE}, Any}} where KMER_TYPE" href="#Mycelia.count_canonical_kmers-Union{Tuple{KMER_TYPE}, Tuple{Type{KMER_TYPE}, Any}} where KMER_TYPE"><code>Mycelia.count_canonical_kmers</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">count_canonical_kmers(_::Type{KMER_TYPE}, sequences) -&gt; Any
</code></pre><p>Count canonical k-mers in biological sequences. A canonical k-mer is the lexicographically  smaller of a DNA sequence and its reverse complement, ensuring strand-independent counting.</p><p><strong>Arguments</strong></p><ul><li><code>KMER_TYPE</code>: Type parameter specifying the k-mer size and structure</li><li><code>sequences</code>: Iterator of biological sequences to analyze</li></ul><p><strong>Returns</strong></p><ul><li><code>Dict{KMER_TYPE,Int}</code>: Dictionary mapping canonical k-mers to their counts</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL13804">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.count_kmers-Union{Tuple{KMER_TYPE}, Tuple{Type{KMER_TYPE}, AbstractString}} where KMER_TYPE" href="#Mycelia.count_kmers-Union{Tuple{KMER_TYPE}, Tuple{Type{KMER_TYPE}, AbstractString}} where KMER_TYPE"><code>Mycelia.count_kmers</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">count_kmers(
    _::Type{KMER_TYPE},
    fastx_file::AbstractString
) -&gt; Any
</code></pre><p>Count k-mers in a FASTA/FASTQ file and return their frequencies.</p><p><strong>Arguments</strong></p><ul><li><code>KMER_TYPE</code>: Type parameter specifying the k-mer type (e.g., <code>DNAKmer{K}</code>)</li><li><code>fastx_file</code>: Path to input FASTA/FASTQ file</li></ul><p><strong>Returns</strong></p><ul><li><code>Dict{KMER_TYPE, Int}</code>: Dictionary mapping each k-mer to its frequency</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL13960">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.count_kmers-Union{Tuple{K}, Tuple{A}, Tuple{Type{Kmers.Mer{K, A}}, BioSequences.LongSequence}} where {A&lt;:BioSequences.AminoAcidAlphabet, K}" href="#Mycelia.count_kmers-Union{Tuple{K}, Tuple{A}, Tuple{Type{Kmers.Mer{K, A}}, BioSequences.LongSequence}} where {A&lt;:BioSequences.AminoAcidAlphabet, K}"><code>Mycelia.count_kmers</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">count_kmers(
    _::Type{Kmers.Kmer{A&lt;:BioSequences.AminoAcidAlphabet, K}},
    sequence::BioSequences.LongSequence
) -&gt; OrderedCollections.OrderedDict{K, Int64} where K&lt;:(Kmers.Kmer{BioSequences.AminoAcidAlphabet, _A, _B} where {_B, _A})
</code></pre><p>Count the frequency of amino acid k-mers in a biological sequence.</p><p><strong>Arguments</strong></p><ul><li><code>Kmers.Kmer{A,K}</code>: Type parameter specifying amino acid alphabet (A) and k-mer length (K)</li><li><code>sequence</code>: Input biological sequence to analyze</li></ul><p><strong>Returns</strong></p><p>A sorted dictionary mapping each k-mer to its frequency count in the sequence.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL13860">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.count_kmers-Union{Tuple{K}, Tuple{A}, Tuple{Type{Kmers.Mer{K, A}}, BioSequences.LongSequence}} where {A&lt;:BioSequences.DNAAlphabet, K}" href="#Mycelia.count_kmers-Union{Tuple{K}, Tuple{A}, Tuple{Type{Kmers.Mer{K, A}}, BioSequences.LongSequence}} where {A&lt;:BioSequences.DNAAlphabet, K}"><code>Mycelia.count_kmers</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">count_kmers(
    _::Type{Kmers.Kmer{A&lt;:BioSequences.DNAAlphabet, K}},
    sequence::BioSequences.LongSequence
) -&gt; Any
</code></pre><p>Count the frequency of each k-mer in a DNA sequence.</p><p><strong>Arguments</strong></p><ul><li><code>::Type{Kmers.Kmer{A,K}}</code>: K-mer type with alphabet A and length K</li><li><code>sequence::BioSequences.LongSequence</code>: Input DNA sequence to analyze</li></ul><p><strong>Returns</strong></p><p>A sorted dictionary mapping each k-mer to its frequency count in the sequence.</p><p><strong>Type Parameters</strong></p><ul><li><code>A &lt;: BioSequences.DNAAlphabet</code>: DNA alphabet type</li><li><code>K</code>: Length of k-mers</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL13822">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.count_kmers-Union{Tuple{K}, Tuple{A}, Tuple{Type{Kmers.Mer{K, A}}, BioSequences.LongSequence}} where {A&lt;:BioSequences.RNAAlphabet, K}" href="#Mycelia.count_kmers-Union{Tuple{K}, Tuple{A}, Tuple{Type{Kmers.Mer{K, A}}, BioSequences.LongSequence}} where {A&lt;:BioSequences.RNAAlphabet, K}"><code>Mycelia.count_kmers</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">count_kmers(
    _::Type{Kmers.Kmer{A&lt;:BioSequences.RNAAlphabet, K}},
    sequence::BioSequences.LongSequence
) -&gt; Any
</code></pre><p>Count the frequency of each k-mer in an RNA sequence.</p><p><strong>Arguments</strong></p><ul><li><code>Kmer</code>: Type parameter specifying the k-mer length K and RNA alphabet</li><li><code>sequence</code>: Input RNA sequence to analyze</li></ul><p><strong>Returns</strong></p><ul><li><code>Dict{Kmers.Kmer, Int}</code>: Sorted dictionary mapping each k-mer to its frequency count</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL13843">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.count_kmers-Union{Tuple{R}, Tuple{KMER_TYPE}, Tuple{Type{KMER_TYPE}, R}} where {KMER_TYPE, R&lt;:Union{FASTX.FASTA.Reader, FASTX.FASTQ.Reader}}" href="#Mycelia.count_kmers-Union{Tuple{R}, Tuple{KMER_TYPE}, Tuple{Type{KMER_TYPE}, R}} where {KMER_TYPE, R&lt;:Union{FASTX.FASTA.Reader, FASTX.FASTQ.Reader}}"><code>Mycelia.count_kmers</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">count_kmers(
    _::Type{KMER_TYPE},
    sequences::Union{FASTX.FASTA.Reader, FASTX.FASTQ.Reader}
) -&gt; Any
</code></pre><p>Counts k-mer occurrences in biological sequences from a FASTA/FASTQ reader.</p><p><strong>Arguments</strong></p><ul><li><code>KMER_TYPE</code>: Type parameter specifying the k-mer length and encoding (e.g., <code>DNAKmer{4}</code> for 4-mers)</li><li><code>sequences</code>: A FASTA or FASTQ reader containing the biological sequences to analyze</li></ul><p><strong>Returns</strong></p><p>A dictionary mapping k-mers to their counts in the input sequences</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL13923">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.count_kmers-Union{Tuple{R}, Tuple{KMER_TYPE}, Tuple{Type{KMER_TYPE}, R}} where {KMER_TYPE, R&lt;:Union{FASTX.FASTA.Record, FASTX.FASTQ.Record}}" href="#Mycelia.count_kmers-Union{Tuple{R}, Tuple{KMER_TYPE}, Tuple{Type{KMER_TYPE}, R}} where {KMER_TYPE, R&lt;:Union{FASTX.FASTA.Record, FASTX.FASTQ.Record}}"><code>Mycelia.count_kmers</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">count_kmers(
    _::Type{KMER_TYPE},
    record::Union{FASTX.FASTA.Record, FASTX.FASTQ.Record}
) -&gt; Any
</code></pre><p>Count the frequency of amino acid k-mers in a biological sequence.</p><p><strong>Arguments</strong></p><ul><li><code>Kmers.Kmer{A,K}</code>: Type parameter specifying amino acid alphabet (A) and k-mer length (K)</li><li><code>sequence</code>: Input biological sequence to analyze</li></ul><p><strong>Returns</strong></p><p>A sorted dictionary mapping each k-mer to its frequency count in the sequence.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL13877">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.count_kmers-Union{Tuple{T}, Tuple{KMER_TYPE}, Tuple{Type{KMER_TYPE}, AbstractVector{T}}} where {KMER_TYPE, T&lt;:AbstractString}" href="#Mycelia.count_kmers-Union{Tuple{T}, Tuple{KMER_TYPE}, Tuple{Type{KMER_TYPE}, AbstractVector{T}}} where {KMER_TYPE, T&lt;:AbstractString}"><code>Mycelia.count_kmers</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">count_kmers(
    _::Type{KMER_TYPE},
    fastx_files::AbstractArray{T&lt;:AbstractString, 1}
) -&gt; Any
</code></pre><p>Count k-mers across multiple FASTA/FASTQ files and merge the results.</p><p><strong>Arguments</strong></p><ul><li><code>KMER_TYPE</code>: Type parameter specifying the k-mer length (e.g., <code>DNAKmer{4}</code> for 4-mers)</li><li><code>fastx_files</code>: Vector of paths to FASTA/FASTQ files</li></ul><p><strong>Returns</strong></p><ul><li><code>Dict{KMER_TYPE, Int}</code>: Dictionary mapping k-mers to their total counts across all files</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL13939">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.count_kmers-Union{Tuple{T}, Tuple{KMER_TYPE}, Tuple{Type{KMER_TYPE}, AbstractVector{T}}} where {KMER_TYPE, T&lt;:Union{FASTX.FASTA.Record, FASTX.FASTQ.Record}}" href="#Mycelia.count_kmers-Union{Tuple{T}, Tuple{KMER_TYPE}, Tuple{Type{KMER_TYPE}, AbstractVector{T}}} where {KMER_TYPE, T&lt;:Union{FASTX.FASTA.Record, FASTX.FASTQ.Record}}"><code>Mycelia.count_kmers</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">count_kmers(
    _::Type{KMER_TYPE},
    records::AbstractArray{T&lt;:Union{FASTX.FASTA.Record, FASTX.FASTQ.Record}, 1}
) -&gt; Any
</code></pre><p>Count k-mers across multiple sequence records and return a sorted frequency table.</p><p><strong>Arguments</strong></p><ul><li><code>KMER_TYPE</code>: Type parameter specifying the k-mer length (e.g., <code>DNAKmer{3}</code> for 3-mers)</li><li><code>records</code>: Vector of FASTA/FASTQ records to analyze</li></ul><p><strong>Returns</strong></p><ul><li><code>Dict{KMER_TYPE, Int}</code>: Sorted dictionary mapping k-mers to their frequencies</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL13902">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.count_matrix_to_probability_matrix-Tuple{Any}" href="#Mycelia.count_matrix_to_probability_matrix-Tuple{Any}"><code>Mycelia.count_matrix_to_probability_matrix</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">count_matrix_to_probability_matrix(counts_matrix) -&gt; Any
</code></pre><p>Convert a matrix of counts into a probability matrix by normalizing each column to sum to 1.0.</p><p><strong>Arguments</strong></p><ul><li><code>counts_matrix::Matrix{&lt;:Number}</code>: Input matrix where each column represents counts/frequencies</li></ul><p><strong>Returns</strong></p><ul><li><code>Matrix{Float64}</code>: Probability matrix where each column sums to 1.0</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL13018">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.count_records-Tuple{Any}" href="#Mycelia.count_records-Tuple{Any}"><code>Mycelia.count_records</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">count_records(fastx) -&gt; Int64
</code></pre><p>Counts the total number of records in a FASTA/FASTQ file.</p><p><strong>Arguments</strong></p><ul><li><code>fastx</code>: Path to a FASTA or FASTQ file (can be gzipped)</li></ul><p><strong>Returns</strong></p><ul><li>Number of records (sequences) in the file</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL14107">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.countmap_columns-Tuple{Any}" href="#Mycelia.countmap_columns-Tuple{Any}"><code>Mycelia.countmap_columns</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">countmap_columns(table)
</code></pre><p>Generate and display frequency counts for all columns in a DataFrame.</p><p><strong>Arguments</strong></p><ul><li><code>table::DataFrame</code>: Input DataFrame to analyze</li></ul><p><strong>Details</strong></p><p>Iterates through each column in the DataFrame and displays:</p><ol><li>The column name</li><li>A Dict mapping unique values to their frequencies using StatsBase.countmap</li></ol></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL7368">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.create_database-Tuple{}" href="#Mycelia.create_database-Tuple{}"><code>Mycelia.create_database</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">create_database(; database, address, username, password)
</code></pre><p>Creates a new Neo4j database instance if it doesn&#39;t already exist.</p><p><strong>Arguments</strong></p><ul><li><code>database::String</code>: Name of the database to create</li><li><code>address::String</code>: Neo4j server address (e.g. &quot;neo4j://localhost:7687&quot;)</li><li><code>username::String</code>: Neo4j authentication username (defaults to &quot;neo4j&quot;)</li><li><code>password::String</code>: Neo4j authentication password</li></ul><p><strong>Notes</strong></p><ul><li>Requires system database privileges to execute</li><li>Silently returns if database already exists</li><li>Temporarily switches to system database to perform creation</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL7159">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.create_node_constraints-Tuple{Any}" href="#Mycelia.create_node_constraints-Tuple{Any}"><code>Mycelia.create_node_constraints</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">create_node_constraints(
    graph;
    address,
    username,
    password,
    database
)
</code></pre><p>Creates unique identifier constraints for each node type in a Neo4j database.</p><p><strong>Arguments</strong></p><ul><li><code>graph</code>: A MetaGraph containing nodes with TYPE properties</li><li><code>address</code>: Neo4j server address</li><li><code>username</code>: Neo4j username (default: &quot;neo4j&quot;)</li><li><code>password</code>: Neo4j password</li><li><code>database</code>: Neo4j database name (default: &quot;neo4j&quot;)</li></ul><p><strong>Details</strong></p><p>Extracts unique node types from the graph and creates Neo4j constraints ensuring each node of a given type has a unique identifier property.</p><p>Failed constraint creation attempts are silently skipped.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL6855">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.create_tarchive-Tuple{}" href="#Mycelia.create_tarchive-Tuple{}"><code>Mycelia.create_tarchive</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">create_tarchive(; directory, tarchive)
</code></pre><p>Creates a gzipped tar archive of the specified directory along with verification files.</p><p><strong>Arguments</strong></p><ul><li><code>directory</code>: Source directory path to archive</li><li><code>tarchive</code>: Optional output archive path (defaults to directory name with .tar.gz extension)</li></ul><p><strong>Generated Files</strong></p><ul><li><code>{tarchive}</code>: The compressed tar archive</li><li><code>{tarchive}.log</code>: Contents listing of the archive</li><li><code>{tarchive}.hashdeep.dfxml</code>: Cryptographic hashes (MD5, SHA1, SHA256) of the archive</li></ul><p><strong>Returns</strong></p><ul><li>Path to the created tar archive file</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL1738">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.cypher-Tuple{Any}" href="#Mycelia.cypher-Tuple{Any}"><code>Mycelia.cypher</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">cypher(
    cmd;
    address,
    username,
    password,
    format,
    database
) -&gt; Cmd
</code></pre><p>Constructs a command to execute Neo4j Cypher queries via cypher-shell.</p><p><strong>Arguments</strong></p><ul><li><code>cmd</code>: The Cypher query command to execute</li><li><code>address::String=&quot;neo4j://localhost:7687&quot;</code>: Neo4j server address</li><li><code>username::String=&quot;neo4j&quot;</code>: Neo4j authentication username</li><li><code>password::String=&quot;password&quot;</code>: Neo4j authentication password </li><li><code>format::String=&quot;auto&quot;</code>: Output format (auto, verbose, or plain)</li><li><code>database::String=&quot;neo4j&quot;</code>: Target Neo4j database name</li></ul><p><strong>Returns</strong></p><ul><li><code>Cmd</code>: A command object ready for execution</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL7105">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.deduplicate_fasta_file-Tuple{Any, Any}" href="#Mycelia.deduplicate_fasta_file-Tuple{Any, Any}"><code>Mycelia.deduplicate_fasta_file</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">deduplicate_fasta_file(in_fasta, out_fasta) -&gt; Any
</code></pre><p>Remove duplicate sequences from a FASTA file while preserving headers.</p><p><strong>Arguments</strong></p><ul><li><code>in_fasta</code>: Path to input FASTA file</li><li><code>out_fasta</code>: Path where deduplicated FASTA will be written</li></ul><p><strong>Returns</strong></p><p>Path to the output FASTA file (same as <code>out_fasta</code> parameter)</p><p><strong>Details</strong></p><ul><li>Sequences are considered identical if they match exactly (case-sensitive)</li><li>For duplicate sequences, keeps the first header encountered</li><li>Input sequences are sorted by identifier before deduplication</li><li>Preserves the original sequence formatting</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL14301">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.detect_alphabet-Tuple{AbstractString}" href="#Mycelia.detect_alphabet-Tuple{AbstractString}"><code>Mycelia.detect_alphabet</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">detect_alphabet(seq::AbstractString) -&gt; Symbol
</code></pre><p>Determines the alphabet of a sequence. The function scans through <code>seq</code> only once:</p><ul><li>If a &#39;T&#39; or &#39;t&#39; is found (and no &#39;U/u&#39;), the sequence is classified as DNA.</li><li>If a &#39;U&#39; or &#39;u&#39; is found (and no &#39;T/t&#39;), it is classified as RNA.</li><li>If both T and U occur, an error is thrown.</li><li>If a character outside the canonical nucleotide and ambiguity codes is encountered, the sequence is assumed to be protein.</li><li>If neither T nor U are found, the sequence is assumed to be DNA.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL13526">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.detect_sequence_extension-Tuple{Union{FASTX.FASTA.Record, FASTX.FASTQ.Record}}" href="#Mycelia.detect_sequence_extension-Tuple{Union{FASTX.FASTA.Record, FASTX.FASTQ.Record}}"><code>Mycelia.detect_sequence_extension</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">detect_sequence_extension(
    record::Union{FASTX.FASTA.Record, FASTX.FASTQ.Record}
) -&gt; String
</code></pre><p>Detect sequence type from input and suggest appropriate file extension.</p><p><strong>Arguments</strong></p><ul><li><code>record</code>: A FASTA/FASTQ record</li><li><code>sequence</code>: A string or BioSequence containing sequence data</li></ul><p><strong>Returns</strong></p><ul><li><code>String</code>: Suggested file extension:<ul><li>&quot;.fna&quot; for DNA</li><li>&quot;.frn&quot; for RNA</li><li>&quot;.faa&quot; for protein</li><li>&quot;.fa&quot; for unrecognized sequences</li></ul></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL16275">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.determine_fasta_coverage-Tuple{Any}" href="#Mycelia.determine_fasta_coverage-Tuple{Any}"><code>Mycelia.determine_fasta_coverage</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">determine_fasta_coverage(bam) -&gt; Any
</code></pre><p>Calculate per-base genomic coverage from a BAM file using bedtools.</p><p><strong>Arguments</strong></p><ul><li><code>bam::String</code>: Path to input BAM file</li></ul><p><strong>Returns</strong></p><ul><li><code>String</code>: Path to the generated coverage file (<code>.coverage.txt</code>)</li></ul><p><strong>Details</strong></p><p>Uses bedtools genomecov to compute per-base coverage. Creates a coverage file  with the format: &lt;chromosome&gt; &lt;position&gt; &lt;coverage_depth&gt;.  If the coverage file already exists, returns the existing file path.</p><p><strong>Dependencies</strong></p><p>Requires bedtools (automatically installed in conda environment)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL667">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.determine_max_canonical_kmers-Tuple{Any, Any}" href="#Mycelia.determine_max_canonical_kmers-Tuple{Any, Any}"><code>Mycelia.determine_max_canonical_kmers</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">determine_max_canonical_kmers(k, ALPHABET) -&gt; Any
</code></pre><p>Calculate the maximum number of possible canonical k-mers for a given alphabet.</p><p><strong>Arguments</strong></p><ul><li><code>k::Integer</code>: Length of k-mer</li><li><code>ALPHABET::Vector{Char}</code>: Character set (nucleotides or amino acids)</li></ul><p><strong>Returns</strong></p><ul><li><code>Int</code>: Maximum number of possible canonical k-mers</li></ul><p><strong>Details</strong></p><ul><li>For amino acids (AA_ALPHABET): returns total possible k-mers</li><li>For nucleotides: returns half of total possible k-mers (canonical form)</li><li>Requires odd k-mer length for nucleotide alphabets</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL14153">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.determine_max_possible_kmers-Tuple{Any, Any}" href="#Mycelia.determine_max_possible_kmers-Tuple{Any, Any}"><code>Mycelia.determine_max_possible_kmers</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">determine_max_possible_kmers(k, ALPHABET) -&gt; Any
</code></pre><p>Calculate the total number of possible unique k-mers that can be generated from a given alphabet.</p><p><strong>Arguments</strong></p><ul><li><code>k</code>: Length of k-mers to consider</li><li><code>ALPHABET</code>: Vector containing the allowed characters/symbols</li></ul><p><strong>Returns</strong></p><ul><li>Integer representing the maximum number of possible unique k-mers (|Σ|ᵏ)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL14180">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.determine_primary_contig-Tuple{Any}" href="#Mycelia.determine_primary_contig-Tuple{Any}"><code>Mycelia.determine_primary_contig</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">determine_primary_contig(qualimap_results) -&gt; Any
</code></pre><p>Determines the contig with the greatest number of total bases mapping to it</p><p>Identify the primary contig based on mapping coverage from Qualimap results.</p><p><strong>Arguments</strong></p><ul><li><code>qualimap_results::DataFrame</code>: DataFrame containing Qualimap alignment statistics with  columns &quot;Contig&quot; and &quot;Mapped bases&quot;</li></ul><p><strong>Returns</strong></p><ul><li><code>String</code>: Name of the contig with the highest number of mapped bases</li></ul><p><strong>Description</strong></p><p>Takes Qualimap alignment results and determines which contig has the most total bases  mapped to it, which often indicates the main chromosomal assembly.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL7783">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.determine_read_lengths-Tuple{Any}" href="#Mycelia.determine_read_lengths-Tuple{Any}"><code>Mycelia.determine_read_lengths</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">determine_read_lengths(
    fastq_file;
    total_reads
) -&gt; Vector{Int64}
</code></pre><p>Calculate sequence lengths for reads in a FASTQ file.</p><p><strong>Arguments</strong></p><ul><li><code>fastq_file::String</code>: Path to input FASTQ file</li><li><code>total_reads::Integer=Inf</code>: Number of reads to process (defaults to all reads)</li></ul><p><strong>Returns</strong></p><ul><li><code>Vector{Int}</code>: Array containing the length of each sequence read</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL14126">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.distance_matrix_to_newick-Tuple{}" href="#Mycelia.distance_matrix_to_newick-Tuple{}"><code>Mycelia.distance_matrix_to_newick</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">distance_matrix_to_newick(
;
    distance_matrix,
    labels,
    outfile
)
</code></pre><p>Create distance matrix from a column-major counts matrix (features as rows and entities as columns) where distance is a proportional to total feature count magnitude (size) and cosine similarity (relative frequency)</p><p>Convert a distance matrix into a Newick tree format using UPGMA hierarchical clustering.</p><p><strong>Arguments</strong></p><ul><li><code>distance_matrix</code>: Square matrix of pairwise distances between entities</li><li><code>labels</code>: Vector of labels corresponding to the entities in the distance matrix</li><li><code>outfile</code>: Path where the Newick tree file will be written</li></ul><p><strong>Returns</strong></p><ul><li>Path to the generated Newick tree file</li></ul><p><strong>Details</strong></p><p>Performs hierarchical clustering using the UPGMA (average linkage) method and  converts the resulting dendrogram into Newick tree format. The branch lengths  in the tree represent the heights from the clustering.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL13037">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.document_frequency-Tuple{Any}" href="#Mycelia.document_frequency-Tuple{Any}"><code>Mycelia.document_frequency</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">document_frequency(documents) -&gt; Dict{_A, Int64} where _A
</code></pre><p>Calculate the document frequency of tokens across a collection of documents.</p><p><strong>Arguments</strong></p><ul><li><code>documents</code>: Collection of text documents where each document is a string</li></ul><p><strong>Returns</strong></p><ul><li>Dictionary mapping each unique token to the number of documents it appears in</li></ul><p><strong>Description</strong></p><p>Computes how many documents contain each unique token. Each document is tokenized  by splitting on whitespace. Tokens are counted only once per document, regardless  of how many times they appear within that document.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL5910">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.download_bandage" href="#Mycelia.download_bandage"><code>Mycelia.download_bandage</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">download_bandage() -&gt; String
download_bandage(outdir) -&gt; Any
</code></pre><p>Downloads and installs Bandage, a bioinformatics visualization tool for genome assembly graphs.</p><p><strong>Arguments</strong></p><ul><li><code>outdir=&quot;/usr/local/bin&quot;</code>: Target installation directory for the Bandage executable</li></ul><p><strong>Returns</strong></p><ul><li>Path to the installed Bandage executable</li></ul><p><strong>Details</strong></p><ul><li>Downloads Bandage v0.8.1 for Ubuntu</li><li>Installs required system dependencies (libxcb-glx0, libx11-xcb-dev, libfontconfig, libgl1-mesa-glx)</li><li>Attempts installation with sudo, falls back to root if sudo fails</li><li>Skips download if Bandage is already installed at target location</li></ul><p><strong>Dependencies</strong></p><p>Requires system commands: wget, unzip, apt</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL698">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.download_blast_db-Tuple{}" href="#Mycelia.download_blast_db-Tuple{}"><code>Mycelia.download_blast_db</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">download_blast_db(; db, dbdir, source, wait)
</code></pre><p>Smart downloading of blast dbs depending on interactive, non interactive context</p><p>For a list of all available databases, run: <code>Mycelia.list_blastdbs()</code></p><p>Downloads and sets up BLAST databases from various sources.</p><p><strong>Arguments</strong></p><ul><li><code>db</code>: Name of the BLAST database to download</li><li><code>dbdir</code>: Directory to store the downloaded database (default: &quot;~/workspace/blastdb&quot;)</li><li><code>source</code>: Download source - one of [&quot;&quot;, &quot;aws&quot;, &quot;gcp&quot;, &quot;ncbi&quot;]. Empty string auto-detects fastest source</li><li><code>wait</code>: Whether to wait for download completion (default: true)</li></ul><p><strong>Returns</strong></p><ul><li>String path to the downloaded database directory</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL6520">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.download_genome_by_accession-Tuple{}" href="#Mycelia.download_genome_by_accession-Tuple{}"><code>Mycelia.download_genome_by_accession</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">download_genome_by_accession(
;
    accession,
    outdir,
    compressed
)
</code></pre><p>Downloads a genomic sequence from NCBI&#39;s nucleotide database by its accession number.</p><p><strong>Arguments</strong></p><ul><li><code>accession::String</code>: NCBI nucleotide accession number (e.g. &quot;NC_045512&quot;)</li><li><code>outdir::String</code>: Output directory path. Defaults to current directory</li><li><code>compressed::Bool</code>: If true, compresses output file with gzip. Defaults to true</li></ul><p><strong>Returns</strong></p><ul><li><code>String</code>: Path to the downloaded file (.fna or .fna.gz)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/ncbi.jl#LL144">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.download_genome_by_ftp-Tuple{}" href="#Mycelia.download_genome_by_ftp-Tuple{}"><code>Mycelia.download_genome_by_ftp</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">download_genome_by_ftp(; ftp, outdir)
</code></pre><p>Downloads a genome file from NCBI FTP server to the specified directory.</p><p><strong>Arguments</strong></p><ul><li><code>ftp::String</code>: NCBI FTP path for the genome (e.g. &quot;ftp://ftp.ncbi.nlm.nih.gov/.../&quot;)</li><li><code>outdir::String</code>: Output directory path. Defaults to current working directory.</li></ul><p><strong>Returns</strong></p><ul><li><code>String</code>: Path to the downloaded file</li></ul><p><strong>Notes</strong></p><ul><li>If the target file already exists, returns the existing file path without re-downloading</li><li>Downloads the genomic.fna.gz version of the genome</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/ncbi.jl#LL186">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.download_mmseqs_db-Tuple{}" href="#Mycelia.download_mmseqs_db-Tuple{}"><code>Mycelia.download_mmseqs_db</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">download_mmseqs_db(; db, dbdir, force, wait)
</code></pre><p>Downloads and sets up MMseqs2 reference databases for sequence searching and analysis.</p><p><strong>Arguments</strong></p><ul><li><code>db::String</code>: Name of database to download (see table below)</li><li><code>dbdir::String</code>: Directory to store the downloaded database (default: &quot;~/workspace/mmseqs&quot;)</li><li><code>force::Bool</code>: If true, force re-download even if database exists (default: false)</li><li><code>wait::Bool</code>: If true, wait for download to complete (default: true)</li></ul><p><strong>Returns</strong></p><ul><li>Path to the downloaded database as a String</li></ul><p><strong>Available Databases</strong></p><table><tr><th style="text-align: right">Database</th><th style="text-align: right">Type</th><th style="text-align: right">Taxonomy</th><th style="text-align: right">Description</th></tr><tr><td style="text-align: right">UniRef100</td><td style="text-align: right">Aminoacid</td><td style="text-align: right">Yes</td><td style="text-align: right">UniProt Reference Clusters - 100% identity</td></tr><tr><td style="text-align: right">UniRef90</td><td style="text-align: right">Aminoacid</td><td style="text-align: right">Yes</td><td style="text-align: right">UniProt Reference Clusters - 90% identity</td></tr><tr><td style="text-align: right">UniRef50</td><td style="text-align: right">Aminoacid</td><td style="text-align: right">Yes</td><td style="text-align: right">UniProt Reference Clusters - 50% identity</td></tr><tr><td style="text-align: right">UniProtKB</td><td style="text-align: right">Aminoacid</td><td style="text-align: right">Yes</td><td style="text-align: right">Universal Protein Knowledge Base</td></tr><tr><td style="text-align: right">NR</td><td style="text-align: right">Aminoacid</td><td style="text-align: right">Yes</td><td style="text-align: right">NCBI Non-redundant proteins</td></tr><tr><td style="text-align: right">NT</td><td style="text-align: right">Nucleotide</td><td style="text-align: right">No</td><td style="text-align: right">NCBI Nucleotide collection</td></tr><tr><td style="text-align: right">GTDB</td><td style="text-align: right">Aminoacid</td><td style="text-align: right">Yes</td><td style="text-align: right">Genome Taxonomy Database</td></tr><tr><td style="text-align: right">PDB</td><td style="text-align: right">Aminoacid</td><td style="text-align: right">No</td><td style="text-align: right">Protein Data Bank structures</td></tr><tr><td style="text-align: right">Pfam-A.full</td><td style="text-align: right">Profile</td><td style="text-align: right">No</td><td style="text-align: right">Protein family alignments</td></tr><tr><td style="text-align: right">SILVA</td><td style="text-align: right">Nucleotide</td><td style="text-align: right">Yes</td><td style="text-align: right">Ribosomal RNA database</td></tr></table><pre><code class="nohighlight hljs">  Name                  Type            Taxonomy        Url                                                           
- UniRef100             Aminoacid            yes        https://www.uniprot.org/help/uniref
- UniRef90              Aminoacid            yes        https://www.uniprot.org/help/uniref
- UniRef50              Aminoacid            yes        https://www.uniprot.org/help/uniref
- UniProtKB             Aminoacid            yes        https://www.uniprot.org/help/uniprotkb
- UniProtKB/TrEMBL      Aminoacid            yes        https://www.uniprot.org/help/uniprotkb
- UniProtKB/Swiss-Prot  Aminoacid            yes        https://uniprot.org
- NR                    Aminoacid            yes        https://ftp.ncbi.nlm.nih.gov/blast/db/FASTA
- NT                    Nucleotide             -        https://ftp.ncbi.nlm.nih.gov/blast/db/FASTA
- GTDB                  Aminoacid            yes        https://gtdb.ecogenomic.org
- PDB                   Aminoacid              -        https://www.rcsb.org
- PDB70                 Profile                -        https://github.com/soedinglab/hh-suite
- Pfam-A.full           Profile                -        https://pfam.xfam.org
- Pfam-A.seed           Profile                -        https://pfam.xfam.org
- Pfam-B                Profile                -        https://xfam.wordpress.com/2020/06/30/a-new-pfam-b-is-released
- CDD                   Profile                -        https://www.ncbi.nlm.nih.gov/Structure/cdd/cdd.shtml
- eggNOG                Profile                -        http://eggnog5.embl.de
- VOGDB                 Profile                -        https://vogdb.org
- dbCAN2                Profile                -        http://bcb.unl.edu/dbCAN2
- SILVA                 Nucleotide           yes        https://www.arb-silva.de
- Resfinder             Nucleotide             -        https://cge.cbs.dtu.dk/services/ResFinder
- Kalamari              Nucleotide           yes        https://github.com/lskatz/Kalamari</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL6209">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.draw_dendrogram_tree-Tuple{MetaGraphs.MetaDiGraph}" href="#Mycelia.draw_dendrogram_tree-Tuple{MetaGraphs.MetaDiGraph}"><code>Mycelia.draw_dendrogram_tree</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">draw_dendrogram_tree(
    mg::MetaGraphs.MetaDiGraph;
    width,
    height,
    fontsize,
    margins,
    mergenodesize,
    lineweight,
    filename
) -&gt; Luxor.Drawing
</code></pre><p>Draw a dendrogram visualization of hierarchical clustering results stored in a MetaDiGraph.</p><p><strong>Arguments</strong></p><ul><li><code>mg::MetaGraphs.MetaDiGraph</code>: Graph containing hierarchical clustering results. Must have <code>:hcl</code> in graph properties with clustering data and vertex properties containing <code>:x</code>, <code>:y</code> coordinates.</li></ul><p><strong>Keywords</strong></p><ul><li><code>width::Integer=500</code>: Width of output image in pixels</li><li><code>height::Integer=500</code>: Height of output image in pixels </li><li><code>fontsize::Integer=12</code>: Font size for node labels in points</li><li><code>margins::Float64</code>: Margin size in pixels, defaults to min(width,height)/20</li><li><code>mergenodesize::Float64=1</code>: Size of circular nodes at merge points</li><li><code>lineweight::Float64=1</code>: Thickness of dendrogram lines</li><li><code>filename::String</code>: Output filename, defaults to timestamp with .dendrogram.png extension</li></ul><p><strong>Returns</strong></p><p>Nothing, but saves dendrogram image to disk and displays preview.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL4174">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.draw_radial_tree-Tuple{MetaGraphs.MetaDiGraph}" href="#Mycelia.draw_radial_tree-Tuple{MetaGraphs.MetaDiGraph}"><code>Mycelia.draw_radial_tree</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">draw_radial_tree(
    mg::MetaGraphs.MetaDiGraph;
    width,
    height,
    fontsize,
    margins,
    mergenodesize,
    lineweight,
    filename
) -&gt; Luxor.Drawing
</code></pre><p>Draw a radial hierarchical clustering tree visualization and save it as an image file.</p><p><strong>Arguments</strong></p><ul><li><code>mg::MetaGraphs.MetaDiGraph</code>: A meta directed graph containing hierarchical clustering data with required graph properties <code>:hcl</code> containing clustering information.</li></ul><p><strong>Keywords</strong></p><ul><li><code>width::Int=500</code>: Width of the output image in pixels</li><li><code>height::Int=500</code>: Height of the output image in pixels</li><li><code>fontsize::Int=12</code>: Font size for node labels</li><li><code>margins::Float64</code>: Margin size (automatically calculated as min(width,height)/20)</li><li><code>mergenodesize::Float64=1</code>: Size of the merge point nodes</li><li><code>lineweight::Float64=1</code>: Thickness of the connecting lines</li><li><code>filename::String</code>: Output filename (defaults to timestamp with &quot;.radial.png&quot; suffix)</li></ul><p><strong>Details</strong></p><p>The function creates a radial visualization of hierarchical clustering results where:</p><ul><li>Leaf nodes are arranged in a circle with labels</li><li>Internal nodes represent merge points</li><li>Connections show the hierarchical structure through arcs and lines</li></ul><p>The visualization is saved as a PNG file and automatically previewed.</p><p><strong>Required Graph Properties</strong></p><p>The input graph must have:</p><ul><li><code>mg.gprops[:hcl].labels</code>: Vector of leaf node labels</li><li><code>mg.gprops[:hcl].order</code>: Vector of ordered leaf nodes</li><li><code>mg.gprops[:hcl].merges</code>: Matrix of merge operations</li><li><code>mg.vprops[v][:x]</code>: X coordinate for each vertex</li><li><code>mg.vprops[v][:y]</code>: Y coordinate for each vertex</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL4259">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.drop_empty_columns!-Tuple{DataFrames.AbstractDataFrame}" href="#Mycelia.drop_empty_columns!-Tuple{DataFrames.AbstractDataFrame}"><code>Mycelia.drop_empty_columns!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">drop_empty_columns!(
    df::DataFrames.AbstractDataFrame
) -&gt; DataFrames.AbstractDataFrame
</code></pre><p>Identify all columns that have only missing or empty values, and remove those columns from the dataframe <em>in-place</em>.</p><p>Returns a modified version of the original dataframe. </p><p>See also: drop<em>empty</em>columns</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL1685">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.drop_empty_columns-Tuple{DataFrames.AbstractDataFrame}" href="#Mycelia.drop_empty_columns-Tuple{DataFrames.AbstractDataFrame}"><code>Mycelia.drop_empty_columns</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">drop_empty_columns(df::DataFrames.AbstractDataFrame) -&gt; Any
</code></pre><p>Identify all columns that have only missing or empty values, and remove those columns from the dataframe.</p><p>Returns a modified copy of the dataframe.</p><p>See also: drop<em>empty</em>columns!</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL1669">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.edge_path_to_sequence-Tuple{Any, Any}" href="#Mycelia.edge_path_to_sequence-Tuple{Any, Any}"><code>Mycelia.edge_path_to_sequence</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">edge_path_to_sequence(kmer_graph, edge_path) -&gt; Any
</code></pre><p>Converts a path of edges in a kmer graph into a DNA sequence by concatenating overlapping kmers.</p><p><strong>Arguments</strong></p><ul><li><code>kmer_graph</code>: A directed graph where vertices represent kmers and edges represent overlaps</li><li><code>edge_path</code>: Vector of edges representing a path through the graph</li></ul><p><strong>Returns</strong></p><p>A <code>BioSequences.LongDNASeq</code> containing the merged sequence represented by the path</p><p><strong>Details</strong></p><p>The function:</p><ol><li>Takes the first kmer from the source vertex of first edge</li><li>For each edge, handles orientation (forward/reverse complement)</li><li>Verifies overlaps between consecutive kmers</li><li>Concatenates unique bases to build final sequence</li></ol></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL14032">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.edge_probability-Tuple{Any, Any}" href="#Mycelia.edge_probability-Tuple{Any, Any}"><code>Mycelia.edge_probability</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">edge_probability(stranded_kmer_graph, edge) -&gt; Any
</code></pre><p>Calculate the probability of traversing a specific edge in a stranded k-mer graph.</p><p>The probability is computed as the ratio of this edge&#39;s coverage weight to the sum of all outgoing edge weights from the source vertex.</p><pre><code class="language-julia hljs">edge_probability(stranded_kmer_graph, edge) -&gt; Any
</code></pre><p><strong>Arguments</strong></p><ul><li><code>stranded_kmer_graph</code>: A directed graph where edges represent k-mer connections</li><li><code>edge</code>: The edge for which to calculate the probability</li></ul><p><strong>Returns</strong></p><ul><li><code>Float64</code>: Probability in range [0,1] representing likelihood of traversing this edge Returns 0.0 if sum of all outgoing edge weights is zero</li></ul><p><strong>Note</strong></p><p>Probability is based on the :coverage property of edges, using their length as weights</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL15867">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.edgemer_to_vertex_kmers-Tuple{Any}" href="#Mycelia.edgemer_to_vertex_kmers-Tuple{Any}"><code>Mycelia.edgemer_to_vertex_kmers</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">edgemer_to_vertex_kmers(
    edgemer
) -&gt; Tuple{Kmers.Kmer{BioSequences.DNAAlphabet{2}}, Kmers.Kmer{BioSequences.DNAAlphabet{2}}}
</code></pre><p>Convert an edgemer to two vertex kmers.</p><p>This function takes an edgemer (a sequence of DNA nucleotides) and converts it into two vertex kmers.  A kmer is a substring of length k from a DNA sequence. The first kmer is created from the first  n-1 elements of the edgemer, and the second kmer is created from the last n-1 elements of the edgemer.</p><p><strong>Arguments</strong></p><ul><li><code>edgemer::AbstractVector{T}</code>: A vector of DNA nucleotides where T is a subtype of <code>BioSequences.DNAAlphabet{2}</code>.</li></ul><p><strong>Returns</strong></p><ul><li><code>Tuple{Kmers.Kmer{BioSequences.DNAAlphabet{2}}, Kmers.Kmer{BioSequences.DNAAlphabet{2}}}</code>: A tuple containing two kmers.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL8561">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.equally_spaced_samples-Tuple{Any, Any}" href="#Mycelia.equally_spaced_samples-Tuple{Any, Any}"><code>Mycelia.equally_spaced_samples</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">equally_spaced_samples(vector, n) -&gt; Any
</code></pre><p>Sample <code>n</code> equally spaced elements from <code>vector</code>.</p><p><strong>Arguments</strong></p><ul><li><code>vector</code>: Input vector to sample from</li><li><code>n</code>: Number of samples to return (must be positive)</li></ul><p><strong>Returns</strong></p><p>A vector containing <code>n</code> equally spaced elements from the input vector.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL4553">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.equivalent_fasta_sequences-Tuple{Any, Any}" href="#Mycelia.equivalent_fasta_sequences-Tuple{Any, Any}"><code>Mycelia.equivalent_fasta_sequences</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">equivalent_fasta_sequences(fasta_1, fasta_2) -&gt; Bool
</code></pre><p>Compare two FASTA files to determine if they contain the same set of sequences, regardless of sequence order.</p><p><strong>Arguments</strong></p><ul><li><code>fasta_1::String</code>: Path to first FASTA file</li><li><code>fasta_2::String</code>: Path to second FASTA file</li></ul><p><strong>Returns</strong></p><ul><li><code>Bool</code>: <code>true</code> if both files contain exactly the same sequences, <code>false</code> otherwise</li></ul><p><strong>Details</strong></p><p>Performs a set-based comparison of DNA sequences by hashing each sequence. Sequence order differences between files do not affect the result.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL15256">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.error_rate_to_q_value-Tuple{Any}" href="#Mycelia.error_rate_to_q_value-Tuple{Any}"><code>Mycelia.error_rate_to_q_value</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">error_rate_to_q_value(error_rate) -&gt; Any
</code></pre><p>Convert a sequencing error probability to a Phred quality score (Q-value).</p><p>The calculation uses the standard Phred formula: Q = -10 * log₁₀(error_rate)</p><p><strong>Arguments</strong></p><ul><li><code>error_rate::Float64</code>: Probability of error (between 0 and 1)</li></ul><p><strong>Returns</strong></p><ul><li><code>q_value::Float64</code>: Phred quality score</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL13998">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.export_blast_db-Tuple{}" href="#Mycelia.export_blast_db-Tuple{}"><code>Mycelia.export_blast_db</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">export_blast_db(; path_to_db, fasta)
</code></pre><p>Export sequences from a BLAST database to a gzipped FASTA file.</p><p><strong>Arguments</strong></p><ul><li><code>path_to_db</code>: Path to the BLAST database</li><li><code>fasta</code>: Output path for the gzipped FASTA file (default: <code>path_to_db * &quot;.fna.gz&quot;</code>)</li></ul><p><strong>Details</strong></p><p>Uses conda&#39;s BLAST environment to extract sequences using <code>blastdbcmd</code>. The output is automatically compressed using <code>pigz</code>. If the output file already exists, the function will skip extraction.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL955">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.export_blast_db_taxonomy_table-Tuple{}" href="#Mycelia.export_blast_db_taxonomy_table-Tuple{}"><code>Mycelia.export_blast_db_taxonomy_table</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">export_blast_db_taxonomy_table(; path_to_db, outfile)
</code></pre><p>Exports a taxonomy mapping table from a BLAST database in seqid2taxid format.</p><p><strong>Arguments</strong></p><ul><li><code>path_to_db::String</code>: Path to the BLAST database</li><li><code>outfile::String</code>: Output file path (defaults to input path + &quot;.seqid2taxid.txt.gz&quot;)</li></ul><p><strong>Returns</strong></p><ul><li><code>String</code>: Path to the created output file</li></ul><p><strong>Details</strong></p><p>Creates a compressed tab-delimited file mapping sequence IDs to taxonomy IDs. Uses blastdbcmd without GI identifiers for better cross-referencing compatibility. If the output file already exists, returns the path without regenerating.</p><p><strong>Dependencies</strong></p><p>Requires BLAST+ tools installed via Bioconda.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL2334">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.extract_pacbiosample_information-Tuple{Any}" href="#Mycelia.extract_pacbiosample_information-Tuple{Any}"><code>Mycelia.extract_pacbiosample_information</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">extract_pacbiosample_information(
    xml
) -&gt; DataFrames.DataFrame
</code></pre><p>Extract biosample and barcode information from a PacBio XML metadata file.</p><p><strong>Arguments</strong></p><ul><li><code>xml</code>: Path to PacBio XML metadata file</li></ul><p><strong>Returns</strong></p><p>DataFrame with two columns:</p><ul><li><code>BioSampleName</code>: Name of the biological sample</li><li><code>BarcodeName</code>: Associated DNA barcode identifier</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL3179">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.fasta2normalized_table-Tuple{Any}" href="#Mycelia.fasta2normalized_table-Tuple{Any}"><code>Mycelia.fasta2normalized_table</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">fasta2normalized_table(
    fasta_file;
    normalize_name,
    outfile,
    force
) -&gt; Any
</code></pre><p>Convert a FASTA file into a normalized tab-separated table format with standardized sequence identifiers.</p><p><strong>Arguments</strong></p><ul><li><code>fasta_file::String</code>: Path to input FASTA file</li><li><code>outfile::String</code>: Path to output compressed TSV file (defaults to input filename + &quot;.tsv.gz&quot;)</li><li><code>force::Bool=false</code>: If true, overwrites existing output file</li></ul><p><strong>Returns</strong></p><ul><li><code>String</code>: Path to the created output file</li></ul><p><strong>Output Format</strong></p><p>Creates a gzipped TSV file with the following columns:</p><ul><li>fasta_identifier: Original FASTA filename</li><li>sequence_sha256: SHA256 hash of the sequence</li><li>sequence_identifier: Original sequence ID from FASTA</li><li>sequence_description: Full sequence description from FASTA</li><li>sequence: The actual sequence</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL3906">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.fasta_and_gff_to_genbank-Tuple{}" href="#Mycelia.fasta_and_gff_to_genbank-Tuple{}"><code>Mycelia.fasta_and_gff_to_genbank</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">fasta_and_gff_to_genbank(; fasta, gff, genbank)
</code></pre><p>Convert FASTA sequence and GFF annotation files to GenBank format using EMBOSS seqret.</p><p><strong>Arguments</strong></p><ul><li><code>fasta::String</code>: Path to input FASTA file containing sequence data</li><li><code>gff::String</code>: Path to input GFF file containing genomic features</li><li><code>genbank::String</code>: Path for output GenBank file</li></ul><p><strong>Details</strong></p><p>Requires EMBOSS toolkit (installed via Bioconda). The function will:</p><ol><li>Create necessary output directories</li><li>Run seqret to combine sequence and features</li><li>Generate a GenBank format file at the specified location</li></ol></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL11047">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.fasta_genome_size-Tuple{Any}" href="#Mycelia.fasta_genome_size-Tuple{Any}"><code>Mycelia.fasta_genome_size</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">fasta_genome_size(fasta_file) -&gt; Any
</code></pre><p>Calculate the total size (in bases) of all sequences in a FASTA file.</p><p><strong>Arguments</strong></p><ul><li><code>fasta_file::AbstractString</code>: Path to the FASTA file</li></ul><p><strong>Returns</strong></p><ul><li><code>Int</code>: Sum of lengths of all sequences in the FASTA file</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL617">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.fasta_list_to_dense_counts_table-Tuple{}" href="#Mycelia.fasta_list_to_dense_counts_table-Tuple{}"><code>Mycelia.fasta_list_to_dense_counts_table</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">fasta_list_to_dense_counts_table(; fasta_list, k, alphabet)
</code></pre><p>Create a dense kmer counts table (canonical for DNA, stranded for RNA &amp; AA) for each fasta provided in a list. Scales very well for large numbers of organisms/fasta files, but not for k. Recommended for k &lt;= 13, although 17 may still be possible</p><p>Generate a dense k-mer frequency matrix from multiple FASTA files.</p><p><strong>Arguments</strong></p><ul><li><code>fasta_list</code>: Vector of paths to FASTA files</li><li><code>k</code>: Length of k-mers to count (recommended k ≤ 13)</li><li><code>alphabet</code>: Symbol specifying sequence type (<code>:DNA</code>, <code>:RNA</code>, or <code>:AA</code>)</li></ul><p><strong>Returns</strong></p><p>Named tuple containing:</p><ul><li><code>sorted_kmers</code>: Vector of sorted k-mers</li><li><code>kmer_counts_matrix</code>: Dense matrix where rows are k-mers and columns are sequences</li></ul><p><strong>Details</strong></p><ul><li>For DNA: Uses canonical k-mers (strand-neutral)</li><li>For RNA/AA: Uses stranded k-mers</li><li>Parallelized using Julia&#39;s multi-threading</li></ul><p><strong>Performance</strong></p><ul><li>Efficient for large numbers of sequences</li><li>Memory usage grows exponentially with k</li><li>For k &gt; 13, use <code>fasta_list_to_sparse_counts_table</code> instead</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL12758">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.fasta_table_to_fasta-Tuple{Any}" href="#Mycelia.fasta_table_to_fasta-Tuple{Any}"><code>Mycelia.fasta_table_to_fasta</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">fasta_table_to_fasta(fasta_df) -&gt; Any
</code></pre><p>Convert a DataFrame containing FASTA sequence information into a vector of FASTA records.</p><p><strong>Arguments</strong></p><ul><li><code>fasta_df::DataFrame</code>: DataFrame with columns &quot;identifier&quot;, &quot;description&quot;, and &quot;sequence&quot;</li></ul><p><strong>Returns</strong></p><ul><li><code>Vector{FASTX.FASTA.Record}</code>: Vector of FASTA records</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL14281">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.fasta_to_reference_kmer_counts-Tuple{}" href="#Mycelia.fasta_to_reference_kmer_counts-Tuple{}"><code>Mycelia.fasta_to_reference_kmer_counts</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">fasta_to_reference_kmer_counts(; kmer_type, fasta)
</code></pre><p>Counts k-mer occurrences in a FASTA file, considering both forward and reverse complement sequences.</p><p><strong>Arguments</strong></p><ul><li><code>kmer_type</code>: Type specification for k-mers (e.g., <code>DNAKmer{21}</code>)</li><li><code>fasta</code>: Path to FASTA file containing reference sequences</li></ul><p><strong>Returns</strong></p><ul><li><code>Dict{kmer_type, Int}</code>: Dictionary mapping each k-mer to its total count across all sequences</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL1328">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.fasta_to_table-Tuple{Any}" href="#Mycelia.fasta_to_table-Tuple{Any}"><code>Mycelia.fasta_to_table</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">fasta_to_table(fasta) -&gt; DataFrames.DataFrame
</code></pre><p>Convert a FASTA file/record iterator to a DataFrame.</p><p><strong>Arguments</strong></p><ul><li><code>fasta</code>: FASTA record iterator from FASTX.jl</li></ul><p><strong>Returns</strong></p><ul><li><code>DataFrame</code> with columns:<ul><li><code>identifier</code>: Sequence identifiers</li><li><code>description</code>: Full sequence descriptions </li><li><code>sequence</code>: Biological sequences as strings</li></ul></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL14257">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.fasta_xam_mapping_stats-Tuple{}" href="#Mycelia.fasta_xam_mapping_stats-Tuple{}"><code>Mycelia.fasta_xam_mapping_stats</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">fasta_xam_mapping_stats(; fasta, xam)
</code></pre><p>Calculate mapping statistics by comparing sequence alignments (BAM/SAM) to a reference FASTA.</p><p><strong>Arguments</strong></p><ul><li><code>fasta::String</code>: Path to reference FASTA file</li><li><code>xam::String</code>: Path to alignment file (BAM or SAM format)</li></ul><p><strong>Returns</strong></p><p>DataFrame with columns:</p><ul><li><code>contig</code>: Reference sequence name</li><li><code>contig_length</code>: Length of reference sequence</li><li><code>total_aligned_bases</code>: Total number of bases aligned to reference</li><li><code>mean_depth</code>: Average depth of coverage (total<em>aligned</em>bases/contig_length)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL3329">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.fastani_list-Tuple{}" href="#Mycelia.fastani_list-Tuple{}"><code>Mycelia.fastani_list</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">fastani_list(
;
    query_list,
    reference_list,
    outfile,
    threads,
    force
) -&gt; Union{Nothing, Base.Process}
</code></pre><p>Run fastani with a query and reference list</p><p>Calculate Average Nucleotide Identity (ANI) between genome sequences using FastANI.</p><p><strong>Arguments</strong></p><ul><li><code>query_list::String</code>: Path to file containing list of query genome paths (one per line)</li><li><code>reference_list::String</code>: Path to file containing list of reference genome paths (one per line)</li><li><code>outfile::String</code>: Path to output file that will contain ANI results</li><li><code>threads::Int=Sys.CPU_THREADS</code>: Number of parallel threads to use</li><li><code>force::Bool=false</code>: If true, rerun analysis even if output file exists</li></ul><p><strong>Output</strong></p><p>Generates a tab-delimited file with columns:</p><ul><li>Query genome</li><li>Reference genome  </li><li>ANI value (%)</li><li>Count of bidirectional fragment mappings</li><li>Total query fragments</li></ul><p><strong>Notes</strong></p><ul><li>Requires FastANI to be available via Bioconda</li><li>Automatically sets up required conda environment</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL7713">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.fasterq_dump-Tuple{}" href="#Mycelia.fasterq_dump-Tuple{}"><code>Mycelia.fasterq_dump</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">fasterq_dump(
;
    outdir,
    srr_identifier
) -&gt; NamedTuple{(:forward_reads, :reverse_reads, :unpaired_reads), &lt;:Tuple{Union{Missing, String}, Union{Missing, String}, Union{Missing, String}}}
</code></pre><p>Download and compress sequencing reads from the SRA database using fasterq-dump.</p><p><strong>Arguments</strong></p><ul><li><code>outdir::String=&quot;&quot;</code>: Output directory for the FASTQ files. Defaults to current directory.</li><li><code>srr_identifier::String=&quot;&quot;</code>: SRA run accession number (e.g., &quot;SRR12345678&quot;)</li></ul><p><strong>Returns</strong></p><p>Named tuple containing paths to the generated files:</p><ul><li><code>forward_reads</code>: Path to forward reads file (*_1.fastq.gz) or <code>missing</code></li><li><code>reverse_reads</code>: Path to reverse reads file (*_2.fastq.gz) or <code>missing</code></li><li><code>unpaired_reads</code>: Path to unpaired reads file (*.fastq.gz) or <code>missing</code></li></ul><p><strong>Outputs</strong></p><p>Creates compressed FASTQ files in the output directory:</p><ul><li><code>{srr_identifier}_1.fastq.gz</code>: Forward reads (for paired-end data)</li><li><code>{srr_identifier}_2.fastq.gz</code>: Reverse reads (for paired-end data)</li><li><code>{srr_identifier}.fastq.gz</code>: Unpaired reads (for single-end data)</li></ul><p><strong>Dependencies</strong></p><p>Requires:</p><ul><li><code>fasterq-dump</code> from the SRA Toolkit (installed via Conda)</li><li><code>gzip</code> for compression</li></ul><p><strong>Notes</strong></p><ul><li>Skips download if output files already exist</li><li>Uses up to 4 threads or system maximum, whichever is lower</li><li>Allocates 1GB memory for processing</li><li>Skips technical reads</li><li>Handles both paired-end and single-end data automatically</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/ncbi.jl#LL32">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.fastq_record-Tuple{}" href="#Mycelia.fastq_record-Tuple{}"><code>Mycelia.fastq_record</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">fastq_record(; identifier, sequence, quality_scores)
</code></pre><p>Construct a FASTX FASTQ record from its components.</p><p><strong>Arguments</strong></p><ul><li><code>identifier::String</code>: The sequence identifier without the &#39;@&#39; prefix</li><li><code>sequence::String</code>: The nucleotide sequence</li><li><code>quality_scores::Vector{Int}</code>: Quality scores (0-93) as raw integers</li></ul><p><strong>Returns</strong></p><ul><li><code>FASTX.FASTQRecord</code>: A parsed FASTQ record</li></ul><p><strong>Notes</strong></p><ul><li>Quality scores are automatically capped at 93 to ensure FASTQ compatibility</li><li>Quality scores are converted to ASCII by adding 33 (Phred+33 encoding)</li><li>The record is constructed in standard FASTQ format with four lines:<ol><li>Header line (@ + identifier)</li><li>Sequence</li><li>Plus line</li><li>Quality scores (ASCII encoded)</li></ol></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL1888">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.fastx_stats-Tuple{Any}" href="#Mycelia.fastx_stats-Tuple{Any}"><code>Mycelia.fastx_stats</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">fastx_stats(fastq) -&gt; Base.Process
</code></pre><p>Calculate basic statistics for FASTQ/FASTA sequence files using seqkit.</p><p><strong>Arguments</strong></p><ul><li><code>fastq::String</code>: Path to input FASTQ/FASTA file</li></ul><p><strong>Details</strong></p><p>Automatically installs and uses seqkit from Bioconda to compute sequence statistics including number of sequences, total bases, GC content, average length, etc.</p><p><strong>Dependencies</strong></p><ul><li>Requires Conda and Bioconda channel</li><li>Installs seqkit package if not present</li></ul><p><strong>Returns</strong></p><p>Prints statistics to standard output in tabular format</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL980">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.fastx_to_contig_lengths-Tuple{Any}" href="#Mycelia.fastx_to_contig_lengths-Tuple{Any}"><code>Mycelia.fastx_to_contig_lengths</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">fastx_to_contig_lengths(
    fastx
) -&gt; OrderedCollections.OrderedDict
</code></pre><p>Generate detailed mapping statistics for each reference sequence/contig in a XAM (SAM/BAM/CRAM) file.</p><p><strong>Arguments</strong></p><ul><li><code>xam</code>: Path to XAM file or XAM object</li></ul><p><strong>Returns</strong></p><p>A DataFrame with per-contig statistics including:</p><ul><li><code>n_aligned_reads</code>: Number of aligned reads</li><li><code>total_aligned_bases</code>: Sum of alignment lengths</li><li><code>total_alignment_score</code>: Sum of alignment scores</li><li>Mapping quality statistics (mean, std, median)</li><li>Alignment length statistics (mean, std, median)</li><li>Alignment score statistics (mean, std, median)</li><li>Percent mismatches statistics (mean, std, median)</li></ul><p>Note: Only primary alignments (isprimary=true) and mapped reads (ismapped=true) are considered.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL3305">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.fastx_to_kmer_graph-Tuple{Any, AbstractString}" href="#Mycelia.fastx_to_kmer_graph-Tuple{Any, AbstractString}"><code>Mycelia.fastx_to_kmer_graph</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">fastx_to_kmer_graph(
    KMER_TYPE,
    fastx::AbstractString
) -&gt; MetaGraphs.MetaGraph
</code></pre><p>Constructs a k-mer graph from a single FASTX format string.</p><p><strong>Arguments</strong></p><ul><li><code>KMER_TYPE</code>: The k-mer type specification (e.g., DNAKmer{K} where K is k-mer length)</li><li><code>fastx::AbstractString</code>: Input sequence in FASTX format (FASTA or FASTQ)</li></ul><p><strong>Returns</strong></p><ul><li><code>KmerGraph</code>: A directed graph where vertices are k-mers and edges represent overlaps</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL8489">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.fastx_to_kmer_graph-Tuple{Any, AbstractVector{&lt;:AbstractString}}" href="#Mycelia.fastx_to_kmer_graph-Tuple{Any, AbstractVector{&lt;:AbstractString}}"><code>Mycelia.fastx_to_kmer_graph</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">fastx_to_kmer_graph(
    KMER_TYPE,
    fastxs::AbstractVector{&lt;:AbstractString}
) -&gt; MetaGraphs.MetaGraph
</code></pre><p>Create an in-memory kmer-graph that records:</p><ul><li>all kmers</li><li>counts</li><li>all <em>observed</em> edges between kmers</li><li>edge orientations</li><li>edge counts</li></ul><p>Construct a kmer-graph from one or more FASTX files (FASTA/FASTQ).</p><p><strong>Arguments</strong></p><ul><li><code>KMER_TYPE</code>: Type for kmer representation (e.g., <code>DNAKmer{K}</code>)</li><li><code>fastxs</code>: Vector of paths to FASTX files</li></ul><p><strong>Returns</strong></p><p>A <code>MetaGraph</code> where:</p><ul><li>Vertices represent unique kmers with properties:<ul><li><code>:kmer</code> =&gt; The kmer sequence</li><li><code>:count</code> =&gt; Number of occurrences</li></ul></li><li>Edges represent observed kmer adjacencies with properties:<ul><li><code>:orientation</code> =&gt; Relative orientation of connected kmers</li><li><code>:count</code> =&gt; Number of observed transitions</li></ul></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL8433">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.fibonacci_numbers_less_than-Tuple{Int64}" href="#Mycelia.fibonacci_numbers_less_than-Tuple{Int64}"><code>Mycelia.fibonacci_numbers_less_than</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">fibonacci_numbers_less_than(
    n::Int64
) -&gt; Union{Vector{Any}, Vector{Int64}}
</code></pre><p>Generate a sequence of Fibonacci numbers strictly less than the input value.</p><p><strong>Arguments</strong></p><ul><li><code>n::Int</code>: Upper bound (exclusive) for the Fibonacci sequence</li></ul><p><strong>Returns</strong></p><ul><li><code>Vector{Int}</code>: Array containing Fibonacci numbers less than n</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL1556">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.filesize_human_readable-Tuple{Any}" href="#Mycelia.filesize_human_readable-Tuple{Any}"><code>Mycelia.filesize_human_readable</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">filesize_human_readable(f) -&gt; Any
</code></pre><p>Gets the size of a file and returns it in a human-readable format.</p><p><strong>Arguments</strong></p><ul><li><code>f</code>: The path to the file, either as a <code>String</code> or an <code>AbstractString</code>.</li></ul><p><strong>Returns</strong></p><p>A string representing the file size in a human-readable format (e.g., &quot;3.40 MB&quot;).</p><p><strong>Details</strong></p><p>This function internally uses <code>filesize(f)</code> to get the file size in bytes, then leverages <code>Base.format_bytes</code> to convert it into a human-readable format with appropriate units (KB, MB, GB, etc.).</p><p><strong>Examples</strong></p><pre><code class="language-julia hljs">julia&gt; filesize_human_readable(&quot;my_image.jpg&quot;)
&quot;2.15 MB&quot;</code></pre><p>See Also</p><ul><li>filesize: Gets the size of a file in bytes.</li><li>Base.format_bytes: Converts a byte count into a human-readable string. </li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL3563">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.find_matching_prefix-Tuple{String, String}" href="#Mycelia.find_matching_prefix-Tuple{String, String}"><code>Mycelia.find_matching_prefix</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">find_matching_prefix(
    filename1::String,
    filename2::String;
    strip_trailing_delimiters
) -&gt; String
</code></pre><p>Find the longest common prefix between two filenames.</p><p><strong>Arguments</strong></p><ul><li><code>filename1::String</code>: First filename to compare</li><li><code>filename2::String</code>: Second filename to compare</li></ul><p><strong>Keywords</strong></p><ul><li><code>strip_trailing_delimiters::Bool=true</code>: If true, removes trailing dots, hyphens, and underscores from the result</li></ul><p><strong>Returns</strong></p><ul><li><code>String</code>: The longest common prefix found between the filenames</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL2973">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.find_nonempty_columns-Tuple{Any}" href="#Mycelia.find_nonempty_columns-Tuple{Any}"><code>Mycelia.find_nonempty_columns</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">find_nonempty_columns(df) -&gt; Any
</code></pre><p>Identify all columns that have only missing or empty values</p><p>Returns as a bit array</p><p>See also: drop<em>empty</em>columns, drop<em>empty</em>columns!</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL1655">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.find_resampling_stretches-Tuple{}" href="#Mycelia.find_resampling_stretches-Tuple{}"><code>Mycelia.find_resampling_stretches</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">find_resampling_stretches(
;
    record_kmer_solidity,
    solid_branching_kmer_indices
)
</code></pre><p>Identifies sequence regions that require resampling based on kmer solidity patterns.</p><p><strong>Arguments</strong></p><ul><li><code>record_kmer_solidity::BitVector</code>: Boolean array where <code>true</code> indicates solid kmers</li><li><code>solid_branching_kmer_indices::Vector{Int}</code>: Indices of solid branching kmers</li></ul><p><strong>Returns</strong></p><ul><li><code>Vector{UnitRange{Int64}}</code>: Array of ranges (start:stop) indicating stretches that need resampling</li></ul><p><strong>Details</strong></p><p>Finds continuous stretches of non-solid kmers and extends them to the nearest solid branching kmers on either side. These stretches represent regions that need resampling.</p><p>If a stretch doesn&#39;t have solid branching kmers on both sides, it is excluded from the result. Duplicate ranges are removed from the final output.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL1828">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.find_true_ranges-Tuple{AbstractVector{Bool}}" href="#Mycelia.find_true_ranges-Tuple{AbstractVector{Bool}}"><code>Mycelia.find_true_ranges</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">find_true_ranges(
    bool_vec::AbstractVector{Bool};
    min_length
) -&gt; Vector
</code></pre><p>Finds contiguous ranges of <code>true</code> values in a boolean vector.</p><p><strong>Arguments</strong></p><ul><li><code>bool_vec::AbstractVector{Bool}</code>: Input boolean vector to analyze</li><li><code>min_length=1</code>: Minimum length requirement for a range to be included</li></ul><p><strong>Returns</strong></p><p>Vector of tuples <code>(start, end)</code> where each tuple represents the indices of a contiguous range of <code>true</code> values meeting the minimum length requirement.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL4527">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.first_of_each_group-Tuple{DataFrames.GroupedDataFrame{DataFrames.DataFrame}}" href="#Mycelia.first_of_each_group-Tuple{DataFrames.GroupedDataFrame{DataFrames.DataFrame}}"><code>Mycelia.first_of_each_group</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">first_of_each_group(
    gdf::DataFrames.GroupedDataFrame{DataFrames.DataFrame}
) -&gt; Any
</code></pre><p>Return a DataFrame containing the first row from each group in a GroupedDataFrame.</p><p><strong>Arguments</strong></p><ul><li><code>gdf::GroupedDataFrame</code>: A grouped DataFrame created using <code>groupby</code></li></ul><p><strong>Returns</strong></p><ul><li><code>DataFrame</code>: A new DataFrame containing first row from each group</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL4044">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.fit_optimal_number_of_clusters" href="#Mycelia.fit_optimal_number_of_clusters"><code>Mycelia.fit_optimal_number_of_clusters</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">fit_optimal_number_of_clusters(
    distance_matrix
) -&gt; @NamedTuple{optimal_number_of_clusters::Int64, ks_assessed::Vector{Int64}, within_cluster_sum_of_squares::Vector{Float64}, silhouette_scores::Vector{Float64}}
fit_optimal_number_of_clusters(
    distance_matrix,
    ks_to_try
) -&gt; NamedTuple{(:optimal_number_of_clusters, :ks_assessed, :within_cluster_sum_of_squares, :silhouette_scores), &lt;:Tuple{Any, Any, Vector{Float64}, Vector{Float64}}}
</code></pre><p>Determines the optimal number of clusters for k-means clustering by maximizing the silhouette score.</p><p><strong>Algorithm</strong></p><ul><li>Starts by evaluating the first 5 k values</li><li>Continues evaluation if optimal k is at the edge of evaluated range</li><li>Refines search by evaluating midpoints between k values around the current optimum</li><li>Iterates until convergence (optimal k remains stable)</li></ul><p><strong>Arguments</strong></p><ul><li><code>distance_matrix::Matrix</code>: Square matrix of pairwise distances between points</li><li><code>ks_to_try::Vector{Int}</code>: Vector of k values to evaluate. Defaults to [1, 2, ...] up to matrix size</li></ul><p><strong>Returns</strong></p><p>Named tuple containing:</p><ul><li><code>optimal_number_of_clusters::Int</code>: The k value giving highest silhouette score</li><li><code>ks_assessed::Vector{Int}</code>: All k values that were evaluated</li><li><code>within_cluster_sum_of_squares::Vector{Float64}</code>: WCSS for each k assessed</li><li><code>silhouette_scores::Vector{Float64}</code>: Silhouette scores for each k assessed</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL5752">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.fit_optimal_number_of_clusters_hclust" href="#Mycelia.fit_optimal_number_of_clusters_hclust"><code>Mycelia.fit_optimal_number_of_clusters_hclust</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">fit_optimal_number_of_clusters_hclust(
    distance_matrix
) -&gt; NamedTuple{(:optimal_number_of_clusters, :ks_assessed, :silhouette_scores, :hclust_result), &lt;:Tuple{Int64, Vector{Int64}, Vector{Float64}, Clustering.Hclust}}
fit_optimal_number_of_clusters_hclust(
    distance_matrix,
    ks_to_try
) -&gt; NamedTuple{(:optimal_number_of_clusters, :ks_assessed, :silhouette_scores, :hclust_result), &lt;:Tuple{Any, Any, Vector{Float64}, Clustering.Hclust}}
</code></pre><p>Determine the optimal number of clusters using hierarchical clustering with iterative refinement.</p><p><strong>Arguments</strong></p><ul><li><code>distance_matrix::Matrix</code>: Square matrix of pairwise distances between observations</li><li><code>ks_to_try::Vector{Int}</code>: Vector of cluster counts to evaluate (default: 1, 2, and sequence from <code>Mycelia.ks()</code>)</li></ul><p><strong>Returns</strong></p><p>Named tuple containing:</p><ul><li><code>optimal_number_of_clusters::Int</code>: Best number of clusters found</li><li><code>ks_assessed::Vector{Int}</code>: All cluster counts that were evaluated</li><li><code>silhouette_scores::Vector{Float64}</code>: Silhouette scores for each k assessed</li><li><code>hclust_result</code>: Hierarchical clustering result object</li></ul><p><strong>Details</strong></p><p>Uses Ward&#39;s linkage method and silhouette scores to evaluate cluster quality.  Implements an adaptive search that focuses on promising regions between initially tested k values. For k=1, silhouette score is set to 0 as a special case.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL5965">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.frequency_matrix_to_cosine_distance_matrix-Tuple{Any}" href="#Mycelia.frequency_matrix_to_cosine_distance_matrix-Tuple{Any}"><code>Mycelia.frequency_matrix_to_cosine_distance_matrix</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">frequency_matrix_to_cosine_distance_matrix(
    probability_matrix
) -&gt; Any
</code></pre><p>Create cosine distance matrix from a column-major counts matrix (features as rows and entities as columns) where distance is a proportional to cosine similarity (relative frequency)</p><p>Compute pairwise cosine distances between entities based on their feature distributions.</p><p><strong>Arguments</strong></p><ul><li><code>probability_matrix</code>: Column-major matrix where rows represent features and columns represent entities. Each column should contain frequency/probability values for one entity.</li></ul><p><strong>Returns</strong></p><ul><li>Symmetric matrix of size (n<em>entities × n</em>entities) containing pairwise cosine distances. Distance values range from 0 (identical distributions) to 1 (orthogonal distributions).</li></ul><p><strong>Details</strong></p><ul><li>Computes upper triangle and mirrors to lower triangle for efficiency</li><li>Uses <code>Distances.cosine_dist</code> for the core computation</li><li>Time complexity is O(n²) where n is the number of entities</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL13200">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.frequency_matrix_to_euclidean_distance_matrix-Tuple{Any}" href="#Mycelia.frequency_matrix_to_euclidean_distance_matrix-Tuple{Any}"><code>Mycelia.frequency_matrix_to_euclidean_distance_matrix</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">frequency_matrix_to_euclidean_distance_matrix(
    counts_table
) -&gt; Any
</code></pre><p>Create a Euclidean distance matrix from a column-major counts matrix (features as rows and entities as columns), where distance is proportional to total feature count magnitude (size).</p><p>Compute pairwise Euclidean distances between entity profiles in a counts matrix.</p><p><strong>Arguments</strong></p><ul><li><code>counts_table</code>: A matrix where rows represent features and columns represent entities (column-major format). Each column contains the feature counts/frequencies for one entity.</li></ul><p><strong>Returns</strong></p><ul><li>A symmetric N×N matrix of Euclidean distances between each pair of entities, where N is the number of entities.</li></ul><p><strong>Details</strong></p><ul><li>Parallelized computation using multi-threading</li><li>Progress tracking via ProgressMeter</li><li>Memory efficient: only upper triangle is computed, then mirrored</li><li>Distance between entities increases with total feature magnitude differences</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL13135">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.genbank_to_codon_frequencies-Tuple{Any}" href="#Mycelia.genbank_to_codon_frequencies-Tuple{Any}"><code>Mycelia.genbank_to_codon_frequencies</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">genbank_to_codon_frequencies(
    genbank;
    allow_all
) -&gt; Dict{BioSymbols.AminoAcid, Dict{Kmers.Kmer{BioSequences.DNAAlphabet{2}, 3, 1}, Int64}}
</code></pre><p>Analyze codon usage frequencies from genes in a GenBank file.</p><p><strong>Arguments</strong></p><ul><li><code>genbank</code>: Path to GenBank format file containing genomic sequences and annotations</li><li><code>allow_all</code>: If true, initializes frequencies for all possible codons with count=1 (default: true)</li></ul><p><strong>Returns</strong></p><p>Nested dictionary mapping amino acids to their corresponding codon usage counts:</p><ul><li>Outer key: AminoAcid (including stop codon)</li><li>Inner key: DNACodon</li><li>Value: Count of codon occurrences</li></ul><p><strong>Details</strong></p><ul><li>Only processes genes marked as &#39;:misc_feature&#39; in the GenBank file</li><li>Analyzes both forward and reverse complement sequences</li><li>Determines coding strand based on presence of stop codons and start codons</li><li>Skips ambiguous sequences that cannot be confidently oriented</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL12465">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.genbank_to_fasta-Tuple{}" href="#Mycelia.genbank_to_fasta-Tuple{}"><code>Mycelia.genbank_to_fasta</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">genbank_to_fasta(; genbank, fasta, force)
</code></pre><p>Convert a GenBank format file to FASTA format using EMBOSS seqret.</p><p><strong>Arguments</strong></p><ul><li><code>genbank</code>: Path to input GenBank format file</li><li><code>fasta</code>: Optional output FASTA file path (defaults to input path with .fna extension)</li><li><code>force</code>: If true, overwrites existing output file (defaults to false)</li></ul><p><strong>Returns</strong></p><p>Path to the output FASTA file</p><p><strong>Notes</strong></p><ul><li>Requires EMBOSS suite (installed automatically via Conda)</li><li>Will not regenerate output if it already exists unless force=true</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL10711">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.generate_all_possible_canonical_kmers-Tuple{Any, Any}" href="#Mycelia.generate_all_possible_canonical_kmers-Tuple{Any, Any}"><code>Mycelia.generate_all_possible_canonical_kmers</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">generate_all_possible_canonical_kmers(k, alphabet) -&gt; Any
</code></pre><p>Create distance matrix from a column-major counts matrix (features as rows and entities as columns) where distance is a proportional to total feature count magnitude (size) and cosine similarity (relative frequency)</p><p>Generate all possible canonical k-mers of length <code>k</code> from the given <code>alphabet</code>.</p><p>For DNA/RNA sequences, returns unique canonical k-mers where each k-mer is represented by the lexicographically smaller of itself and its reverse complement. For amino acid sequences, returns all possible k-mers without canonicalization.</p><p><strong>Arguments</strong></p><ul><li><code>k</code>: Length of k-mers to generate</li><li><code>alphabet</code>: Vector of BioSymbols (DNA, RNA or AminoAcid)</li></ul><p><strong>Returns</strong></p><ul><li>Vector of k-mers, canonicalized for DNA/RNA alphabets</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL12707">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.generate_all_possible_kmers-Tuple{Any, Any}" href="#Mycelia.generate_all_possible_kmers-Tuple{Any, Any}"><code>Mycelia.generate_all_possible_kmers</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">generate_all_possible_kmers(k, alphabet) -&gt; Any
</code></pre><p>Create distance matrix from a column-major counts matrix (features as rows and entities as columns) where distance is a proportional to total feature count magnitude (size) and cosine similarity (relative frequency)</p><p>Generate a sorted list of all possible k-mers for a given alphabet.</p><p><strong>Arguments</strong></p><ul><li><code>k::Integer</code>: Length of k-mers to generate</li><li><code>alphabet</code>: Collection of symbols (DNA, RNA, or amino acids) from BioSymbols</li></ul><p><strong>Returns</strong></p><ul><li>Sorted Vector of Kmers of the appropriate type (DNA, RNA, or amino acid)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL12677">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.generate_transterm_coordinates_from_fasta-Tuple{Any}" href="#Mycelia.generate_transterm_coordinates_from_fasta-Tuple{Any}"><code>Mycelia.generate_transterm_coordinates_from_fasta</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">generate_transterm_coordinates_from_fasta(fasta) -&gt; Any
</code></pre><p>Generate minimal coordinate files required for TransTermHP analysis from FASTA sequences.</p><p>Creates artificial gene annotations at sequence boundaries to enable TransTermHP to run without real gene annotations. For each sequence in the FASTA file, generates two single-base-pair &quot;genes&quot; at positions 1-2 and (L-1)-L, where L is sequence length.</p><p><strong>Arguments</strong></p><ul><li><code>fasta</code>: Path to input FASTA file containing sequences to analyze</li></ul><p><strong>Returns</strong></p><ul><li>Path to generated coordinate file (original path with &quot;.coords&quot; extension)</li></ul><p><strong>Format</strong></p><p>Generated coordinate file follows TransTermHP format: gene_id start stop chromosome</p><p>where chromosome matches FASTA sequence identifiers.</p><p>See also: <a href="#Mycelia.run_transterm-Tuple{}"><code>run_transterm</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL4736">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.generate_transterm_coordinates_from_gff-Tuple{Any}" href="#Mycelia.generate_transterm_coordinates_from_gff-Tuple{Any}"><code>Mycelia.generate_transterm_coordinates_from_gff</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">generate_transterm_coordinates_from_gff(gff_file) -&gt; Any
</code></pre><p>Convert a GFF file to a coordinates file compatible with TransTermHP format.</p><p><strong>Arguments</strong></p><ul><li><code>gff_file::String</code>: Path to input GFF file</li></ul><p><strong>Processing</strong></p><ul><li>Converts 1-based to 0-based coordinates</li><li>Extracts gene IDs from the attributes field</li><li>Retains columns: gene_id, start, end, seqid</li></ul><p><strong>Returns</strong></p><ul><li>Path to the generated coordinates file (original filename with &#39;.coords&#39; suffix)</li></ul><p><strong>Output Format</strong></p><p>Space-delimited file with columns: gene_id, start, end, seqid</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL4823">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.get_base_extension-Tuple{String}" href="#Mycelia.get_base_extension-Tuple{String}"><code>Mycelia.get_base_extension</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_base_extension(filename::String) -&gt; String
</code></pre><p>Extract the base file extension from a filename, handling compressed files.</p><p>For regular files, returns the last extension. For gzipped files, returns the extension before .gz.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL3887">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.get_correct_quality-Tuple{Symbol, Int64, Int64}" href="#Mycelia.get_correct_quality-Tuple{Symbol, Int64, Int64}"><code>Mycelia.get_correct_quality</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_correct_quality(tech::Symbol, pos::Int, read_length::Int) -&gt; Int</code></pre><p>Simulates a Phred quality score (using the Sanger convention) for a correctly observed base. For Illumina, the quality score is modeled to decay linearly from ~40 at the start to ~20 at the end of the read. For other technologies, the score is sampled from a normal distribution with parameters typical for that platform.</p><p>Returns an integer quality score.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL13446-L13454">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.get_error_quality-Tuple{Symbol}" href="#Mycelia.get_error_quality-Tuple{Symbol}"><code>Mycelia.get_error_quality</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_error_quality(tech::Symbol) -&gt; Int</code></pre><p>Simulates a Phred quality score (using the Sanger convention) for a base observed with an error. Error bases are assigned lower quality scores than correctly observed bases. For Illumina, scores typically range between 5 and 15; for nanopore and pacbio, slightly lower values are used; and for ultima, a modest quality score is assigned.</p><p>Returns an integer quality score.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL13474-L13483">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.get_genbank-Tuple{}" href="#Mycelia.get_genbank-Tuple{}"><code>Mycelia.get_genbank</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_genbank(
;
    db,
    accession,
    ftp
) -&gt; Union{Nothing, GenomicAnnotations.GenBank.Reader}
</code></pre><p>Get dna (db = &quot;nuccore&quot;) or protein (db = &quot;protein&quot;) sequences from NCBI or get fasta directly from FTP site</p><p>Retrieve GenBank records from NCBI or directly from an FTP site.</p><p><strong>Arguments</strong></p><ul><li><code>db::String</code>: NCBI database to query (&quot;nuccore&quot; for nucleotide or &quot;protein&quot; for protein sequences)</li><li><code>accession::String</code>: NCBI accession number for the sequence</li><li><code>ftp::String</code>: Direct FTP URL to a GenBank file (gzipped)</li></ul><p><strong>Returns</strong></p><ul><li><code>GenomicAnnotations.GenBank.Reader</code>: A reader object containing the GenBank record</li></ul><p><strong>Details</strong></p><p>When using NCBI queries (<code>db</code> and <code>accession</code>), the function implements rate limiting  (0.5s sleep) to comply with NCBI&#39;s API restrictions of max 2 requests per second.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL11005">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.get_gff-Tuple{}" href="#Mycelia.get_gff-Tuple{}"><code>Mycelia.get_gff</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_gff(; db, accession, ftp) -&gt; Any
</code></pre><p>Get dna (db = &quot;nuccore&quot;) or protein (db = &quot;protein&quot;) sequences from NCBI or get fasta directly from FTP site</p><p>Retrieve GFF3 formatted genomic feature data from NCBI or direct FTP source.</p><p><strong>Arguments</strong></p><ul><li><code>db::String</code>: NCBI database to query (&quot;nuccore&quot; for DNA or &quot;protein&quot; for protein sequences)</li><li><code>accession::String</code>: NCBI accession number</li><li><code>ftp::String</code>: Direct FTP URL to GFF3 file (typically gzipped)</li></ul><p><strong>Returns</strong></p><ul><li><code>IO</code>: IOBuffer containing uncompressed GFF3 data</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL10976">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.get_kmer_index-Tuple{Any, Any}" href="#Mycelia.get_kmer_index-Tuple{Any, Any}"><code>Mycelia.get_kmer_index</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_kmer_index(kmers, kmer) -&gt; Any
</code></pre><p>Returns the index position of a given k-mer in a sorted list of k-mers.</p><p><strong>Arguments</strong></p><ul><li><code>kmers</code>: A sorted vector of k-mers to search within</li><li><code>kmer</code>: The k-mer sequence to find</li></ul><p><strong>Returns</strong></p><p>Integer index position where <code>kmer</code> is found in <code>kmers</code></p><p><strong>Throws</strong></p><ul><li><code>AssertionError</code>: If the k-mer is not found in the list</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL12737">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.get_sequence-Tuple{}" href="#Mycelia.get_sequence-Tuple{}"><code>Mycelia.get_sequence</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_sequence(
;
    db,
    accession,
    ftp
) -&gt; Union{Nothing, FASTX.FASTA.Reader}
</code></pre><p>Get dna (db = &quot;nuccore&quot;) or protein (db = &quot;protein&quot;) sequences from NCBI or get fasta directly from FTP site</p><p>Retrieve FASTA format sequences from NCBI databases or direct FTP URLs.</p><p><strong>Arguments</strong></p><ul><li><code>db::String</code>: NCBI database type (&quot;nuccore&quot; for DNA or &quot;protein&quot; for protein sequences)</li><li><code>accession::String</code>: NCBI sequence accession number</li><li><code>ftp::String</code>: Direct FTP URL to a FASTA file (alternative to db/accession pair)</li></ul><p><strong>Returns</strong></p><ul><li><code>FASTX.FASTA.Reader</code>: Reader object containing the requested sequence(s)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL7388">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.gfa_to_fasta-Tuple{}" href="#Mycelia.gfa_to_fasta-Tuple{}"><code>Mycelia.gfa_to_fasta</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">gfa_to_fasta(; gfa, fasta)
</code></pre><p>Convert a GFA (Graphical Fragment Assembly) file to FASTA format.</p><p><strong>Arguments</strong></p><ul><li><code>gfa::String</code>: Path to input GFA file</li><li><code>fasta::String=gfa * &quot;.fna&quot;</code>: Path for output FASTA file. Defaults to input filename with &quot;.fna&quot; extension</li></ul><p><strong>Returns</strong></p><ul><li><code>String</code>: Path to the generated FASTA file</li></ul><p><strong>Details</strong></p><p>Uses gfatools (via Conda) to perform the conversion. The function will:</p><ol><li>Ensure gfatools is available in the Conda environment</li><li>Execute the conversion using gfatools gfa2fa</li><li>Write sequences to the specified FASTA file</li></ol></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL632">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.gfa_to_structure_table-Tuple{Any}" href="#Mycelia.gfa_to_structure_table-Tuple{Any}"><code>Mycelia.gfa_to_structure_table</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">gfa_to_structure_table(
    gfa
) -&gt; NamedTuple{(:contig_table, :records), &lt;:Tuple{DataFrames.DataFrame, Any}}
</code></pre><p>Convert a GFA (Graphical Fragment Assembly) file into a structured representation.</p><p><strong>Arguments</strong></p><ul><li><code>gfa</code>: Path to GFA file or GFA content as string</li></ul><p><strong>Returns</strong></p><p>Named tuple containing:</p><ul><li><code>contig_table</code>: DataFrame with columns:<ul><li><code>connected_component</code>: Integer ID for each component</li><li><code>contigs</code>: Comma-separated list of contig IDs</li><li><code>is_circular</code>: Boolean indicating if component forms a cycle</li><li><code>is_closed</code>: Boolean indicating if single contig forms a cycle</li><li><code>lengths</code>: Comma-separated list of contig lengths</li></ul></li><li><code>records</code>: FASTA records from the GFA</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL3459">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.githash-Tuple{}" href="#Mycelia.githash-Tuple{}"><code>Mycelia.githash</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">githash(; short) -&gt; SubString{String}
</code></pre><p>Returns the current git commit hash of the repository.</p><p><strong>Arguments</strong></p><ul><li><code>short::Bool=false</code>: If true, returns abbreviated 8-character hash</li></ul><p><strong>Returns</strong></p><p>A string containing the git commit hash (full 40 characters by default)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL1453">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.graph_to_gfa-Tuple{}" href="#Mycelia.graph_to_gfa-Tuple{}"><code>Mycelia.graph_to_gfa</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">graph_to_gfa(; graph, outfile)
</code></pre><p>Convert a Mycelia graph to GFA (Graphical Fragment Assembly) format.</p><p>Writes a graph to GFA format, including:</p><ul><li>Header (H) line with GFA version</li><li>Segment (S) lines for each vertex with sequence and depth</li><li>Link (L) lines for edges with overlap size and orientations</li></ul><p><strong>Arguments</strong></p><ul><li><code>graph</code>: MetaGraph containing sequence vertices and their relationships</li><li><code>outfile</code>: Path where the GFA file should be written</li></ul><p><strong>Returns</strong></p><ul><li>Path to the written GFA file</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL11882">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.hclust_to_metagraph-Tuple{Clustering.Hclust}" href="#Mycelia.hclust_to_metagraph-Tuple{Clustering.Hclust}"><code>Mycelia.hclust_to_metagraph</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">hclust_to_metagraph(
    hcl::Clustering.Hclust
) -&gt; MetaGraphs.MetaDiGraph{Int64, Float64}
</code></pre><p>Convert a hierarchical clustering tree into a directed metagraph representation.</p><p><strong>Arguments</strong></p><ul><li><code>hcl::Clustering.Hclust</code>: Hierarchical clustering result object</li></ul><p><strong>Returns</strong></p><ul><li><code>MetaGraphs.MetaDiGraph</code>: Directed graph with metadata representing the clustering hierarchy</li></ul><p><strong>Graph Properties</strong></p><p>The resulting graph contains the following vertex properties:</p><ul><li><code>:hclust_id</code>: String identifier for each node</li><li><code>:height</code>: Height/distance at each merge point (0.0 for leaves)</li><li><code>:x</code>: Horizontal position for visualization (0-1 range)</li><li><code>:y</code>: Vertical position based on normalized height</li><li><code>:hcl</code>: Original clustering object (stored as graph property)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL4075">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.heirarchically_cluster_distance_matrix-Tuple{Any}" href="#Mycelia.heirarchically_cluster_distance_matrix-Tuple{Any}"><code>Mycelia.heirarchically_cluster_distance_matrix</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">heirarchically_cluster_distance_matrix(
    distance_matrix
) -&gt; Clustering.Hclust
</code></pre><p>Performs hierarchical clustering on a distance matrix using Ward&#39;s linkage method.</p><p><strong>Arguments</strong></p><ul><li><code>distance_matrix::Matrix{&lt;:Real}</code>: A symmetric distance/dissimilarity matrix</li></ul><p><strong>Returns</strong></p><ul><li><code>HierarchicalCluster</code>: A hierarchical clustering object from Clustering.jl</li></ul><p><strong>Details</strong></p><p>Uses Ward&#39;s method (minimum variance) for clustering, which:</p><ul><li>Minimizes total within-cluster variance</li><li>Produces compact, spherical clusters</li><li>Works well for visualization in radial layouts</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL4382">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.identify_optimal_number_of_clusters-Tuple{Any}" href="#Mycelia.identify_optimal_number_of_clusters-Tuple{Any}"><code>Mycelia.identify_optimal_number_of_clusters</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">identify_optimal_number_of_clusters(
    distance_matrix
) -&gt; Tuple{Clustering.Hclust, Int64}
</code></pre><p>Determine the optimal number of clusters for a dataset using hierarchical clustering and silhouette score analysis.</p><p><strong>Arguments</strong></p><ul><li><code>distance_matrix</code>: A symmetric matrix of pairwise distances between data points</li></ul><p><strong>Returns</strong></p><p>A tuple containing:</p><ul><li><code>hcl</code>: The fitted hierarchical clustering object</li><li><code>optimal_number_of_clusters</code>: Integer indicating the optimal number of clusters</li></ul><p><strong>Details</strong></p><p>The function:</p><ol><li>Performs hierarchical clustering on the distance matrix</li><li>Tests cluster counts from 2 to √n (where n is dataset size)</li><li>Evaluates each clustering using silhouette scores</li><li>Generates a diagnostic plot showing silhouette scores vs cluster counts</li><li>Selects the number of clusters that minimizes the silhouette score</li></ol><p>The diagnostic plot is displayed automatically during execution.</p><p><strong>See Also</strong></p><ul><li><code>heirarchically_cluster_distance_matrix</code></li><li><code>Clustering.silhouettes</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL4412">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.install_hashdeep-Tuple{}" href="#Mycelia.install_hashdeep-Tuple{}"><code>Mycelia.install_hashdeep</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">install_hashdeep() -&gt; Union{Nothing, Base.Process}
</code></pre><p>Ensures the hashdeep utility is installed on the system.</p><p>Checks if hashdeep is available in PATH and attempts to install it via apt package manager if not found. Will try with sudo privileges first, then without sudo if that fails.</p><p><strong>Details</strong></p><ul><li>Checks PATH for existing hashdeep executable</li><li>Attempts installation using apt package manager</li><li>Requires a Debian-based Linux distribution</li></ul><p><strong>Returns</strong></p><ul><li>Nothing, but prints status messages during execution</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL1708">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.is_equivalent-Tuple{Any, Any}" href="#Mycelia.is_equivalent-Tuple{Any, Any}"><code>Mycelia.is_equivalent</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">is_equivalent(a, b) -&gt; Any
</code></pre><p>Check if two biological sequences are equivalent, considering both direct and reverse complement matches.</p><p><strong>Arguments</strong></p><ul><li><code>a</code>: First biological sequence (BioSequence or compatible type)</li><li><code>b</code>: Second biological sequence (BioSequence or compatible type)</li></ul><p><strong>Returns</strong></p><ul><li><code>Bool</code>: <code>true</code> if sequences are identical or if one is the reverse complement of the other, <code>false</code> otherwise</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL14016">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.isolate_normalized_primary_contig-Tuple{Any, Any, Any, Any, Int64}" href="#Mycelia.isolate_normalized_primary_contig-Tuple{Any, Any, Any, Any, Int64}"><code>Mycelia.isolate_normalized_primary_contig</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">isolate_normalized_primary_contig(
    assembled_fasta,
    assembled_gfa,
    qualimap_report_txt,
    identifier,
    k::Int64;
    primary_contig_fasta
) -&gt; String
</code></pre><p>Primary contig is defined as the contig with the most bases mapped to it</p><p>In the context of picking out phage from metagenomic assemblies the longest contig is often bacteria whereas the highest coverage contigs are often primer-dimers or other PCR amplification artifacts.</p><p>Taking the contig that has the most bases mapped to it as a product of length * depth is cherry picked as our phage</p><p>Isolates and exports the primary contig from an assembly based on coverage depth × length.</p><p>The primary contig is defined as the contig with the highest total mapped bases  (coverage depth × length). This method helps identify potential phage contigs in  metagenomic assemblies, avoiding both long bacterial contigs and short high-coverage  PCR artifacts.</p><p><strong>Arguments</strong></p><ul><li><code>assembled_fasta</code>: Path to the assembled contigs in FASTA format</li><li><code>assembled_gfa</code>: Path to the assembly graph in GFA format</li><li><code>qualimap_report_txt</code>: Path to Qualimap coverage report</li><li><code>identifier</code>: String identifier for the output file</li><li><code>k</code>: Integer representing k-mer size used in assembly</li><li><code>primary_contig_fasta</code>: Optional output filepath (default: &quot;{identifier}.primary_contig.fna&quot;)</li></ul><p><strong>Returns</strong></p><ul><li>Path to the output FASTA file containing the primary contig</li></ul><p><strong>Notes</strong></p><ul><li>For circular contigs, removes the k-mer closure scar if detected</li><li>Trims k bases from the end if they match the first k bases</li><li>Uses coverage × length to avoid both long bacterial contigs and short PCR artifacts</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL7807">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.iterative_polishing" href="#Mycelia.iterative_polishing"><code>Mycelia.iterative_polishing</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">iterative_polishing(
    fastq
) -&gt; Vector{T} where T&lt;:(NamedTuple{(:fastq, :k), &lt;:Tuple{Any, Any}})
iterative_polishing(
    fastq,
    max_k
) -&gt; Vector{T} where T&lt;:(NamedTuple{(:fastq, :k), &lt;:Tuple{Any, Any}})
iterative_polishing(
    fastq,
    max_k,
    plot
) -&gt; Vector{T} where T&lt;:(NamedTuple{(:fastq, :k), &lt;:Tuple{Any, Any}})
</code></pre><p>Performs iterative error correction on FASTQ sequences using progressively larger k-mer sizes.</p><p>Starting with the default k-mer size, this function repeatedly applies polishing steps, incrementing the k-mer size until either reaching max_k or encountering instability.</p><p><strong>Arguments</strong></p><ul><li><code>fastq</code>: Path to input FASTQ file or FastqRecord object</li><li><code>max_k</code>: Maximum k-mer size to attempt (default: 89)</li><li><code>plot</code>: Whether to generate diagnostic plots (default: false)</li></ul><p><strong>Returns</strong></p><p>Vector of polishing results, where each element contains:</p><ul><li>k: k-mer size used</li><li>fastq: resulting polished sequences</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL2305">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.jaccard_distance-Tuple{Any, Any}" href="#Mycelia.jaccard_distance-Tuple{Any, Any}"><code>Mycelia.jaccard_distance</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">jaccard_distance(set1, set2) -&gt; Any
</code></pre><p>Calculate the Jaccard distance between two sets, which is the complement of the Jaccard similarity.</p><p>The Jaccard distance is defined as: <span>$J_d(A,B) = 1 - J_s(A,B) = 1 - \frac{|A ∩ B|}{|A ∪ B|}$</span></p><p><strong>Arguments</strong></p><ul><li><code>set1</code>: First set to compare</li><li><code>set2</code>: Second set to compare</li></ul><p><strong>Returns</strong></p><ul><li><code>Float64</code>: A value in [0,1] where 0 indicates identical sets and 1 indicates disjoint sets</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL2721">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.jaccard_similarity-Tuple{Any, Any}" href="#Mycelia.jaccard_similarity-Tuple{Any, Any}"><code>Mycelia.jaccard_similarity</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">jaccard_similarity(set1, set2) -&gt; Any
</code></pre><p>Compute the Jaccard similarity coefficient between two sets.</p><p>The Jaccard similarity is defined as the size of the intersection divided by the size of the union of two sets:</p><pre><code class="nohighlight hljs">J(A,B) = |A ∩ B| / |A ∪ B|</code></pre><p><strong>Arguments</strong></p><ul><li><code>set1</code>: First set for comparison</li><li><code>set2</code>: Second set for comparison</li></ul><p><strong>Returns</strong></p><ul><li><code>Float64</code>: A value between 0.0 and 1.0, where:<ul><li>1.0 indicates identical sets</li><li>0.0 indicates completely disjoint sets</li></ul></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL2698">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.jellyfish_count-Tuple{}" href="#Mycelia.jellyfish_count-Tuple{}"><code>Mycelia.jellyfish_count</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">jellyfish_count(
;
    fastx,
    k,
    threads,
    max_mem,
    canonical,
    outfile,
    conda_check
)
</code></pre><p>Count k-mers in a FASTA/FASTQ file using Jellyfish.</p><p><strong>Arguments</strong></p><ul><li><code>fastx::String</code>: Path to input FASTA/FASTQ file (can be gzipped)</li><li><code>k::Integer</code>: k-mer length</li><li><code>threads::Integer=Sys.CPU_THREADS</code>: Number of threads to use</li><li><code>max_mem::Integer=Int(Sys.free_memory())</code>: Maximum memory in bytes (defaults to system free memory)</li><li><code>canonical::Bool=false</code>: Whether to count canonical k-mers (both strands combined)</li><li><code>outfile::String=auto</code>: Output filename (auto-generated based on input and parameters)</li><li><code>conda_check::Bool=true</code>: Whether to verify Jellyfish conda installation</li></ul><p><strong>Returns</strong></p><ul><li><code>String</code>: Path to gzipped TSV file containing k-mer counts</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL1131">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.jellyfish_counts_to_kmer_frequency_histogram" href="#Mycelia.jellyfish_counts_to_kmer_frequency_histogram"><code>Mycelia.jellyfish_counts_to_kmer_frequency_histogram</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">jellyfish_counts_to_kmer_frequency_histogram(
    jellyfish_counts_file
) -&gt; Any
jellyfish_counts_to_kmer_frequency_histogram(
    jellyfish_counts_file,
    outfile
) -&gt; Any
</code></pre><p>Convert a Jellyfish k-mer count file into a frequency histogram.</p><p><strong>Arguments</strong></p><ul><li><code>jellyfish_counts_file::String</code>: Path to the gzipped TSV file containing Jellyfish k-mer counts</li><li><code>outfile::String=replace(jellyfish_counts_file, r&quot;\.tsv\.gz$&quot; =&gt; &quot;.count_histogram.tsv&quot;)</code>: Optional output file path</li></ul><p><strong>Returns</strong></p><ul><li><code>String</code>: Path to the generated histogram file</li></ul><p><strong>Description</strong></p><p>Processes a Jellyfish k-mer count file to create a frequency histogram where:</p><ul><li>Column 1: Number of k-mers that share the same count</li><li>Column 2: The count they share</li></ul><p>Uses system sorting with LC_ALL=C for optimal performance on large files.</p><p>Notes</p><ul><li>Requires gzip, sort, uniq, and sed command line tools</li><li>Uses intermediate disk storage for sorting large files</li><li>Skips processing if output file already exists</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL1208">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.jitter-Tuple{Any, Any}" href="#Mycelia.jitter-Tuple{Any, Any}"><code>Mycelia.jitter</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">jitter(x, n) -&gt; Any
</code></pre><p>Add random noise to create a vector of jittered values.</p><p>Generates <code>n</code> values by adding random noise to the input value <code>x</code>.  The noise is uniformly distributed between -1/3 and 1/3.</p><p><strong>Arguments</strong></p><ul><li><code>x</code>: Base value to add jitter to</li><li><code>n</code>: Number of jittered values to generate</li></ul><p><strong>Returns</strong></p><ul><li>Vector of length <code>n</code> containing jittered values around <code>x</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL1309">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.kmer_counts_dict_to_vector-Tuple{Any, Any}" href="#Mycelia.kmer_counts_dict_to_vector-Tuple{Any, Any}"><code>Mycelia.kmer_counts_dict_to_vector</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">kmer_counts_dict_to_vector(
    kmer_to_index_map,
    kmer_counts
) -&gt; Any
</code></pre><p>Convert a dictionary of k-mer counts to a fixed-length numeric vector based on a predefined mapping.</p><p><strong>Arguments</strong></p><ul><li><code>kmer_to_index_map</code>: Dictionary mapping k-mer sequences to their corresponding vector indices</li><li><code>kmer_counts</code>: Dictionary containing k-mer sequences and their occurrence counts</li></ul><p><strong>Returns</strong></p><ul><li>A vector where each position corresponds to a k-mer count, with zeros for absent k-mers</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL12656">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.kmer_counts_to_cosine_similarity-Tuple{Any, Any}" href="#Mycelia.kmer_counts_to_cosine_similarity-Tuple{Any, Any}"><code>Mycelia.kmer_counts_to_cosine_similarity</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">kmer_counts_to_cosine_similarity(
    kmer_counts_1,
    kmer_counts_2
) -&gt; Any
</code></pre><p>Calculate the cosine similarity between two k-mer count dictionaries.</p><p><strong>Arguments</strong></p><ul><li><code>kmer_counts_1::Dict{String,Int}</code>: First dictionary mapping k-mer sequences to their counts</li><li><code>kmer_counts_2::Dict{String,Int}</code>: Second dictionary mapping k-mer sequences to their counts</li></ul><p><strong>Returns</strong></p><ul><li><code>Float64</code>: Cosine distance between the two k-mer count vectors, in range [0,1] where 0 indicates identical distributions and 1 indicates maximum dissimilarity</li></ul><p><strong>Details</strong></p><p>Converts k-mer count dictionaries into vectors using a unified set of keys, then computes cosine distance. Missing k-mers are treated as count 0. Result is invariant to input order and total counts (normalized internally).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL2643">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.kmer_counts_to_js_divergence-Tuple{Any, Any}" href="#Mycelia.kmer_counts_to_js_divergence-Tuple{Any, Any}"><code>Mycelia.kmer_counts_to_js_divergence</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">kmer_counts_to_js_divergence(
    kmer_counts_1,
    kmer_counts_2
) -&gt; Any
</code></pre><p>Calculate the Jensen-Shannon divergence between two k-mer frequency distributions.</p><p><strong>Arguments</strong></p><ul><li><code>kmer_counts_1</code>: Dictionary mapping k-mers to their counts in first sequence</li><li><code>kmer_counts_2</code>: Dictionary mapping k-mers to their counts in second sequence</li></ul><p><strong>Returns</strong></p><ul><li>Normalized Jensen-Shannon divergence score between 0 and 1, where:<ul><li>0 indicates identical distributions</li><li>1 indicates maximally different distributions</li></ul></li></ul><p><strong>Notes</strong></p><ul><li>The measure is symmetric: JS(P||Q) = JS(Q||P)</li><li>Counts are automatically normalized to probability distributions</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL2669">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.kmer_counts_to_merqury_qv-Union{Tuple{}, Tuple{N}, Tuple{k}} where {k, N}" href="#Mycelia.kmer_counts_to_merqury_qv-Union{Tuple{}, Tuple{N}, Tuple{k}} where {k, N}"><code>Mycelia.kmer_counts_to_merqury_qv</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">kmer_counts_to_merqury_qv(
;
    raw_data_counts,
    assembly_counts
)
</code></pre><p>Calculate assembly Quality Value (QV) score using the Merqury method.</p><p>Estimates base-level accuracy by comparing k-mer distributions between raw sequencing data and assembly. Higher QV scores indicate better assembly quality.</p><p><strong>Arguments</strong></p><ul><li><code>raw_data_counts::AbstractDict{Kmers.DNAKmer{k,N}, Int}</code>: K-mer counts from raw sequencing data</li><li><code>assembly_counts::AbstractDict{Kmers.DNAKmer{k,N}, Int}</code>: K-mer counts from assembly</li></ul><p><strong>Returns</strong></p><ul><li><code>Float64</code>: Quality Value score in Phred scale (-10log₁₀(error rate))</li></ul><p><strong>Method</strong></p><p>QV is calculated using:</p><ol><li>Ktotal = number of unique kmers in assembly</li><li>Kshared = number of kmers shared between raw data and assembly</li><li>P = (Kshared/Ktotal)^(1/k) = estimated base-level accuracy</li><li>QV = -10log₁₀(1-P)</li></ol><p><strong>Reference</strong></p><p>Rhie et al. &quot;Merqury: reference-free quality, completeness, and phasing assessment for genome assemblies&quot; Genome Biology (2020)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL2750">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.kmer_path_to_sequence-Tuple{Any}" href="#Mycelia.kmer_path_to_sequence-Tuple{Any}"><code>Mycelia.kmer_path_to_sequence</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">kmer_path_to_sequence(kmer_path) -&gt; Any
</code></pre><p>Convert a path of overlapping k-mers into a single DNA sequence.</p><p><strong>Arguments</strong></p><ul><li><code>kmer_path</code>: Vector of k-mers (DNA sequences) where each consecutive pair overlaps by k-1 bases</li></ul><p><strong>Returns</strong></p><ul><li><code>BioSequences.LongDNA{2}</code>: Assembled DNA sequence from the k-mer path</li></ul><p><strong>Description</strong></p><p>Reconstructs the original DNA sequence by joining k-mers, validating that consecutive k-mers  overlap correctly. The first k-mer is used in full, then each subsequent k-mer contributes  its last base.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL13236">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.ks-Tuple{}" href="#Mycelia.ks-Tuple{}"><code>Mycelia.ks</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ks(; min, max) -&gt; Vector{Int64}
</code></pre><p>Generates a specialized sequence of prime numbers combining:</p><ul><li>Odd primes up to 23 (flip_point)</li><li>Primes nearest to Fibonacci numbers above 23 up to max</li></ul><p><strong>Arguments</strong></p><ul><li><code>min::Int=0</code>: Lower bound for the sequence</li><li><code>max::Int=10_000</code>: Upper bound for the sequence</li></ul><p><strong>Returns</strong></p><p>Vector of Int containing the specialized prime sequence</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL1583">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.lawrencium_sbatch-Tuple{}" href="#Mycelia.lawrencium_sbatch-Tuple{}"><code>Mycelia.lawrencium_sbatch</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">lawrencium_sbatch(
;
    job_name,
    mail_user,
    mail_type,
    logdir,
    partition,
    qos,
    account,
    nodes,
    ntasks,
    time,
    cpus_per_task,
    mem_gb,
    cmd
)
</code></pre><p>Submit a job to SLURM scheduler on Lawrence Berkeley Lab&#39;s Lawrencium cluster.</p><p><strong>Arguments</strong></p><ul><li><code>job_name</code>: Name identifier for the SLURM job</li><li><code>mail_user</code>: Email address for job notifications</li><li><code>mail_type</code>: Notification type (&quot;ALL&quot;, &quot;BEGIN&quot;, &quot;END&quot;, &quot;FAIL&quot;, or &quot;NONE&quot;)</li><li><code>logdir</code>: Directory for SLURM output and error logs</li><li><code>partition</code>: Lawrencium compute partition</li><li><code>qos</code>: Quality of Service level</li><li><code>account</code>: Project account for billing</li><li><code>nodes</code>: Number of nodes to allocate</li><li><code>ntasks</code>: Number of tasks to spawn</li><li><code>time</code>: Wall time limit in format &quot;days-hours:minutes:seconds&quot;</li><li><code>cpus_per_task</code>: CPU cores per task</li><li><code>mem_gb</code>: Memory per node in GB</li><li><code>cmd</code>: Shell command to execute</li></ul><p><strong>Returns</strong></p><ul><li><code>true</code> if submission was successful</li></ul><p><strong>Note</strong></p><p>Function includes 5-second delays before and after submission for queue stability.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL261">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.list_blastdbs-Tuple{}" href="#Mycelia.list_blastdbs-Tuple{}"><code>Mycelia.list_blastdbs</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">list_blastdbs(; source) -&gt; Vector{String}
</code></pre><p>Lists available BLAST databases from the specified source.</p><p><strong>Arguments</strong></p><ul><li><code>source::String=&quot;ncbi&quot;</code>: Source of BLAST databases, defaults to &quot;ncbi&quot;</li></ul><p><strong>Returns</strong></p><ul><li><code>Vector{String}</code>: Array of available BLAST database names</li></ul><p><strong>Notes</strong></p><ul><li>Requires sudo/root privileges to install BLAST+ tools if not already present</li><li>Internet connection required to fetch database listings</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL6278">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.list_classes-Tuple{}" href="#Mycelia.list_classes-Tuple{}"><code>Mycelia.list_classes</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">list_classes() -&gt; DataFrames.DataFrame
</code></pre><p>Returns an array of all taxonomic classes in the database.</p><p>Classes represent a major taxonomic rank between phylum and order in biological classification.</p><p><strong>Returns</strong></p><ul><li><code>Vector{String}</code>: Array of class names sorted alphabetically</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL14669">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.list_databases-Tuple{}" href="#Mycelia.list_databases-Tuple{}"><code>Mycelia.list_databases</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">list_databases(; address, username, password)
</code></pre><p>Lists all available Neo4j databases on the specified server.</p><p><strong>Arguments</strong></p><ul><li><code>address::String</code>: Neo4j server address (e.g. &quot;neo4j://localhost:7687&quot;)</li><li><code>username::String=&quot;neo4j&quot;</code>: Neo4j authentication username</li><li><code>password::String</code>: Neo4j authentication password</li></ul><p><strong>Returns</strong></p><ul><li><code>DataFrame</code>: Contains database information with columns typically including:<ul><li>name: Database name</li><li>address: Database address</li><li>role: Database role (e.g., primary, secondary)</li><li>status: Current status (e.g., online, offline)</li><li>default: Boolean indicating if it&#39;s the default database</li></ul></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL7134">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.list_families-Tuple{}" href="#Mycelia.list_families-Tuple{}"><code>Mycelia.list_families</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">list_families() -&gt; DataFrames.DataFrame
</code></pre><p>Returns a sorted vector of all family names present in the database.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL14698">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.list_full_taxonomy-Tuple{}" href="#Mycelia.list_full_taxonomy-Tuple{}"><code>Mycelia.list_full_taxonomy</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">list_full_taxonomy() -&gt; DataFrames.DataFrame
</code></pre><p>Retrieves and formats the complete NCBI taxonomy hierarchy into a structured DataFrame.</p><p><strong>Details</strong></p><ul><li>Automatically sets up taxonkit environment and downloads taxonomy database if needed</li><li>Starts from root taxid (1) and includes all descendant taxa</li><li>Reformats lineage information into separate columns for each taxonomic rank</li></ul><p><strong>Returns</strong></p><p>DataFrame with columns:</p><ul><li><code>taxid</code>: Taxonomy identifier</li><li><code>lineage</code>: Full taxonomic lineage string</li><li><code>taxid_lineage</code>: Lineage with taxonomy IDs</li><li>Individual rank columns:<ul><li>superkingdom, kingdom, phylum, class, order, family, genus, species</li><li>corresponding taxid columns (e.g., superkingdom_taxid)</li></ul></li></ul><p><strong>Dependencies</strong></p><p>Requires taxonkit (installed automatically via Bioconda)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL14466">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.list_genera-Tuple{}" href="#Mycelia.list_genera-Tuple{}"><code>Mycelia.list_genera</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">list_genera() -&gt; DataFrames.DataFrame
</code></pre><p>Returns a sorted vector of all genera names present in the database.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL14707">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.list_kingdoms-Tuple{}" href="#Mycelia.list_kingdoms-Tuple{}"><code>Mycelia.list_kingdoms</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">list_kingdoms() -&gt; DataFrames.DataFrame
</code></pre><p>Lists all taxonomic kingdoms in the database.</p><p>Returns a vector of kingdom names as strings. Kingdoms represent the highest major taxonomic rank in biological classification.</p><p><strong>Returns</strong></p><ul><li><code>Vector{String}</code>: Array of kingdom names</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL14645">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.list_orders-Tuple{}" href="#Mycelia.list_orders-Tuple{}"><code>Mycelia.list_orders</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">list_orders() -&gt; DataFrames.DataFrame
</code></pre><p>Lists all orders in the taxonomic database.</p><p>Returns a vector of strings containing valid order names according to current mycological taxonomy. Uses the underlying <code>list_rank()</code> function with rank=&quot;order&quot;.</p><p><strong>Returns</strong></p><ul><li><code>Vector{String}</code>: Alphabetically sorted list of order names</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL14683">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.list_phylums-Tuple{}" href="#Mycelia.list_phylums-Tuple{}"><code>Mycelia.list_phylums</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">list_phylums() -&gt; DataFrames.DataFrame
</code></pre><p>Returns a sorted list of all unique phyla in the database.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL14660">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.list_rank-Tuple{Any}" href="#Mycelia.list_rank-Tuple{Any}"><code>Mycelia.list_rank</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">list_rank(rank) -&gt; DataFrames.DataFrame
</code></pre><p>List all taxonomic entries at the specified rank level.</p><p><strong>Arguments</strong></p><ul><li><code>rank::String</code>: Taxonomic rank to query. Must be one of:<ul><li>&quot;top&quot; (top level)</li><li>&quot;superkingdom&quot;/&quot;domain&quot;  </li><li>&quot;kingdom&quot;</li><li>&quot;phylum&quot; </li><li>&quot;class&quot;</li><li>&quot;order&quot;</li><li>&quot;family&quot;</li><li>&quot;genus&quot;</li><li>&quot;species&quot;</li></ul></li></ul><p><strong>Returns</strong></p><p>DataFrame with columns:</p><ul><li><code>taxid</code>: NCBI taxonomy ID</li><li><code>name</code>: Scientific name at the specified rank</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL14585">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.list_ranks-Tuple{}" href="#Mycelia.list_ranks-Tuple{}"><code>Mycelia.list_ranks</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">list_ranks(; synonyms) -&gt; Vector{String}
</code></pre><p>Return an ordered list of taxonomic ranks from highest (top) to lowest (species).</p><p><strong>Arguments</strong></p><ul><li><code>synonyms::Bool=false</code>: If true, includes alternative names for certain ranks (e.g. &quot;domain&quot; for &quot;superkingdom&quot;)</li></ul><p><strong>Returns</strong></p><ul><li><code>Vector{String}</code>: An array of taxonomic rank names in hierarchical order</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL14526">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.list_species-Tuple{}" href="#Mycelia.list_species-Tuple{}"><code>Mycelia.list_species</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">list_species() -&gt; DataFrames.DataFrame
</code></pre><p>Returns a sorted vector of all species names present in the database.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL14716">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.list_subtaxa-Tuple{Any}" href="#Mycelia.list_subtaxa-Tuple{Any}"><code>Mycelia.list_subtaxa</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">list_subtaxa(taxid) -&gt; Vector{Int64}
</code></pre><p>Returns an array of Integer taxon IDs representing all sub-taxa under the specified taxonomic ID.</p><p><strong>Arguments</strong></p><ul><li><code>taxid</code>: NCBI taxonomy identifier for the parent taxon</li></ul><p><strong>Returns</strong></p><p>Vector{Int} containing all descendant taxon IDs</p><p><strong>Details</strong></p><ul><li>Requires taxonkit to be installed via Bioconda</li><li>Automatically sets up taxonkit database if not present</li><li>Uses local taxonomy database in ~/.taxonkit/</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL14732">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.list_superkingdoms-Tuple{}" href="#Mycelia.list_superkingdoms-Tuple{}"><code>Mycelia.list_superkingdoms</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">list_superkingdoms() -&gt; DataFrames.DataFrame
</code></pre><p>Returns an array of all taxonomic superkingdoms (e.g., Bacteria, Archaea, Eukaryota).</p><p><strong>Returns</strong></p><ul><li><code>Vector{String}</code>: Array containing names of all superkingdoms in the taxonomy database</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL14633">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.list_toplevel-Tuple{}" href="#Mycelia.list_toplevel-Tuple{}"><code>Mycelia.list_toplevel</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">list_toplevel() -&gt; DataFrames.DataFrame
</code></pre><p>Returns a DataFrame containing the top-level taxonomic nodes.</p><p>The DataFrame has two fixed rows representing the most basic taxonomic classifications:</p><ul><li>taxid=0: &quot;unclassified&quot;</li><li>taxid=1: &quot;root&quot;</li></ul><p><strong>Returns</strong></p><p>DataFrame     Columns:     - taxid::Int : Taxonomic identifier     - name::String : Node name</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL14565">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.load_blast_db_taxonomy_table-Tuple{Any}" href="#Mycelia.load_blast_db_taxonomy_table-Tuple{Any}"><code>Mycelia.load_blast_db_taxonomy_table</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">load_blast_db_taxonomy_table(
    compressed_blast_db_taxonomy_table_file
) -&gt; DataFrames.DataFrame
</code></pre><p>Loads a BLAST database taxonomy mapping table from a gzipped file into a DataFrame.</p><p><strong>Arguments</strong></p><ul><li><code>compressed_blast_db_taxonomy_table_file::String</code>: Path to a gzipped file containing BLAST taxonomy mappings</li></ul><p><strong>Returns</strong></p><ul><li><code>DataFrame</code>: A DataFrame with columns <code>:sequence_id</code> and <code>:taxid</code> containing the sequence-to-taxonomy mappings</li></ul><p><strong>Format</strong></p><p>Input file should be a space-delimited text file (gzipped) with two columns:</p><ol><li>sequence identifier</li><li>taxonomy identifier (taxid)</li></ol></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL2365">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.load_genbank_metadata-Tuple{}" href="#Mycelia.load_genbank_metadata-Tuple{}"><code>Mycelia.load_genbank_metadata</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">load_genbank_metadata() -&gt; DataFrames.DataFrame
</code></pre><p>Load metadata for GenBank sequences into a DataFrame.</p><p>This is a convenience wrapper around <code>load_ncbi_metadata(&quot;genbank&quot;)</code> that specifically loads metadata from the GenBank database.</p><p><strong>Returns</strong></p><ul><li><code>DataFrame</code>: Contains metadata fields like accession numbers, taxonomy,</li></ul><p>and sequence information from GenBank.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL7308">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.load_graph-Tuple{Any}" href="#Mycelia.load_graph-Tuple{Any}"><code>Mycelia.load_graph</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">load_graph(file) -&gt; Any
</code></pre><p>Load a graph structure from a serialized file.</p><p><strong>Arguments</strong></p><ul><li><code>file::AbstractString</code>: Path to the file containing the serialized graph data</li></ul><p><strong>Returns</strong></p><ul><li>The deserialized graph object</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL10841">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.load_graph-Tuple{String}" href="#Mycelia.load_graph-Tuple{String}"><code>Mycelia.load_graph</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">load_graph(file::String) -&gt; Any
</code></pre><p>Loads a graph object from a serialized file.</p><p><strong>Arguments</strong></p><ul><li><code>file::String</code>: Path to the file containing the serialized graph data. The file should have been created using <code>save_graph</code>.</li></ul><p><strong>Returns</strong></p><ul><li>The deserialized graph object stored under the &quot;graph&quot; key.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL12245">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.load_jellyfish_counts-Tuple{Any}" href="#Mycelia.load_jellyfish_counts-Tuple{Any}"><code>Mycelia.load_jellyfish_counts</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">load_jellyfish_counts(
    jellyfish_counts
) -&gt; DataFrames.DataFrame
</code></pre><p>Load k-mer counts from a Jellyfish output file into a DataFrame.</p><p><strong>Arguments</strong></p><ul><li><code>jellyfish_counts::String</code>: Path to a gzipped TSV file (*.jf.tsv.gz) containing Jellyfish k-mer counts</li></ul><p><strong>Returns</strong></p><ul><li><code>DataFrame</code>: Table with columns:<ul><li><code>kmer</code>: Biologically encoded k-mers as <code>DNAKmer{k}</code> objects</li><li><code>count</code>: Integer count of each k-mer&#39;s occurrences</li></ul></li></ul><p><strong>Notes</strong></p><ul><li>Input file must be a gzipped TSV with exactly two columns (k-mer sequences and counts)</li><li>K-mer length is automatically detected from the first entry</li><li>Filename must end with &#39;.jf.tsv.gz&#39;</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL1251">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.load_jld2-Tuple{Any}" href="#Mycelia.load_jld2-Tuple{Any}"><code>Mycelia.load_jld2</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">load_jld2(filename) -&gt; Any
</code></pre><p>Load data stored in a JLD2 file format.</p><p><strong>Arguments</strong></p><ul><li><code>filename::String</code>: Path to the JLD2 file to load</li></ul><p><strong>Returns</strong></p><ul><li><code>Dict</code>: Dictionary containing the loaded data structures</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL10696">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.load_matrix_jld2-Tuple{Any}" href="#Mycelia.load_matrix_jld2-Tuple{Any}"><code>Mycelia.load_matrix_jld2</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">load_matrix_jld2(filename) -&gt; Any
</code></pre><p>Loads a matrix from a JLD2 file.</p><p><strong>Arguments</strong></p><ul><li><code>filename::String</code>: Path to the JLD2 file containing the matrix under the key &quot;matrix&quot;</li></ul><p><strong>Returns</strong></p><ul><li><code>Matrix</code>: The loaded matrix data</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL10681">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.load_ncbi_metadata-Tuple{Any}" href="#Mycelia.load_ncbi_metadata-Tuple{Any}"><code>Mycelia.load_ncbi_metadata</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">load_ncbi_metadata(db) -&gt; DataFrames.DataFrame
</code></pre><p>Load and parse the assembly summary metadata from NCBI&#39;s FTP server for either GenBank or RefSeq databases.</p><p><strong>Arguments</strong></p><ul><li><code>db::String</code>: Database source, must be either &quot;genbank&quot; or &quot;refseq&quot;</li></ul><p><strong>Returns</strong></p><ul><li><code>DataFrame</code>: Parsed metadata table with properly typed columns including:<ul><li>Integer columns: taxid, species_taxid, genome metrics, and gene counts</li><li>Float columns: gc_percent</li><li>Date columns: seq<em>rel</em>date, annotation_date</li><li>String columns: all other fields</li></ul></li></ul><p><strong>Details</strong></p><p>Downloads the assembly summary file from NCBI&#39;s FTP server and processes it by:</p><ol><li>Parsing the tab-delimited file with commented headers</li><li>Converting numeric strings to proper Integer/Float types</li><li>Parsing date strings to Date objects</li><li>Handling missing values throughout</li></ol></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL7202">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.load_ncbi_taxonomy-Tuple{}" href="#Mycelia.load_ncbi_taxonomy-Tuple{}"><code>Mycelia.load_ncbi_taxonomy</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">load_ncbi_taxonomy(
;
    path_to_taxdump
) -&gt; MetaGraphs.MetaDiGraph{T, Float64} where T&lt;:Integer
</code></pre><p>Downloads and constructs a MetaDiGraph representation of the NCBI taxonomy database.</p><p><strong>Arguments</strong></p><ul><li><code>path_to_taxdump</code>: Directory path where taxonomy files will be downloaded and extracted</li></ul><p><strong>Returns</strong></p><ul><li><code>MetaDiGraph</code>: A directed graph where:<ul><li>Vertices represent taxa with properties:<ul><li><code>:tax_id</code>: NCBI taxonomy identifier</li><li><code>:scientific_name</code>, <code>:common_name</code>, etc.: Name properties</li><li><code>:rank</code>: Taxonomic rank</li><li><code>:division_id</code>, <code>:division_cde</code>, <code>:division_name</code>: Division information</li></ul></li><li>Edges represent parent-child relationships in the taxonomy</li></ul></li></ul><p><strong>Dependencies</strong></p><p>Requires internet connection for initial download. Uses DataFrames, MetaGraphs, and ProgressMeter.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL7423">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.load_refseq_metadata-Tuple{}" href="#Mycelia.load_refseq_metadata-Tuple{}"><code>Mycelia.load_refseq_metadata</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">load_refseq_metadata() -&gt; DataFrames.DataFrame
</code></pre><p>Loads NCBI RefSeq metadata into a DataFrame. RefSeq is NCBI&#39;s curated collection  of genomic, transcript and protein sequences.</p><p><strong>Returns</strong></p><ul><li><code>DataFrame</code>: Contains metadata columns including accession numbers, taxonomic information,</li></ul><p>and sequence details from RefSeq.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL7294">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.local_blast_database_info-Tuple{}" href="#Mycelia.local_blast_database_info-Tuple{}"><code>Mycelia.local_blast_database_info</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">local_blast_database_info(; blastdbs_dir) -&gt; Any
</code></pre><p>Query information about local BLAST databases and return a formatted summary.</p><p><strong>Arguments</strong></p><ul><li><code>blastdbs_dir::String</code>: Directory containing BLAST databases (default: &quot;~/workspace/blastdb&quot;)</li></ul><p><strong>Returns</strong></p><ul><li><code>DataFrame</code> with columns:<ul><li>BLAST database path</li><li>BLAST database molecule type</li><li>BLAST database title</li><li>date of last update</li><li>number of bases/residues</li><li>number of sequences</li><li>number of bytes</li><li>BLAST database format version</li><li>human readable size</li></ul></li></ul><p><strong>Dependencies</strong></p><p>Requires NCBI BLAST+ tools. Will attempt to install via apt-get if not present.</p><p><strong>Side Effects</strong></p><ul><li>May install system packages (ncbi-blast+, perl-doc) using sudo/apt-get</li><li>Filters out numbered database fragments from results</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL6332">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.merge_colors-Tuple{Any, Any}" href="#Mycelia.merge_colors-Tuple{Any, Any}"><code>Mycelia.merge_colors</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">merge_colors(c1, c2) -&gt; Any
</code></pre><p>Merge two colors by calculating their minimal color difference vector.</p><p><strong>Arguments</strong></p><ul><li><code>c1::Color</code>: First color input</li><li><code>c2::Color</code>: Second color input </li></ul><p><strong>Returns</strong></p><ul><li>If colors are equal, returns the input color</li><li>Otherwise returns the color difference vector (c1-c2 or c2-c1) with minimal RGB sum</li></ul><p><strong>Details</strong></p><p>Calculates two difference vectors:</p><ul><li>mix_a = c1 - c2 </li><li>mix_b = c2 - c1</li></ul><p>Returns the difference vector with the smallest sum of RGB components.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL4462">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.merge_fasta_files-Tuple{}" href="#Mycelia.merge_fasta_files-Tuple{}"><code>Mycelia.merge_fasta_files</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">merge_fasta_files(; fasta_files, fasta_file)
</code></pre><p>Join fasta files while adding origin prefixes to the identifiers.</p><p>Does not guarantee uniqueness but will warn if conflicts arise</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL14367">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.metasha256-Tuple{Vector{&lt;:AbstractString}}" href="#Mycelia.metasha256-Tuple{Vector{&lt;:AbstractString}}"><code>Mycelia.metasha256</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">metasha256(
    vector_of_sha256s::Vector{&lt;:AbstractString}
) -&gt; String
</code></pre><p>Compute a single SHA256 hash from multiple SHA256 hashes.</p><p>Takes a vector of hex-encoded SHA256 hashes and produces a new SHA256 hash by:</p><ol><li>Sorting the input hashes lexicographically</li><li>Concatenating them in sorted order</li><li>Computing a new SHA256 hash over the concatenated data</li></ol><p><strong>Arguments</strong></p><ul><li><code>vector_of_sha256s</code>: Vector of hex-encoded SHA256 hash strings</li></ul><p><strong>Returns</strong></p><ul><li>A hex-encoded string representing the computed meta-hash</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL3828">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.minimap_index-Tuple{}" href="#Mycelia.minimap_index-Tuple{}"><code>Mycelia.minimap_index</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">minimap_index(
;
    fasta,
    mem_gb,
    mapping_type,
    threads,
    as_string,
    denominator
)
</code></pre><p>Generate a minimap2 index command and output file path for mapping DNA sequencing reads.</p><p>Run this on the machine you intend to use to map the reads to confirm the index will fit.</p><p><strong>Arguments</strong></p><ul><li><code>fasta</code>: Path to the reference FASTA file to be indexed</li><li><code>mem_gb</code>: Available system memory in gigabytes for indexing</li><li><code>mapping_type</code>: Sequencing technology preset. One of:<ul><li>&quot;map-hifi&quot;: PacBio HiFi reads</li><li>&quot;map-ont&quot;: Oxford Nanopore reads</li><li>&quot;map-pb&quot;: PacBio CLR reads</li><li>&quot;sr&quot;: Short reads</li><li>&quot;lr:hq&quot;: High-quality long reads</li></ul></li><li><code>threads</code>: Number of threads to use for indexing</li><li><code>as_string</code>: Return command as String instead of Cmd (default: false)</li><li><code>denominator</code>: Divisor for calculating index size (default: 10)</li></ul><p><strong>Returns</strong></p><p>Named tuple containing:</p><ul><li><code>cmd</code>: The minimap2 indexing command (as String or Cmd)</li><li><code>outfile</code>: Path to the output index file (.mmi)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL2821">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.minimap_map-Tuple{}" href="#Mycelia.minimap_map-Tuple{}"><code>Mycelia.minimap_map</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">minimap_map(
;
    fasta,
    fastq,
    mapping_type,
    as_string,
    mem_gb,
    threads,
    denominator
)
</code></pre><p>Generate minimap2 alignment commands for sequence mapping.</p><p>aligning and compressing. No sorting or filtering.</p><p>Use shell_only=true to get string command to submit to SLURM</p><p>Creates a command to align reads in FASTQ format to a reference FASTA using minimap2,  followed by SAM compression with pigz. Handles resource allocation and conda environment setup.</p><p><strong>Arguments</strong></p><ul><li><code>fasta</code>: Path to reference FASTA file</li><li><code>fastq</code>: Path to query FASTQ file</li><li><code>mapping_type</code>: Alignment preset (&quot;map-hifi&quot;, &quot;map-ont&quot;, &quot;map-pb&quot;, &quot;sr&quot;, or &quot;lr:hq&quot;)</li><li><code>as_string</code>: If true, returns shell command as string; if false, returns command array</li><li><code>mem_gb</code>: Available memory in GB for indexing (defaults to system free memory)</li><li><code>threads</code>: Number of CPU threads to use (defaults to system threads)</li><li><code>denominator</code>: Divisor for calculating minimap2 index size</li></ul><p><strong>Returns</strong></p><p>Named tuple containing:</p><ul><li><code>cmd</code>: Shell command (as string or array)</li><li><code>outfile</code>: Path to compressed output SAM file</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL2859">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.minimap_map_paired_end-Tuple{}" href="#Mycelia.minimap_map_paired_end-Tuple{}"><code>Mycelia.minimap_map_paired_end</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">minimap_map_paired_end(
;
    fasta,
    forward,
    reverse,
    mem_gb,
    threads,
    outdir,
    as_string,
    mapping_type,
    denominator
)
</code></pre><p>Maps paired-end reads to a reference genome using minimap2 and compresses the output.</p><p><strong>Arguments</strong></p><ul><li><code>fasta::String</code>: Path to reference genome FASTA file</li><li><code>forward::String</code>: Path to forward reads FASTQ file</li><li><code>reverse::String</code>: Path to reverse reads FASTQ file  </li><li><code>mem_gb::Integer</code>: Available system memory in GB</li><li><code>threads::Integer</code>: Number of threads to use</li><li><code>outdir::String</code>: Output directory (defaults to forward reads directory)</li><li><code>as_string::Bool</code>: Return command as string instead of Cmd array</li><li><code>mapping_type::String</code>: Mapping preset, e.g. &quot;sr&quot; for short reads (default)</li><li><code>denominator::Float64</code>: Memory scaling factor for minimap2 index</li></ul><p><strong>Returns</strong></p><p>Named tuple containing:</p><ul><li><code>cmd</code>: Command(s) to execute (String or Vector{Cmd})</li><li><code>outfile</code>: Path to compressed output SAM file (*.sam.gz)</li></ul><p><strong>Dependencies</strong></p><p>Requires bioconda packages: minimap2, samtools, pigz</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL3071">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.minimap_map_paired_end_with_index-Tuple{}" href="#Mycelia.minimap_map_paired_end_with_index-Tuple{}"><code>Mycelia.minimap_map_paired_end_with_index</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">minimap_map_paired_end_with_index(
;
    fasta,
    forward,
    reverse,
    mem_gb,
    threads,
    outdir,
    as_string,
    mapping_type,
    denominator
)
</code></pre><p>Map paired-end reads to a reference sequence using minimap2.</p><p><strong>Arguments</strong></p><ul><li><code>fasta::String</code>: Path to reference FASTA file</li><li><code>forward::String</code>: Path to forward reads FASTQ file</li><li><code>reverse::String</code>: Path to reverse reads FASTQ file</li><li><code>mem_gb::Integer</code>: Available system memory in GB</li><li><code>threads::Integer</code>: Number of threads to use</li><li><code>outdir::String</code>: Output directory (defaults to forward reads directory)</li><li><code>as_string::Bool=false</code>: Return command as string instead of Cmd array</li><li><code>mapping_type::String=&quot;sr&quot;</code>: Minimap2 preset [&quot;map-hifi&quot;, &quot;map-ont&quot;, &quot;map-pb&quot;, &quot;sr&quot;, &quot;lr:hq&quot;]</li><li><code>denominator::Float64</code>: Memory scaling factor for index size</li></ul><p><strong>Returns</strong></p><p>Named tuple containing:</p><ul><li><code>cmd</code>: Command(s) to execute (String or Array{Cmd})</li><li><code>outfile</code>: Path to compressed output SAM file (*.sam.gz)</li></ul><p><strong>Notes</strong></p><ul><li>Requires minimap2, samtools, and pigz conda environments</li><li>Automatically compresses output using pigz</li><li>Index file must exist at <code>$(fasta).x$(mapping_type).I$(index_size).mmi</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL3006">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.minimap_map_with_index-Tuple{}" href="#Mycelia.minimap_map_with_index-Tuple{}"><code>Mycelia.minimap_map_with_index</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">minimap_map_with_index(
;
    fasta,
    mem_gb,
    mapping_type,
    threads,
    fastq,
    as_string,
    denominator
)
</code></pre><p>Generate minimap2 mapping commands with a pre-built index file.</p><p><strong>Arguments</strong></p><ul><li><code>fasta</code>: Path to the reference FASTA file</li><li><code>mem_gb</code>: Available system memory in gigabytes for index generation</li><li><code>mapping_type</code>: Mapping preset. Must be one of: &quot;map-hifi&quot;, &quot;map-ont&quot;, &quot;map-pb&quot;, &quot;sr&quot;, or &quot;lr:hq&quot;</li><li><code>threads</code>: Number of threads to use for mapping and compression</li><li><code>fastq</code>: Path to input FASTQ file</li><li><code>as_string</code>: If true, returns command as a string; if false, returns as command array</li><li><code>denominator</code>: Divisor for index size calculation (default: 10)</li></ul><p><strong>Returns</strong></p><p>Named tuple containing:</p><ul><li><code>cmd</code>: The minimap2 mapping command (string or array)</li><li><code>outfile</code>: Path to the output compressed SAM file</li></ul><p><strong>Notes</strong></p><ul><li>Requires pre-built index file with pattern: <code>${fasta}.x${mapping_type}.I${index_size}.mmi</code></li><li>Automatically installs required conda environments (minimap2, samtools, pigz)</li><li>Output is automatically compressed with pigz</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL2915">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.mmseqs_pairwise_search-Tuple{}" href="#Mycelia.mmseqs_pairwise_search-Tuple{}"><code>Mycelia.mmseqs_pairwise_search</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mmseqs_pairwise_search(; fasta, output)
</code></pre><p>Perform all-vs-all sequence search using MMseqs2&#39;s easy-search command.</p><p><strong>Arguments</strong></p><ul><li><code>fasta::String</code>: Path to input FASTA file containing sequences to compare</li><li><code>output::String</code>: Output directory path (default: input filename + &quot;.mmseqs<em>easy</em>search_pairwise&quot;)</li></ul><p><strong>Returns</strong></p><ul><li><code>String</code>: Path to the output directory</li></ul><p><strong>Details</strong></p><p>Executes MMseqs2 with sensitive search parameters (7 sensitivity steps) and outputs results in  tabular format with the following columns:</p><ul><li>query, qheader: Query sequence ID and header</li><li>target, theader: Target sequence ID and header  </li><li>pident: Percentage sequence identity</li><li>fident: Fraction of identical matches</li><li>nident: Number of identical matches</li><li>alnlen: Alignment length</li><li>mismatch: Number of mismatches</li><li>gapopen: Number of gap openings</li><li>qstart, qend, qlen: Query sequence coordinates and length</li><li>tstart, tend, tlen: Target sequence coordinates and length</li><li>evalue: Expected value</li><li>bits: Bit score</li></ul><p>Requires MMseqs2 to be available through Bioconda.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL869">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.mutate_sequence-Tuple{Any}" href="#Mycelia.mutate_sequence-Tuple{Any}"><code>Mycelia.mutate_sequence</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mutate_sequence(reference_sequence) -&gt; Tuple{Any, Any}
</code></pre><p>Generate a single random mutation in an amino acid sequence.</p><p><strong>Arguments</strong></p><ul><li><code>reference_sequence</code>: Input amino acid sequence to be mutated</li></ul><p><strong>Returns</strong></p><ul><li><code>mutant_sequence</code>: The sequence after applying the mutation</li><li><code>haplotype</code>: A <code>SequenceVariation.Haplotype</code> object containing the mutation details</li></ul><p><strong>Details</strong></p><p>Performs one of three possible mutation types:</p><ul><li>Substitution: Replace one amino acid with another</li><li>Insertion: Insert 1+ random amino acids at a position</li><li>Deletion: Remove 1+ amino acids from a position</li></ul><p>Insertion and deletion sizes follow a truncated Poisson distribution (λ=1, min=1).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL13629">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.n_maximally_distinguishable_colors-Tuple{Any}" href="#Mycelia.n_maximally_distinguishable_colors-Tuple{Any}"><code>Mycelia.n_maximally_distinguishable_colors</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">n_maximally_distinguishable_colors(n) -&gt; Any
</code></pre><p>Generate <code>n</code> colors that are maximally distinguishable from each other.</p><p><strong>Arguments</strong></p><ul><li><code>n::Integer</code>: The number of distinct colors to generate</li></ul><p><strong>Returns</strong></p><p>A vector of <code>n</code> RGB colors that are optimized for maximum perceptual distinction, using white (RGB(1,1,1)) and black (RGB(0,0,0)) as anchor colors.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL4059">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.name2taxid-Tuple{Any}" href="#Mycelia.name2taxid-Tuple{Any}"><code>Mycelia.name2taxid</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">name2taxid(name) -&gt; DataFrames.DataFrame
</code></pre><p>Convert scientific name(s) to NCBI taxonomy ID(s) using taxonkit.</p><p><strong>Arguments</strong></p><ul><li><code>name::AbstractString</code>: Scientific name(s) to query. Can be a single name or multiple names separated by newlines.</li></ul><p><strong>Returns</strong></p><ul><li><code>DataFrame</code> with columns:<ul><li><code>name</code>: Input scientific name</li><li><code>taxid</code>: NCBI taxonomy ID</li><li><code>rank</code>: Taxonomic rank (e.g., &quot;species&quot;, &quot;genus&quot;)</li></ul></li></ul><p><strong>Dependencies</strong></p><p>Requires taxonkit package (installed automatically via Bioconda)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL14756">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.names2taxids-Tuple{AbstractVector{&lt;:AbstractString}}" href="#Mycelia.names2taxids-Tuple{AbstractVector{&lt;:AbstractString}}"><code>Mycelia.names2taxids</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">names2taxids(names::AbstractVector{&lt;:AbstractString}) -&gt; Any
</code></pre><p>Convert a vector of species/taxon names to their corresponding NCBI taxonomy IDs.</p><p><strong>Arguments</strong></p><ul><li><code>names::AbstractVector{&lt;:AbstractString}</code>: Vector of scientific names or common names</li></ul><p><strong>Returns</strong></p><ul><li><code>Vector{Int}</code>: Vector of NCBI taxonomy IDs corresponding to the input names</li></ul><p>Progress is displayed using ProgressMeter.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL14968">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.ncbi_ftp_path_to_url-Tuple{}" href="#Mycelia.ncbi_ftp_path_to_url-Tuple{}"><code>Mycelia.ncbi_ftp_path_to_url</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ncbi_ftp_path_to_url(; ftp_path, extension)
</code></pre><p>Constructs a complete NCBI FTP URL by combining a base FTP path with a file extension.</p><p><strong>Arguments</strong></p><ul><li><code>ftp_path::String</code>: Base FTP directory path for the resource</li><li><code>extension::String</code>: File extension to append to the resource name</li></ul><p><strong>Returns</strong></p><ul><li><code>String</code>: Complete FTP URL path to the requested resource</li></ul><p>Extensions include:</p><ul><li>genomic.fna.gz</li><li>genomic.gff.gz</li><li>protein.faa.gz</li><li>assembly_report.txt</li><li>assembly_stats.txt</li><li>cds<em>from</em>genomic.fna.gz</li><li>feature_count.txt.gz</li><li>feature_table.txt.gz</li><li>genomic.gbff.gz</li><li>genomic.gtf.gz</li><li>protein.gpff.gz</li><li>translated_cds.faa.gz</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL7324">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.ncbi_genome_download_accession-Tuple{}" href="#Mycelia.ncbi_genome_download_accession-Tuple{}"><code>Mycelia.ncbi_genome_download_accession</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ncbi_genome_download_accession(
;
    accession,
    outdir,
    outpath,
    include_string
)
</code></pre><p>Download an accession using NCBI datasets command line tool</p><p>the .zip download output to outpath will be unzipped</p><p>returns the outfolder</p><p>ncbi&#39;s default include string is  include_string = &quot;gff3,rna,cds,protein,genome,seq-report&quot;</p><p>Downloads and extracts a genome from NCBI using the datasets command line tool.</p><p><strong>Arguments</strong></p><ul><li><code>accession</code>: NCBI accession number for the genome</li><li><code>outdir</code>: Directory where files will be downloaded (defaults to current directory)</li><li><code>outpath</code>: Full path for the temporary zip file (defaults to <code>outdir/accession.zip</code>)</li><li><code>include_string</code>: Data types to download (defaults to all &quot;gff3,rna,cds,protein,genome,seq-report&quot;).</li></ul><p><strong>Returns</strong></p><ul><li>Path to the extracted genome data directory</li></ul><p><strong>Notes</strong></p><ul><li>Requires the ncbi-datasets-cli conda package (automatically installed if missing)</li><li>Downloaded zip file is automatically removed after extraction</li><li>If output folder already exists, download is skipped</li><li>Data is extracted to <code>outdir/accession/ncbi_dataset/data/accession</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL10736">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.ncbi_taxon_summary-Tuple{Any}" href="#Mycelia.ncbi_taxon_summary-Tuple{Any}"><code>Mycelia.ncbi_taxon_summary</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ncbi_taxon_summary(taxa_id) -&gt; DataFrames.DataFrame
</code></pre><p>Retrieve taxonomic information for a given NCBI taxonomy ID.</p><p><strong>Arguments</strong></p><ul><li><code>taxa_id</code>: NCBI taxonomy identifier (integer)</li></ul><p><strong>Returns</strong></p><ul><li><code>DataFrame</code>: Taxonomy summary containing fields like tax_id, rank, species, etc.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL1509">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.nearest_prime-Tuple{Int64}" href="#Mycelia.nearest_prime-Tuple{Int64}"><code>Mycelia.nearest_prime</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">nearest_prime(n::Int64) -&gt; Int64
</code></pre><p>Find the closest prime number to the given integer <code>n</code>.</p><p>Returns the nearest prime number to <code>n</code>. If two prime numbers are equally distant  from <code>n</code>, returns the smaller one.</p><p><strong>Arguments</strong></p><ul><li><code>n::Int</code>: The input integer to find the nearest prime for</li></ul><p><strong>Returns</strong></p><ul><li><code>Int</code>: The closest prime number to <code>n</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL1529">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.nersc_sbatch-Tuple{}" href="#Mycelia.nersc_sbatch-Tuple{}"><code>Mycelia.nersc_sbatch</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">nersc_sbatch(
;
    job_name,
    mail_user,
    mail_type,
    logdir,
    scriptdir,
    qos,
    nodes,
    ntasks,
    time,
    cpus_per_task,
    mem_gb,
    cmd,
    constraint
)
</code></pre><p>Submit a batch job to NERSC&#39;s SLURM workload manager.</p><p><strong>Arguments</strong></p><ul><li><code>job_name</code>: Identifier for the SLURM job</li><li><code>mail_user</code>: Email address for job notifications</li><li><code>mail_type</code>: Notification type (&quot;ALL&quot;, &quot;BEGIN&quot;, &quot;END&quot;, &quot;FAIL&quot;, or &quot;NONE&quot;)</li><li><code>logdir</code>: Directory for storing job output/error logs</li><li><code>scriptdir</code>: Directory for storing generated SLURM scripts</li><li><code>qos</code>: Quality of Service level (&quot;regular&quot;, &quot;premium&quot;, or &quot;preempt&quot;)</li><li><code>nodes</code>: Number of nodes to allocate</li><li><code>ntasks</code>: Number of tasks to run</li><li><code>time</code>: Maximum wall time in format &quot;days-HH:MM:SS&quot;</li><li><code>cpus_per_task</code>: CPU cores per task</li><li><code>mem_gb</code>: Memory per node in GB</li><li><code>cmd</code>: Command(s) to execute (String or Vector{String})</li><li><code>constraint</code>: Node type constraint (&quot;cpu&quot; or &quot;gpu&quot;)</li></ul><p><strong>Returns</strong></p><ul><li><code>true</code> if job submission succeeds</li><li><code>false</code> if submission fails</li></ul><p><strong>QoS Options</strong></p><ul><li>regular: Standard priority queue</li><li>premium: High priority queue (5x throughput limit)</li><li>preempt: Reduced credit usage but jobs may be interrupted</li></ul><p>https://docs.nersc.gov/jobs/policy/ https://docs.nersc.gov/systems/perlmutter/architecture/#cpu-nodes</p><p>default is to use shared qos</p><p>use</p><ul><li>regular</li><li>preempt (reduced credit usage but not guaranteed to finish)</li><li>premium (priorty runs limited to 5x throughput)</li></ul><p>https://docs.nersc.gov/systems/perlmutter/running-jobs/#tips-and-tricks</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL472">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.nersc_sbatch_shared-Tuple{}" href="#Mycelia.nersc_sbatch_shared-Tuple{}"><code>Mycelia.nersc_sbatch_shared</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">nersc_sbatch_shared(
;
    job_name,
    mail_user,
    mail_type,
    logdir,
    qos,
    nodes,
    ntasks,
    time,
    cpus_per_task,
    mem_gb,
    cmd,
    constraint
)
</code></pre><p>Submit a job to NERSC&#39;s SLURM scheduler using the shared QOS (Quality of Service).</p><p><strong>Arguments</strong></p><ul><li><code>job_name</code>: Identifier for the job</li><li><code>mail_user</code>: Email address for job notifications</li><li><code>mail_type</code>: Notification type (&quot;ALL&quot;, &quot;BEGIN&quot;, &quot;END&quot;, &quot;FAIL&quot;, &quot;REQUEUE&quot;, &quot;STAGE_OUT&quot;)</li><li><code>logdir</code>: Directory for storing job output and error logs</li><li><code>qos</code>: Quality of Service level (&quot;shared&quot;, &quot;regular&quot;, &quot;preempt&quot;, &quot;premium&quot;)</li><li><code>nodes</code>: Number of nodes to allocate</li><li><code>ntasks</code>: Number of tasks to run</li><li><code>time</code>: Maximum wall time in format &quot;days-hours:minutes:seconds&quot;</li><li><code>cpus_per_task</code>: Number of CPUs per task</li><li><code>mem_gb</code>: Memory per node in GB (default: 2GB per CPU)</li><li><code>cmd</code>: Command to execute</li><li><code>constraint</code>: Node type constraint (&quot;cpu&quot; or &quot;gpu&quot;)</li></ul><p><strong>Resource Limits</strong></p><ul><li>Maximum memory per node: 512GB</li><li>Maximum cores per node: 128</li><li>Default memory allocation: 2GB per CPU requested</li></ul><p><strong>QOS Options</strong></p><ul><li>shared: Default QOS for shared node usage</li><li>regular: Standard priority</li><li>preempt: Reduced credit usage but preemptible</li><li>premium: 5x throughput priority (limited usage)</li></ul><p><strong>Returns</strong></p><p><code>true</code> if job submission succeeds</p><p>https://docs.nersc.gov/jobs/policy/ https://docs.nersc.gov/systems/perlmutter/architecture/#cpu-nodes</p><p>default is to use shared qos</p><p>use</p><ul><li>regular</li><li>preempt (reduced credit usage but not guaranteed to finish)</li><li>premium (priority runs limited to 5x throughput)</li></ul><p>max request is 512Gb memory and 128 cores per node</p><p>https://docs.nersc.gov/systems/perlmutter/running-jobs/#tips-and-tricks</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL388">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.node_type_to_dataframe-Tuple{}" href="#Mycelia.node_type_to_dataframe-Tuple{}"><code>Mycelia.node_type_to_dataframe</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">node_type_to_dataframe(; node_type, graph)
</code></pre><p>Convert all nodes of a specific type in a MetaGraph to a DataFrame representation.</p><p><strong>Arguments</strong></p><ul><li><code>node_type</code>: The type of nodes to extract from the graph</li><li><code>graph</code>: A MetaGraph containing the nodes</li></ul><p><strong>Returns</strong></p><p>A DataFrame where:</p><ul><li>Each row represents a node of the specified type</li><li>Columns correspond to all unique properties found across nodes</li><li>Values are JSON-serialized strings for consistency</li></ul><p><strong>Notes</strong></p><ul><li>All values are normalized through JSON serialization</li><li>Dictionary values receive double JSON encoding</li><li>The TYPE column is converted using <code>type_to_string</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL6712">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.normalize_codon_frequencies-Tuple{Any}" href="#Mycelia.normalize_codon_frequencies-Tuple{Any}"><code>Mycelia.normalize_codon_frequencies</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">normalize_codon_frequencies(
    codon_frequencies
) -&gt; Dict{BioSymbols.AminoAcid, Dict{Kmers.Kmer{BioSequences.DNAAlphabet{2}, 3, 1}, Float64}}
</code></pre><p>Normalizes codon frequencies for each amino acid such that frequencies sum to 1.0.</p><p><strong>Arguments</strong></p><ul><li><code>codon_frequencies</code>: Nested dictionary mapping amino acids to their codon frequency distributions</li></ul><p><strong>Returns</strong></p><ul><li>Normalized codon frequencies where values for each amino acid sum to 1.0</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL12538">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.normalize_countmap-Tuple{Any}" href="#Mycelia.normalize_countmap-Tuple{Any}"><code>Mycelia.normalize_countmap</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">normalize_countmap(countmap) -&gt; Dict
</code></pre><p>Normalize a dictionary of counts into a probability distribution where values sum to 1.0.</p><p><strong>Arguments</strong></p><ul><li><code>countmap::Dict</code>: Dictionary mapping keys to count values</li></ul><p><strong>Returns</strong></p><ul><li><code>Dict</code>: New dictionary with same keys but values normalized by total sum</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL3163">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.normalize_distance_matrix-Tuple{Any}" href="#Mycelia.normalize_distance_matrix-Tuple{Any}"><code>Mycelia.normalize_distance_matrix</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">normalize_distance_matrix(distance_matrix) -&gt; Any
</code></pre><p>Create distance matrix from a column-major counts matrix (features as rows and entities as columns) where distance is a proportional to total feature count magnitude (size) and cosine similarity (relative frequency)</p><p>Normalize a distance matrix by dividing all elements by the maximum non-NaN value.</p><p><strong>Arguments</strong></p><ul><li><code>distance_matrix</code>: A matrix of distance values that may contain <code>NaN</code>, <code>nothing</code>, or <code>missing</code> values</li></ul><p><strong>Returns</strong></p><ul><li>Normalized distance matrix with values scaled to [0, 1] range</li></ul><p><strong>Details</strong></p><ul><li>Filters out <code>NaN</code>, <code>nothing</code>, and <code>missing</code> values when finding the maximum</li><li>All elements are divided by the same maximum value to preserve relative distances</li><li>If all values are NaN/nothing/missing, may return NaN values</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL12971">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.normalize_vcf-Tuple{}" href="#Mycelia.normalize_vcf-Tuple{}"><code>Mycelia.normalize_vcf</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">normalize_vcf(; reference_fasta, vcf_file)
</code></pre><p>Normalize a VCF file using bcftools norm, with automated handling of compression and indexing.</p><p><strong>Arguments</strong></p><ul><li><code>reference_fasta::String</code>: Path to the reference FASTA file used for normalization</li><li><code>vcf_file::String</code>: Path to input VCF file (can be gzipped or uncompressed)</li></ul><p><strong>Returns</strong></p><ul><li><code>String</code>: Path to the normalized, sorted, and compressed output VCF file (*.sorted.normalized.vcf.gz)</li></ul><p><strong>Notes</strong></p><ul><li>Requires bioconda packages: htslib, tabix, bcftools</li><li>Creates intermediate files with extensions .tbi for indices</li><li>Skips processing if output file already exists</li><li>Performs left-alignment and normalization of variants</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL15282">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.normalized_current_datetime-Tuple{}" href="#Mycelia.normalized_current_datetime-Tuple{}"><code>Mycelia.normalized_current_datetime</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">normalized_current_datetime() -&gt; String
</code></pre><p>Returns the current date and time as a normalized string with all non-word characters removed.</p><p>The output format is based on ISO datetime (YYYYMMDDThhmmss) but strips any special characters like hyphens, colons or dots.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL1441">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.observe-Tuple{R} where R&lt;:Union{FASTX.FASTA.Record, FASTX.FASTQ.Record}" href="#Mycelia.observe-Tuple{R} where R&lt;:Union{FASTX.FASTA.Record, FASTX.FASTQ.Record}"><code>Mycelia.observe</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">observe(
    record::Union{FASTX.FASTA.Record, FASTX.FASTQ.Record};
    error_rate
)
</code></pre><p>Simulate sequencing of a DNA/RNA record by introducing random errors at the specified rate.</p><p><strong>Arguments</strong></p><ul><li><code>record</code>: A FASTA or FASTQ record containing the sequence to be &quot;observed&quot;</li><li><code>error_rate</code>: Probability of error at each position (default: 0.0)</li></ul><p><strong>Returns</strong></p><p>A new FASTQ.Record with:</p><ul><li>Random UUID as identifier</li><li>Original record&#39;s description </li><li>Modified sequence with introduced errors</li><li>Generated quality scores</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL13502">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.observe-Union{Tuple{BioSequences.LongSequence{T}}, Tuple{T}} where T" href="#Mycelia.observe-Union{Tuple{BioSequences.LongSequence{T}}, Tuple{T}} where T"><code>Mycelia.observe</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">observe(sequence::BioSequences.LongSequence{T}; error_rate=nothing, tech::Symbol=:illumina) where T</code></pre><p>Simulates the “observation” of a biological polymer (DNA, RNA, or protein) by introducing realistic errors along with base‐quality scores. The simulation takes into account both random and systematic error components. In particular, for technologies:</p><ul><li><strong>illumina</strong>: (mostly substitution errors) the per‐base quality decays along the read (from ~Q40 at the start to ~Q20 at the end);</li><li><strong>nanopore</strong>: errors are more frequent and include both substitutions and indels (with overall lower quality scores, and an extra “homopolymer” penalty);</li><li><strong>pacbio</strong>: errors are dominated by indels (with quality scores typical of raw reads);</li><li><strong>ultima</strong>: (UG 100/ppmSeq™) correct bases are assigned very high quality (~Q60) while errors are extremely rare and, if they occur, are given a modest quality.</li></ul><p>An error is introduced at each position with a (possibly position‐dependent) probability. For Illumina, the error probability increases along the read; additionally, if a base is part of a homopolymer run (length ≥ 3) and the chosen technology is one that struggles with homopolymers (nanopore, pacbio, ultima), then the local error probability is multiplied by a constant factor.</p><p>Returns a tuple <code>(new_seq, quality_scores)</code> where:</p><ul><li><code>new_seq</code> is a <code>BioSequences.LongSequence{T}</code> containing the “observed” sequence (which may be longer or shorter than the input if insertions or deletions occur), and </li><li><code>quality_scores</code> is a vector of integers representing the Phred quality scores (using the Sanger convention) for each base in the output sequence.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL13325-L13341">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.open_fastx-Tuple{AbstractString}" href="#Mycelia.open_fastx-Tuple{AbstractString}"><code>Mycelia.open_fastx</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">open_fastx(
    path::AbstractString
) -&gt; Union{FASTX.FASTA.Reader, FASTX.FASTQ.Reader{T} where T&lt;:(TranscodingStreams.TranscodingStream{C, S} where {S&lt;:IO, C&lt;:TranscodingStreams.Codec})}
</code></pre><p>Open and return a reader for FASTA or FASTQ format files.</p><p><strong>Arguments</strong></p><ul><li><code>path::AbstractString</code>: Path to input file. Can be:<ul><li>Local file path</li><li>HTTP/FTP URL</li><li>Gzip compressed (.gz extension)</li></ul></li></ul><p><strong>Supported formats</strong></p><ul><li>FASTA (.fasta, .fna, .faa, .fa)</li><li>FASTQ (.fastq, .fq)</li></ul><p><strong>Returns</strong></p><ul><li><code>FASTX.FASTA.Reader</code> for FASTA files</li><li><code>FASTX.FASTQ.Reader</code> for FASTQ files</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL12011">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.open_genbank-Tuple{Any}" href="#Mycelia.open_genbank-Tuple{Any}"><code>Mycelia.open_genbank</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">open_genbank(
    genbank_file
) -&gt; Vector{GenomicAnnotations.Record}
</code></pre><p>Opens and parses a GenBank format file containing genomic sequence and annotation data.</p><p><strong>Arguments</strong></p><ul><li><code>genbank_file::AbstractString</code>: Path to the GenBank (.gb or .gbk) file</li></ul><p><strong>Returns</strong></p><ul><li><code>Vector{GenomicAnnotations.Chromosome}</code>: Vector containing parsed chromosome data</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL11098">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.open_gff-Tuple{String}" href="#Mycelia.open_gff-Tuple{String}"><code>Mycelia.open_gff</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">open_gff(path::String) -&gt; Any
</code></pre><p>Opens a GFF (General Feature Format) file for reading.</p><p><strong>Arguments</strong></p><ul><li><code>path::String</code>: Path to GFF file. Can be:<ul><li>Local file path</li><li>HTTP/FTP URL (FTP URLs are automatically converted to HTTP)</li><li>Gzipped file (automatically decompressed)</li></ul></li></ul><p><strong>Returns</strong></p><ul><li><code>IO</code>: An IO stream ready to read the GFF content</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL11339">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.parse_blast_report-Tuple{Any}" href="#Mycelia.parse_blast_report-Tuple{Any}"><code>Mycelia.parse_blast_report</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">parse_blast_report(blast_report) -&gt; DataFrames.DataFrame
</code></pre><p>Expects output type 7 from BLAST, default output type 6 doesn&#39;t have the header comments and won&#39;t auto-parse</p><p>Parse a BLAST output file into a structured DataFrame.</p><p><strong>Arguments</strong></p><ul><li><code>blast_report::AbstractString</code>: Path to a BLAST output file in format 7 (tabular with comments)</li></ul><p><strong>Returns</strong></p><ul><li><code>DataFrame</code>: Table containing BLAST results with columns matching the header fields. Returns empty DataFrame if no hits found.</li></ul><p><strong>Details</strong></p><ul><li>Requires BLAST output format 7 (<code>-outfmt 7</code>), which includes header comments</li><li>Handles missing values (encoded as &quot;N/A&quot;) automatically</li><li>Infers column types based on BLAST field names</li><li>Supports standard BLAST tabular fields including sequence IDs, scores, alignments and taxonomic information</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL11747">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.parse_gfa-Tuple{Any}" href="#Mycelia.parse_gfa-Tuple{Any}"><code>Mycelia.parse_gfa</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">parse_gfa(gfa) -&gt; MetaGraphs.MetaGraph{Int64, Float64}
</code></pre><p>Parse a GFA (Graphical Fragment Assembly) file into a MetaGraph representation.</p><p><strong>Arguments</strong></p><ul><li><code>gfa</code>: Path to GFA format file</li></ul><p><strong>Returns</strong></p><p>A <code>MetaGraph</code> where:</p><ul><li>Vertices represent segments (contigs)</li><li>Edges represent links between segments</li><li>Vertex properties include <code>:id</code> with segment identifiers</li><li>Graph property <code>:records</code> contains the original FASTA records</li></ul><p><strong>Format Support</strong></p><p>Handles standard GFA v1 lines:</p><ul><li><code>H</code>: Header lines (skipped)</li><li><code>S</code>: Segments (stored as nodes with FASTA records)</li><li><code>L</code>: Links (stored as edges)</li><li><code>P</code>: Paths (stored in paths dictionary)</li><li><code>A</code>: HiFiAsm specific lines (skipped)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL3391">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.parse_jsonl-Tuple{String}" href="#Mycelia.parse_jsonl-Tuple{String}"><code>Mycelia.parse_jsonl</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">parse_jsonl(filepath::String) -&gt; Vector{Dict{String, Any}}
</code></pre><p>Parse a JSONL (JSON Lines) file into a vector of dictionaries.</p><p><strong>Arguments</strong></p><ul><li><code>filepath::String</code>: Path to the JSONL file to parse</li></ul><p><strong>Returns</strong></p><ul><li><code>Vector{Dict{String, Any}}</code>: Vector containing parsed JSON objects, one per line</li></ul><p><strong>Description</strong></p><p>Reads a JSONL file line by line, parsing each line as a separate JSON object. Uses pre-allocation and progress tracking for efficient processing of large files.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL3681">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.parse_mmseqs_easy_taxonomy_lca_tsv-Tuple{Any}" href="#Mycelia.parse_mmseqs_easy_taxonomy_lca_tsv-Tuple{Any}"><code>Mycelia.parse_mmseqs_easy_taxonomy_lca_tsv</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">parse_mmseqs_easy_taxonomy_lca_tsv(
    lca_tsv
) -&gt; DataFrames.DataFrame
</code></pre><p>Parse the taxonomic Last Common Ancestor (LCA) TSV output from MMseqs2&#39;s easy-taxonomy workflow.</p><p><strong>Arguments</strong></p><ul><li><code>lca_tsv</code>: Path to the TSV file containing MMseqs2 taxonomy results</li></ul><p><strong>Returns</strong></p><p>DataFrame with columns:</p><ul><li><code>contig_id</code>: Sequence identifier</li><li><code>taxon_id</code>: NCBI taxonomy identifier </li><li><code>taxon_rank</code>: Taxonomic rank (e.g. species, genus)</li><li><code>taxon_name</code>: Scientific name</li><li><code>fragments_retained</code>: Number of fragments kept</li><li><code>fragments_taxonomically_assigned</code>: Number of fragments with taxonomy</li><li><code>fragments_in_agreement_with_assignment</code>: Fragments matching contig taxonomy</li><li><code>support -log(E-value)</code>: Statistical support score</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL11217">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.parse_mmseqs_easy_taxonomy_tophit_report-Tuple{Any}" href="#Mycelia.parse_mmseqs_easy_taxonomy_tophit_report-Tuple{Any}"><code>Mycelia.parse_mmseqs_easy_taxonomy_tophit_report</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">parse_mmseqs_easy_taxonomy_tophit_report(
    tophit_report
) -&gt; DataFrames.DataFrame
</code></pre><p>Parse an MMseqs2 easy-taxonomy tophit report into a structured DataFrame.</p><p><strong>Arguments</strong></p><ul><li><code>tophit_report::String</code>: Path to the MMseqs2 easy-taxonomy tophit report file (tab-delimited)</li></ul><p><strong>Returns</strong></p><ul><li><code>DataFrame</code>: A DataFrame with columns:<ul><li><code>target_id</code>: Target sequence identifier</li><li><code>number of sequences aligning to target</code>: Count of aligned sequences</li><li><code>unique coverage of target</code>: Ratio of uniqueAlignedResidues to targetLength</li><li><code>Target coverage</code>: Ratio of alignedResidues to targetLength</li><li><code>Average sequence identity</code>: Mean sequence identity</li><li><code>taxon_id</code>: Taxonomic identifier</li><li><code>taxon_rank</code>: Taxonomic rank</li><li><code>taxon_name</code>: Species name and lineage</li></ul></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL11176">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.parse_mmseqs_tophit_aln-Tuple{Any}" href="#Mycelia.parse_mmseqs_tophit_aln-Tuple{Any}"><code>Mycelia.parse_mmseqs_tophit_aln</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">parse_mmseqs_tophit_aln(tophit_aln) -&gt; DataFrames.DataFrame
</code></pre><p>Parse MMseqs2 tophit alignment output file into a structured DataFrame.</p><p><strong>Arguments</strong></p><ul><li><code>tophit_aln::AbstractString</code>: Path to tab-delimited MMseqs2 alignment output file</li></ul><p><strong>Returns</strong></p><p>DataFrame with columns:</p><ul><li><code>query</code>: Query sequence/profile identifier</li><li><code>target</code>: Target sequence/profile identifier  </li><li><code>percent identity</code>: Sequence identity percentage</li><li><code>alignment length</code>: Length of alignment</li><li><code>number of mismatches</code>: Count of mismatched positions</li><li><code>number of gaps</code>: Count of gap openings</li><li><code>query start</code>: Start position in query sequence</li><li><code>query end</code>: End position in query sequence</li><li><code>target start</code>: Start position in target sequence</li><li><code>target end</code>: End position in target sequence</li><li><code>evalue</code>: E-value of alignment</li><li><code>bit score</code>: Bit score of alignment</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL11132">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.parse_qualimap_contig_coverage-Tuple{Any}" href="#Mycelia.parse_qualimap_contig_coverage-Tuple{Any}"><code>Mycelia.parse_qualimap_contig_coverage</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">parse_qualimap_contig_coverage(
    qualimap_report_txt
) -&gt; DataFrames.DataFrame
</code></pre><p>Parse contig coverage statistics from a Qualimap BAM QC report file.</p><p><strong>Arguments</strong></p><ul><li><code>qualimap_report_txt::String</code>: Path to Qualimap bamqc report text file</li></ul><p><strong>Returns</strong></p><ul><li><code>DataFrame</code>: Coverage statistics with columns:<ul><li><code>Contig</code>: Contig identifier</li><li><code>Length</code>: Contig length in bases</li><li><code>Mapped bases</code>: Number of bases mapped to contig</li><li><code>Mean coverage</code>: Average coverage depth</li><li><code>Standard Deviation</code>: Standard deviation of coverage</li><li><code>% Mapped bases</code>: Percentage of total mapped bases on this contig</li></ul></li></ul><p><strong>Supported Assemblers</strong></p><p>Handles output from both SPAdes and MEGAHIT assemblers:</p><ul><li>SPAdes format: NODE<em>X</em>length<em>Y</em>cov_Z</li><li>MEGAHIT format: kXX_Y </li></ul><p>Parse the contig coverage information from qualimap bamqc text report, which looks like the following:</p><pre><code class="nohighlight hljs"># this is spades
&gt;&gt;&gt;&gt;&gt;&gt;&gt; Coverage per contig

	NODE_1_length_107478_cov_9.051896	107478	21606903	201.0355886786133	60.39424208607496
	NODE_2_length_5444_cov_1.351945	5444	153263	28.152645113886848	5.954250612823136
	NODE_3_length_1062_cov_0.154390	1062	4294	4.043314500941619	1.6655384692688975
	NODE_4_length_776_cov_0.191489	776	3210	4.13659793814433	2.252009588980858

# below is megahit
&gt;&gt;&gt;&gt;&gt;&gt;&gt; Coverage per contig

	k79_175	235	3862	16.43404255319149	8.437436249612457
	k79_89	303	3803	12.551155115511552	5.709975376279777
	k79_262	394	6671	16.931472081218274	7.579217802849293
	k79_90	379	1539	4.060686015831134	1.2929729111266581
	k79_91	211	3749	17.767772511848342	11.899185693011933
	k79_0	2042	90867	44.49902056807052	18.356525483516613</code></pre><p>To make this more robust, consider reading in the names of the contigs from the assembled fasta</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL11614">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.parse_rtg_eval_output-Tuple{Any}" href="#Mycelia.parse_rtg_eval_output-Tuple{Any}"><code>Mycelia.parse_rtg_eval_output</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">parse_rtg_eval_output(f) -&gt; DataFrames.DataFrame
</code></pre><p>Parse RTG evaluation output from a gzipped tab-separated file.</p><p><strong>Arguments</strong></p><ul><li><code>f</code>: Path to a gzipped TSV file containing RTG evaluation output</li></ul><p><strong>Format</strong></p><p>Expected file format:</p><ul><li>Header line starting with &#39;#&#39; and tab-separated column names</li><li>Data rows in tab-separated format</li><li>Empty files return a DataFrame with empty columns matching header</li></ul><p><strong>Returns</strong></p><p>A DataFrame where:</p><ul><li>Column names are taken from the header line (stripped of &#39;#&#39;)</li><li>Data is parsed as Float64 values</li><li>Empty files result in empty columns preserving header structure</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL1042">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.parse_transterm_output-Tuple{Any}" href="#Mycelia.parse_transterm_output-Tuple{Any}"><code>Mycelia.parse_transterm_output</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">parse_transterm_output(
    transterm_output
) -&gt; DataFrames.DataFrame
</code></pre><p>Parse TransTerm terminator prediction output into a structured DataFrame.</p><p>Takes a TransTerm output file path and returns a DataFrame containing parsed terminator predictions. Each row represents one predicted terminator with the following columns:</p><ul><li><code>chromosome</code>: Identifier of the sequence being analyzed</li><li><code>term_id</code>: Unique terminator identifier (e.g. &quot;TERM 19&quot;)</li><li><code>start</code>: Start position of the terminator</li><li><code>stop</code>: End position of the terminator</li><li><code>strand</code>: Strand orientation (&quot;+&quot; or &quot;-&quot;)</li><li><code>location</code>: Context type, where:<ul><li>G/g = in gene interior (≥50bp from ends)</li><li>F/f = between two +strand genes</li><li>R/r = between two -strand genes</li><li>T = between ends of +strand and -strand genes</li><li>H = between starts of +strand and -strand genes</li><li>N = none of the above</li></ul>Lowercase indicates opposite strand from region</li><li><code>confidence</code>: Overall confidence score (0-100)</li><li><code>hairpin_score</code>: Hairpin structure score</li><li><code>tail_score</code>: Tail sequence score  </li><li><code>notes</code>: Additional annotations (e.g. &quot;bidir&quot;)</li></ul><p><strong>Arguments</strong></p><ul><li><code>transterm_output::AbstractString</code>: Path to TransTerm output file</li></ul><p><strong>Returns</strong></p><ul><li><code>DataFrame</code>: Parsed terminator predictions with columns as described above</li></ul><p>See TransTerm HP documentation for details on scoring and location codes.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL10856">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.parse_virsorter_score_tsv-Tuple{Any}" href="#Mycelia.parse_virsorter_score_tsv-Tuple{Any}"><code>Mycelia.parse_virsorter_score_tsv</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">parse_virsorter_score_tsv(
    virsorter_score_tsv
) -&gt; DataFrames.DataFrame
</code></pre><p>Parse a VirSorter score TSV file and return a DataFrame.</p><p><strong>Arguments</strong></p><ul><li><code>virsorter_score_tsv::String</code>: The file path to the VirSorter score TSV file.</li></ul><p><strong>Returns</strong></p><ul><li><code>DataFrame</code>: A DataFrame containing the parsed data from the TSV file. If the file is empty, returns a DataFrame with the appropriate headers but no data.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL11113">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.parse_xam_to_mapped_records_table" href="#Mycelia.parse_xam_to_mapped_records_table"><code>Mycelia.parse_xam_to_mapped_records_table</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">parse_xam_to_mapped_records_table(
    xam
) -&gt; DataFrames.DataFrame
parse_xam_to_mapped_records_table(
    xam,
    primary_only
) -&gt; DataFrames.DataFrame
</code></pre><p>Parse SAM/BAM files into a DataFrame containing mapped read alignments.</p><p><strong>Arguments</strong></p><ul><li><code>xam::String</code>: Path to input SAM/BAM file (supports .sam, .bam, or .sam.gz)</li><li><code>primary_only::Bool=false</code>: Flag to filter for primary alignments only (currently unused)</li></ul><p><strong>Returns</strong></p><p>DataFrame with columns:</p><ul><li><code>template</code>: Read template name</li><li><code>flag</code>: SAM flag</li><li><code>reference</code>: Reference sequence name</li><li><code>position</code>: Alignment position range</li><li><code>mappingquality</code>: Mapping quality score</li><li><code>tlen</code>: Template length</li><li><code>alignlength</code>: Alignment length</li><li><code>ismapped</code>: Boolean indicating if read is mapped</li><li><code>isprimary</code>: Boolean indicating if alignment is primary</li><li><code>alignment_score</code>: Alignment score (AS tag)</li><li><code>mismatches</code>: Number of mismatches (NM tag)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL2388">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.parse_xam_to_primary_mapping_table-Tuple{Any}" href="#Mycelia.parse_xam_to_primary_mapping_table-Tuple{Any}"><code>Mycelia.parse_xam_to_primary_mapping_table</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">parse_xam_to_primary_mapping_table(
    xam
) -&gt; DataFrames.DataFrame
</code></pre><p>Parse a SAM/BAM alignment file and extract template-to-reference mapping information.</p><p><strong>Arguments</strong></p><ul><li><code>xam::String</code>: Path to input alignment file (.sam, .sam.gz, or .bam format)</li></ul><p><strong>Returns</strong></p><ul><li><code>DataFrame</code>: Table with columns:<ul><li><code>template</code>: Read template names</li><li><code>reference</code>: Reference sequence names</li></ul></li></ul><p>Only includes primary alignments (not secondary/supplementary) that are mapped to references. Skips header lines starting with &#39;@&#39;.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL2464">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.parse_xam_to_summary_table-Tuple{Any}" href="#Mycelia.parse_xam_to_summary_table-Tuple{Any}"><code>Mycelia.parse_xam_to_summary_table</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">parse_xam_to_summary_table(xam) -&gt; DataFrames.DataFrame
</code></pre><p>Parse a SAM/BAM file into a summary DataFrame containing alignment metadata.</p><p><strong>Arguments</strong></p><ul><li><code>xam::AbstractString</code>: Path to input SAM (.sam), BAM (.bam), or gzipped SAM (.sam.gz) file</li></ul><p><strong>Returns</strong></p><p>DataFrame with columns:</p><ul><li><code>template</code>: Read name</li><li><code>flag</code>: SAM flag</li><li><code>reference</code>: Reference sequence name</li><li><code>position</code>: Alignment position range (start:end)</li><li><code>mappingquality</code>: Mapping quality score</li><li><code>alignment_score</code>: Alignment score (AS tag)</li><li><code>isprimary</code>: Whether alignment is primary</li><li><code>alignlength</code>: Length of the alignment</li><li><code>ismapped</code>: Whether read is mapped</li><li><code>mismatches</code>: Number of mismatches (NM tag)</li></ul><p>Note: Only mapped reads are included in the output DataFrame.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL7585">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.parse_xam_to_taxonomic_mapping_quality" href="#Mycelia.parse_xam_to_taxonomic_mapping_quality"><code>Mycelia.parse_xam_to_taxonomic_mapping_quality</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">parse_xam_to_taxonomic_mapping_quality(
    xam
) -&gt; DataFrames.DataFrame
parse_xam_to_taxonomic_mapping_quality(
    xam,
    primary_only
) -&gt; DataFrames.DataFrame
</code></pre><p>Parse alignment data from SAM/BAM files into a structured DataFrame containing mapping quality and taxonomic information.</p><p><strong>Arguments</strong></p><ul><li><code>xam::String</code>: Path to input file (.sam, .bam, or .sam.gz)</li><li><code>primary_only::Bool=false</code>: When true, include only primary alignments (currently not implemented)</li></ul><p><strong>Returns</strong></p><p>DataFrames.DataFrame with columns:</p><ul><li><code>template</code>: Read name</li><li><code>flag</code>: SAM flag</li><li><code>reference</code>: Reference sequence name  </li><li><code>position</code>: Alignment position range</li><li><code>mappingquality</code>: Mapping quality score</li><li><code>tlen</code>: Template length</li><li><code>alignlength</code>: Alignment length</li><li><code>ismapped</code>: Boolean indicating if read is mapped</li><li><code>isprimary</code>: Boolean indicating if alignment is primary</li><li><code>alignment_score</code>: Alignment score (AS tag)</li><li><code>mismatches</code>: Number of mismatches (NM tag)</li></ul><p><strong>Notes</strong></p><ul><li>Skips unmapped reads</li><li>Automatically detects and handles SAM/BAM/compressed SAM formats</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL2513">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.path_to_sequence-Tuple{Any, Any}" href="#Mycelia.path_to_sequence-Tuple{Any, Any}"><code>Mycelia.path_to_sequence</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">path_to_sequence(kmers, path) -&gt; Any
</code></pre><p>Convert a path through k-mers into a single DNA sequence.</p><p>Takes a vector of k-mers and a path representing the order to traverse them, reconstructs the original sequence by joining the k-mers according to the path. The first k-mer is used in full, then only the last nucleotide from each subsequent k-mer is added.</p><p><strong>Arguments</strong></p><ul><li><code>kmers</code>: Vector of DNA k-mers (as LongDNA{4})</li><li><code>path</code>: Vector of tuples representing the path through the k-mers</li></ul><p><strong>Returns</strong></p><ul><li><code>LongDNA{4}</code>: The reconstructed DNA sequence</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL15842">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.pixels_to_points-Tuple{Any}" href="#Mycelia.pixels_to_points-Tuple{Any}"><code>Mycelia.pixels_to_points</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">pixels_to_points(pixels) -&gt; Any
</code></pre><p>Convert pixel measurements to point measurements using the standard 4:3 ratio.</p><p>Points are the standard unit for typography (1 point = 1/72 inch), while pixels are  used for screen measurements. This conversion uses the conventional 4:3 ratio where  3 points equal 4 pixels.</p><p><strong>Arguments</strong></p><ul><li><code>pixels</code>: The number of pixels to convert</li></ul><p><strong>Returns</strong></p><ul><li>The equivalent measurement in points</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL4140">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.plot_graph-Tuple{Any}" href="#Mycelia.plot_graph-Tuple{Any}"><code>Mycelia.plot_graph</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">plot_graph(graph) -&gt; Any
</code></pre><p>Creates a visualization of a kmer graph where nodes represent kmers and their sizes reflect counts.</p><p><strong>Arguments</strong></p><ul><li><code>graph</code>: A MetaGraph where vertices have <code>:kmer</code> and <code>:count</code> properties</li></ul><p><strong>Returns</strong></p><ul><li>A Plots.jl plot object showing the graph visualization</li></ul><p><strong>Details</strong></p><ul><li>Node sizes are scaled based on kmer counts</li><li>Plot dimensions scale logarithmically with number of vertices</li><li>Each node is labeled with its kmer sequence</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL12192">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.plot_kmer_frequency_spectra-Tuple{Any}" href="#Mycelia.plot_kmer_frequency_spectra-Tuple{Any}"><code>Mycelia.plot_kmer_frequency_spectra</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">plot_kmer_frequency_spectra(
    counts;
    log_scale,
    kwargs...
) -&gt; Plots.Plot
</code></pre><p>Plots a histogram of kmer counts against # of kmers with those counts</p><p>Returns the plot object for adding additional layers and saving</p><p>Creates a scatter plot visualizing the k-mer frequency spectrum - the relationship between k-mer frequencies and how many k-mers occur at each frequency.</p><p><strong>Arguments</strong></p><ul><li><code>counts::AbstractVector{&lt;:Integer}</code>: Vector of k-mer counts/frequencies</li><li><code>log_scale::Union{Function,Nothing} = log2</code>: Function to apply logarithmic scaling to both axes. Set to <code>nothing</code> to use linear scaling.</li><li><code>kwargs...</code>: Additional keyword arguments passed to <code>StatsPlots.plot()</code></li></ul><p><strong>Returns</strong></p><ul><li><code>Plots.Plot</code>: A scatter plot object that can be further modified or saved</li></ul><p><strong>Details</strong></p><p>The x-axis shows k-mer frequencies (how many times each k-mer appears), while the y-axis shows how many distinct k-mers appear at each frequency. Both axes are log-scaled by default using log2.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL12090">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.plot_optimal_cluster_assessment_results-Tuple{Any}" href="#Mycelia.plot_optimal_cluster_assessment_results-Tuple{Any}"><code>Mycelia.plot_optimal_cluster_assessment_results</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">plot_optimal_cluster_assessment_results(
    clustering_results
) -&gt; Any
</code></pre><p>Visualizes cluster assessment metrics and saves the resulting plots.</p><p><strong>Arguments</strong></p><ul><li><code>clustering_results</code>: A named tuple containing:<ul><li><code>ks_assessed</code>: Vector of k values tested</li><li><code>within_cluster_sum_of_squares</code>: Vector of WCSS scores</li><li><code>silhouette_scores</code>: Vector of silhouette scores</li><li><code>optimal_number_of_clusters</code>: Integer indicating optimal k</li></ul></li></ul><p><strong>Details</strong></p><p>Creates two plots:</p><ol><li>Within-cluster sum of squares (WCSS) vs number of clusters</li><li>Silhouette scores vs number of clusters</li></ol><p>Both plots include a vertical line indicating the optimal number of clusters.</p><p><strong>Outputs</strong></p><p>Saves two SVG files in the project directory:</p><ul><li><code>wcss.svg</code>: WCSS plot</li><li><code>silhouette.svg</code>: Silhouette scores plot</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL5861">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.points_to_pixels-Tuple{Any}" href="#Mycelia.points_to_pixels-Tuple{Any}"><code>Mycelia.points_to_pixels</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">points_to_pixels(points) -&gt; Any
</code></pre><p>Convert typographic points to pixels using a 4:3 ratio (1 point = 4/3 pixels).</p><p><strong>Arguments</strong></p><ul><li><code>points</code>: Size in typographic points (pt)</li></ul><p><strong>Returns</strong></p><ul><li>Size in pixels (px)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL4159">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.polish_fastq-Tuple{}" href="#Mycelia.polish_fastq-Tuple{}"><code>Mycelia.polish_fastq</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">polish_fastq(; fastq, k)
</code></pre><p>Polish FASTQ reads using a k-mer graph-based approach to correct potential sequencing errors.</p><p><strong>Arguments</strong></p><ul><li><code>fastq::String</code>: Path to input FASTQ file</li><li><code>k::Int=1</code>: Initial k-mer size parameter. Final assembly k-mer size may differ.</li></ul><p><strong>Process</strong></p><ol><li>Builds a directed k-mer graph from input reads</li><li>Processes each read through the graph to find optimal paths</li><li>Writes corrected reads to a new FASTQ file</li><li>Automatically compresses output with gzip</li></ol><p><strong>Returns</strong></p><p>Named tuple with:</p><ul><li><code>fastq::String</code>: Path to output gzipped FASTQ file</li><li><code>k::Int</code>: Final assembly k-mer size used</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL2096">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.prefetch-Tuple{}" href="#Mycelia.prefetch-Tuple{}"><code>Mycelia.prefetch</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">prefetch(; SRR, outdir)
</code></pre><p>Downloads Sequence Read Archive (SRA) data using the prefetch tool from sra-tools.</p><p><strong>Arguments</strong></p><ul><li><code>SRR</code>: SRA accession number (e.g., &quot;SRR12345678&quot;)</li><li><code>outdir</code>: Directory where the downloaded data will be saved. Defaults to current directory.</li></ul><p><strong>Notes</strong></p><ul><li>Requires sra-tools which will be installed in a Conda environment</li><li>Downloads are saved in .sra format</li><li>Internet connection required</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/ncbi.jl#LL6">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.process_fastq_record-Tuple{}" href="#Mycelia.process_fastq_record-Tuple{}"><code>Mycelia.process_fastq_record</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">process_fastq_record(
;
    record,
    kmer_graph,
    yen_k_shortest_paths_and_weights,
    yen_k
)
</code></pre><p>Process and error-correct a FASTQ sequence record using a kmer graph and path resampling.</p><p><strong>Arguments</strong></p><ul><li><code>record</code>: FASTQ record containing the sequence to process</li><li><code>kmer_graph</code>: MetaGraph containing the kmer network and associated properties</li><li><code>yen_k_shortest_paths_and_weights</code>: Cache of pre-computed k-shortest paths between nodes</li><li><code>yen_k</code>: Number of alternative paths to consider during resampling (default: 3)</li></ul><p><strong>Description</strong></p><p>Performs error correction by:</p><ol><li>Trimming low-quality sequence ends</li><li>Identifying stretches requiring resampling between solid branching kmers</li><li>Selecting alternative paths through the kmer graph based on:<ul><li>Path quality scores</li><li>Transition likelihoods</li><li>Path length similarity to original sequence</li></ul></li></ol><p><strong>Returns</strong></p><ul><li>Modified FASTQ record with error-corrected sequence and updated quality scores</li><li>Original record if no error correction was needed</li></ul><p><strong>Required Graph Properties</strong></p><p>The kmer_graph must contain the following properties:</p><ul><li>:ordered_kmers</li><li>:likely<em>valid</em>kmer_indices  </li><li>:kmer_indices</li><li>:branching_nodes</li><li>:assembly_k</li><li>:transition_likelihoods</li><li>:kmer<em>mean</em>quality</li><li>:kmer<em>total</em>quality</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL1917">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.q_value_to_error_rate-Tuple{Any}" href="#Mycelia.q_value_to_error_rate-Tuple{Any}"><code>Mycelia.q_value_to_error_rate</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">q_value_to_error_rate(q_value) -&gt; Any
</code></pre><p>Convert a Phred quality score (Q-value) to a probability of error.</p><p><strong>Arguments</strong></p><ul><li><code>q_value</code>: Phred quality score, typically ranging from 0 to 40</li></ul><p><strong>Returns</strong></p><ul><li>Error probability in range [0,1], where 0 indicates highest confidence</li></ul><p>A Q-value of 10 corresponds to an error rate of 0.1 (10%), while a Q-value of  30 corresponds to an error rate of 0.001 (0.1%).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL13979">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.qc_filter_long_reads_fastplong-Tuple{}" href="#Mycelia.qc_filter_long_reads_fastplong-Tuple{}"><code>Mycelia.qc_filter_long_reads_fastplong</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">qc_filter_long_reads_fastplong(
;
    in_fastq,
    report_title,
    out_fastq,
    html_report,
    json_report,
    min_length,
    max_length
)
</code></pre><p>Perform QC filtering on long-read FASTQ files using fastplong.</p><p><strong>Arguments</strong></p><ul><li><code>in_fastq::String</code>: Path to the input FASTQ file.</li><li><code>out_fastq::String</code>: Path to the output FASTQ file.</li><li><code>quality_threshold::Int</code>: Minimum average quality to retain a read (default 10).</li><li><code>min_length::Int</code>: Minimum read length (default 1000).</li><li><code>max_length::Int=0</code>: Maximum read length (default 0, no maximum).</li></ul><p><strong>Returns</strong></p><ul><li><code>String</code>: Path to the filtered FASTQ file.</li></ul><p><strong>Details</strong></p><p>This function uses fastplong to filter long reads based on quality and length criteria. It is optimized for Oxford Nanopore, PacBio, or similar long-read datasets.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/fastq-qc.jl#LL106">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.qc_filter_long_reads_filtlong-Tuple{}" href="#Mycelia.qc_filter_long_reads_filtlong-Tuple{}"><code>Mycelia.qc_filter_long_reads_filtlong</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">qc_filter_long_reads_filtlong(
;
    in_fastq,
    out_fastq,
    min_mean_q,
    keep_percent
)
</code></pre><p>Filter and process long reads from a FASTQ file using Filtlong.</p><p>This function filters long sequencing reads based on quality and length criteria,  then compresses the output using pigz.</p><p><strong>Arguments</strong></p><ul><li><code>in_fastq::String</code>: Path to the input FASTQ file.</li><li><code>out_fastq::String</code>: Path to the output filtered and compressed FASTQ file.   Defaults to the input filename with &quot;.filtlong.fq.gz&quot; appended.</li><li><code>min_mean_q::Int</code>: Minimum mean quality score for reads to be kept. Default is 20.</li><li><code>keep_percent::Int</code>: Percentage of reads to keep after filtering. Default is 95.</li></ul><p><strong>Returns</strong></p><ul><li><code>out_fastq</code></li></ul><p><strong>Details</strong></p><p>This function uses Filtlong to filter long reads and pigz for compression. It requires the Bioconda environment for Filtlong to be set up, which is handled internally.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/fastq-qc.jl#LL152">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.qc_filter_short_reads_fastp-Tuple{String, String}" href="#Mycelia.qc_filter_short_reads_fastp-Tuple{String, String}"><code>Mycelia.qc_filter_short_reads_fastp</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">qc_filter_short_reads_fastp(
    in_fastq::String,
    out_fastq::String;
    adapter_seq,
    quality_threshold,
    min_length
)
</code></pre><p>Perform quality control (QC) filtering and trimming on short-read FASTQ files using fastp.</p><p><strong>Arguments</strong></p><ul><li><code>in_fastq::String</code>: Path to the input FASTQ file.</li><li><code>out_fastq::String</code>: Path to the output FASTQ file.</li><li><code>adapter_seq::String</code>: Adapter sequence to trim.</li><li><code>quality_threshold::Int</code>: Minimum phred score for trimming (default 20).</li><li><code>min_length::Int</code>: Minimum read length to retain (default 50).</li></ul><p><strong>Returns</strong></p><ul><li><code>String</code>: Path to the filtered and trimmed FASTQ file.</li></ul><p><strong>Details</strong></p><p>This function uses fastp to remove adapter contamination, trim low‐quality bases from the 3′ end, and discard reads shorter than <code>min_length</code>. It’s a simple wrapper that executes the external fastp command.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/fastq-qc.jl#LL81">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.rand_of_each_group-Tuple{DataFrames.GroupedDataFrame{DataFrames.DataFrame}}" href="#Mycelia.rand_of_each_group-Tuple{DataFrames.GroupedDataFrame{DataFrames.DataFrame}}"><code>Mycelia.rand_of_each_group</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">rand_of_each_group(
    gdf::DataFrames.GroupedDataFrame{DataFrames.DataFrame}
) -&gt; Any
</code></pre><p>Select one random row from each group in a grouped DataFrame.</p><p><strong>Arguments</strong></p><ul><li><code>gdf::GroupedDataFrame</code>: A grouped DataFrame created using <code>groupby</code></li></ul><p><strong>Returns</strong></p><ul><li><code>DataFrame</code>: A new DataFrame containing exactly one randomly sampled row from each group</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL3995">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.random_fasta_record-Tuple{}" href="#Mycelia.random_fasta_record-Tuple{}"><code>Mycelia.random_fasta_record</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">random_fasta_record(
;
    moltype,
    seed,
    L
) -&gt; FASTX.FASTA.Record
</code></pre><p>Generates a random FASTA record with a specified molecular type and sequence length.</p><p><strong>Arguments</strong></p><ul><li><code>moltype::Symbol=:DNA</code>: The type of molecule to generate (<code>:DNA</code>, <code>:RNA</code>, or <code>:AA</code> for amino acids).</li><li><code>seed</code>: The random seed used for sequence generation (default: a random integer).</li><li><code>L</code>: The length of the sequence (default: a random integer up to <code>typemax(UInt16)</code>).</li></ul><p><strong>Returns</strong></p><ul><li>A <code>FASTX.FASTA.Record</code> containing:<ul><li>A randomly generated UUID identifier.</li><li>A randomly generated sequence of the specified type.</li></ul></li></ul><p><strong>Errors</strong></p><ul><li>Throws an error if <code>moltype</code> is not one of <code>:DNA</code>, <code>:RNA</code>, or <code>:AA</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL13291">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.random_symmetric_distance_matrix-Tuple{Any}" href="#Mycelia.random_symmetric_distance_matrix-Tuple{Any}"><code>Mycelia.random_symmetric_distance_matrix</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">random_symmetric_distance_matrix(n) -&gt; Any
</code></pre><p>Generate a random symmetric distance matrix of size n×n with zeros on the diagonal.</p><p><strong>Arguments</strong></p><ul><li><code>n</code>: Positive integer specifying the matrix dimensions</li></ul><p><strong>Returns</strong></p><ul><li>A symmetric n×n matrix with random values in [0,1), zeros on the diagonal</li></ul><p><strong>Details</strong></p><ul><li>The matrix is symmetric, meaning M[i,j] = M[j,i]</li><li>Diagonal elements M[i,i] are set to 0.0</li><li>Off-diagonal elements are uniformly distributed random values</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL4013">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.rclone_copy-Tuple{Any, Any}" href="#Mycelia.rclone_copy-Tuple{Any, Any}"><code>Mycelia.rclone_copy</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">rclone_copy(source, dest; config, max_attempts, sleep_timer)
</code></pre><p>Copy files between local and remote storage using rclone with automated retry logic.</p><p><strong>Arguments</strong></p><ul><li><code>source::String</code>: Source path or remote (e.g. &quot;local/path&quot; or &quot;gdrive:folder&quot;)</li><li><code>dest::String</code>: Destination path or remote (e.g. &quot;gdrive:folder&quot; or &quot;local/path&quot;)</li></ul><p><strong>Keywords</strong></p><ul><li><code>config::String=&quot;&quot;</code>: Optional path to rclone config file</li><li><code>max_attempts::Int=3</code>: Maximum number of retry attempts</li><li><code>sleep_timer::Int=60</code>: Initial sleep duration between retries in seconds (doubles after each attempt)</li></ul><p><strong>Details</strong></p><p>Uses optimized rclone settings for large files:</p><ul><li>2GB chunk size</li><li>1TB upload cutoff</li><li>Rate limited to 1 transaction per second</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL1606">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.rclone_list_directories-Tuple{Any}" href="#Mycelia.rclone_list_directories-Tuple{Any}"><code>Mycelia.rclone_list_directories</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">rclone_list_directories(path) -&gt; Any
</code></pre><p>List all directories at the specified rclone path.</p><p><strong>Arguments</strong></p><ul><li><code>path::String</code>: Remote path to list directories from (e.g. &quot;remote:/path/to/dir&quot;)</li></ul><p><strong>Returns</strong></p><ul><li><code>Vector{String}</code>: Full paths to all directories found at the specified location</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL852">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.read_fastani-Tuple{String}" href="#Mycelia.read_fastani-Tuple{String}"><code>Mycelia.read_fastani</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">read_fastani(path::String) -&gt; DataFrames.DataFrame
</code></pre><p>Imports results of fastani</p><p>Reads and processes FastANI output results from a tab-delimited file.</p><p><strong>Arguments</strong></p><ul><li><code>path::String</code>: Path to the FastANI output file</li></ul><p><strong>Returns</strong></p><p>DataFrame with columns:</p><ul><li><code>query</code>: Original query filepath</li><li><code>query_identifier</code>: Extracted filename without extension</li><li><code>reference</code>: Original reference filepath</li><li><code>reference_identifier</code>: Extracted filename without extension</li><li><code>%_identity</code>: ANI percentage identity</li><li><code>fragments_mapped</code>: Number of fragments mapped</li><li><code>total_query_fragments</code>: Total number of query fragments</li></ul><p><strong>Notes</strong></p><ul><li>Expects tab-delimited input file from FastANI</li><li>Automatically strips .fasta, .fna, or .fa extensions from filenames</li><li>Column order is preserved as listed above</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL11672">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.read_gff-Tuple{AbstractString}" href="#Mycelia.read_gff-Tuple{AbstractString}"><code>Mycelia.read_gff</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">read_gff(gff::AbstractString) -&gt; DataFrames.DataFrame
</code></pre><p>Reads a GFF (General Feature Format) file and parses it into a DataFrame.</p><p><strong>Arguments</strong></p><ul><li><code>gff::AbstractString</code>: Path to the GFF file</li></ul><p><strong>Returns</strong></p><ul><li><code>DataFrame</code>: A DataFrame containing the parsed GFF data with standard columns: seqid, source, type, start, end, score, strand, phase, and attributes</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL11369">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.read_gff-Tuple{Any}" href="#Mycelia.read_gff-Tuple{Any}"><code>Mycelia.read_gff</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">read_gff(gff_io) -&gt; DataFrames.DataFrame
</code></pre><p>Read a GFF (General Feature Format) file into a DataFrame.</p><p><strong>Arguments</strong></p><ul><li><code>gff_io</code>: An IO stream containing GFF formatted data</li></ul><p><strong>Returns</strong></p><ul><li><code>DataFrame</code>: A DataFrame with standard GFF columns:<ul><li>seqid: sequence identifier</li><li>source: feature source</li><li>type: feature type</li><li>start: start position (1-based)</li><li>end: end position</li><li>score: numeric score</li><li>strand: strand (+, -, or .)</li><li>phase: phase (0, 1, 2 or .)</li><li>attributes: semicolon-separated key-value pairs</li></ul></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL11385">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.read_kraken_report-Tuple{Any}" href="#Mycelia.read_kraken_report-Tuple{Any}"><code>Mycelia.read_kraken_report</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">read_kraken_report(kraken_report) -&gt; DataFrames.DataFrame
</code></pre><p>Parse a Kraken taxonomic classification report into a structured DataFrame.</p><p><strong>Arguments</strong></p><ul><li><code>kraken_report::AbstractString</code>: Path to a tab-delimited Kraken report file</li></ul><p><strong>Returns</strong></p><ul><li><code>DataFrame</code>: A DataFrame with the following columns:<ul><li><code>percentage_of_fragments_at_or_below_taxon</code>: Percentage of fragments covered</li><li><code>number_of_fragments_at_or_below_taxon</code>: Count of fragments at/below taxon</li><li><code>number_of_fragments_assigned_directly_to_taxon</code>: Direct fragment assignments</li><li><code>rank</code>: Taxonomic rank</li><li><code>ncbi_taxonid</code>: NCBI taxonomy identifier</li><li><code>scientific_name</code>: Scientific name (whitespace-trimmed)</li></ul></li></ul><p><strong>Notes</strong></p><ul><li>Scientific names are automatically stripped of leading/trailing whitespace</li><li>Input file must be tab-delimited</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL11495">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.read_mmseqs_easy_search-Tuple{Any}" href="#Mycelia.read_mmseqs_easy_search-Tuple{Any}"><code>Mycelia.read_mmseqs_easy_search</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">read_mmseqs_easy_search(mmseqs_file) -&gt; DataFrames.DataFrame
</code></pre><p>Read results from MMSeqs2 easy-search output file into a DataFrame.</p><p><strong>Arguments</strong></p><ul><li><code>mmseqs_file::String</code>: Path to the tab-delimited output file from MMSeqs2 easy-search</li></ul><p><strong>Returns</strong></p><ul><li><code>DataFrame</code>: Contains search results with columns:<ul><li><code>query</code>: Query sequence identifier</li><li><code>target</code>: Target sequence identifier</li><li><code>seqIdentity</code>: Sequence identity (0.0-1.0)</li><li><code>alnLen</code>: Alignment length</li><li><code>mismatch</code>: Number of mismatches</li><li><code>gapOpen</code>: Number of gap openings</li><li><code>qStart</code>: Query start position</li><li><code>qEnd</code>: Query end position</li><li><code>tStart</code>: Target start position </li><li><code>tEnd</code>: Target end position</li><li><code>evalue</code>: Expected value</li><li><code>bits</code>: Bit score</li></ul></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL11275">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.reverse_translate-Tuple{BioSequences.LongAA}" href="#Mycelia.reverse_translate-Tuple{BioSequences.LongAA}"><code>Mycelia.reverse_translate</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">reverse_translate(
    protein_sequence::BioSequences.LongAA
) -&gt; BioSequences.LongSequence{BioSequences.DNAAlphabet{2}}
</code></pre><p>Convert a protein sequence back to a possible DNA coding sequence using weighted random codon selection.</p><p><strong>Arguments</strong></p><ul><li><code>protein_sequence::BioSequences.LongAA</code>: The amino acid sequence to reverse translate</li></ul><p><strong>Returns</strong></p><ul><li><code>BioSequences.LongDNA{2}</code>: A DNA sequence that would translate to the input protein sequence</li></ul><p><strong>Details</strong></p><p>Uses codon usage frequencies to randomly select codons for each amino acid, weighted by their  natural occurrence. Each selected codon is guaranteed to translate back to the original amino acid.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL12563">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.rolling_centered_avg-Union{Tuple{AbstractVector{T}}, Tuple{T}} where T" href="#Mycelia.rolling_centered_avg-Union{Tuple{AbstractVector{T}}, Tuple{T}} where T"><code>Mycelia.rolling_centered_avg</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">rolling_centered_avg(data::AbstractArray{T, 1}; window_size)
</code></pre><p>Compute a centered moving average over a vector using a sliding window.</p><p><strong>Arguments</strong></p><ul><li><code>data::AbstractVector{T}</code>: Input vector to be averaged</li><li><code>window_size::Int</code>: Size of the sliding window (odd number recommended)</li></ul><p><strong>Returns</strong></p><ul><li><code>Vector{Float64}</code>: Vector of same length as input containing moving averages</li></ul><p><strong>Details</strong></p><ul><li>For points near the edges, the window is truncated to available data</li><li>Window is centered on each point, using floor(window_size/2) points on each side</li><li>Result type is always Float64 regardless of input type T</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL4642">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.run_blast-Tuple{}" href="#Mycelia.run_blast-Tuple{}"><code>Mycelia.run_blast</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">run_blast(
;
    out_dir,
    fasta,
    blast_db,
    blast_command,
    force,
    remote,
    wait
)
</code></pre><p>Run a BLAST (Basic Local Alignment Search Tool) command with the specified parameters.</p><p><strong>Arguments</strong></p><ul><li><code>out_dir::String</code>: The output directory where the BLAST results will be stored.</li><li><code>fasta::String</code>: The path to the input FASTA file.</li><li><code>blast_db::String</code>: The path to the BLAST database.</li><li><code>blast_command::String</code>: The BLAST command to be executed (e.g., <code>blastn</code>, <code>blastp</code>).</li><li><code>force::Bool</code>: If <code>true</code>, forces the BLAST command to run even if the output file already exists. Default is <code>false</code>.</li><li><code>remote::Bool</code>: If <code>true</code>, runs the BLAST command remotely. Default is <code>false</code>.</li><li><code>wait::Bool</code>: If <code>true</code>, waits for the BLAST command to complete before returning. Default is <code>true</code>.</li></ul><p><strong>Returns</strong></p><ul><li><code>outfile::String</code>: The path to the output file containing the BLAST results.</li></ul><p><strong>Description</strong></p><p>This function constructs and runs a BLAST command based on the provided parameters. It creates the necessary output directory, constructs the output file name, and determines whether the BLAST command needs to be run based on the existence and size of the output file. The function supports both local and remote execution of the BLAST command.</p><p>If <code>force</code> is set to <code>true</code> or the output file does not exist or is empty, the BLAST command is executed. The function logs the command being run and measures the time taken for execution. The output file path is returned upon completion.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL5436">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.run_blastn-Tuple{}" href="#Mycelia.run_blastn-Tuple{}"><code>Mycelia.run_blastn</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">run_blastn(
;
    out_dir,
    fasta,
    blast_db,
    task,
    force,
    remote,
    wait
)
</code></pre><p>Run the BLASTN (Basic Local Alignment Search Tool for Nucleotides) command with specified parameters.</p><p><strong>Arguments</strong></p><ul><li><code>out_dir::String</code>: The output directory where the BLASTN results will be saved.</li><li><code>fasta::String</code>: The path to the input FASTA file containing the query sequences.</li><li><code>blast_db::String</code>: The path to the BLAST database to search against.</li><li><code>task::String</code>: The BLASTN task to perform. Default is &quot;megablast&quot;.</li><li><code>force::Bool</code>: If true, forces the BLASTN command to run even if the output file already exists. Default is false.</li><li><code>remote::Bool</code>: If true, runs the BLASTN command remotely. Default is false.</li><li><code>wait::Bool</code>: If true, waits for the BLASTN command to complete before returning. Default is true.</li></ul><p><strong>Returns</strong></p><ul><li><code>outfile::String</code>: The path to the output file containing the BLASTN results.</li></ul><p><strong>Description</strong></p><p>This function constructs and runs a BLASTN command based on the provided parameters. It creates an output directory if it doesn&#39;t exist, constructs the output file path, and checks if the BLASTN command needs to be run based on the existence and size of the output file. The function supports running the BLASTN command locally or remotely, with options to force re-running and to wait for completion.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL5328">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.run_clustal_omega-Tuple{}" href="#Mycelia.run_clustal_omega-Tuple{}"><code>Mycelia.run_clustal_omega</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">run_clustal_omega(; fasta, outfmt)
</code></pre><p>Run Clustal Omega multiple sequence alignment on a FASTA file.</p><p><strong>Arguments</strong></p><ul><li><code>fasta::String</code>: Path to input FASTA file</li><li><code>outfmt::String=&quot;clustal&quot;</code>: Output format for the alignment</li></ul><p><strong>Returns</strong></p><ul><li><code>String</code>: Path to the output alignment file</li></ul><p><strong>Supported Output Formats</strong></p><ul><li><code>&quot;fasta&quot;</code>: FASTA format</li><li><code>&quot;clustal&quot;</code>: Clustal format</li><li><code>&quot;msf&quot;</code>: MSF format  </li><li><code>&quot;phylip&quot;</code>: PHYLIP format</li><li><code>&quot;selex&quot;</code>: SELEX format</li><li><code>&quot;stockholm&quot;</code>: Stockholm format</li><li><code>&quot;vienna&quot;</code>: Vienna format</li></ul><p><strong>Notes</strong></p><ul><li>Uses Bioconda to manage the Clustal Omega installation</li><li>Caches results - will return existing output file if already generated</li><li>Handles single sequence files gracefully by returning output path without error</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL3523">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.run_ectyper-Tuple{Any}" href="#Mycelia.run_ectyper-Tuple{Any}"><code>Mycelia.run_ectyper</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">run_ectyper(fasta_file) -&gt; Any
</code></pre><p>Run ECTyper for serotyping E. coli genome assemblies.</p><p><strong>Arguments</strong></p><ul><li><code>fasta_file::String</code>: Path to input FASTA file containing assembled genome(s)</li></ul><p><strong>Returns</strong></p><ul><li><code>String</code>: Path to output directory containing ECTyper results</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL3645">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.run_hifiasm-Tuple{}" href="#Mycelia.run_hifiasm-Tuple{}"><code>Mycelia.run_hifiasm</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">run_hifiasm(; fastq, outdir)
</code></pre><p>Run the hifiasm genome assembler on PacBio HiFi reads.</p><p><strong>Arguments</strong></p><ul><li><code>fastq::String</code>: Path to input FASTQ file containing HiFi reads</li><li><code>outdir::String</code>: Output directory path (default: &quot;{basename(fastq)}_hifiasm&quot;)</li></ul><p><strong>Returns</strong></p><p>Named tuple containing:</p><ul><li><code>outdir::String</code>: Path to output directory</li><li><code>hifiasm_outprefix::String</code>: Prefix used for hifiasm output files</li></ul><p><strong>Details</strong></p><ul><li>Automatically creates and uses a conda environment with hifiasm</li><li>Uses primary assembly mode (–primary) optimized for inbred samples</li><li>Skips assembly if output files already exist at the specified prefix</li><li>Utilizes all available CPU threads</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL4496">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.run_mlst-Tuple{Any}" href="#Mycelia.run_mlst-Tuple{Any}"><code>Mycelia.run_mlst</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">run_mlst(fasta_file) -&gt; String
</code></pre><p>Run Multi-Locus Sequence Typing (MLST) analysis on a genome assembly.</p><p><strong>Arguments</strong></p><ul><li><code>fasta_file::String</code>: Path to input FASTA file containing the genome assembly</li></ul><p><strong>Returns</strong></p><ul><li>Path to the output file containing MLST results (<code>&lt;input&gt;.mlst.out</code>)</li></ul><p><strong>Details</strong></p><p>Uses the <code>mlst</code> tool from PubMLST to identify sequence types by comparing allelic  profiles of housekeeping genes against curated MLST schemes.</p><p><strong>Dependencies</strong></p><ul><li>Requires Bioconda and the <code>mlst</code> package</li><li>Automatically sets up conda environment if not present</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL3614">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.run_mmseqs_easy_search-Tuple{}" href="#Mycelia.run_mmseqs_easy_search-Tuple{}"><code>Mycelia.run_mmseqs_easy_search</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">run_mmseqs_easy_search(
;
    query_fasta,
    target_database,
    out_dir,
    outfile,
    format_output,
    threads,
    force
)
</code></pre><p>Runs the MMseqs2 easy-search command on the given query FASTA file against the target database.</p><p><strong>Arguments</strong></p><ul><li><code>query_fasta::String</code>: Path to the query FASTA file.</li><li><code>target_database::String</code>: Path to the target database.</li><li><code>out_dir::String</code>: Directory to store the output file. Defaults to the directory of the query FASTA file.</li><li><code>outfile::String</code>: Name of the output file. Defaults to a combination of the query FASTA and target database filenames.</li><li><code>format_output::String</code>: Format of the output. Defaults to a predefined set of fields.</li><li><code>threads::Int</code>: Number of CPU threads to use. Defaults to the number of CPU threads available.</li><li><code>force::Bool</code>: If true, forces the re-generation of the output file even if it already exists. Defaults to false.</li></ul><p><strong>Returns</strong></p><ul><li><code>outfile_path::String</code>: Path to the generated output file.</li></ul><p><strong>Notes</strong></p><ul><li>Adds the <code>mmseqs2</code> environment using Bioconda if not already present.</li><li>Removes temporary files created during the process.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL5269">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.run_padloc-Tuple{Any}" href="#Mycelia.run_padloc-Tuple{Any}"><code>Mycelia.run_padloc</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">run_padloc(fasta_file) -&gt; Union{Nothing, Base.Process}
</code></pre><p>Run the &#39;padloc&#39; tool from the &#39;padlocbio&#39; conda environment on a given FASTA file.</p><p>https://doi.org/10.1093/nar/gkab883 https://github.com/padlocbio/padloc</p><p>This function first ensures that the &#39;padloc&#39; environment is available via Bioconda.  It then attempts to update the &#39;padloc&#39; database.  If a &#39;padloc&#39; output file (with a &#39;_padloc.csv&#39; suffix) does not already exist for the input FASTA file,  it runs &#39;padloc&#39; with the specified FASTA file as input.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL3590">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.run_parallel_progress-Tuple{Function, AbstractVector}" href="#Mycelia.run_parallel_progress-Tuple{Function, AbstractVector}"><code>Mycelia.run_parallel_progress</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">run_parallel_progress(
    f::Function,
    items::AbstractVector
) -&gt; Any
</code></pre><p>Run a function <code>f</code> in parallel over a collection of <code>items</code> with a progress meter.</p><p><strong>Arguments</strong></p><ul><li><code>f::Function</code>: The function to be applied to each item in the collection.</li><li><code>items::AbstractVector</code>: A collection of items to be processed.</li></ul><p><strong>Description</strong></p><p>This function creates a progress meter to track the progress of processing each item in the <code>items</code> collection.  It uses multithreading to run the function <code>f</code> on each item in parallel, updating the progress meter after each item is processed.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL16344">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.run_prodigal-Tuple{}" href="#Mycelia.run_prodigal-Tuple{}"><code>Mycelia.run_prodigal</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">run_prodigal(; fasta_file, out_dir)
</code></pre><p>Run Prodigal gene prediction software on input FASTA file to identify protein-coding genes in metagenomes or single genomes.</p><p><strong>Arguments</strong></p><ul><li><code>fasta_file::String</code>: Path to input FASTA file containing genomic sequences</li><li><code>out_dir::String=dirname(fasta_file)</code>: Directory for output files. Defaults to input file&#39;s directory</li></ul><p><strong>Returns</strong></p><p>Named tuple containing paths to all output files:</p><ul><li><code>fasta_file</code>: Input FASTA file path</li><li><code>out_dir</code>: Output directory path  </li><li><code>gff</code>: Path to GFF format gene predictions</li><li><code>gene_scores</code>: Path to all potential genes and their scores</li><li><code>fna</code>: Path to nucleotide sequences of predicted genes</li><li><code>faa</code>: Path to protein translations of predicted genes</li><li><code>std_out</code>: Path to captured stdout</li><li><code>std_err</code>: Path to captured stderr</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL5504">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.run_pyrodigal-Tuple{}" href="#Mycelia.run_pyrodigal-Tuple{}"><code>Mycelia.run_pyrodigal</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">run_pyrodigal(; fasta_file, out_dir)
</code></pre><p>Run Pyrodigal gene prediction on a FASTA file using the meta procedure optimized for metagenomic sequences.</p><p>Pyrodigal is a reimplementation of the Prodigal gene finder, which identifies protein-coding sequences in bacterial and archaeal genomes.</p><p><strong>Arguments</strong></p><ul><li><code>fasta_file::String</code>: Path to input FASTA file containing genomic sequences</li><li><code>out_dir::String</code>: Output directory path (default: input filename + &quot;_pyrodigal&quot;)</li></ul><p><strong>Returns</strong></p><p>Named tuple containing:</p><ul><li><code>fasta_file</code>: Input FASTA file path</li><li><code>out_dir</code>: Output directory path</li><li><code>gff</code>: Path to GFF output file with gene predictions</li><li><code>faa</code>: Path to FASTA file with predicted protein sequences </li><li><code>fna</code>: Path to FASTA file with nucleotide sequences</li></ul><p><strong>Notes</strong></p><ul><li>Uses metagenomic mode (<code>-p meta</code>) optimized for mixed communities</li><li>Masks runs of N nucleotides (<code>-m</code> flag)</li><li>Minimum gene length set to 33bp</li><li>Maximum overlap between genes set to 31bp</li><li>Requires Pyrodigal to be available in a Conda environment</li><li>Skips processing if output files already exist</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL5587">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.run_samtools_flagstat" href="#Mycelia.run_samtools_flagstat"><code>Mycelia.run_samtools_flagstat</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">run_samtools_flagstat(xam) -&gt; Any
run_samtools_flagstat(xam, samtools_flagstat) -&gt; Any
</code></pre><p>Generate alignment statistics for a SAM/BAM/CRAM file using samtools flagstat.</p><p><strong>Arguments</strong></p><ul><li><code>xam::AbstractString</code>: Path to input SAM/BAM/CRAM alignment file</li><li><code>samtools_flagstat::AbstractString</code>: Output path for flagstat results (default: input_path.samtools-flagstat.txt)</li></ul><p><strong>Returns</strong></p><ul><li><code>String</code>: Path to the generated flagstat output file</li></ul><p><strong>Details</strong></p><p>Runs samtools flagstat to calculate statistics on the alignment file, including:</p><ul><li>Total reads</li><li>Secondary alignments</li><li>Supplementary alignments  </li><li>Duplicates</li><li>Mapped/unmapped reads</li><li>Proper pairs</li><li>Read 1/2 counts</li></ul><p><strong>Requirements</strong></p><ul><li>Requires samtools to be available via Bioconda</li><li>Input file must be in SAM, BAM or CRAM format</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL3356">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.run_transterm-Tuple{}" href="#Mycelia.run_transterm-Tuple{}"><code>Mycelia.run_transterm</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">run_transterm(; fasta, gff)
</code></pre><p>Run TransTermHP to predict rho-independent transcription terminators in DNA sequences.</p><p><strong>Arguments</strong></p><ul><li><code>fasta</code>: Path to input FASTA file containing DNA sequences</li><li><code>gff</code>: Optional path to GFF annotation file. If provided, improves prediction accuracy</li></ul><p><strong>Returns</strong></p><ul><li><code>String</code>: Path to output file containing TransTermHP predictions</li></ul><p><strong>Details</strong></p><ul><li>Uses Conda environment &#39;transtermhp&#39; for execution</li><li>Automatically generates coordinate file from FASTA or GFF input</li><li>Removes temporary coordinate file after completion</li><li>Requires Mycelia&#39;s Conda setup</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL4694">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.run_trnascan-Tuple{}" href="#Mycelia.run_trnascan-Tuple{}"><code>Mycelia.run_trnascan</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">run_trnascan(; fna_file, outdir)
</code></pre><p>Run tRNAscan-SE to identify and annotate transfer RNA genes in the provided sequence file.</p><p><strong>Arguments</strong></p><ul><li><code>fna_file::String</code>: Path to input FASTA nucleotide file</li><li><code>outdir::String</code>: Output directory path (default: input<em>file</em>path + &quot;_trnascan&quot;)</li></ul><p><strong>Returns</strong></p><ul><li><code>String</code>: Path to the output directory containing tRNAscan-SE results</li></ul><p><strong>Output Files</strong></p><p>Creates the following files in <code>outdir</code>:</p><ul><li><code>*.trnascan.out</code>: Main output with tRNA predictions</li><li><code>*.trnascan.bed</code>: BED format coordinates</li><li><code>*.trnascan.fasta</code>: FASTA sequences of predicted tRNAs</li><li><code>*.trnascan.struct</code>: Secondary structure predictions</li><li><code>*.trnascan.stats</code>: Summary statistics</li><li><code>*.trnascan.log</code>: Program execution log</li></ul><p><strong>Notes</strong></p><ul><li>Uses the general tRNA model (-G flag) suitable for all domains of life</li><li>Automatically sets up tRNAscan-SE via Bioconda</li><li>Skips processing if output directory contains files</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL4945">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.samtools_index_fasta-Tuple{}" href="#Mycelia.samtools_index_fasta-Tuple{}"><code>Mycelia.samtools_index_fasta</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">samtools_index_fasta(; fasta)
</code></pre><p>Creates an index file (.fai) for a FASTA reference sequence using samtools.</p><p>The FASTA index allows efficient random access to the reference sequence. This is  required by many bioinformatics tools that need to quickly fetch subsequences  from the reference.</p><p><strong>Arguments</strong></p><ul><li><code>fasta</code>: Path to the input FASTA file</li></ul><p><strong>Side Effects</strong></p><ul><li>Creates a <code>{fasta}.fai</code> index file in the same directory as input</li><li>Installs samtools via conda if not already present</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL1807">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.save_graph-Tuple{Graphs.AbstractGraph, String}" href="#Mycelia.save_graph-Tuple{Graphs.AbstractGraph, String}"><code>Mycelia.save_graph</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">save_graph(
    graph::Graphs.AbstractGraph,
    outfile::String
) -&gt; String
</code></pre><p>Saves the given graph to a file in JLD2 format.</p><p><strong>Arguments</strong></p><ul><li><code>graph::Graphs.AbstractGraph</code>: The graph to be saved.</li><li><code>outfile::String</code>: The name of the output file. If the file extension is not <code>.jld2</code>, it will be appended automatically.</li></ul><p><strong>Returns</strong></p><ul><li><code>String</code>: The name of the output file with the <code>.jld2</code> extension.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL12225">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.save_matrix_jld2-Tuple{}" href="#Mycelia.save_matrix_jld2-Tuple{}"><code>Mycelia.save_matrix_jld2</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">save_matrix_jld2(; matrix, filename)
</code></pre><p>Saves a matrix to a JLD2 file format.</p><p><strong>Arguments</strong></p><ul><li><code>matrix</code>: The matrix to be saved</li><li><code>filename</code>: String path where the file should be saved</li></ul><p><strong>Returns</strong></p><ul><li>The filename string that was used to save the matrix</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL10659">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.scg_sbatch-Tuple{}" href="#Mycelia.scg_sbatch-Tuple{}"><code>Mycelia.scg_sbatch</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">scg_sbatch(
;
    job_name,
    mail_user,
    mail_type,
    logdir,
    partition,
    account,
    nodes,
    ntasks,
    time,
    cpus_per_task,
    mem_gb,
    cmd
)
</code></pre><p>Submit a job to SLURM using sbatch with specified parameters.</p><p><strong>Arguments</strong></p><ul><li><code>job_name::String</code>: Name identifier for the SLURM job</li><li><code>mail_user::String</code>: Email address for job notifications</li><li><code>mail_type::String</code>: Type of mail notifications (default: &quot;ALL&quot;)</li><li><code>logdir::String</code>: Directory for error and output logs (default: &quot;~/workspace/slurmlogs&quot;)</li><li><code>partition::String</code>: SLURM partition to submit job to</li><li><code>account::String</code>: Account to charge for compute resources</li><li><code>nodes::Int</code>: Number of nodes to allocate (default: 1)</li><li><code>ntasks::Int</code>: Number of tasks to run (default: 1)</li><li><code>time::String</code>: Maximum wall time in format &quot;days-hours:minutes:seconds&quot; (default: &quot;1-00:00:00&quot;)</li><li><code>cpus_per_task::Int</code>: CPUs per task (default: 1)</li><li><code>mem_gb::Int</code>: Memory in GB, defaults to 32GB per CPU</li><li><code>cmd::String</code>: Command to execute</li></ul><p><strong>Returns</strong></p><ul><li><code>Bool</code>: Returns true if submission succeeds</li></ul><p><strong>Notes</strong></p><ul><li>Function includes 5-second delays before and after submission</li><li>Memory is automatically scaled with CPU count</li><li>Log files are named with job ID (%j) and job name (%x)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL325">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.seq2sha256-Tuple{AbstractString}" href="#Mycelia.seq2sha256-Tuple{AbstractString}"><code>Mycelia.seq2sha256</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">seq2sha256(seq::AbstractString) -&gt; String
</code></pre><p>Compute the SHA-256 hash of a sequence string.</p><p><strong>Arguments</strong></p><ul><li><code>seq::AbstractString</code>: Input sequence to be hashed</li></ul><p><strong>Returns</strong></p><ul><li><code>String</code>: Hexadecimal representation of the SHA-256 hash</li></ul><p><strong>Details</strong></p><p>The input sequence is converted to uppercase before hashing.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL3792">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.seq2sha256-Tuple{BioSequences.BioSequence}" href="#Mycelia.seq2sha256-Tuple{BioSequences.BioSequence}"><code>Mycelia.seq2sha256</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">seq2sha256(seq::BioSequences.BioSequence) -&gt; String
</code></pre><p>Convert a biological sequence to its SHA256 hash value.</p><p>Calculates a cryptographic hash of the sequence by first converting it to a string representation. This method dispatches to the string version of <code>seq2sha256</code>.</p><p><strong>Arguments</strong></p><ul><li><code>seq::BioSequences.BioSequence</code>: The biological sequence to hash</li></ul><p><strong>Returns</strong></p><ul><li><code>String</code>: A 64-character hexadecimal string representing the SHA256 hash</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL3810">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.sequence_to_stranded_path-Tuple{Any, Any}" href="#Mycelia.sequence_to_stranded_path-Tuple{Any, Any}"><code>Mycelia.sequence_to_stranded_path</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">sequence_to_stranded_path(
    stranded_kmers,
    sequence
) -&gt; Vector{Pair{Int64, Bool}}
</code></pre><p>Convert a DNA sequence into a path through a collection of stranded k-mers.</p><p><strong>Arguments</strong></p><ul><li><code>stranded_kmers</code>: Collection of unique k-mers representing possible path vertices</li><li><code>sequence</code>: Input DNA sequence to convert to a path</li></ul><p><strong>Returns</strong></p><p>Vector of <code>Pair{Int,Bool}</code> where:</p><ul><li>First element (Int) is the index of the k-mer in <code>stranded_kmers</code></li><li>Second element (Bool) indicates orientation (true=forward, false=reverse)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL15817">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.setup_taxonkit_taxonomy-Tuple{}" href="#Mycelia.setup_taxonkit_taxonomy-Tuple{}"><code>Mycelia.setup_taxonkit_taxonomy</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">setup_taxonkit_taxonomy() -&gt; String
</code></pre><p>Downloads and extracts the NCBI taxonomy database required for taxonkit operations.</p><p>Downloads <code>taxdump.tar.gz</code> from NCBI FTP server and extracts it to <code>~/.taxonkit/</code>. This is a prerequisite for using taxonkit-based taxonomy functions.</p><p><strong>Requirements</strong></p><ul><li>Working internet connection</li><li>Sufficient disk space (~100MB)</li><li><code>taxonkit</code> must be installed separately</li></ul><p><strong>Returns</strong></p><ul><li>Nothing</li></ul><p><strong>Throws</strong></p><ul><li><code>SystemError</code> if download fails or if unable to create directory</li><li><code>ErrorException</code> if tar extraction fails</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL14435">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.sha256_file-Tuple{AbstractString}" href="#Mycelia.sha256_file-Tuple{AbstractString}"><code>Mycelia.sha256_file</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">sha256_file(file::AbstractString) -&gt; String
</code></pre><p>Compute the SHA-256 hash of the contents of a file.</p><p><strong>Arguments</strong></p><ul><li><code>file::AbstractString</code>: The path to the file for which the SHA-256 hash is to be computed.</li></ul><p><strong>Returns</strong></p><ul><li><code>String</code>: The SHA-256 hash of the file contents, represented as a hexadecimal string.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL16328">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.showall_blastdbs-Tuple{}" href="#Mycelia.showall_blastdbs-Tuple{}"><code>Mycelia.showall_blastdbs</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">showall_blastdbs(; source) -&gt; Any
</code></pre><p>Display available BLAST databases from specified source.</p><p><strong>Arguments</strong></p><ul><li><code>source::String=&quot;ncbi&quot;</code>: Database source (default: &quot;ncbi&quot;)</li></ul><p><strong>Returns</strong></p><ul><li><code>DataFrame</code>: Table of available BLAST databases with columns:<ul><li>NAME: Database name</li><li>SIZE (GB): Database size</li><li>LAST_UPDATED: Update date</li><li>and other metadata fields</li></ul></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL6304">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.simulate_nanopore_reads-Tuple{}" href="#Mycelia.simulate_nanopore_reads-Tuple{}"><code>Mycelia.simulate_nanopore_reads</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">simulate_nanopore_reads(; fasta, quantity, outfile)
</code></pre><p>Simulate Oxford Nanopore sequencing reads using the Badread tool with 2023 error models.</p><p><strong>Arguments</strong></p><ul><li><code>fasta::String</code>: Path to input reference FASTA file</li><li><code>quantity::String</code>: Either fold coverage (e.g. &quot;50x&quot;) or total bases to sequence (e.g. &quot;1000000&quot;)</li><li><code>outfile::String</code>: Output path for gzipped FASTQ file. Defaults to input filename with modified extension</li></ul><p><strong>Returns</strong></p><ul><li><code>String</code>: Path to the generated output FASTQ file</li></ul><p>See also: <code>simulate_pacbio_reads</code>, <code>simulate_nearly_perfect_long_reads</code>, <code>simulate_short_reads</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/read-simulation.jl#LL90">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.simulate_nearly_perfect_long_reads-Tuple{}" href="#Mycelia.simulate_nearly_perfect_long_reads-Tuple{}"><code>Mycelia.simulate_nearly_perfect_long_reads</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">simulate_nearly_perfect_long_reads()
</code></pre><p>Simulate high-quality long reads with minimal errors using Badread.</p><p><strong>Arguments</strong></p><ul><li><code>reference::String</code>: Path to reference FASTA file</li><li><code>quantity::String</code>: Coverage depth (e.g. &quot;50x&quot;) or total bases (e.g. &quot;1000000&quot;)</li><li><code>length_mean::Int=40000</code>: Mean read length</li><li><code>length_sd::Int=20000</code>: Standard deviation of read length</li></ul><p><strong>Returns</strong></p><p>Vector of simulated reads in FASTQ format</p><p><strong>Details</strong></p><p>Generates nearly perfect long reads by setting error rates and artifacts to minimum values. Uses ideal quality scores and disables common sequencing artifacts like chimeras and adapters.</p><p>See also: <code>simulate_pacbio_reads</code>, <code>simulate_nanopore_reads</code>, <code>simulate_short_reads</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/read-simulation.jl#LL117">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.simulate_pacbio_reads-Tuple{}" href="#Mycelia.simulate_pacbio_reads-Tuple{}"><code>Mycelia.simulate_pacbio_reads</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">simulate_pacbio_reads(; fasta, quantity, outfile)
</code></pre><p>Simulate PacBio HiFi reads using the Badread error model.</p><p><strong>Arguments</strong></p><ul><li><code>fasta::String</code>: Path to input FASTA file containing reference sequence</li><li><code>quantity::String</code>: Coverage depth (e.g. &quot;50x&quot;) or total bases (e.g. &quot;1000000&quot;) - NOT TOTAL READS</li><li><code>outfile::String</code>: Output filepath for simulated reads. Defaults to input filename with &quot;.badread.pacbio2021.{quantity}.fq.gz&quot; suffix</li></ul><p><strong>Returns</strong></p><ul><li><code>String</code>: Path to the generated output file</li></ul><p><strong>Notes</strong></p><ul><li>Requires Badread tool from Bioconda</li><li>Uses PacBio 2021 error and quality score models</li><li>Average read length ~15kb</li><li>Output is gzipped FASTQ format</li></ul><p>See also: <code>simulate_nanopore_reads</code>, <code>simulate_nearly_perfect_long_reads</code>, <code>simulate_short_reads</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/read-simulation.jl#LL58">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.simulate_short_reads-Tuple{}" href="#Mycelia.simulate_short_reads-Tuple{}"><code>Mycelia.simulate_short_reads</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">simulate_short_reads(; in_fasta, coverage, outbase)
</code></pre><p>Simulate Illumina paired-end short reads from a FASTA file using ART simulator.</p><p><strong>Arguments</strong></p><ul><li><code>in_fasta::String</code>: Input FASTA file path</li><li><code>coverage::Number</code>: Desired read coverage/depth</li><li><code>outbase::String</code>: Prefix for output files (default: &quot;<span>${in_fasta}.art.$</span>{coverage}x.&quot;)</li></ul><p><strong>Outputs</strong></p><p>Generates two gzipped FASTQ files:</p><ul><li><code>${outbase}1.fq.gz</code>: Forward reads</li><li><code>${outbase}2.fq.gz</code>: Reverse reads</li></ul><p><strong>Details</strong></p><p>Uses ART Illumina with the following parameters:</p><ul><li>Read length: 150bp</li><li>Fragment length: 500bp (SD: 10bp)</li><li>Sequencing system: HiSeq 2500 (HS25)</li></ul><p><strong>Dependencies</strong></p><p>Requires ART simulator (automatically installed via Bioconda)</p><p>See also: <code>simulate_nanopore_reads</code>, <code>simulate_nearly_perfect_long_reads</code>, <code>simulate_pacbio_reads</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/read-simulation.jl#LL1">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.simulate_variants-Tuple{FASTX.FASTA.Record}" href="#Mycelia.simulate_variants-Tuple{FASTX.FASTA.Record}"><code>Mycelia.simulate_variants</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">simulate_variants(
    fasta_record::FASTX.FASTA.Record;
    n_variants,
    window_size,
    variant_size_disbribution,
    variant_type_likelihoods
) -&gt; Any
</code></pre><p>Simulates genetic variants (substitutions, insertions, deletions, inversions) in a DNA sequence.</p><p><strong>Arguments</strong></p><ul><li><code>fasta_record</code>: Input DNA sequence in FASTA format</li></ul><p><strong>Keywords</strong></p><ul><li><code>n_variants=√(sequence_length)</code>: Number of variants to generate</li><li><code>window_size=sequence_length/n_variants</code>: Size of windows for variant placement</li><li><code>variant_size_disbribution=Geometric(1/√window_size)</code>: Distribution for variant sizes</li><li><code>variant_type_likelihoods</code>: Vector of pairs mapping variant types to probabilities<ul><li><code>:substitution =&gt; 10⁻¹</code></li><li><code>:insertion =&gt; 10⁻²</code> </li><li><code>:deletion =&gt; 10⁻²</code></li><li><code>:inversion =&gt; 10⁻²</code></li></ul></li></ul><p><strong>Returns</strong></p><p>DataFrame in VCF format containing simulated variants with columns: CHROM, POS, ID, REF, ALT, QUAL, FILTER, INFO, FORMAT, SAMPLE</p><p><strong>Notes</strong></p><ul><li>Variants are distributed across sequence windows to ensure spread</li><li>Variant sizes are capped by window size</li><li>Equivalent variants are filtered out</li><li>FILTER column indicates variant type</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL15017">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.simulate_variants-Tuple{String}" href="#Mycelia.simulate_variants-Tuple{String}"><code>Mycelia.simulate_variants</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">simulate_variants(fasta_file::String) -&gt; String
</code></pre><p>Simulates genetic variants from sequences in a FASTA file and generates corresponding VCF records.</p><p><strong>Arguments</strong></p><ul><li><code>fasta_file::String</code>: Path to input FASTA file containing sequences to analyze</li></ul><p><strong>Details</strong></p><ol><li>Processes each record in the input FASTA file</li><li>Generates simulated variants for each sequence</li><li>Creates a VCF file with the same base name as input file (.vcf extension)</li><li>Updates sequences with simulated variants in a new FASTA file (.vcf.fna extension)</li></ol><p><strong>Returns</strong></p><p>Path to the modified FASTA file containing sequences with simulated variants</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL15143">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.sort_fastq" href="#Mycelia.sort_fastq"><code>Mycelia.sort_fastq</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">sort_fastq(input_fastq) -&gt; String
sort_fastq(input_fastq, output_fastq) -&gt; Any
</code></pre><p>This turns a 4-line FASTQ entry into a single tab separated line, adds a column with the length of each read, passes it to Unix sort, removes the length column, and converts it back into a FASTQ file.</p><p>sorts longest to shortest!!</p><p>http://thegenomefactory.blogspot.com/2012/11/sorting-fastq-files-by-sequence-length.html</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL14070">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.split_gff_attributes_into_columns-Tuple{Any}" href="#Mycelia.split_gff_attributes_into_columns-Tuple{Any}"><code>Mycelia.split_gff_attributes_into_columns</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">split_gff_attributes_into_columns(gff_df) -&gt; Any
</code></pre><p>Takes a GFF (General Feature Format) DataFrame and expands the attributes column into separate columns.</p><p><strong>Arguments</strong></p><ul><li><code>gff_df::DataFrame</code>: A DataFrame containing GFF data with an &#39;attributes&#39; column formatted as key-value pairs separated by semicolons (e.g., &quot;ID=gene1;Name=BRCA1;Type=gene&quot;)</li></ul><p><strong>Returns</strong></p><ul><li><code>DataFrame</code>: The input DataFrame with additional columns for each attribute key found in the &#39;attributes&#39; column</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL11432">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.subsample_reads_seqkit-Tuple{}" href="#Mycelia.subsample_reads_seqkit-Tuple{}"><code>Mycelia.subsample_reads_seqkit</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">subsample_reads_seqkit(
;
    in_fastq,
    out_fastq,
    n_reads,
    proportion_reads
)
</code></pre><p>Subsample reads from a FASTQ file using seqkit.</p><p><strong>Arguments</strong></p><ul><li><code>in_fastq::String</code>: Path to input FASTQ file</li><li><code>out_fastq::String=&quot;&quot;</code>: Path to output FASTQ file. If empty, auto-generated based on input filename</li><li><code>n_reads::Union{Missing,Int}=missing</code>: Number of reads to sample</li><li><code>proportion_reads::Union{Missing,Float64}=missing</code>: Proportion of reads to sample (0.0-1.0)</li></ul><p><strong>Returns</strong></p><ul><li><code>String</code>: Path to the output FASTQ file</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL1004">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.system_mem_to_minimap_index_size-Tuple{}" href="#Mycelia.system_mem_to_minimap_index_size-Tuple{}"><code>Mycelia.system_mem_to_minimap_index_size</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">system_mem_to_minimap_index_size(
;
    system_mem_gb,
    denominator
)
</code></pre><p>Calculate appropriate minimap index size based on available system memory.</p><p>Converts total system memory to a recommended minimap index size by dividing the available memory by a denominator factor. Returns the size as a string with &#39;G&#39; suffix.</p><p><strong>Arguments</strong></p><ul><li><code>system_mem_gb::Number</code>: Total system memory in gigabytes</li><li><code>denominator::Number=DEFAULT_MINIMAP_DENOMINATOR</code>: Divisor to scale down memory allocation</li></ul><p><strong>Returns</strong></p><ul><li><code>String</code>: Formatted memory size string (e.g. &quot;4G&quot;)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL2796">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.system_overview-Tuple{}" href="#Mycelia.system_overview-Tuple{}"><code>Mycelia.system_overview</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">system_overview(
;
    path
) -&gt; @NamedTuple{system_threads::Int64, julia_threads::Int64, total_memory::String, available_memory::String, occupied_memory::String, total_storage::String, available_storage::String, occupied_storage::String}
</code></pre><p>Parse a JSONL (JSON Lines) file into a vector of dictionaries.</p><p><strong>Arguments</strong></p><ul><li><code>filepath::String</code>: Path to the JSONL file to parse</li></ul><p><strong>Returns</strong></p><ul><li><code>Vector{Dict{String, Any}}</code>: Vector containing parsed JSON objects, one per line</li></ul><p><strong>Description</strong></p><p>Reads a JSONL file line by line, parsing each line as a separate JSON object. Uses pre-allocation and progress tracking for efficient processing of large files.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL3715">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.tar_extract-Tuple{}" href="#Mycelia.tar_extract-Tuple{}"><code>Mycelia.tar_extract</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">tar_extract(; tarchive, directory)
</code></pre><p>Extract contents of a gzipped tar archive file to a specified directory.</p><p><strong>Arguments</strong></p><ul><li><code>tarchive::AbstractString</code>: Path to the .tar.gz file to extract</li><li><code>directory::AbstractString=dirname(tarchive)</code>: Target directory for extraction (defaults to the archive&#39;s directory)</li></ul><p><strong>Returns</strong></p><ul><li><code>AbstractString</code>: Path to the directory where contents were extracted</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL1790">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.taxids2lca-Tuple{Vector{Int64}}" href="#Mycelia.taxids2lca-Tuple{Vector{Int64}}"><code>Mycelia.taxids2lca</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">taxids2lca(ids::Vector{Int64}) -&gt; Int64
</code></pre><p>Calculate the Lowest Common Ancestor (LCA) taxonomic ID for a set of input taxonomic IDs.</p><p><strong>Arguments</strong></p><ul><li><code>ids::Vector{Int}</code>: Vector of NCBI taxonomic IDs</li></ul><p><strong>Returns</strong></p><ul><li><code>Int</code>: The taxonomic ID of the lowest common ancestor</li></ul><p><strong>Details</strong></p><p>Uses taxonkit to compute the LCA. Automatically sets up the required taxonomy database  if not already present in <code>~/.taxonkit/</code>.</p><p><strong>Dependencies</strong></p><ul><li>Requires taxonkit (installed via Bioconda)</li><li>Requires taxonomy database (downloaded automatically if missing)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL14931">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.taxids2ncbi_taxonomy_table-Tuple{AbstractVector{Int64}}" href="#Mycelia.taxids2ncbi_taxonomy_table-Tuple{AbstractVector{Int64}}"><code>Mycelia.taxids2ncbi_taxonomy_table</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">taxids2ncbi_taxonomy_table(
    taxids::AbstractVector{Int64}
) -&gt; DataFrames.DataFrame
</code></pre><p>Convert a vector of NCBI taxonomy IDs into a detailed taxonomy table using NCBI Datasets CLI.</p><p><strong>Arguments</strong></p><ul><li><code>taxids::AbstractVector{Int}</code>: Vector of NCBI taxonomy IDs to query</li></ul><p><strong>Returns</strong></p><ul><li><code>DataFrame</code>: Table containing taxonomy information with columns including:<ul><li>tax_id</li><li>species</li><li>genus</li><li>family</li><li>order</li><li>class</li><li>phylum</li><li>kingdom</li></ul></li></ul><p><strong>Dependencies</strong></p><p>Requires ncbi-datasets-cli Conda package (automatically installed if missing)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL14790">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.taxids2taxonkit_summarized_lineage_table-Tuple{AbstractVector{Int64}}" href="#Mycelia.taxids2taxonkit_summarized_lineage_table-Tuple{AbstractVector{Int64}}"><code>Mycelia.taxids2taxonkit_summarized_lineage_table</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">taxids2taxonkit_summarized_lineage_table(
    taxids::AbstractVector{Int64}
) -&gt; DataFrames.DataFrame
</code></pre><p>Convert a vector of taxonomy IDs to a summarized lineage table using taxonkit.</p><p><strong>Arguments</strong></p><ul><li><code>taxids::AbstractVector{Int}</code>: Vector of NCBI taxonomy IDs</li></ul><p><strong>Returns</strong></p><p>DataFrame with the following columns:</p><ul><li><code>taxid</code>: Original input taxonomy ID</li><li><code>species_taxid</code>, <code>species</code>: Species level taxonomy ID and name</li><li><code>genus_taxid</code>, <code>genus</code>: Genus level taxonomy ID and name  </li><li><code>family_taxid</code>, <code>family</code>: Family level taxonomy ID and name</li><li><code>superkingdom_taxid</code>, <code>superkingdom</code>: Superkingdom level taxonomy ID and name</li></ul><p>Missing values are used when a taxonomic rank is not available.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL14892">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.taxids2taxonkit_taxid2lineage_ranks-Tuple{AbstractVector{Int64}}" href="#Mycelia.taxids2taxonkit_taxid2lineage_ranks-Tuple{AbstractVector{Int64}}"><code>Mycelia.taxids2taxonkit_taxid2lineage_ranks</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">taxids2taxonkit_taxid2lineage_ranks(
    taxids::AbstractVector{Int64}
) -&gt; Dict{Int64, Dict{String, @NamedTuple{lineage::String, taxid::Union{Missing, Int64}}}}
</code></pre><p>Convert taxonomic IDs to a structured lineage rank mapping.</p><p>Takes a vector of taxonomic IDs and returns a nested dictionary mapping each input taxid  to its complete taxonomic lineage information. For each taxid, creates a dictionary where:</p><ul><li>Keys are taxonomic ranks (e.g., &quot;species&quot;, &quot;genus&quot;, &quot;family&quot;)</li><li>Values are NamedTuples containing:<ul><li><code>lineage::String</code>: The taxonomic name at that rank</li><li><code>taxid::Union{Int, Missing}</code>: The corresponding taxonomic ID (if available)</li></ul></li></ul><p>Excludes &quot;no rank&quot; entries from the final output.</p><p>Returns:     Dict{Int, Dict{String, NamedTuple{(:lineage, :taxid), Tuple{String, Union{Int, Missing}}}}}</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL14859">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.taxonomic_id_to_children-Tuple{Any}" href="#Mycelia.taxonomic_id_to_children-Tuple{Any}"><code>Mycelia.taxonomic_id_to_children</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">taxonomic_id_to_children(
    tax_id;
    DATABASE_ID,
    USERNAME,
    PASSWORD
)
</code></pre><p>Query Neo4j database to find all descendant taxonomic IDs for a given taxonomic ID.</p><p><strong>Arguments</strong></p><ul><li><code>tax_id</code>: Source taxonomic ID to find children for</li><li><code>DATABASE_ID</code>: Neo4j database identifier (required)</li><li><code>USERNAME</code>: Neo4j database username (default: &quot;neo4j&quot;)</li><li><code>PASSWORD</code>: Neo4j database password (required)</li></ul><p><strong>Returns</strong></p><p><code>Vector{Int}</code>: Sorted array of unique child taxonomic IDs</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL7265">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.translate_nucleic_acid_fasta-Tuple{Any, Any}" href="#Mycelia.translate_nucleic_acid_fasta-Tuple{Any, Any}"><code>Mycelia.translate_nucleic_acid_fasta</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">translate_nucleic_acid_fasta(
    fasta_nucleic_acid_file,
    fasta_amino_acid_file
) -&gt; Any
</code></pre><p>Translates nucleic acid sequences from a FASTA file into amino acid sequences.</p><p><strong>Arguments</strong></p><ul><li><code>fasta_nucleic_acid_file::String</code>: Path to input FASTA file containing nucleic acid sequences</li><li><code>fasta_amino_acid_file::String</code>: Path where the translated amino acid sequences will be written</li></ul><p><strong>Returns</strong></p><ul><li><code>String</code>: Path to the output FASTA file containing translated amino acid sequences</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL14225">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.transterm_output_to_gff-Tuple{Any}" href="#Mycelia.transterm_output_to_gff-Tuple{Any}"><code>Mycelia.transterm_output_to_gff</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">transterm_output_to_gff(transterm_output) -&gt; Any
</code></pre><p>Convert TransTerm terminator predictions output to GFF3 format.</p><p>Parses TransTerm output and generates a standardized GFF3 file with the following transformations:</p><ul><li>Sets source field to &quot;transterm&quot;</li><li>Sets feature type to &quot;terminator&quot;  </li><li>Converts terminator IDs to GFF attributes</li><li>Renames fields to match GFF3 spec</li></ul><p><strong>Arguments</strong></p><ul><li><code>transterm_output::String</code>: Path to the TransTerm output file</li></ul><p><strong>Returns</strong></p><ul><li><code>String</code>: Path to the generated GFF3 file (original filename with .gff extension)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL10939">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.trim_galore-Tuple{}" href="#Mycelia.trim_galore-Tuple{}"><code>Mycelia.trim_galore</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">trim_galore(
;
    outdir,
    identifier
) -&gt; Union{Nothing, Base.Process}
</code></pre><p>Trim paired-end FASTQ reads using Trim Galore, a wrapper around Cutadapt and FastQC.</p><p><strong>Arguments</strong></p><ul><li><code>outdir::String</code>: Output directory containing input FASTQ files</li><li><code>identifier::String</code>: Prefix for input/output filenames</li></ul><p><strong>Input files</strong></p><p>Expects paired FASTQ files in <code>outdir</code> named:</p><ul><li><code>{identifier}_1.fastq.gz</code> (forward reads)</li><li><code>{identifier}_2.fastq.gz</code> (reverse reads)</li></ul><p><strong>Output files</strong></p><p>Creates trimmed reads in <code>outdir/trim_galore/</code>:</p><ul><li><code>{identifier}_1_val_1.fq.gz</code> (trimmed forward reads)</li><li><code>{identifier}_2_val_2.fq.gz</code> (trimmed reverse reads)</li></ul><p><strong>Dependencies</strong></p><p>Requires trim_galore conda environment:</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/fastq-qc.jl#LL1">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.trim_galore_paired-Tuple{}" href="#Mycelia.trim_galore_paired-Tuple{}"><code>Mycelia.trim_galore_paired</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">trim_galore_paired(; forward_reads, reverse_reads, outdir)
</code></pre><p>Trim paired-end FASTQ reads using Trim Galore, a wrapper around Cutadapt and FastQC.</p><p><strong>Arguments</strong></p><ul><li><code>forward_reads::String</code>: Path to forward reads FASTQ file</li><li><code>reverse_reads::String</code>: Path to reverse reads FASTQ file</li><li><code>outdir::String</code>: Output directory for trimmed files</li></ul><p><strong>Returns</strong></p><ul><li><code>Tuple{String, String}</code>: Paths to trimmed forward and reverse read files</li></ul><p><strong>Dependencies</strong></p><p>Requires trim_galore conda environment:</p><ul><li><code>mamba create -n trim_galore -c bioconda trim_galore</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/fastq-qc.jl#LL42">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.type_to_string-Tuple{AbstractString}" href="#Mycelia.type_to_string-Tuple{AbstractString}"><code>Mycelia.type_to_string</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">type_to_string(T::AbstractString) -&gt; Any
</code></pre><p>Converts an AbstractString type to its string representation.</p><p><strong>Arguments</strong></p><ul><li><code>T::AbstractString</code>: The string type to convert</li></ul><p><strong>Returns</strong></p><p>A string representation of the input type</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL6914">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.type_to_string-Tuple{Any}" href="#Mycelia.type_to_string-Tuple{Any}"><code>Mycelia.type_to_string</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">type_to_string(T) -&gt; Any
</code></pre><p>Convert a type to its string representation, with special handling for Kmer types.</p><p><strong>Arguments</strong></p><ul><li><code>T</code>: The type to convert to string</li></ul><p><strong>Returns</strong></p><ul><li>String representation of the type<ul><li>For Kmer types: Returns &quot;Kmers.DNAKmer{K}&quot; where K is the kmer length</li><li>For other types: Returns the standard string representation</li></ul></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL6893">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.update_bioconda_env-Tuple{Any}" href="#Mycelia.update_bioconda_env-Tuple{Any}"><code>Mycelia.update_bioconda_env</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">update_bioconda_env(pkg) -&gt; Base.Process
</code></pre><p>Update a package and its dependencies in its dedicated Conda environment.</p><p><strong>Arguments</strong></p><ul><li><code>pkg::String</code>: Name of the package/environment to update</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL179">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.update_fasta_with_vcf-Tuple{}" href="#Mycelia.update_fasta_with_vcf-Tuple{}"><code>Mycelia.update_fasta_with_vcf</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">update_fasta_with_vcf(; in_fasta, vcf_file, out_fasta)
</code></pre><p>Apply variants from a VCF file to a reference FASTA sequence.</p><p><strong>Arguments</strong></p><ul><li><code>in_fasta</code>: Path to input reference FASTA file</li><li><code>vcf_file</code>: Path to input VCF file containing variants</li><li><code>out_fasta</code>: Optional output path for modified FASTA. Defaults to replacing &#39;.vcf&#39; with &#39;.normalized.vcf.fna&#39;</li></ul><p><strong>Details</strong></p><ol><li>Normalizes indels in the VCF using bcftools norm</li><li>Applies variants to the reference sequence using bcftools consensus</li><li>Handles temporary files and compression with bgzip/tabix</li></ol><p><strong>Requirements</strong></p><p>Requires bioconda packages: htslib, tabix, bcftools</p><p><strong>Returns</strong></p><p>Path to the output FASTA file containing the modified sequence</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL15214">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.update_gff_with_mmseqs-Tuple{Any, Any}" href="#Mycelia.update_gff_with_mmseqs-Tuple{Any, Any}"><code>Mycelia.update_gff_with_mmseqs</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">update_gff_with_mmseqs(gff_file, mmseqs_file)
</code></pre><p>Update GFF annotations with protein descriptions from MMseqs2 search results.</p><p><strong>Arguments</strong></p><ul><li><code>gff_file::String</code>: Path to input GFF3 format file</li><li><code>mmseqs_file::String</code>: Path to MMseqs2 easy-search output file</li></ul><p><strong>Returns</strong></p><ul><li><code>DataFrame</code>: Modified GFF table with updated attribute columns containing protein descriptions</li></ul><p><strong>Details</strong></p><p>Takes sequence matches from MMseqs2 and adds their descriptions as &#39;label&#39; and &#39;product&#39;  attributes in the GFF file. Only considers top hits from MMseqs2 results. Preserves existing  GFF attributes while prepending new annotations.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL11303">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.upload_edge_type_over_url_from_graph-Tuple{}" href="#Mycelia.upload_edge_type_over_url_from_graph-Tuple{}"><code>Mycelia.upload_edge_type_over_url_from_graph</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">upload_edge_type_over_url_from_graph(
;
    src_type,
    dst_type,
    edge_type,
    graph,
    ADDRESS,
    USERNAME,
    PASSWORD,
    DATABASE,
    window_size
)
</code></pre><p>Upload edges of a specific type from a MetaGraph to a Neo4j database, batching uploads in windows.</p><p><strong>Arguments</strong></p><ul><li><code>src_type</code>: Type of source nodes to filter</li><li><code>dst_type</code>: Type of destination nodes to filter  </li><li><code>edge_type</code>: Type of edges to upload</li><li><code>graph</code>: MetaGraph containing the nodes and edges</li><li><code>ADDRESS</code>: Neo4j server URL</li><li><code>USERNAME</code>: Neo4j username (default: &quot;neo4j&quot;)</li><li><code>PASSWORD</code>: Neo4j password</li><li><code>DATABASE</code>: Neo4j database name (default: &quot;neo4j&quot;)</li><li><code>window_size</code>: Number of edges to upload in each batch (default: 100)</li></ul><p><strong>Details</strong></p><ul><li>Filters edges based on source, destination and edge types</li><li>Preserves all edge properties except :TYPE when uploading</li><li>Uses MERGE operations to avoid duplicate nodes/relationships</li><li>Uploads are performed in batches for better performance</li><li>Progress is shown via ProgressMeter</li></ul><p><strong>Returns</strong></p><p>Nothing</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL7036">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.upload_node_over_api-Tuple{Any, Any}" href="#Mycelia.upload_node_over_api-Tuple{Any, Any}"><code>Mycelia.upload_node_over_api</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">upload_node_over_api(
    graph,
    v;
    ADDRESS,
    USERNAME,
    PASSWORD,
    DATABASE
)
</code></pre><p>Upload a single node from a MetaGraph to a Neo4j database using the HTTP API.</p><p><strong>Arguments</strong></p><ul><li><code>graph</code>: MetaGraph containing the node to be uploaded</li><li><code>v</code>: Vertex identifier in the graph</li><li><code>ADDRESS</code>: Neo4j server address (e.g. &quot;http://localhost:7474&quot;)</li><li><code>USERNAME</code>: Neo4j authentication username (default: &quot;neo4j&quot;)</li><li><code>PASSWORD</code>: Neo4j authentication password</li><li><code>DATABASE</code>: Target Neo4j database name (default: &quot;neo4j&quot;)</li></ul><p><strong>Details</strong></p><p>Generates and executes a Cypher MERGE command using the node&#39;s properties. The node&#39;s :TYPE  and :identifier properties are used for node labeling, while other non-empty properties  are added as node properties.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL6800">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.upload_node_table-Tuple{}" href="#Mycelia.upload_node_table-Tuple{}"><code>Mycelia.upload_node_table</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">upload_node_table(
;
    table,
    window_size,
    address,
    password,
    username,
    database,
    neo4j_import_dir
)
</code></pre><p>Upload a DataFrame to Neo4j as nodes in batched windows.</p><p><strong>Arguments</strong></p><ul><li><code>table::DataFrame</code>: Input DataFrame where each row becomes a node. Must contain a &quot;TYPE&quot; column.</li><li><code>address::String</code>: Neo4j server address (e.g. &quot;bolt://localhost:7687&quot;)</li><li><code>password::String</code>: Neo4j database password</li><li><code>neo4j_import_dir::String</code>: Directory path accessible to Neo4j for importing files</li><li><code>window_size::Int=1000</code>: Number of rows to process in each batch</li><li><code>username::String=&quot;neo4j&quot;</code>: Neo4j database username</li><li><code>database::String=&quot;neo4j&quot;</code>: Target Neo4j database name</li></ul><p><strong>Notes</strong></p><ul><li>All rows must have the same node type (specified in &quot;TYPE&quot; column)</li><li>Column names become node properties</li><li>Requires write permissions on neo4j<em>import</em>dir</li><li>Large tables are processed in batches of size window_size</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL6752">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.upload_node_type_over_url_from_graph-Tuple{}" href="#Mycelia.upload_node_type_over_url_from_graph-Tuple{}"><code>Mycelia.upload_node_type_over_url_from_graph</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">upload_node_type_over_url_from_graph(
;
    node_type,
    graph,
    ADDRESS,
    USERNAME,
    PASSWORD,
    DATABASE,
    window_size
)
</code></pre><p>Upload nodes of a specific type from a graph to a Neo4j database using MERGE operations.</p><p><strong>Arguments</strong></p><ul><li><code>node_type</code>: The type label for the nodes to upload</li><li><code>graph</code>: Source MetaGraph containing the nodes</li><li><code>ADDRESS</code>: Neo4j server address (e.g. &quot;bolt://localhost:7687&quot;)</li><li><code>PASSWORD</code>: Neo4j database password</li><li><code>USERNAME=&quot;neo4j&quot;</code>: Neo4j username (defaults to &quot;neo4j&quot;)</li><li><code>DATABASE=&quot;neo4j&quot;</code>: Target Neo4j database name (defaults to &quot;neo4j&quot;)</li><li><code>window_size=100</code>: Number of nodes to upload in each batch (defaults to 100)</li></ul><p><strong>Details</strong></p><p>Performs batched uploads of nodes using Neo4j MERGE operations. Node properties are  automatically extracted from the graph vertex properties, excluding the &#39;TYPE&#39; property.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL6995">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.upload_nodes_over_api-Tuple{Any}" href="#Mycelia.upload_nodes_over_api-Tuple{Any}"><code>Mycelia.upload_nodes_over_api</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">upload_nodes_over_api(
    graph;
    ADDRESS,
    USERNAME,
    PASSWORD,
    DATABASE
)
</code></pre><p>Uploads all nodes from the given graph to a specified API endpoint.</p><p><strong>Arguments</strong></p><ul><li><code>graph</code>: The graph containing the nodes to be uploaded.</li><li><code>ADDRESS</code>: The API endpoint address.</li><li><code>USERNAME</code>: The username for authentication (default: &quot;neo4j&quot;).</li><li><code>PASSWORD</code>: The password for authentication.</li><li><code>DATABASE</code>: The database name (default: &quot;neo4j&quot;).</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL6837">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.upload_nodes_to_neo4j-Tuple{}" href="#Mycelia.upload_nodes_to_neo4j-Tuple{}"><code>Mycelia.upload_nodes_to_neo4j</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">upload_nodes_to_neo4j(
;
    graph,
    address,
    username,
    password,
    format,
    database,
    neo4j_import_directory
)
</code></pre><p>Upload all nodes from a MetaGraph to a Neo4j database, processing each unique node type separately.</p><p><strong>Arguments</strong></p><ul><li><code>graph</code>: A MetaGraph containing nodes to be uploaded</li><li><code>address</code>: Neo4j server address (e.g., &quot;bolt://localhost:7687&quot;)</li><li><code>username</code>: Neo4j authentication username (default: &quot;neo4j&quot;)</li><li><code>password</code>: Neo4j authentication password</li><li><code>format</code>: Data format for upload (default: &quot;auto&quot;)</li><li><code>database</code>: Target Neo4j database name (default: &quot;neo4j&quot;)</li><li><code>neo4j_import_directory</code>: Path to Neo4j&#39;s import directory for bulk loading</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL6680">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.vcat_with_missing-Tuple{Vararg{DataFrames.AbstractDataFrame}}" href="#Mycelia.vcat_with_missing-Tuple{Vararg{DataFrames.AbstractDataFrame}}"><code>Mycelia.vcat_with_missing</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">vcat_with_missing(
    dfs::DataFrames.AbstractDataFrame...
) -&gt; Union{DataFrames.DataFrame, Vector{Any}}
</code></pre><p>Vertically concatenate DataFrames with different column structures by automatically handling missing values.</p><p><strong>Arguments</strong></p><ul><li><code>dfs</code>: Variable number of DataFrames to concatenate vertically</li></ul><p><strong>Returns</strong></p><ul><li><code>DataFrame</code>: Combined DataFrame containing all rows and columns from input DataFrames,  with <code>missing</code> values where columns didn&#39;t exist in original DataFrames</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL3750">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.visualize_genome_coverage-Tuple{Any}" href="#Mycelia.visualize_genome_coverage-Tuple{Any}"><code>Mycelia.visualize_genome_coverage</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">visualize_genome_coverage(coverage_table) -&gt; Any
</code></pre><p>Creates a multi-panel visualization of genome coverage across chromosomes.</p><p><strong>Arguments</strong></p><ul><li><code>coverage_table</code>: DataFrame containing columns &quot;chromosome&quot; and &quot;coverage&quot; with genomic coverage data</li></ul><p><strong>Returns</strong></p><ul><li><code>Plots.Figure</code>: A composite figure with coverage plots for each chromosome</li></ul><p><strong>Details</strong></p><p>Generates one subplot per chromosome, arranged vertically. Each subplot shows the coverage  distribution across genomic positions for that chromosome.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL4670">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.viterbi_maximum_likelihood_traversals-Tuple{Any}" href="#Mycelia.viterbi_maximum_likelihood_traversals-Tuple{Any}"><code>Mycelia.viterbi_maximum_likelihood_traversals</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">viterbi_maximum_likelihood_traversals(
    stranded_kmer_graph;
    error_rate,
    verbosity
) -&gt; Vector{FASTX.FASTA.Record}
</code></pre><p>Finds maximum likelihood paths through a stranded k-mer graph using the Viterbi algorithm to correct sequencing errors.</p><p><strong>Arguments</strong></p><ul><li><code>stranded_kmer_graph</code>: A directed graph where vertices represent k-mers and edges represent overlaps</li><li><code>error_rate::Float64</code>: Expected per-base error rate (default: 1/(k+1)). Must be &lt; 0.5</li><li><code>verbosity::String</code>: Output detail level (&quot;debug&quot;, &quot;reads&quot;, or &quot;dataset&quot;)</li></ul><p><strong>Returns</strong></p><p>Vector of FASTX.FASTA.Record containing error-corrected sequences</p><p><strong>Details</strong></p><ul><li>Uses dynamic programming to find most likely path through k-mer graph</li><li>Accounts for matches, mismatches, insertions and deletions</li><li>State likelihoods based on k-mer coverage counts</li><li>Transition probabilities derived from error rate</li><li>Progress tracking based on verbosity level</li></ul><p><strong>Notes</strong></p><ul><li>Error rate should be probability of error (e.g. 0.01 for 1%), not accuracy</li><li>Higher verbosity levels (&quot;debug&quot;, &quot;reads&quot;) provide detailed path finding information</li><li>&quot;dataset&quot; verbosity shows only summary statistics</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL15901">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.wcss-Tuple{Any}" href="#Mycelia.wcss-Tuple{Any}"><code>Mycelia.wcss</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">wcss(clustering_result) -&gt; Any
</code></pre><p>Calculate the Within-Cluster Sum of Squares (WCSS) for a clustering result.</p><p><strong>Arguments</strong></p><ul><li><code>clustering_result</code>: A clustering result object containing:<ul><li><code>counts</code>: Vector with number of points in each cluster</li><li><code>assignments</code>: Vector of cluster assignments for each point</li><li><code>costs</code>: Vector of distances/costs from each point to its cluster center</li></ul></li></ul><p><strong>Returns</strong></p><ul><li><code>Float64</code>: The total within-cluster sum of squared distances</li></ul><p><strong>Description</strong></p><p>WCSS measures the compactness of clusters by summing the squared distances  between each data point and its assigned cluster center.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL5937">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.write_fasta-Tuple{}" href="#Mycelia.write_fasta-Tuple{}"><code>Mycelia.write_fasta</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">write_fasta(; outfile, records, gzip)
</code></pre><p>Writes FASTA records to a file, optionally gzipped.</p><p><strong>Arguments</strong></p><ul><li><code>outfile::AbstractString</code>: Path to the output FASTA file.  Will append &quot;.gz&quot; if <code>gzip</code> is true.</li><li><code>records::Vector{FASTX.FASTA.Record}</code>: A vector of FASTA records.</li><li><code>gzip::Bool=false</code>: Whether to compress the output with gzip.</li></ul><p><strong>Returns</strong></p><ul><li><code>outfile::String</code>: The path to the output FASTA file (including &quot;.gz&quot; if applicable).</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL12054">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.write_gff-Tuple{}" href="#Mycelia.write_gff-Tuple{}"><code>Mycelia.write_gff</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">write_gff(; gff, outfile)
</code></pre><p>Write GFF (General Feature Format) data to a tab-delimited file.</p><p><strong>Arguments</strong></p><ul><li><code>gff</code>: DataFrame/Table containing GFF formatted data</li><li><code>outfile</code>: String path where the output file should be written</li></ul><p><strong>Returns</strong></p><ul><li><code>String</code>: Path to the written output file</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL11478">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.write_vcf_table-Tuple{}" href="#Mycelia.write_vcf_table-Tuple{}"><code>Mycelia.write_vcf_table</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">write_vcf_table(; vcf_file, vcf_table, fasta_file)
</code></pre><p>Write variant data to a VCF v4.3 format file.</p><p><strong>Arguments</strong></p><ul><li><code>vcf_file::String</code>: Output path for the VCF file</li><li><code>vcf_table::DataFrame</code>: Table containing variant data with standard VCF columns</li><li><code>fasta_file::String</code>: Path to the reference genome FASTA file</li></ul><p><strong>Details</strong></p><p>Automatically filters out equivalent variants where REF == ALT. Includes standard VCF headers for substitutions, insertions, deletions, and inversions. Adds GT (Genotype) and GQ (Genotype Quality) format fields.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL15171">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.xam_to_contig_mapping_stats-Tuple{Any}" href="#Mycelia.xam_to_contig_mapping_stats-Tuple{Any}"><code>Mycelia.xam_to_contig_mapping_stats</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">xam_to_contig_mapping_stats(xam) -&gt; Any
</code></pre><p>Generate detailed mapping statistics for each reference sequence/contig in a XAM (SAM/BAM/CRAM) file.</p><p><strong>Arguments</strong></p><ul><li><code>xam</code>: Path to XAM file or XAM object</li></ul><p><strong>Returns</strong></p><p>A DataFrame with per-contig statistics including:</p><ul><li><code>n_aligned_reads</code>: Number of aligned reads</li><li><code>total_aligned_bases</code>: Sum of alignment lengths</li><li><code>total_alignment_score</code>: Sum of alignment scores</li><li>Mapping quality statistics (mean, std, median)</li><li>Alignment length statistics (mean, std, median)</li><li>Alignment score statistics (mean, std, median)</li><li>Percent mismatches statistics (mean, std, median)</li></ul><p>Note: Only primary alignments (isprimary=true) and mapped reads (ismapped=true) are considered.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/5f66ff3f54118d2276b65b68c448211804317e6e/src/Mycelia.jl#LL3234">source</a></section></article></article><nav class="docs-footer"><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.8.1 on <span class="colophon-date" title="Thursday 20 February 2025 02:37">Thursday 20 February 2025</span>. Using Julia version 1.11.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
