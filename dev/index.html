<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Home · Mycelia</title><meta name="title" content="Home · Mycelia"/><meta property="og:title" content="Home · Mycelia"/><meta property="twitter:title" content="Home · Mycelia"/><meta name="description" content="Documentation for Mycelia."/><meta property="og:description" content="Documentation for Mycelia."/><meta property="twitter:description" content="Documentation for Mycelia."/><script data-outdated-warner src="assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="search_index.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href>Mycelia</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li class="is-active"><a class="tocitem" href>Home</a><ul class="internal"><li><a class="tocitem" href="#Quick-Start"><span>Quick Start</span></a></li><li><a class="tocitem" href="#Key-Features-and-Research-Areas"><span>Key Features &amp; Research Areas</span></a></li><li><a class="tocitem" href="#Documentation-Contents"><span>Documentation Contents</span></a></li><li><a class="tocitem" href="#Installation"><span>Installation</span></a></li><li><a class="tocitem" href="#Function-Docstrings"><span>Function Docstrings</span></a></li></ul></li><li><a class="tocitem" href="getting-started/">Getting Started</a></li><li><a class="tocitem" href="concepts/">Concepts</a></li><li><span class="tocitem">API Reference</span><ul><li><input class="collapse-toggle" id="menuitem-4-1" type="checkbox"/><label class="tocitem" for="menuitem-4-1"><span class="docs-label">Workflows</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="api/workflows/assembly-suite/">Assembly Suite</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-2" type="checkbox"/><label class="tocitem" for="menuitem-4-2"><span class="docs-label">Quick Reference</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="api/quick-reference/parameter-guide/">Parameter Guide</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-3" type="checkbox"/><label class="tocitem" for="menuitem-4-3"><span class="docs-label">Examples</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="api/examples/basic-workflows/">Basic Workflows</a></li></ul></li><li><a class="tocitem" href="api/">API Documentation</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Home</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Home</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/cjprybol/Mycelia/blob/master/docs/src/index.md#L" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Mycelia-Documentation"><a class="docs-heading-anchor" href="#Mycelia-Documentation">Mycelia Documentation</a><a id="Mycelia-Documentation-1"></a><a class="docs-heading-anchor-permalink" href="#Mycelia-Documentation" title="Permalink"></a></h1><p><strong>An experimental Julia package for bioinformatics and computational biology</strong></p><p>Mycelia is a research-oriented package exploring novel approaches to genomic analysis, with a focus on graph-based genome assembly and quality-aware sequence processing. Currently in early development, it provides both experimental algorithms and integrations with established bioinformatics tools.</p><h2 id="Quick-Start"><a class="docs-heading-anchor" href="#Quick-Start">Quick Start</a><a id="Quick-Start-1"></a><a class="docs-heading-anchor-permalink" href="#Quick-Start" title="Permalink"></a></h2><p>New to Mycelia? Start with our <a href="getting-started/">Getting Started Guide</a> to install the package and complete your first genomic analysis in minutes.</p><h2 id="Key-Features-and-Research-Areas"><a class="docs-heading-anchor" href="#Key-Features-and-Research-Areas">Key Features &amp; Research Areas</a><a id="Key-Features-and-Research-Areas-1"></a><a class="docs-heading-anchor-permalink" href="#Key-Features-and-Research-Areas" title="Permalink"></a></h2><h3 id="Currently-Available"><a class="docs-heading-anchor" href="#Currently-Available">Currently Available</a><a id="Currently-Available-1"></a><a class="docs-heading-anchor-permalink" href="#Currently-Available" title="Permalink"></a></h3><ul><li><strong>🧬 Sequence Processing</strong>: Basic FASTA/FASTQ I/O and read simulation</li><li><strong>📊 K-mer Analysis</strong>: Canonical k-mer counting and distance metrics</li><li><strong>🔧 Tool Integration</strong>: Wrappers for established assemblers (MEGAHIT, SPAdes, hifiasm)</li><li><strong>⚡ HPC Support</strong>: SLURM job submission and rclone integration</li></ul><h3 id="In-Active-Development"><a class="docs-heading-anchor" href="#In-Active-Development">In Active Development</a><a id="In-Active-Development-1"></a><a class="docs-heading-anchor-permalink" href="#In-Active-Development" title="Permalink"></a></h3><ul><li><strong>🧪 Novel Assembly Algorithms</strong>: Graph-based approaches with quality awareness</li><li><strong>🌐 Pangenome Analysis</strong>: K-mer based comparative genomics</li><li><strong>📈 Quality Control</strong>: Integration with QC tools (fastp, filtlong, trim_galore)</li></ul><h3 id="Planned-Features"><a class="docs-heading-anchor" href="#Planned-Features">Planned Features</a><a id="Planned-Features-1"></a><a class="docs-heading-anchor-permalink" href="#Planned-Features" title="Permalink"></a></h3><ul><li><strong>🔍 Annotation</strong>: Gene prediction and functional annotation</li><li><strong>🌳 Phylogenetics</strong>: Tree construction from pangenome data</li><li><strong>📊 Visualization</strong>: Interactive plots for genomic data</li></ul><h2 id="Documentation-Contents"><a class="docs-heading-anchor" href="#Documentation-Contents">Documentation Contents</a><a id="Documentation-Contents-1"></a><a class="docs-heading-anchor-permalink" href="#Documentation-Contents" title="Permalink"></a></h2><ul><li><a href="getting-started/#Getting-Started-with-Mycelia">Getting Started with Mycelia</a></li><li class="no-marker"><ul><li><a href="getting-started/#What-is-Mycelia?">What is Mycelia?</a></li><li><a href="getting-started/#Prerequisites">Prerequisites</a></li><li><a href="getting-started/#Installation">Installation</a></li><li><a href="getting-started/#Your-First-Analysis">Your First Analysis</a></li><li><a href="getting-started/#What&#39;s-Next?">What&#39;s Next?</a></li><li><a href="getting-started/#Getting-Help">Getting Help</a></li><li><a href="getting-started/#Memory-and-Performance">Memory and Performance</a></li><li><a href="getting-started/#Contributing-2">Contributing</a></li></ul></li><li><a href="concepts/#Bioinformatics-Concepts-and-Tools">Bioinformatics Concepts and Tools</a></li><li class="no-marker"><ul><li><a href="concepts/#Table-of-Contents">Table of Contents</a></li><li><a href="concepts/#Workflow-Overview">Workflow Overview</a></li><li><a href="concepts/#Data-Acquisition">Data Acquisition</a></li><li><a href="concepts/#Quality-Control">Quality Control</a></li><li><a href="concepts/#Sequence-Analysis">Sequence Analysis</a></li><li><a href="concepts/#Genome-Assembly-2">Genome Assembly</a></li><li><a href="concepts/#Gene-Annotation">Gene Annotation</a></li><li><a href="concepts/#Comparative-Genomics">Comparative Genomics</a></li><li><a href="concepts/#Phylogenetics">Phylogenetics</a></li><li><a href="concepts/#Tool-Selection-Guide">Tool Selection Guide</a></li></ul></li><li><a href="api/#API-Documentation">API Documentation</a></li><li class="no-marker"><ul><li><a href="api/#Quick-Start">🧬 Quick Start</a></li><li><a href="api/#By-Workflow-Stage">📋 By Workflow Stage</a></li><li><a href="api/#By-Data-Type">📁 By Data Type</a></li><li><a href="api/#By-Analysis-Goal">🎯 By Analysis Goal</a></li><li><a href="api/#Finding-What-You-Need">🔍 Finding What You Need</a></li><li><a href="api/#Usage-Patterns">💡 Usage Patterns</a></li></ul></li><li><a href="api/#Basic-usage">Basic usage</a></li><li><a href="api/#Advanced-usage-with-options">Advanced usage with options</a></li><li class="no-marker"><ul><li><a href="api/#Integration-with-Tutorials">🚀 Integration with Tutorials</a></li></ul></li><li><a href="visualization-gallery/#Visualization-Gallery">Visualization Gallery</a></li><li class="no-marker"><ul><li><a href="visualization-gallery/#Overview">Overview</a></li><li><a href="visualization-gallery/#Data-Quality-and-Preprocessing">Data Quality &amp; Preprocessing</a></li><li><a href="visualization-gallery/#Sequence-Analysis-and-K-mers">Sequence Analysis &amp; K-mers</a></li><li><a href="visualization-gallery/#Assembly-Visualization">Assembly Visualization</a></li><li><a href="visualization-gallery/#Annotation-and-Gene-Features">Annotation &amp; Gene Features</a></li><li><a href="visualization-gallery/#Comparative-Genomics">Comparative Genomics</a></li><li><a href="visualization-gallery/#Performance-and-Benchmarking">Performance &amp; Benchmarking</a></li><li><a href="visualization-gallery/#Customization-and-Export">Customization and Export</a></li><li><a href="visualization-gallery/#Gallery-Organization">Gallery Organization</a></li><li><a href="visualization-gallery/#Interactive-Examples">Interactive Examples</a></li></ul></li></ul><h2 id="Installation"><a class="docs-heading-anchor" href="#Installation">Installation</a><a id="Installation-1"></a><a class="docs-heading-anchor-permalink" href="#Installation" title="Permalink"></a></h2><h3 id="Quick-Install"><a class="docs-heading-anchor" href="#Quick-Install">Quick Install</a><a id="Quick-Install-1"></a><a class="docs-heading-anchor-permalink" href="#Quick-Install" title="Permalink"></a></h3><pre><code class="language-julia hljs">import Pkg
Pkg.add(url=&quot;https://github.com/cjprybol/Mycelia.git&quot;)</code></pre><h3 id="Development-Install"><a class="docs-heading-anchor" href="#Development-Install">Development Install</a><a id="Development-Install-1"></a><a class="docs-heading-anchor-permalink" href="#Development-Install" title="Permalink"></a></h3><pre><code class="language-julia hljs">import Pkg
Pkg.develop(url=&quot;git@github.com:cjprybol/Mycelia.git&quot;)</code></pre><p>For detailed installation instructions including HPC setup, see the <a href="getting-started/">Getting Started Guide</a>.</p><h2 id="Function-Docstrings"><a class="docs-heading-anchor" href="#Function-Docstrings">Function Docstrings</a><a id="Function-Docstrings-1"></a><a class="docs-heading-anchor-permalink" href="#Function-Docstrings" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.AssemblyAction" href="#Mycelia.AssemblyAction"><code>Mycelia.AssemblyAction</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">AssemblyAction</code></pre><p>Action representation for reinforcement learning decisions during assembly.</p><p><strong>Fields</strong></p><ul><li><code>decision::Symbol</code>: Primary decision (:continue<em>k, :next</em>k, :terminate)</li><li><code>viterbi_params::Dict{Symbol, Float64}</code>: Viterbi algorithm parameters</li><li><code>correction_threshold::Float64</code>: Quality threshold for error correction</li><li><code>batch_size::Int</code>: Batch size for processing (memory management)</li><li><code>max_iterations::Int</code>: Maximum iterations at current k before forced progression</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/reinforcement-learning.jl#LL71-L82">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.AssemblyConfig" href="#Mycelia.AssemblyConfig"><code>Mycelia.AssemblyConfig</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Assembly configuration structure.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/assembly.jl#LL236-L238">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.AssemblyEnvironment" href="#Mycelia.AssemblyEnvironment"><code>Mycelia.AssemblyEnvironment</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">AssemblyEnvironment</code></pre><p>Reinforcement learning environment for training assembly decision policies.</p><p><strong>Fields</strong></p><ul><li><code>current_state::AssemblyState</code>: Current environment state</li><li><code>training_datasets::Vector{String}</code>: Paths to training FASTQ files</li><li><code>validation_datasets::Vector{String}</code>: Paths to validation FASTQ files</li><li><code>episode_length::Int</code>: Maximum steps per training episode</li><li><code>step_count::Int</code>: Current step in episode</li><li><code>reward_history::Vector{Float64}</code>: Reward history for current episode</li><li><code>action_history::Vector{AssemblyAction}</code>: Action history for experience replay</li><li><code>assembly_cache::Dict{String, Any}</code>: Cache for intermediate assembly results</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/reinforcement-learning.jl#LL115-L129">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.AssemblyMethod" href="#Mycelia.AssemblyMethod"><code>Mycelia.AssemblyMethod</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Assembly method enumeration for unified interface.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/assembly.jl#LL217-L219">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.AssemblyResult" href="#Mycelia.AssemblyResult"><code>Mycelia.AssemblyResult</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Assembly result structure containing contigs and metadata.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/assembly.jl#LL265-L267">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.AssemblyState" href="#Mycelia.AssemblyState"><code>Mycelia.AssemblyState</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">AssemblyState</code></pre><p>State representation for reinforcement learning environment containing all information needed to make assembly decisions.</p><p><strong>Fields</strong></p><ul><li><code>current_k::Int</code>: Current k-mer size being processed</li><li><code>assembly_quality::Float64</code>: Current assembly quality score (QV-based)</li><li><code>correction_rate::Float64</code>: Rate of successful error corrections in recent iterations</li><li><code>memory_usage::Float64</code>: Current memory utilization (fraction of limit)</li><li><code>graph_connectivity::Float64</code>: Graph connectivity metric (proportion of strongly connected components)</li><li><code>coverage_uniformity::Float64</code>: Uniformity of k-mer coverage distribution</li><li><code>error_signal_clarity::Float64</code>: Clarity of error signal detection (sparsity-based)</li><li><code>iteration_history::Vector{Float64}</code>: Recent reward history for trend analysis</li><li><code>k_progression::Vector{Int}</code>: Sequence of k-mer sizes processed so far</li><li><code>corrections_made::Int</code>: Total corrections made at current k</li><li><code>time_elapsed::Float64</code>: Time spent on current k-mer size (seconds)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/reinforcement-learning.jl#LL38-L56">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.BenchmarkConfig" href="#Mycelia.BenchmarkConfig"><code>Mycelia.BenchmarkConfig</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Benchmark configuration for consistent testing.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/performance-benchmarks.jl#LL20-L22">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.BioSequenceEdgeData" href="#Mycelia.BioSequenceEdgeData"><code>Mycelia.BioSequenceEdgeData</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Edge data for variable-length BioSequence graphs.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/fasta-graphs.jl#LL35-L37">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.BioSequenceVertexData" href="#Mycelia.BioSequenceVertexData"><code>Mycelia.BioSequenceVertexData</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Vertex data for variable-length BioSequence graphs.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/fasta-graphs.jl#LL20-L22">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.BubbleStructure" href="#Mycelia.BubbleStructure"><code>Mycelia.BubbleStructure</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">BubbleStructure</code></pre><p>Represents a bubble (alternative path) in the assembly graph.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/sequence-graphs-next.jl#LL975-L979">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.ContigPath" href="#Mycelia.ContigPath"><code>Mycelia.ContigPath</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ContigPath</code></pre><p>Represents a linear path through the graph forming a contig.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/sequence-graphs-next.jl#LL1019-L1023">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.DQNPolicy" href="#Mycelia.DQNPolicy"><code>Mycelia.DQNPolicy</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">DQNPolicy</code></pre><p>Deep Q-Network policy for high-level assembly decisions.</p><p>This is a placeholder structure for the neural network architecture that will be implemented with a machine learning framework like Flux.jl or MLJ.jl.</p><p><strong>Fields</strong></p><ul><li><code>state_dim::Int</code>: Dimension of state representation</li><li><code>action_dim::Int</code>: Number of possible actions</li><li><code>hidden_dims::Vector{Int}</code>: Hidden layer dimensions</li><li><code>learning_rate::Float64</code>: Learning rate for training</li><li><code>epsilon::Float64</code>: Exploration rate for epsilon-greedy policy</li><li><code>experience_buffer::Vector{Any}</code>: Experience replay buffer</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/reinforcement-learning.jl#LL576-L591">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.FastqQualityResults" href="#Mycelia.FastqQualityResults"><code>Mycelia.FastqQualityResults</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Stores comprehensive FASTQ quality analysis results.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/quality-control-and-benchmarking.jl#LL568-L570">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.GraphMode" href="#Mycelia.GraphMode"><code>Mycelia.GraphMode</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Graph mode for handling strand information.</p><ul><li><code>SingleStrand</code>: Sequences are single-stranded (RNA, amino acids, or directional DNA)</li><li><code>DoubleStrand</code>: Sequences are double-stranded DNA/RNA with canonical representation</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/sequence-graphs-next.jl#LL23-L27">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.GraphPath" href="#Mycelia.GraphPath"><code>Mycelia.GraphPath</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Represents a complete path through the k-mer graph.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/sequence-graphs-next.jl#LL1992-L1994">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.KmerEdgeData" href="#Mycelia.KmerEdgeData"><code>Mycelia.KmerEdgeData</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Type-stable metadata for k-mer graph edges.</p><p>Edges represent valid strand-aware transitions between canonical k-mers. The transition is valid only if the strand orientations allow for proper overlap.</p><p>Fields:</p><ul><li><code>coverage</code>: Vector of edge traversal observations with strand information</li><li><code>weight</code>: Edge weight/confidence score based on coverage</li><li><code>src_strand</code>: Required strand orientation of source k-mer for this transition</li><li><code>dst_strand</code>: Required strand orientation of destination k-mer for this transition</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/sequence-graphs-next.jl#LL48-L59">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.KmerVertexData" href="#Mycelia.KmerVertexData"><code>Mycelia.KmerVertexData</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Type-stable metadata for k-mer graph vertices.</p><p>Vertices always represent canonical k-mers for memory efficiency and cleaner graphs. Strand information is tracked in the coverage data and edge transitions.</p><p>Fields:</p><ul><li><code>coverage</code>: Vector of observation coverage data as (observation<em>id, position, strand</em>orientation) tuples</li><li><code>canonical_kmer</code>: The canonical k-mer (BioSequence type - NO string conversion)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/sequence-graphs-next.jl#LL30-L39">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.PangenomeAnalysisResult" href="#Mycelia.PangenomeAnalysisResult"><code>Mycelia.PangenomeAnalysisResult</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">PangenomeAnalysisResult</code></pre><p>Results of k-mer based pangenome analysis.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/pangenome-analysis.jl#LL4-L8">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.QualityBioSequenceEdgeData" href="#Mycelia.QualityBioSequenceEdgeData"><code>Mycelia.QualityBioSequenceEdgeData</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Quality-aware BioSequence edge data.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/fastq-graphs.jl#LL53-L55">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.QualityBioSequenceVertexData" href="#Mycelia.QualityBioSequenceVertexData"><code>Mycelia.QualityBioSequenceVertexData</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Quality-aware BioSequence vertex data.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/fastq-graphs.jl#LL22-L24">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.QualityDistribution" href="#Mycelia.QualityDistribution"><code>Mycelia.QualityDistribution</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Stores quality distribution statistics for FASTQ analysis.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/quality-control-and-benchmarking.jl#LL559-L561">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.QualmerEdgeData" href="#Mycelia.QualmerEdgeData"><code>Mycelia.QualmerEdgeData</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Edge data for quality-aware k-mer graphs.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/qualmer-analysis.jl#LL367-L369">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.QualmerObservation" href="#Mycelia.QualmerObservation"><code>Mycelia.QualmerObservation</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Qualmer observation for tracking k-mer occurrences in sequences.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/qualmer-analysis.jl#LL316-L318">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.QualmerVertexData" href="#Mycelia.QualmerVertexData"><code>Mycelia.QualmerVertexData</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Vertex data for quality-aware k-mer graphs.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/qualmer-analysis.jl#LL331-L333">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.RepeatRegion" href="#Mycelia.RepeatRegion"><code>Mycelia.RepeatRegion</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">RepeatRegion</code></pre><p>Represents a repetitive region in the assembly graph.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/sequence-graphs-next.jl#LL996-L1000">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.RewardComponents" href="#Mycelia.RewardComponents"><code>Mycelia.RewardComponents</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">RewardComponents</code></pre><p>Structured representation of reward signal components for training the RL agent.</p><p><strong>Fields</strong></p><ul><li><code>accuracy_reward::Float64</code>: Primary reward based on assembly accuracy (weighted 1000x)</li><li><code>efficiency_reward::Float64</code>: Secondary reward for computational efficiency (weighted 10x)</li><li><code>error_penalty::Float64</code>: Penalty for false positives/negatives (weighted -500x)</li><li><code>progress_bonus::Float64</code>: Bonus for making meaningful progress</li><li><code>termination_reward::Float64</code>: Reward for appropriate termination timing</li><li><code>total_reward::Float64</code>: Weighted sum of all components</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/reinforcement-learning.jl#LL91-L103">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.ScaffoldResult" href="#Mycelia.ScaffoldResult"><code>Mycelia.ScaffoldResult</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ScaffoldResult</code></pre><p>Results from scaffolding analysis.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/sequence-graphs-next.jl#LL1037-L1041">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.StrandOrientation" href="#Mycelia.StrandOrientation"><code>Mycelia.StrandOrientation</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Strand orientation for k-mer observations and transitions.</p><ul><li><code>Forward</code>: k-mer as observed (5&#39; to 3&#39;)</li><li><code>Reverse</code>: reverse complement of k-mer (3&#39; to 5&#39;)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/sequence-graphs-next.jl#LL16-L20">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.ViterbiConfig" href="#Mycelia.ViterbiConfig"><code>Mycelia.ViterbiConfig</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ViterbiConfig</code></pre><p>Configuration for Viterbi algorithm parameters.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/viterbi-next.jl#LL47-L51">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.ViterbiPath" href="#Mycelia.ViterbiPath"><code>Mycelia.ViterbiPath</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ViterbiPath</code></pre><p>Complete Viterbi path through the k-mer graph.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/viterbi-next.jl#LL30-L34">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.ViterbiState" href="#Mycelia.ViterbiState"><code>Mycelia.ViterbiState</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ViterbiState</code></pre><p>State information for Viterbi algorithm on k-mer graphs.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/viterbi-next.jl#LL11-L15">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.WalkStep" href="#Mycelia.WalkStep"><code>Mycelia.WalkStep</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Represents a step in a probabilistic walk through the graph.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/sequence-graphs-next.jl#LL1982-L1984">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.JLD2_read_table-Tuple{String}" href="#Mycelia.JLD2_read_table-Tuple{String}"><code>Mycelia.JLD2_read_table</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">JLD2_read_table(filename::String) -&gt; Any
</code></pre><p>Read a DataFrame from a JLD2 file without needing to know the internal name. If the file contains multiple DataFrames, returns the first one found.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/utility-functions.jl#LL522">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.JLD2_write_table-Tuple{}" href="#Mycelia.JLD2_write_table-Tuple{}"><code>Mycelia.JLD2_write_table</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">JLD2_write_table(; df, filename)
</code></pre><p>Write a DataFrame to a JLD2 file using a standardized internal name.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/utility-functions.jl#LL510">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia._add_biosequence_edges!-Tuple{MetaGraphsNext.MetaGraph, Vector{FASTX.FASTA.Record}, Mycelia.GraphMode, Int64}" href="#Mycelia._add_biosequence_edges!-Tuple{MetaGraphsNext.MetaGraph, Vector{FASTX.FASTA.Record}, Mycelia.GraphMode, Int64}"><code>Mycelia._add_biosequence_edges!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Add edges to BioSequence graph based on sequence overlaps.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/fasta-graphs.jl#LL252-L254">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia._add_biosequence_edges_from_paths!-Tuple{MetaGraphsNext.MetaGraph, Vector{Vector{Any}}, MetaGraphsNext.MetaGraph}" href="#Mycelia._add_biosequence_edges_from_paths!-Tuple{MetaGraphsNext.MetaGraph, Vector{Vector{Any}}, MetaGraphsNext.MetaGraph}"><code>Mycelia._add_biosequence_edges_from_paths!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Add edges between BioSequences based on k-mer path relationships.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/fasta-graphs.jl#LL384-L386">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia._add_observation_to_graph!-NTuple{5, Any}" href="#Mycelia._add_observation_to_graph!-NTuple{5, Any}"><code>Mycelia._add_observation_to_graph!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">_add_observation_to_graph!(
    graph,
    observation,
    obs_idx,
    canonical_kmers,
    graph_mode
)
</code></pre><p>Add a sequence observation to an existing k-mer graph with strand-aware edge creation.</p><p><strong>Arguments</strong></p><ul><li><code>graph</code>: MetaGraphsNext k-mer graph with canonical vertices</li><li><code>observation</code>: FASTA/FASTQ record</li><li><code>obs_idx</code>: Observation index</li><li><code>canonical_kmers</code>: Vector of canonical k-mers in the graph</li><li><code>graph_mode</code>: SingleStrand or DoubleStrand mode</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/sequence-graphs-next.jl#LL138">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia._add_quality_biosequence_edges!-Tuple{MetaGraphsNext.MetaGraph, Vector{FASTX.FASTQ.Record}, Mycelia.GraphMode, Int64, UInt8}" href="#Mycelia._add_quality_biosequence_edges!-Tuple{MetaGraphsNext.MetaGraph, Vector{FASTX.FASTQ.Record}, Mycelia.GraphMode, Int64, UInt8}"><code>Mycelia._add_quality_biosequence_edges!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Add quality-weighted edges to BioSequence graph.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/fastq-graphs.jl#LL357-L359">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia._add_quality_biosequence_edges_from_qualmer_paths!-Tuple{MetaGraphsNext.MetaGraph, Vector{Vector{Any}}, MetaGraphsNext.MetaGraph}" href="#Mycelia._add_quality_biosequence_edges_from_qualmer_paths!-Tuple{MetaGraphsNext.MetaGraph, Vector{Vector{Any}}, MetaGraphsNext.MetaGraph}"><code>Mycelia._add_quality_biosequence_edges_from_qualmer_paths!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Add edges between quality-aware BioSequences based on qualmer path relationships.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/fastq-graphs.jl#LL517-L519">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia._add_qualmer_edges!-Union{Tuple{KmerT}, Tuple{MetaGraphsNext.MetaGraph, Dict{KmerT, Mycelia.QualmerVertexData}, Vector{FASTX.FASTQ.Record}, Int64, Mycelia.GraphMode}} where KmerT" href="#Mycelia._add_qualmer_edges!-Union{Tuple{KmerT}, Tuple{MetaGraphsNext.MetaGraph, Dict{KmerT, Mycelia.QualmerVertexData}, Vector{FASTX.FASTQ.Record}, Int64, Mycelia.GraphMode}} where KmerT"><code>Mycelia._add_qualmer_edges!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Add edges to the qualmer graph based on k-mer adjacency in sequences.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/qualmer-analysis.jl#LL506-L508">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia._add_simulated_errors-Tuple{String, Float64, String}" href="#Mycelia._add_simulated_errors-Tuple{String, Float64, String}"><code>Mycelia._add_simulated_errors</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Add simulated sequencing errors to a sequence string.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/reference-databases.jl#LL3715-L3717">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia._add_strand_aware_edge!-NTuple{7, Any}" href="#Mycelia._add_strand_aware_edge!-NTuple{7, Any}"><code>Mycelia._add_strand_aware_edge!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Helper function to add strand-aware coverage data to an edge.</p><p>This function creates edges that respect strand orientation constraints. Each edge represents a biologically valid transition between k-mers.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/sequence-graphs-next.jl#LL195-L200">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia._add_vertex_coverage!-NTuple{5, Any}" href="#Mycelia._add_vertex_coverage!-NTuple{5, Any}"><code>Mycelia._add_vertex_coverage!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Helper function to add coverage data to a vertex.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/sequence-graphs-next.jl#LL186-L188">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia._assemble_biosequence_graph-Tuple{Any, Any}" href="#Mycelia._assemble_biosequence_graph-Tuple{Any, Any}"><code>Mycelia._assemble_biosequence_graph</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>BioSequence graph assembly implementation (variable-length simplified from k-mer graphs).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/assembly.jl#LL1530-L1532">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia._assemble_hybrid_olc-Tuple{Any, Any}" href="#Mycelia._assemble_hybrid_olc-Tuple{Any, Any}"><code>Mycelia._assemble_hybrid_olc</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Hybrid OLC assembly (placeholder for future implementation).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/assembly.jl#LL914-L916">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia._assemble_kmer_graph-Tuple{Any, Any}" href="#Mycelia._assemble_kmer_graph-Tuple{Any, Any}"><code>Mycelia._assemble_kmer_graph</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>K-mer graph assembly implementation (fixed-length k-mer foundation).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/assembly.jl#LL567-L569">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia._assemble_multi_k-Tuple{Any, Any}" href="#Mycelia._assemble_multi_k-Tuple{Any, Any}"><code>Mycelia._assemble_multi_k</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Multi-k assembly (placeholder for future implementation).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/assembly.jl#LL926-L928">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia._assemble_ngram_graph-Tuple{Any, Any}" href="#Mycelia._assemble_ngram_graph-Tuple{Any, Any}"><code>Mycelia._assemble_ngram_graph</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>N-gram graph assembly implementation (fixed-length unicode character analysis).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/assembly.jl#LL1495-L1497">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia._assemble_quality_biosequence_graph-Tuple{Any, Any}" href="#Mycelia._assemble_quality_biosequence_graph-Tuple{Any, Any}"><code>Mycelia._assemble_quality_biosequence_graph</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Quality-aware BioSequence graph assembly implementation (variable-length simplified from qualmer graphs).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/assembly.jl#LL1570-L1572">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia._assemble_qualmer_graph-Tuple{Any, Any}" href="#Mycelia._assemble_qualmer_graph-Tuple{Any, Any}"><code>Mycelia._assemble_qualmer_graph</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Quality-aware k-mer graph assembly implementation (fixed-length qualmer foundation).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/assembly.jl#LL626-L628">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia._assemble_string_graph-Tuple{Any, Any}" href="#Mycelia._assemble_string_graph-Tuple{Any, Any}"><code>Mycelia._assemble_string_graph</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>String graph assembly implementation (variable-length simplified from N-gram graphs).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/assembly.jl#LL528-L530">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia._calculate_consensus_quality_from_observations-Tuple{Vector{&lt;:Mycelia.QualmerObservation}, Int64}" href="#Mycelia._calculate_consensus_quality_from_observations-Tuple{Vector{&lt;:Mycelia.QualmerObservation}, Int64}"><code>Mycelia._calculate_consensus_quality_from_observations</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Calculate consensus quality from multiple observations at a specific position. Uses the joint probability and multiple observations to compute a consensus quality score.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/assembly.jl#LL1285-L1288">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia._calculate_l_statistic-Tuple{Any, Any}" href="#Mycelia._calculate_l_statistic-Tuple{Any, Any}"><code>Mycelia._calculate_l_statistic</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">_calculate_l_statistic(sorted_lengths, threshold)</code></pre><p>Calculate L-statistic (number of contigs needed to reach a given percentage of total assembly length). For example, L50 is the number of contigs needed to reach 50% of the total assembly length.</p><p><strong>Arguments</strong></p><ul><li><code>sorted_lengths</code>: Vector of contig lengths sorted in descending order</li><li><code>threshold</code>: Fraction of total length (e.g., 0.5 for L50, 0.9 for L90)</li></ul><p><strong>Returns</strong></p><ul><li><code>Int</code>: Number of contigs needed to reach the threshold</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/assembly.jl#LL1027-L1039">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia._calculate_n_statistic-Tuple{Any, Any}" href="#Mycelia._calculate_n_statistic-Tuple{Any, Any}"><code>Mycelia._calculate_n_statistic</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Calculate N-statistic (N50, N90, etc.) for contig lengths.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/assembly.jl#LL1009-L1011">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia._calculate_path_coverage-Tuple{Vector, MetaGraphsNext.MetaGraph}" href="#Mycelia._calculate_path_coverage-Tuple{Vector, MetaGraphsNext.MetaGraph}"><code>Mycelia._calculate_path_coverage</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Calculate coverage for a path from constituent k-mers.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/fasta-graphs.jl#LL369-L371">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia._calculate_qualmer_path_coverage-Tuple{Vector, MetaGraphsNext.MetaGraph}" href="#Mycelia._calculate_qualmer_path_coverage-Tuple{Vector, MetaGraphsNext.MetaGraph}"><code>Mycelia._calculate_qualmer_path_coverage</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Calculate coverage for qualmer path.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/fastq-graphs.jl#LL503-L505">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia._calculate_transition_probabilities-Tuple{Any}" href="#Mycelia._calculate_transition_probabilities-Tuple{Any}"><code>Mycelia._calculate_transition_probabilities</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Helper function to calculate normalized transition probabilities.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/sequence-graphs-next.jl#LL2272-L2274">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia._check_conda_env_exists-Tuple{AbstractString}" href="#Mycelia._check_conda_env_exists-Tuple{AbstractString}"><code>Mycelia._check_conda_env_exists</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">_check_conda_env_exists(env_name::AbstractString) -&gt; Bool</code></pre><p>Check if a conda environment exists.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/bioconda.jl#LL89-L93">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia._contigs_to_records-Tuple{Any}" href="#Mycelia._contigs_to_records-Tuple{Any}"><code>Mycelia._contigs_to_records</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Convert contigs to FASTA records for graph construction.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/assembly.jl#LL998-L1000">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia._create_empty_kmer_graph-Tuple{Any}" href="#Mycelia._create_empty_kmer_graph-Tuple{Any}"><code>Mycelia._create_empty_kmer_graph</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Helper function to create an empty k-mer graph.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/sequence-graphs-next.jl#LL231-L233">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia._detect_sequence_extension-Tuple{Symbol}" href="#Mycelia._detect_sequence_extension-Tuple{Symbol}"><code>Mycelia._detect_sequence_extension</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">_detect_sequence_extension(sequence_type::Symbol) -&gt; String
</code></pre><p>Internal helper function to convert sequence type to file extension.</p><p>Arguments</p><ul><li>sequence_type: Symbol representing sequence type (:DNA, :RNA, or :AA)</li></ul><p>Returns</p><ul><li>String: Appropriate file extensions</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/fastx.jl#LL911">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia._determine_kmer_type-Tuple{Any, Any}" href="#Mycelia._determine_kmer_type-Tuple{Any, Any}"><code>Mycelia._determine_kmer_type</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Determine appropriate k-mer type from observations.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/assembly.jl#LL1630-L1632">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia._determine_strand-Tuple{Mycelia.Qualmer, Mycelia.Qualmer}" href="#Mycelia._determine_strand-Tuple{Mycelia.Qualmer, Mycelia.Qualmer}"><code>Mycelia._determine_strand</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Determine strand orientation by comparing original and canonical qualmers.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/qualmer-analysis.jl#LL577-L579">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia._find_heaviest_eulerian_path-Tuple{Any, Any, Set}" href="#Mycelia._find_heaviest_eulerian_path-Tuple{Any, Any, Set}"><code>Mycelia._find_heaviest_eulerian_path</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Find the heaviest (highest confidence) Eulerian path starting from a given vertex.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/assembly.jl#LL765-L767">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia._find_linear_paths-Tuple{MetaGraphsNext.MetaGraph, Int64}" href="#Mycelia._find_linear_paths-Tuple{MetaGraphsNext.MetaGraph, Int64}"><code>Mycelia._find_linear_paths</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Find linear paths in a k-mer graph.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/fasta-graphs.jl#LL283-L285">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia._find_linear_qualmer_paths-Tuple{MetaGraphsNext.MetaGraph, Int64}" href="#Mycelia._find_linear_qualmer_paths-Tuple{MetaGraphsNext.MetaGraph, Int64}"><code>Mycelia._find_linear_qualmer_paths</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Find linear paths in a qualmer graph.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/fastq-graphs.jl#LL398-L400">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia._find_quality_sequence_overlap-Tuple{Any, Any, Mycelia.QualityBioSequenceVertexData, Mycelia.QualityBioSequenceVertexData, Int64}" href="#Mycelia._find_quality_sequence_overlap-Tuple{Any, Any, Mycelia.QualityBioSequenceVertexData, Mycelia.QualityBioSequenceVertexData, Int64}"><code>Mycelia._find_quality_sequence_overlap</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Find quality-weighted overlap between two sequences.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/fastq-graphs.jl#LL580-L582">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia._find_qualmer_paths-Tuple{Any, Any}" href="#Mycelia._find_qualmer_paths-Tuple{Any, Any}"><code>Mycelia._find_qualmer_paths</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Find quality-aware paths in a qualmer graph.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/assembly.jl#LL1121-L1123">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia._find_sequence_overlap-Tuple{Any, Any, Int64}" href="#Mycelia._find_sequence_overlap-Tuple{Any, Any, Int64}"><code>Mycelia._find_sequence_overlap</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Find overlap between two sequences.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/fasta-graphs.jl#LL433-L435">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia._generate_contigs_from_qualmer_graph-Tuple{Any, Any}" href="#Mycelia._generate_contigs_from_qualmer_graph-Tuple{Any, Any}"><code>Mycelia._generate_contigs_from_qualmer_graph</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Generate contigs from qualmer graph using probabilistic walks.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/assembly.jl#LL1443-L1445">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia._generate_contigs_probabilistic-Tuple{Any, Any}" href="#Mycelia._generate_contigs_probabilistic-Tuple{Any, Any}"><code>Mycelia._generate_contigs_probabilistic</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Generate contigs using probabilistic walks when Eulerian paths are not available.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/assembly.jl#LL938-L940">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia._generate_fastq_contigs_from_qualmer_graph-Tuple{Any, Any}" href="#Mycelia._generate_fastq_contigs_from_qualmer_graph-Tuple{Any, Any}"><code>Mycelia._generate_fastq_contigs_from_qualmer_graph</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Generate FASTQ contigs from qualmer graph using probabilistic walks when no paths are found.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/assembly.jl#LL1337-L1339">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia._get_output_files-Tuple{AbstractString}" href="#Mycelia._get_output_files-Tuple{AbstractString}"><code>Mycelia._get_output_files</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">_get_output_files(output_dir::AbstractString) -&gt; Vector{String}</code></pre><p>Get a list of all files in the output directory.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/utility-functions.jl#LL1-L5">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia._get_valid_transitions-Tuple{Any, Any, Any}" href="#Mycelia._get_valid_transitions-Tuple{Any, Any, Any}"><code>Mycelia._get_valid_transitions</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Helper function to get valid transitions from a vertex with given strand orientation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/sequence-graphs-next.jl#LL2243-L2245">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia._is_valid_qualmer_transition-Tuple{Any, Any, Mycelia.StrandOrientation, Mycelia.StrandOrientation}" href="#Mycelia._is_valid_qualmer_transition-Tuple{Any, Any, Mycelia.StrandOrientation, Mycelia.StrandOrientation}"><code>Mycelia._is_valid_qualmer_transition</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Validate that the transition between two k-mers is biologically valid.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/qualmer-analysis.jl#LL584-L586">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia._is_valid_transition-NTuple{5, Any}" href="#Mycelia._is_valid_transition-NTuple{5, Any}"><code>Mycelia._is_valid_transition</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">_is_valid_transition(
    src_kmer,
    dst_kmer,
    src_strand,
    dst_strand,
    k
) -&gt; Any
</code></pre><p>Validate that a transition between two k-mers with given strand orientations is biologically valid.</p><p>For a transition to be valid, the suffix of the source k-mer must match the prefix of the  destination k-mer when accounting for strand orientations.</p><p><strong>Arguments</strong></p><ul><li><code>src_kmer</code>: Source canonical k-mer</li><li><code>dst_kmer</code>: Destination canonical k-mer  </li><li><code>src_strand</code>: Strand orientation of source k-mer</li><li><code>dst_strand</code>: Strand orientation of destination k-mer</li><li><code>k</code>: K-mer size</li></ul><p><strong>Returns</strong></p><ul><li><code>Bool</code>: true if transition is biologically valid</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/sequence-graphs-next.jl#LL325">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia._iterative_viterbi_paths-Tuple{Any, Any, Any}" href="#Mycelia._iterative_viterbi_paths-Tuple{Any, Any, Any}"><code>Mycelia._iterative_viterbi_paths</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Iterative Viterbi algorithm for finding optimal paths through qualmer graph. Uses dynamic programming with quality scores as emission/transition probabilities.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/assembly.jl#LL820-L823">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia._path_to_sequence-Tuple{Any, Any}" href="#Mycelia._path_to_sequence-Tuple{Any, Any}"><code>Mycelia._path_to_sequence</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Convert a path of vertices to a DNA sequence.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/assembly.jl#LL959-L961">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia._polish_contig_viterbi-Tuple{Any, Any, Any}" href="#Mycelia._polish_contig_viterbi-Tuple{Any, Any, Any}"><code>Mycelia._polish_contig_viterbi</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Polish a single contig using Viterbi error correction.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/assembly.jl#LL981-L983">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia._prepare_fastq_observations-Tuple{Any}" href="#Mycelia._prepare_fastq_observations-Tuple{Any}"><code>Mycelia._prepare_fastq_observations</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Convert observations to FASTQ records for quality processing.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/assembly.jl#LL1083-L1085">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia._prepare_observations-Tuple{Any}" href="#Mycelia._prepare_observations-Tuple{Any}"><code>Mycelia._prepare_observations</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Prepare observations from various input formats (FASTA/FASTQ records or file paths).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/assembly.jl#LL493-L495">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia._quality_weighted_walk" href="#Mycelia._quality_weighted_walk"><code>Mycelia._quality_weighted_walk</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Perform quality-weighted walk through qualmer graph.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/assembly.jl#LL1388-L1390">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia._qualmer_path_to_consensus_fastq-Tuple{Any, Any, String}" href="#Mycelia._qualmer_path_to_consensus_fastq-Tuple{Any, Any, String}"><code>Mycelia._qualmer_path_to_consensus_fastq</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Enhanced qualmer path to sequence with consensus quality calculation. Uses joint probability from multiple observations to compute consensus quality.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/assembly.jl#LL1240-L1243">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia._qualmer_path_to_fastq_record-Tuple{Any, Any, String}" href="#Mycelia._qualmer_path_to_fastq_record-Tuple{Any, Any, String}"><code>Mycelia._qualmer_path_to_fastq_record</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Enhanced qualmer path to FASTQ record conversion with quality propagation. This is the core function that enables quality-aware assembly output.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/assembly.jl#LL1197-L1200">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia._qualmer_path_to_sequence-Tuple{Any, Any}" href="#Mycelia._qualmer_path_to_sequence-Tuple{Any, Any}"><code>Mycelia._qualmer_path_to_sequence</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Convert qualmer path to DNA sequence.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/assembly.jl#LL1175-L1177">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia._reconstruct_sequence_and_quality_from_qualmer_path-Tuple{Vector, MetaGraphsNext.MetaGraph, Type}" href="#Mycelia._reconstruct_sequence_and_quality_from_qualmer_path-Tuple{Vector, MetaGraphsNext.MetaGraph, Type}"><code>Mycelia._reconstruct_sequence_and_quality_from_qualmer_path</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Reconstruct sequence and quality from qualmer path.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/fastq-graphs.jl#LL466-L468">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia._reconstruct_sequence_from_kmer_path-Tuple{Vector, Type}" href="#Mycelia._reconstruct_sequence_from_kmer_path-Tuple{Vector, Type}"><code>Mycelia._reconstruct_sequence_from_kmer_path</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Reconstruct a BioSequence from a path of k-mers.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/fasta-graphs.jl#LL346-L348">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia._reconstruct_sequence_from_path-Tuple{Any}" href="#Mycelia._reconstruct_sequence_from_path-Tuple{Any}"><code>Mycelia._reconstruct_sequence_from_path</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Helper function to reconstruct sequence from a graph path.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/sequence-graphs-next.jl#LL2318-L2320">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia._reconstruct_shortest_path-NTuple{5, Any}" href="#Mycelia._reconstruct_shortest_path-NTuple{5, Any}"><code>Mycelia._reconstruct_shortest_path</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Helper function to reconstruct shortest path from Dijkstra&#39;s algorithm.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/sequence-graphs-next.jl#LL2358-L2360">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia._sample_transition-Tuple{Any, Any}" href="#Mycelia._sample_transition-Tuple{Any, Any}"><code>Mycelia._sample_transition</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Helper function to sample a transition based on probabilities.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/sequence-graphs-next.jl#LL2291-L2293">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia._sequence_to_canonical_path-Tuple{Any, Any, Any}" href="#Mycelia._sequence_to_canonical_path-Tuple{Any, Any, Any}"><code>Mycelia._sequence_to_canonical_path</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">_sequence_to_canonical_path(
    canonical_kmers,
    sequence,
    graph_mode
) -&gt; Vector{&lt;:Tuple{Any, Mycelia.StrandOrientation}}
</code></pre><p>Convert a sequence to a path through canonical k-mer space with strand awareness.</p><p>This is the key function that handles the distinction between single-strand and  double-strand modes while maintaining canonical k-mer vertices.</p><p><strong>Arguments</strong></p><ul><li><code>canonical_kmers</code>: Vector of canonical k-mers available in the graph</li><li><code>sequence</code>: DNA/RNA sequence to convert</li><li><code>graph_mode</code>: SingleStrand or DoubleStrand mode</li></ul><p><strong>Returns</strong></p><ul><li>Vector of (canonical<em>kmer, strand</em>orientation) pairs representing the path</li></ul><p><strong>Details</strong></p><p>In DoubleStrand mode:</p><ul><li>Each observed k-mer is converted to its canonical form</li><li>Strand orientation tracks whether the canonical form matches the observed k-mer</li><li>Edges respect the biological constraint that transitions must maintain proper overlap</li></ul><p>In SingleStrand mode:</p><ul><li>K-mers are used as-is (no reverse complement consideration)</li><li>All strand orientations are Forward</li><li>Suitable for RNA, amino acids, or directional DNA analysis</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/sequence-graphs-next.jl#LL245">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia._setup_phageboost_environment" href="#Mycelia._setup_phageboost_environment"><code>Mycelia._setup_phageboost_environment</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">_setup_phageboost_environment(force_reinstall::Bool=false)</code></pre><p>Set up the PhageBoost conda environment if it doesn&#39;t exist or if force_reinstall is true.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/bioconda.jl#LL16-L20">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia._simplify_ngram_graph-Tuple{Any}" href="#Mycelia._simplify_ngram_graph-Tuple{Any}"><code>Mycelia._simplify_ngram_graph</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Simplify N-gram graph by removing unnecessary complexity.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/assembly.jl#LL1612-L1614">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia._simplify_ngram_to_string_graph-Tuple{Any}" href="#Mycelia._simplify_ngram_to_string_graph-Tuple{Any}"><code>Mycelia._simplify_ngram_to_string_graph</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Convert N-gram graph to variable-length string graph.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/assembly.jl#LL1621-L1623">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia._simplify_string_graph-Tuple{Any}" href="#Mycelia._simplify_string_graph-Tuple{Any}"><code>Mycelia._simplify_string_graph</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Simplify string graph by removing unnecessary complexity.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/assembly.jl#LL1070-L1072">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia._simulate_fastq_reads_from_sequence-Tuple{Any, String}" href="#Mycelia._simulate_fastq_reads_from_sequence-Tuple{Any, String}"><code>Mycelia._simulate_fastq_reads_from_sequence</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">_simulate_fastq_reads_from_sequence(
    sequence,
    identifier::String;
    coverage,
    read_length,
    error_rate,
    sequence_type
) -&gt; Vector{FASTX.FASTQ.Record}
</code></pre><p>Generate simulated FASTQ reads from a reference sequence.</p><p><strong>Arguments</strong></p><ul><li><code>sequence</code>: Reference sequence (String or BioSequences type)</li><li><code>identifier</code>: Sequence identifier</li><li><code>coverage::Int</code>: Desired coverage depth</li><li><code>read_length::Int</code>: Length of individual reads</li><li><code>error_rate::Float64</code>: Simulated error rate</li><li><code>sequence_type::String</code>: Type of sequence (&quot;DNA&quot;, &quot;RNA&quot;, &quot;AA&quot;)</li></ul><p><strong>Returns</strong></p><ul><li><code>Vector{FASTX.FASTQ.Record}</code>: Vector of simulated FASTQ reads with quality scores</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/reference-databases.jl#LL3638">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia._validate_against_reference-Tuple{Any, Any}" href="#Mycelia._validate_against_reference-Tuple{Any, Any}"><code>Mycelia._validate_against_reference</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Validate assembly against reference sequence (placeholder).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/assembly.jl#LL1058-L1060">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia._viterbi_optimal_path-Tuple{Any, Any, Set, Int64}" href="#Mycelia._viterbi_optimal_path-Tuple{Any, Any, Set, Int64}"><code>Mycelia._viterbi_optimal_path</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Find optimal path using Viterbi-like dynamic programming on quality scores.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/assembly.jl#LL861-L863">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.accuracy-Tuple{Any, Any}" href="#Mycelia.accuracy-Tuple{Any, Any}"><code>Mycelia.accuracy</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">accuracy(true_labels, pred_labels)</code></pre><p>Returns the overall accuracy.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/quality-control-and-benchmarking.jl#LL105-L109">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.add_bioconda_env-Tuple{Any}" href="#Mycelia.add_bioconda_env-Tuple{Any}"><code>Mycelia.add_bioconda_env</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">add_bioconda_env(pkg; force) -&gt; Union{Nothing, Base.Process}
</code></pre><p>Create a new Conda environment with a specified Bioconda package.</p><p><strong>Arguments</strong></p><ul><li><code>pkg::String</code>: Package name to install. Can include channel specification using </li></ul><p>the format &quot;channel::package&quot;</p><p><strong>Keywords</strong></p><ul><li><code>force::Bool=false</code>: If true, recreates the environment even if it already exists</li></ul><p><strong>Details</strong></p><p>The function creates a new Conda environment named after the package and installs the package into it. It uses channel priority: conda-forge &gt; bioconda &gt; defaults. If CONDA_RUNNER is set to &#39;mamba&#39;, it will ensure mamba is installed first.</p><p><strong>Examples</strong></p><pre><code class="language-julia hljs"># Install basic package
add_bioconda_env(&quot;blast&quot;)

# Install from specific channel
add_bioconda_env(&quot;bioconda::blast&quot;)

# Force reinstallation
add_bioconda_env(&quot;blast&quot;, force=true)</code></pre><p><strong>Notes</strong></p><ul><li>Requires Conda.jl to be installed and configured</li><li>Uses CONDA_RUNNER global variable to determine whether to use conda or mamba</li><li>Cleans conda cache after installation</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/bioconda.jl#LL132">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.add_edgemer_to_graph!-NTuple{4, Any}" href="#Mycelia.add_edgemer_to_graph!-NTuple{4, Any}"><code>Mycelia.add_edgemer_to_graph!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">add_edgemer_to_graph!(
    graph,
    record_identifier,
    index,
    observed_edgemer
) -&gt; Any
</code></pre><p>Add an observed edgemer to a graph with its associated metadata.</p><p><strong>Arguments</strong></p><ul><li><code>graph::MetaGraph</code>: The graph to modify</li><li><code>record_identifier</code>: Identifier for the source record</li><li><code>index</code>: Position where edgemer was observed</li><li><code>observed_edgemer</code>: The biological sequence representing the edgemer</li></ul><p><strong>Details</strong></p><p>Processes the edgemer by:</p><ol><li>Splitting it into source and destination kmers</li><li>Converting kmers to their canonical forms</li><li>Creating or updating an edge with orientation metadata</li><li>Storing observation details (record, position, orientation)</li></ol><p><strong>Returns</strong></p><p>Modified graph with the new edge and metadata</p><p><strong>Note</strong></p><p>If the edge already exists, the observation is added to the existing metadata.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/sequence-graphs.jl#LL2690">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.add_fastx_records_to_graph!-Tuple{Any, Any}" href="#Mycelia.add_fastx_records_to_graph!-Tuple{Any, Any}"><code>Mycelia.add_fastx_records_to_graph!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">add_fastx_records_to_graph!(graph, fastxs) -&gt; Any
</code></pre><p>Add FASTX records from multiple files as a graph property.</p><p><strong>Arguments</strong></p><ul><li><code>graph</code>: A MetaGraph that will store the FASTX records</li><li><code>fastxs</code>: Collection of FASTA/FASTQ file paths to process</li></ul><p><strong>Details</strong></p><p>Creates a dictionary mapping sequence descriptions to their corresponding FASTX records, then stores this dictionary as a graph property under the key <code>:records</code>. Multiple input files are merged, with later files overwriting records with duplicate descriptions.</p><p><strong>Returns</strong></p><p>The modified graph with added records property.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/sequence-graphs.jl#LL2613">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.add_record_edgemers_to_graph!-Tuple{Any}" href="#Mycelia.add_record_edgemers_to_graph!-Tuple{Any}"><code>Mycelia.add_record_edgemers_to_graph!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">add_record_edgemers_to_graph!(graph) -&gt; Any
</code></pre><p>Processes DNA sequence records stored in the graph and adds their edgemers (k+1 length subsequences)  to build the graph structure.</p><p><strong>Arguments</strong></p><ul><li><code>graph</code>: A Mycelia graph object containing DNA sequence records and graph properties</li></ul><p><strong>Details</strong></p><ul><li>Uses the k-mer size specified in <code>graph.gprops[:k]</code> to generate k+1 length edgemers</li><li>Iterates through each record in <code>graph.gprops[:records]</code></li><li>For each record, generates all possible overlapping edgemers</li><li>Adds each edgemer to the graph with its position and record information</li></ul><p><strong>Returns</strong></p><ul><li>The modified graph object with added edgemer information</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/sequence-graphs.jl#LL2641">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.adjust_quality_scores-Tuple{String, String, Float64}" href="#Mycelia.adjust_quality_scores-Tuple{String, String, Float64}"><code>Mycelia.adjust_quality_scores</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Adjust quality scores based on likelihood improvement.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/iterative-assembly.jl#LL644-L646">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.alphabet_to_biosequence_type-Tuple{Symbol}" href="#Mycelia.alphabet_to_biosequence_type-Tuple{Symbol}"><code>Mycelia.alphabet_to_biosequence_type</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">alphabet_to_biosequence_type(
    alphabet::Symbol
) -&gt; Union{Type{BioSequences.LongAA}, Type{BioSequences.LongSequence{BioSequences.DNAAlphabet{4}}}, Type{BioSequences.LongSequence{BioSequences.RNAAlphabet{4}}}}
</code></pre><p>Determine the BioSequence type from an alphabet symbol.</p><p>Maps alphabet symbols to the corresponding BioSequences.jl type for  type-safe sequence operations throughout the codebase.</p><p><strong>Arguments</strong></p><ul><li><code>alphabet::Symbol</code>: The alphabet symbol (<code>:DNA</code>, <code>:RNA</code>, or <code>:AA</code>)</li></ul><p><strong>Returns</strong></p><ul><li><code>Type{&lt;:BioSequences.BioSequence}</code>: The corresponding BioSequence type</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia hljs">alphabet_to_biosequence_type(:DNA)  # Returns BioSequences.LongDNA{4}
alphabet_to_biosequence_type(:RNA)  # Returns BioSequences.LongRNA{4}
alphabet_to_biosequence_type(:AA)   # Returns BioSequences.LongAA</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/utility-functions.jl#LL2087">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.amino_acids_to_codons-Tuple{}" href="#Mycelia.amino_acids_to_codons-Tuple{}"><code>Mycelia.amino_acids_to_codons</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">amino_acids_to_codons(

) -&gt; Dict{BioSymbols.AminoAcid, DataType}
</code></pre><p>Creates a mapping from amino acids to representative DNA codons using the standard genetic code.</p><p><strong>Returns</strong></p><ul><li>Dictionary mapping each amino acid (including stop codon <code>AA_Term</code>) to a valid DNA codon that encodes it</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/codon-optimization.jl#LL124">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.analyze_fastq_quality-Tuple{String}" href="#Mycelia.analyze_fastq_quality-Tuple{String}"><code>Mycelia.analyze_fastq_quality</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">analyze_fastq_quality(fastq_file::String)</code></pre><p>Analyzes quality metrics for a FASTQ file.</p><p>Calculates comprehensive quality statistics including read count, quality scores, length distribution, GC content, and quality threshold percentages.</p><p><strong>Arguments</strong></p><ul><li><code>fastq_file</code>: Path to FASTQ file (can be gzipped)</li></ul><p><strong>Returns</strong></p><p>FastqQualityResults with the following fields:</p><ul><li><code>n_reads</code>: Total number of reads</li><li><code>mean_quality</code>: Average Phred quality score across all reads</li><li><code>mean_length</code>: Average read length</li><li><code>gc_content</code>: GC content percentage</li><li><code>quality_distribution</code>: QualityDistribution with Q20+, Q30+, Q40+ percentages</li></ul><p><strong>Example</strong></p><pre><code class="language-julia hljs">quality_stats = Mycelia.analyze_fastq_quality(&quot;reads.fastq&quot;)
println(&quot;Total reads: $(quality_stats.n_reads)&quot;)
println(&quot;Mean quality: $(quality_stats.mean_quality)&quot;)
println(&quot;Q30+ reads: $(quality_stats.quality_distribution.q30_percent)%&quot;)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/quality-control-and-benchmarking.jl#LL579-L605">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.analyze_pangenome_kmers-Tuple{Vector{String}}" href="#Mycelia.analyze_pangenome_kmers-Tuple{Vector{String}}"><code>Mycelia.analyze_pangenome_kmers</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">analyze_pangenome_kmers(genome_files::Vector{String}; kmer_type=Kmers.DNAKmer{21}, distance_metric=:jaccard)</code></pre><p>Perform comprehensive k-mer based pangenome analysis using existing Mycelia infrastructure.</p><p>Leverages existing <code>count_canonical_kmers</code> and distance metric functions to analyze genomic content across multiple genomes, identifying core, accessory, and unique regions.</p><p><strong>Arguments</strong></p><ul><li><code>genome_files</code>: Vector of FASTA file paths containing genome sequences</li><li><code>kmer_type</code>: K-mer type from Kmers.jl (default: <code>Kmers.DNAKmer{21}</code>)</li><li><code>distance_metric</code>: Distance metric (<code>:jaccard</code>, <code>:bray_curtis</code>, <code>:cosine</code>, <code>:js_divergence</code>)</li></ul><p><strong>Returns</strong></p><ul><li><code>PangenomeAnalysisResult</code> with comprehensive pangenome statistics</li></ul><p><strong>Example</strong></p><pre><code class="language-julia hljs">genome_files = [&quot;genome1.fasta&quot;, &quot;genome2.fasta&quot;, &quot;genome3.fasta&quot;]
result = Mycelia.analyze_pangenome_kmers(genome_files, kmer_type=Kmers.DNAKmer{31})
println(&quot;Core k-mers: $(length(result.core_kmers))&quot;)
println(&quot;Total pangenome size: $(size(result.presence_absence_matrix, 1)) k-mers&quot;)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/pangenome-analysis.jl#LL21-L44">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.analyze_repeat_region-Tuple{MetaGraphsNext.MetaGraph{&lt;:Integer, String, Mycelia.KmerVertexData, Mycelia.KmerEdgeData}, String, Int64}" href="#Mycelia.analyze_repeat_region-Tuple{MetaGraphsNext.MetaGraph{&lt;:Integer, String, Mycelia.KmerVertexData, Mycelia.KmerEdgeData}, String, Int64}"><code>Mycelia.analyze_repeat_region</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Analyze a potential repeat region starting from a vertex.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/sequence-graphs-next.jl#LL1518-L1520">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.annotate_aa_fasta-Tuple{}" href="#Mycelia.annotate_aa_fasta-Tuple{}"><code>Mycelia.annotate_aa_fasta</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">annotate_aa_fasta(
;
    fasta,
    identifier,
    basedir,
    mmseqsdb,
    threads
)
</code></pre><p>Annotate amino acid sequences in a FASTA file using MMseqs2 search against UniRef50 database.</p><p><strong>Arguments</strong></p><ul><li><code>fasta</code>: Path to input FASTA file containing amino acid sequences</li><li><code>identifier</code>: Name for the output directory (defaults to FASTA filename without extension)</li><li><code>basedir</code>: Base directory for output (defaults to current directory)</li><li><code>mmseqsdb</code>: Path to MMseqs2 formatted UniRef50 database (defaults to ~/workspace/mmseqs/UniRef50)</li><li><code>threads</code>: Number of CPU threads to use (defaults to system thread count)</li></ul><p><strong>Returns</strong></p><ul><li>Path to the output directory containing MMseqs2 search results</li></ul><p>The function creates a new directory named by <code>identifier</code> under <code>basedir</code>, copies the input FASTA file, and runs MMseqs2 easy-search against the specified database. If the output directory already exists, the function skips processing and returns the directory path.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/annotation.jl#LL1371">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.annotate_fasta-Tuple{}" href="#Mycelia.annotate_fasta-Tuple{}"><code>Mycelia.annotate_fasta</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">annotate_fasta(
;
    fasta,
    identifier,
    basedir,
    mmseqsdb,
    threads
)
</code></pre><p>Perform comprehensive annotation of a FASTA file including gene prediction, protein homology search, and terminator prediction.</p><p><strong>Arguments</strong></p><ul><li><code>fasta::String</code>: Path to input FASTA file</li><li><code>identifier::String</code>: Unique identifier for output directory (default: FASTA filename without extension)</li><li><code>basedir::String</code>: Base directory for output (default: current working directory)</li><li><code>mmseqsdb::String</code>: Path to MMseqs2 UniRef50 database (default: <code>joinpath(homedir(), &quot;workspace/mmseqs/UniRef50&quot;)</code>)</li><li><code>threads::Int</code>: Number of CPU threads to use (default: all available). Note: This argument is not explicitly used by Pyrodigal or MMseqs2 in this version of the function, they might use their own defaults or require modifications to <code>run_pyrodigal</code> or <code>run_mmseqs_easy_search</code> to respect it.</li></ul><p><strong>Processing Steps</strong></p><ol><li>Creates output directory and copies input FASTA.</li><li>Runs Pyrodigal for gene prediction (nucleotide, amino acid, and GFF output).</li><li>Performs MMseqs2 homology search against UniRef50.</li><li>Predicts terminators using TransTerm.</li><li>Combines annotations into a unified GFF file.</li><li>Generates GenBank format output.</li></ol><p><strong>Returns</strong></p><ul><li><code>String</code>: Path to the output directory containing all generated files.</li></ul><p><strong>Files Generated (within the output directory specified by <code>identifier</code>)</strong></p><ul><li><code>(basename(fasta)).pyrodigal.fna</code>: Predicted genes (nucleotide) from Pyrodigal.</li><li><code>(basename(fasta)).pyrodigal.faa</code>: Predicted proteins from Pyrodigal.</li><li><code>(basename(fasta)).pyrodigal.gff</code>: Pyrodigal GFF annotations.</li><li><code>(basename(fasta)).gff</code>: Combined GFF annotations (MMseqs2 and TransTerm).</li><li><code>(basename(fasta)).gff.genbank</code>: Final GenBank format from the first combined GFF.</li><li><code>(basename(fasta)).transterm_raw.gff</code>: Combined GFF (MMseqs2 and a second TransTerm run).</li><li><code>(basename(fasta)).transterm_raw.gff.genbank</code>: Final GenBank format from the second combined GFF.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/annotation.jl#LL1285">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.apply_learned_policy-Tuple{Mycelia.DQNPolicy, String}" href="#Mycelia.apply_learned_policy-Tuple{Mycelia.DQNPolicy, String}"><code>Mycelia.apply_learned_policy</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">apply_learned_policy(policy::DQNPolicy, input_fastq::String; output_dir=&quot;rl_assembly&quot;)</code></pre><p>Apply a trained RL policy to perform genome assembly.</p><p>This function uses a trained policy to make autonomous assembly decisions.</p><p><strong>Arguments</strong></p><ul><li><code>policy::DQNPolicy</code>: Trained assembly policy</li><li><code>input_fastq::String</code>: Path to input FASTQ file</li><li><code>output_dir::String</code>: Output directory for assembly results</li></ul><p><strong>Returns</strong></p><ul><li><code>Dict{String, Any}</code>: Assembly results and metadata</li></ul><p><strong>Example</strong></p><pre><code class="language-julia hljs">results = apply_learned_policy(trained_policy, &quot;genome.fastq&quot;)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/reinforcement-learning.jl#LL1155-L1174">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.are_equivalent_bubbles-Tuple{Mycelia.BubbleStructure, Mycelia.BubbleStructure}" href="#Mycelia.are_equivalent_bubbles-Tuple{Mycelia.BubbleStructure, Mycelia.BubbleStructure}"><code>Mycelia.are_equivalent_bubbles</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Check if two bubbles are equivalent.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/sequence-graphs-next.jl#LL1461-L1463">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.assemble_genome-Tuple{Any}" href="#Mycelia.assemble_genome-Tuple{Any}"><code>Mycelia.assemble_genome</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">assemble_genome(reads; method=StringGraph, config=AssemblyConfig()) -&gt; AssemblyResult</code></pre><p>Unified genome assembly interface using Phase 2 next-generation algorithms.</p><p><strong>Arguments</strong></p><ul><li><code>reads</code>: Vector of FASTA/FASTQ records or file paths</li><li><code>method</code>: Assembly strategy (StringGraph, KmerGraph, HybridOLC, MultiK)</li><li><code>config</code>: Assembly configuration parameters</li></ul><p><strong>Returns</strong></p><ul><li><code>AssemblyResult</code>: Structure containing contigs, names, and assembly metadata</li></ul><p><strong>Details</strong></p><p>This is the main entry point for the unified assembly pipeline, leveraging:</p><ul><li>Phase 1: MetaGraphsNext strand-aware graph construction  </li><li>Phase 2: Probabilistic algorithms, enhanced Viterbi, and graph algorithms</li><li>Phase 3: Integrated workflow with polishing and validation</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia hljs"># Basic assembly with default parameters
reads = load_fastq_records(&quot;reads.fastq&quot;)
result = assemble_genome(reads)

# Custom assembly with specific k-mer size and error rate
config = AssemblyConfig(k=25, error_rate=0.005, polish_iterations=5)
result = assemble_genome(reads; method=KmerGraph, config=config)

# Access results
contigs = result.contigs
stats = result.assembly_stats</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/assembly.jl#LL321-L354">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.assemble_strings-Tuple{MetaGraphsNext.MetaGraph{var&quot;#s35&quot;, Graph} where {var&quot;#s35&quot;&lt;:Graphs.SimpleGraphs.AbstractSimpleGraph, Graph&lt;:Graphs.AbstractGraph{var&quot;#s35&quot;}}}" href="#Mycelia.assemble_strings-Tuple{MetaGraphsNext.MetaGraph{var&quot;#s35&quot;, Graph} where {var&quot;#s35&quot;&lt;:Graphs.SimpleGraphs.AbstractSimpleGraph, Graph&lt;:Graphs.AbstractGraph{var&quot;#s35&quot;}}}"><code>Mycelia.assemble_strings</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Assemble strings by performing graph walks from each connected component.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/string-graphs.jl#LL145-L147">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.assembly_summary-Tuple{Dict{Int64, Any}}" href="#Mycelia.assembly_summary-Tuple{Dict{Int64, Any}}"><code>Mycelia.assembly_summary</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Generate a summary report of the assembly process.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/intelligent-assembly.jl#LL605-L607">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.assess_alignment-Tuple{Any, Any}" href="#Mycelia.assess_alignment-Tuple{Any, Any}"><code>Mycelia.assess_alignment</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">assess_alignment(
    a,
    b
) -&gt; @NamedTuple{total_matches::Int64, total_edits::Int64}
</code></pre><p>Aligns two sequences using the Levenshtein distance and returns the total number of matches and edits.</p><p><strong>Arguments</strong></p><ul><li><code>a::AbstractString</code>: The first sequence to be aligned.</li><li><code>b::AbstractString</code>: The second sequence to be aligned.</li></ul><p><strong>Returns</strong></p><ul><li><code>NamedTuple{(:total_matches, :total_edits), Tuple{Int, Int}}</code>: A named tuple containing:<ul><li><code>total_matches::Int</code>: The total number of matching bases in the alignment.</li><li><code>total_edits::Int</code>: The total number of edits (insertions, deletions, substitutions) in the alignment.</li></ul></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/alignments-and-mapping.jl#LL338">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.assess_alignment_accuracy-Tuple{Any}" href="#Mycelia.assess_alignment_accuracy-Tuple{Any}"><code>Mycelia.assess_alignment_accuracy</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">assess_alignment_accuracy(alignment_result) -&gt; Any
</code></pre><p>Return proportion of matched bases in alignment to total matches + edits.</p><p>Calculate the accuracy of a sequence alignment by computing the ratio of matched bases  to total alignment operations (matches + edits).</p><p><strong>Arguments</strong></p><ul><li><code>alignment_result</code>: Alignment result object containing <code>total_matches</code> and <code>total_edits</code> fields</li></ul><p><strong>Returns</strong></p><p>Float64 between 0.0 and 1.0 representing alignment accuracy, where:</p><ul><li>1.0 indicates perfect alignment (all matches)</li><li>0.0 indicates no matches</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/alignments-and-mapping.jl#LL274">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.assess_assembly_kmer_quality-Tuple{}" href="#Mycelia.assess_assembly_kmer_quality-Tuple{}"><code>Mycelia.assess_assembly_kmer_quality</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">assess_assembly_kmer_quality(; assembly, observations, ks)
</code></pre><p>Evaluate genome assembly quality by comparing k-mer distributions between assembled sequences and raw observations.</p><p><strong>Arguments</strong></p><ul><li><code>assembly</code>: Input assembled sequences to evaluate</li><li><code>observations</code>: Raw sequencing data for comparison</li><li><code>ks::Vector{Int}</code>: Vector of k-mer sizes to analyze (default: k=17 to 23)</li></ul><p><strong>Returns</strong></p><p>DataFrame containing quality metrics for each k-mer size:</p><ul><li><code>k</code>: K-mer length used</li><li><code>cosine_distance</code>: Cosine similarity between k-mer distributions</li><li><code>js_divergence</code>: Jensen-Shannon divergence between distributions  </li><li><code>qv</code>: MerQury-style quality value score</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/kmer-analysis.jl#LL409">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.assess_assembly_quality-Tuple{Any}" href="#Mycelia.assess_assembly_quality-Tuple{Any}"><code>Mycelia.assess_assembly_quality</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">assess_assembly_quality(contigs_file)</code></pre><p>Assess basic assembly quality metrics from a FASTA file.</p><p>Calculates standard assembly quality metrics including contig count, total length, and N50 statistic for assembly evaluation.</p><p><strong>Arguments</strong></p><ul><li><code>contigs_file</code>: Path to FASTA file containing assembly contigs</li></ul><p><strong>Returns</strong></p><ul><li>Tuple of (n<em>contigs, total</em>length, n50, l50)<ul><li><code>n_contigs</code>: Number of contigs in the assembly</li><li><code>total_length</code>: Total length of all contigs in base pairs</li><li><code>n50</code>: N50 statistic (length of shortest contig in the set covering 50% of assembly)</li><li><code>l50</code>: L50 statistic (number of contigs needed to reach 50% of assembly length)</li></ul></li></ul><p><strong>Example</strong></p><pre><code class="language-julia hljs">n_contigs, total_length, n50, l50 = assess_assembly_quality(&quot;assembly.fasta&quot;)
println(&quot;Assembly has $n_contigs contigs, $total_length bp total, N50=$n50, L50=$l50&quot;)</code></pre><p><strong>See Also</strong></p><ul><li><code>assess_assembly_kmer_quality</code>: For k-mer based assembly quality assessment</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/quality-control-and-benchmarking.jl#LL189-L215">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.assess_dnamer_saturation-Tuple{AbstractString}" href="#Mycelia.assess_dnamer_saturation-Tuple{AbstractString}"><code>Mycelia.assess_dnamer_saturation</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">assess_dnamer_saturation(
    fastx::AbstractString;
    power,
    outdir,
    min_k,
    max_k,
    threshold,
    kmers_to_assess
)
</code></pre><p>Analyzes k-mer saturation in a FASTA/FASTQ file to determine optimal k-mer size.</p><p><strong>Arguments</strong></p><ul><li><code>fastx::AbstractString</code>: Path to input FASTA/FASTQ file</li><li><code>power::Int=10</code>: Exponent for downsampling k-mers (2^power)</li><li><code>outdir::String=&quot;&quot;</code>: Output directory for results. Uses current directory if empty</li><li><code>min_k::Int=3</code>: Minimum k-mer size to evaluate</li><li><code>max_k::Int=17</code>: Maximum k-mer size to evaluate</li><li><code>threshold::Float64=0.1</code>: Saturation threshold for k-mer assessment</li><li><code>kmers_to_assess::Int=10_000_000</code>: Maximum number of k-mers to sample</li></ul><p><strong>Returns</strong></p><p><code>Dict{Int,Float64}</code>: Dictionary mapping k-mer sizes to their saturation scores</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/kmer-analysis.jl#LL820">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.assess_dnamer_saturation-Tuple{AbstractVector{&lt;:AbstractString}, Any}" href="#Mycelia.assess_dnamer_saturation-Tuple{AbstractVector{&lt;:AbstractString}, Any}"><code>Mycelia.assess_dnamer_saturation</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">assess_dnamer_saturation(
    fastxs::AbstractVector{&lt;:AbstractString},
    kmer_type;
    kmers_to_assess,
    power,
    min_count
) -&gt; Union{@NamedTuple{sampling_points::Vector{Int64}, unique_kmer_counts::Vector{Int64}}, NamedTuple{(:sampling_points, :unique_kmer_counts, :eof), &lt;:Tuple{Vector, Vector{Int64}, Bool}}}
</code></pre><p>Assess k-mer saturation in DNA sequences from FASTX files.</p><p><strong>Arguments</strong></p><ul><li><code>fastxs::AbstractVector{&lt;:AbstractString}</code>: Vector of paths to FASTA/FASTQ files</li><li><code>kmer_type</code>: Type of k-mer to analyze (e.g., DNAKmer{21})</li><li><code>kmers_to_assess=Inf</code>: Maximum number of k-mers to process</li><li><code>power=10</code>: Base for exponential sampling intervals</li><li><code>min_count=1</code>: Minimum count threshold for considering a k-mer</li></ul><p><strong>Returns</strong></p><p>Named tuple containing:</p><ul><li><code>sampling_points::Vector{Int}</code>: K-mer counts at which samples were taken</li><li><code>unique_kmer_counts::Vector{Int}</code>: Number of unique canonical k-mers at each sampling point</li><li><code>eof::Bool</code>: Whether the entire input was processed</li></ul><p><strong>Details</strong></p><p>Analyzes k-mer saturation by counting unique canonical k-mers at exponentially spaced  intervals (powers of <code>power</code>). Useful for assessing sequence complexity and coverage. Returns early if all possible k-mers are observed.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/kmer-analysis.jl#LL618">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.assess_dnamer_saturation-Tuple{AbstractVector{&lt;:AbstractString}}" href="#Mycelia.assess_dnamer_saturation-Tuple{AbstractVector{&lt;:AbstractString}}"><code>Mycelia.assess_dnamer_saturation</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">assess_dnamer_saturation(
    fastxs::AbstractVector{&lt;:AbstractString};
    power,
    outdir,
    min_k,
    max_k,
    threshold,
    kmers_to_assess,
    plot
)
</code></pre><p>Analyze k-mer saturation in DNA sequences to determine optimal k value.</p><p><strong>Arguments</strong></p><ul><li><code>fastxs</code>: Vector of paths to FASTA/FASTQ files to analyze</li><li><code>power</code>: Base of logarithmic sampling points (default: 10)</li><li><code>outdir</code>: Optional output directory for plots and results</li><li><code>min_k</code>: Minimum k-mer size to test (default: 7)</li><li><code>max_k</code>: Maximum k-mer size to test (default: 17)</li><li><code>threshold</code>: Saturation threshold to determine optimal k (default: 0.1)</li><li><code>kmers_to_assess</code>: Maximum number of k-mers to sample (default: 10M)</li><li><code>plot</code>: Whether to generate saturation curves (default: true)</li></ul><p><strong>Returns</strong></p><p>Integer representing the first k value that achieves saturation below threshold. If no k value meets the threshold, returns the k with minimum saturation.</p><p><strong>Details</strong></p><ul><li>Tests only prime k values between min<em>k and max</em>k</li><li>Generates saturation curves using logarithmic sampling</li><li>Fits curves to estimate maximum unique k-mers</li><li>If outdir is provided, saves plots as SVG and chosen k value to text file</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/kmer-analysis.jl#LL706">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.assess_duplication_rates-Tuple{Any}" href="#Mycelia.assess_duplication_rates-Tuple{Any}"><code>Mycelia.assess_duplication_rates</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">assess_duplication_rates(fastq; results_table) -&gt; Any
</code></pre><p>Analyze sequence duplication rates in a FASTQ file.</p><p>This function processes a FASTQ file to quantify both exact sequence duplications and  canonical duplications (considering sequences and their reverse complements as equivalent). The function makes two passes through the file: first to count total records, then to analyze unique sequences.</p><p><strong>Arguments</strong></p><ul><li><code>fastq::String</code>: Path to the input FASTQ file to analyze</li><li><code>results_table::String</code>: Optional. Path where the results will be saved as a tab-separated file. Defaults to the same path as the input file but with extension changed to &quot;.duplication_rates.tsv&quot;</li></ul><p><strong>Returns</strong></p><ul><li><code>String</code>: Path to the results table file</li></ul><p><strong>Output</strong></p><p>Generates a tab-separated file containing the following metrics:</p><ul><li><code>total_records</code>: Total number of sequence records in the file</li><li><code>total_unique_observations</code>: Count of unique sequence strings</li><li><code>total_unique_canonical_observations</code>: Count of unique canonical sequences  (after normalizing for reverse complements)</li><li><code>percent_unique_observations</code>: Percentage of sequences that are unique</li><li><code>percent_unique_canonical_observations</code>: Percentage of sequences that are unique after canonicalization</li><li><code>percent_duplication_rate</code>: Percentage of sequences that are duplicates (100 - percent<em>unique</em>observations)</li><li><code>percent_canonical_duplication_rate</code>: Percentage of sequences that are duplicates after canonicalization</li></ul><p><strong>Notes</strong></p><ul><li>If the specified results file already exists and is not empty, the function will return early without recomputing.</li><li>Progress is displayed during processing with a progress bar showing speed.</li></ul><p><strong>Example</strong></p><pre><code class="language-julia hljs"># Analyze a FASTQ file and save results to default location
result_path = assess_duplication_rates(&quot;data/sample.fastq&quot;)

# Specify custom output path
result_path = assess_duplication_rates(&quot;data/sample.fastq&quot;, results_table=&quot;results/duplication_analysis.tsv&quot;)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/fastx.jl#LL118">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.assess_optimal_kmer_alignment-Tuple{Any, Any}" href="#Mycelia.assess_optimal_kmer_alignment-Tuple{Any, Any}"><code>Mycelia.assess_optimal_kmer_alignment</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">assess_optimal_kmer_alignment(
    kmer,
    observed_kmer
) -&gt; Tuple{@NamedTuple{total_matches::Int64, total_edits::Int64}, Union{Missing, Bool}}
</code></pre><p>Used to determine which orientation provides an optimal alignment for initiating path likelihood analyses in viterbi analysis</p><p>Compare alignment scores between a query k-mer and an observed k-mer in both forward and reverse complement orientations to determine optimal alignment.</p><p><strong>Arguments</strong></p><ul><li><code>kmer</code>: Query k-mer sequence to align</li><li><code>observed_kmer</code>: Target k-mer sequence to align against</li></ul><p><strong>Returns</strong></p><p>A tuple containing:</p><ul><li><code>alignment_result</code>: The alignment result object for the optimal orientation</li><li><code>orientation</code>: Boolean indicating orientation (<code>true</code> = forward, <code>false</code> = reverse complement, <code>missing</code> = tied scores)</li></ul><p><strong>Details</strong></p><ul><li>Performs pairwise alignment in both orientations using <code>assess_alignment()</code></li><li>Calculates accuracy scores using <code>assess_alignment_accuracy()</code></li><li>For tied alignment scores, randomly selects one orientation</li><li>Uses BioSequences.reverse_complement for reverse orientation comparison</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/alignments-and-mapping.jl#LL294">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.attempt_error_correction-Tuple{Any, Any, Any}" href="#Mycelia.attempt_error_correction-Tuple{Any, Any, Any}"><code>Mycelia.attempt_error_correction</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Attempt to correct a specific k-mer using probabilistic path finding. Returns true if correction was applied.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/intelligent-assembly.jl#LL215-L218">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.bam_to_fastq-Tuple{}" href="#Mycelia.bam_to_fastq-Tuple{}"><code>Mycelia.bam_to_fastq</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">bam_to_fastq(; bam, fastq)
</code></pre><p>Convert a BAM file to FASTQ format with gzip compression.</p><p><strong>Arguments</strong></p><ul><li><code>bam</code>: Path to input BAM file</li><li><code>fastq</code>: Optional output path. Defaults to input path with &quot;.fq.gz&quot; extension</li></ul><p><strong>Returns</strong></p><ul><li>Path to the generated FASTQ file</li></ul><p><strong>Details</strong></p><ul><li>Uses samtools through conda environment</li><li>Automatically skips if output file exists</li><li>Output is gzip compressed</li><li>Requires samtools to be available via conda</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/xam.jl#LL401">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.bandage_visualize-Tuple{}" href="#Mycelia.bandage_visualize-Tuple{}"><code>Mycelia.bandage_visualize</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">bandage_visualize(; gfa, img)
</code></pre><p>Generate a visualization of a genome assembly graph using Bandage.</p><p><strong>Arguments</strong></p><ul><li><code>gfa</code>: Path to input GFA (Graphical Fragment Assembly) file</li><li><code>img</code>: Optional output image path. Defaults to GFA filename with .png extension</li></ul><p><strong>Returns</strong></p><ul><li>Path to the generated image file</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/plotting-and-visualization.jl#LL979">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.batch_download_viroid_references-Tuple{Vector{String}}" href="#Mycelia.batch_download_viroid_references-Tuple{Vector{String}}"><code>Mycelia.batch_download_viroid_references</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">batch_download_viroid_references(
    species_list::Vector{String};
    base_outdir,
    download_genome,
    download_cds,
    download_protein,
    max_per_species
) -&gt; Dict{String, Any}
</code></pre><p>Download reference data for multiple viroid species in batch.</p><p><strong>Arguments</strong></p><ul><li><code>species_list::Vector{String}</code>: List of viroid species to download</li><li><code>base_outdir::String</code>: Base output directory (subdirectories created per species)</li><li><code>download_genome::Bool</code>: Download genomic sequences (default: true)</li><li><code>download_cds::Bool</code>: Download CDS sequences (default: true)</li><li><code>download_protein::Bool</code>: Download protein sequences (default: true)</li><li><code>max_per_species::Int</code>: Maximum sequences per species per type (default: 5)</li></ul><p><strong>Returns</strong></p><ul><li><code>Dict{String, NamedTuple}</code>: Dictionary mapping species names to their downloaded file info</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia hljs"># Download data for all known viroid species
species_list = get_viroid_species_list()
results = batch_download_viroid_references(species_list, &quot;viroid_database/&quot;)

# Download only genomes for a subset
pstv_like = [&quot;Potato spindle tuber viroid&quot;, &quot;Tomato planta macho viroid&quot;]  
results = batch_download_viroid_references(pstv_like, &quot;pstv_group/&quot;;
                                         download_cds=false, download_protein=false)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/reference-databases.jl#LL3189">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.benchmark_graph_construction" href="#Mycelia.benchmark_graph_construction"><code>Mycelia.benchmark_graph_construction</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">benchmark_graph_construction()
benchmark_graph_construction(
    config::Mycelia.BenchmarkConfig
)
</code></pre><p>Benchmark graph construction performance: Legacy vs Next-generation.</p><p>Compares:</p><ul><li>MetaGraphs.jl (legacy) vs MetaGraphsNext.jl (next-gen)</li><li>Memory allocation patterns</li><li>Construction time</li><li>Type stability</li></ul><p><strong>Arguments</strong></p><ul><li><code>config</code>: BenchmarkConfig for test parameters</li></ul><p><strong>Returns</strong></p><ul><li>NamedTuple with benchmark results</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/performance-benchmarks.jl#LL59">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.benchmark_memory_patterns" href="#Mycelia.benchmark_memory_patterns"><code>Mycelia.benchmark_memory_patterns</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">benchmark_memory_patterns()
benchmark_memory_patterns(config::Mycelia.BenchmarkConfig)
</code></pre><p>Benchmark memory usage patterns for different graph representations.</p><p>Compares memory usage of:</p><ul><li>Stranded vertices (legacy) vs canonical vertices (next-gen)</li><li>Edge metadata structures</li><li>Coverage tracking efficiency</li></ul><p><strong>Arguments</strong></p><ul><li><code>config</code>: BenchmarkConfig for test parameters</li></ul><p><strong>Returns</strong></p><ul><li>NamedTuple with memory analysis results</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/performance-benchmarks.jl#LL143">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.benchmark_type_stability" href="#Mycelia.benchmark_type_stability"><code>Mycelia.benchmark_type_stability</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">benchmark_type_stability()
benchmark_type_stability(config::Mycelia.BenchmarkConfig)
</code></pre><p>Benchmark type stability and allocation patterns.</p><p>Measures:</p><ul><li>Type inference success</li><li>Runtime allocations</li><li>Performance predictability</li></ul><p><strong>Arguments</strong></p><ul><li><code>config</code>: BenchmarkConfig for test parameters</li></ul><p><strong>Returns</strong></p><ul><li>NamedTuple with type stability metrics</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/performance-benchmarks.jl#LL203">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.bernoulli_pca_epca-Tuple{AbstractMatrix{Bool}}" href="#Mycelia.bernoulli_pca_epca-Tuple{AbstractMatrix{Bool}}"><code>Mycelia.bernoulli_pca_epca</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>bernoulli<em>pca</em>epca(M::AbstractMatrix{Bool}; k::Int=0)</p><p>Perform Bernoulli (logistic) EPCA on a 0/1 matrix <code>M</code> (features × samples).</p><p><strong>When to use</strong></p><p>Use for binary (0/1) data, such as presence/absence or yes/no features.</p><p><strong>Returns</strong></p><p>A NamedTuple with</p><ul><li><code>model</code>    : the fitted <code>ExpFamilyPCA.BernoulliEPCA</code> object  </li><li><code>scores</code>   : k×n_samples matrix of low‐dimensional sample scores  </li><li><code>loadings</code> : k×n_features matrix of feature loadings  </li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/dimensionality-reduction.jl#LL190-L203">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.best_label_mapping-Tuple{Any, Any}" href="#Mycelia.best_label_mapping-Tuple{Any, Any}"><code>Mycelia.best_label_mapping</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">best_label_mapping(true_labels, pred_labels)</code></pre><p>Finds the optimal mapping from predicted labels to true labels using the Hungarian algorithm, so that the total overlap (confusion matrix diagonal) is maximized. Returns the remapped predicted labels and the mapping as a Dict.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/quality-control-and-benchmarking.jl#LL153-L159">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.binary_matrix_to_jaccard_distance_matrix-Tuple{Union{BitMatrix, Matrix{Bool}}}" href="#Mycelia.binary_matrix_to_jaccard_distance_matrix-Tuple{Union{BitMatrix, Matrix{Bool}}}"><code>Mycelia.binary_matrix_to_jaccard_distance_matrix</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">binary_matrix_to_jaccard_distance_matrix(binary_matrix::Union{BitMatrix, Matrix{Bool}})</code></pre><p>Pairwise Jaccard distance between columns of a binary matrix (BitMatrix or Matrix{Bool}). Throws an error if the input is not strictly a binary matrix.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/distance-metrics.jl#LL338-L343">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.binomial_pca_epca-Tuple{AbstractMatrix{&lt;:Integer}}" href="#Mycelia.binomial_pca_epca-Tuple{AbstractMatrix{&lt;:Integer}}"><code>Mycelia.binomial_pca_epca</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">binomial_pca_epca(M::AbstractMatrix{&lt;:Integer}; k::Int=0, ntrials::Int=1)</code></pre><p>Perform Binomial EPCA on a count matrix <code>M</code> (features × samples).</p><p><strong>When to use</strong></p><p>Use for integer count data representing the number of successes out of a fixed number of trials (e.g., number of mutated alleles out of total alleles).</p><p><strong>Keyword arguments</strong></p><ul><li><code>k</code> : desired number of latent dimensions; if <code>k&lt;1</code> defaults to <code>min(n_samples-1, n_features, 10)</code></li><li><code>ntrials</code> : number of trials for the Binomial distribution (default=1)</li></ul><p><strong>Returns</strong></p><p>NamedTuple with fields</p><ul><li><code>model</code>    : the fitted <code>ExpFamilyPCA.BinomialEPCA</code> object  </li><li><code>scores</code>   : k×n_samples matrix of sample scores  </li><li><code>loadings</code> : k×n_features matrix of feature loadings  </li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/dimensionality-reduction.jl#LL388-L405">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.biosequences_to_counts_table-Tuple{}" href="#Mycelia.biosequences_to_counts_table-Tuple{}"><code>Mycelia.biosequences_to_counts_table</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">biosequences_to_counts_table(; biosequences, k)
</code></pre><p>Convert a collection of biological sequences into a k-mer count matrix.</p><p><strong>Arguments</strong></p><ul><li><code>biosequences</code>: Vector of biological sequences (DNA, RNA, or Amino Acids)</li><li><code>k</code>: Length of k-mers to count</li></ul><p><strong>Returns</strong></p><p>Named tuple with:</p><ul><li><code>sorted_kmers</code>: Vector of all unique k-mers found, lexicographically sorted</li><li><code>kmer_counts_matrix</code>: Sparse matrix where rows are k-mers and columns are sequences</li></ul><p><strong>Details</strong></p><ul><li>For DNA sequences, counts canonical k-mers (both strands)</li><li>Uses parallel processing with Thread-safe progress tracking</li><li>Memory efficient sparse matrix representation</li><li>Supports DNA, RNA and Amino Acid sequences</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/kmer-analysis.jl#LL1831">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.biosequences_to_dense_counts_table-Tuple{}" href="#Mycelia.biosequences_to_dense_counts_table-Tuple{}"><code>Mycelia.biosequences_to_dense_counts_table</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">biosequences_to_dense_counts_table(; biosequences, k)
</code></pre><p>Convert a collection of biological sequences into a dense k-mer count matrix.</p><p><strong>Arguments</strong></p><ul><li><code>biosequences</code>: Collection of DNA, RNA, or amino acid sequences (BioSequence types)</li><li><code>k::Integer</code>: Length of k-mers to count (must be ≤ 13)</li></ul><p><strong>Returns</strong></p><p>Named tuple containing:</p><ul><li><code>sorted_kmers</code>: Vector of all possible k-mers in sorted order</li><li><code>kmer_counts_matrix</code>: Dense matrix where rows are k-mers and columns are sequences</li></ul><p><strong>Details</strong></p><ul><li>For DNA sequences, counts canonical k-mers (both strands)</li><li>For RNA and protein sequences, counts exact k-mers</li><li>Uses parallel processing with threads</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/kmer-analysis.jl#LL1778">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.blastdb2table-Tuple{}" href="#Mycelia.blastdb2table-Tuple{}"><code>Mycelia.blastdb2table</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">blastdb2table(
;
    blastdb,
    ALL_FIELDS,
    sequence_sha256,
    sequence_hash,
    sequence_id,
    accession,
    gi,
    sequence_title,
    blast_name,
    taxid,
    taxonomic_super_kingdom,
    scientific_name,
    scientific_names_leaf_nodes,
    common_taxonomic_name,
    common_names_leaf_nodes,
    leaf_node_taxids,
    membership_integer,
    ordinal_id,
    pig,
    sequence_length,
    sequence
)
</code></pre><p>Convert a BLAST database to an in-memory table with sequence and taxonomy information.</p><p><strong>Arguments</strong></p><ul><li><code>blastdb::String</code>: Path to the BLAST database</li><li><code>outfile::String=&quot;&quot;</code>: Optional output file path. If provided, results will be saved to this file</li><li><code>force::Bool=false</code>: Whether to overwrite existing output file</li><li><code>ALL_FIELDS::Bool=true</code>: If true, include all fields regardless of other flag settings</li><li>Field selection flags (default to false unless ALL_FIELDS is true):<ul><li><code>sequence_sha256::Bool</code>: Include SHA256 hash of the sequence</li><li><code>sequence_hash::Bool</code>: Include sequence hash</li><li><code>sequence_id::Bool</code>: Include sequence ID</li><li><code>accession::Bool</code>: Include accession number</li><li><code>gi::Bool</code>: Include GI number</li><li><code>sequence_title::Bool</code>: Include sequence title</li><li><code>blast_name::Bool</code>: Include BLAST name</li><li><code>taxid::Bool</code>: Include taxid</li><li><code>taxonomic_super_kingdom::Bool</code>: Include taxonomic super kingdom</li><li><code>scientific_name::Bool</code>: Include scientific name</li><li><code>scientific_names_leaf_nodes::Bool</code>: Include scientific names for leaf-node taxids</li><li><code>common_taxonomic_name::Bool</code>: Include common taxonomic name</li><li><code>common_names_leaf_nodes::Bool</code>: Include common taxonomic names for leaf-node taxids</li><li><code>leaf_node_taxids::Bool</code>: Include leaf-node taxids</li><li><code>membership_integer::Bool</code>: Include membership integer</li><li><code>ordinal_id::Bool</code>: Include ordinal ID</li><li><code>pig::Bool</code>: Include PIG</li><li><code>sequence_length::Bool</code>: Include sequence length</li><li><code>sequence::Bool</code>: Include the full sequence</li></ul></li></ul><p><strong>Returns</strong></p><ul><li><code>DataFrame</code>: DataFrame containing the requested columns from the BLAST database</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/reference-databases.jl#LL536">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.blastdb_to_fasta-Tuple{}" href="#Mycelia.blastdb_to_fasta-Tuple{}"><code>Mycelia.blastdb_to_fasta</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">blastdb_to_fasta(
;
    blastdb,
    entries,
    taxids,
    outfile,
    force,
    max_cores
)
</code></pre><p>Convert a BLAST database to FASTA format.</p><p><strong>Arguments</strong></p><ul><li><code>blastdb::String</code>: Name of the BLAST database to convert (e.g. &quot;nr&quot;, &quot;nt&quot;)</li><li><code>dbdir::String</code>: Directory containing the BLAST database files</li><li><code>outfile::String</code>: Path for the output FASTA file</li></ul><p><strong>Returns</strong></p><ul><li>Path to the generated FASTA file as String</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/reference-databases.jl#LL10">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.bray_curtis_distance-Tuple{AbstractMatrix{&lt;:Integer}}" href="#Mycelia.bray_curtis_distance-Tuple{AbstractMatrix{&lt;:Integer}}"><code>Mycelia.bray_curtis_distance</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Compute the Bray-Curtis distance between columns of a count matrix.</p><p><strong>Arguments</strong></p><ul><li><code>M::AbstractMatrix{&lt;:Integer}</code>: Count matrix where rows are features and columns are samples</li></ul><p><strong>Returns</strong></p><ul><li><code>Matrix{Float64}</code>: Symmetric distance matrix with Bray-Curtis distances</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/distance-metrics.jl#LL25-L33">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.breadth_first_sample-Tuple{Any, Int64}" href="#Mycelia.breadth_first_sample-Tuple{Any, Int64}"><code>Mycelia.breadth_first_sample</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Breadth-first sampling: sample at least one from each group, then sample remaining proportionally to group frequencies</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/utility-functions.jl#LL372-L375">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.breadth_first_sample_dataframe-Tuple{DataFrames.DataFrame, Union{String, Symbol}, Int64}" href="#Mycelia.breadth_first_sample_dataframe-Tuple{DataFrames.DataFrame, Union{String, Symbol}, Int64}"><code>Mycelia.breadth_first_sample_dataframe</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Apply breadth-first sampling to a DataFrame</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/utility-functions.jl#LL232-L234">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.build_biosequence_graph-Tuple{Vector{FASTX.FASTA.Record}}" href="#Mycelia.build_biosequence_graph-Tuple{Vector{FASTX.FASTA.Record}}"><code>Mycelia.build_biosequence_graph</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">build_biosequence_graph(
    fasta_records::Vector{FASTX.FASTA.Record};
    graph_mode,
    min_overlap
) -&gt; MetaGraphsNext.MetaGraph{Int64, Graphs.SimpleGraphs.SimpleDiGraph{Int64}, _A, _B, _C, Nothing, Mycelia.var&quot;#267#268&quot;, Float64} where {_A, _B, _C}
</code></pre><p>Build a BioSequence graph directly from FASTA records.</p><p>This creates a variable-length BioSequence graph where vertices are the input sequences and edges represent relationships between sequences (e.g., overlaps, containment).</p><p><strong>Arguments</strong></p><ul><li><code>fasta_records</code>: Vector of FASTA records</li><li><code>graph_mode</code>: SingleStrand or DoubleStrand mode (default: DoubleStrand)</li><li><code>min_overlap</code>: Minimum overlap length for creating edges (default: 100)</li></ul><p><strong>Returns</strong></p><ul><li>MetaGraphsNext.MetaGraph with BioSequence vertices and overlap edges</li></ul><p><strong>Example</strong></p><pre><code class="language-julia hljs">records = [FASTX.FASTA.Record(&quot;seq1&quot;, &quot;ATCGATCGATCG&quot;), 
           FASTX.FASTA.Record(&quot;seq2&quot;, &quot;CGATCGATCGAA&quot;)]
graph = build_biosequence_graph(records)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/fasta-graphs.jl#LL52">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.build_directed_kmer_graph-Tuple{}" href="#Mycelia.build_directed_kmer_graph-Tuple{}"><code>Mycelia.build_directed_kmer_graph</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">build_directed_kmer_graph(; fastq, k, plot)
</code></pre><p>Constructs a directed graph representation of k-mer transitions from FASTQ sequencing data.</p><p><strong>Arguments</strong></p><ul><li><code>fastq</code>: Path to input FASTQ file</li><li><code>k</code>: K-mer size (default: 1). Must be odd and prime. If k=1, optimal size is auto-determined</li><li><code>plot</code>: Boolean to display quality distribution plot (default: false)</li></ul><p><strong>Returns</strong></p><p>MetaDiGraph with properties:</p><ul><li>assembly_k: k-mer size used</li><li>kmer_counts: frequency of each k-mer</li><li>transition_likelihoods: edge weights between k-mers</li><li>kmer<em>mean</em>quality, kmer<em>total</em>quality: quality metrics</li><li>branching<em>nodes, unbranching</em>nodes: topological classification</li><li>likely<em>valid</em>kmer_indices: k-mers above mean quality threshold</li><li>likely<em>sequencing</em>artifact_indices: potential erroneous k-mers</li></ul><p><strong>Note</strong></p><p>For DNA assembly, quality scores are normalized across both strands.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/sequence-graphs.jl#LL382">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.build_genome_distance_matrix-Tuple{Vector{String}}" href="#Mycelia.build_genome_distance_matrix-Tuple{Vector{String}}"><code>Mycelia.build_genome_distance_matrix</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">build_genome_distance_matrix(genome_files::Vector{String}; kmer_type=Kmers.DNAKmer{21}, metric=:js_divergence)</code></pre><p>Build a distance matrix between all genome pairs using existing distance metrics.</p><p>Creates a comprehensive pairwise distance matrix using established k-mer distance functions, suitable for phylogenetic analysis and clustering.</p><p><strong>Arguments</strong></p><ul><li><code>genome_files</code>: Vector of genome FASTA file paths</li><li><code>kmer_type</code>: K-mer type from Kmers.jl (default: <code>Kmers.DNAKmer{21}</code>)</li><li><code>metric</code>: Distance metric (<code>:js_divergence</code>, <code>:cosine</code>, <code>:jaccard</code>)</li></ul><p><strong>Returns</strong></p><ul><li>Named tuple with distance matrix and genome names</li></ul><p><strong>Example</strong></p><pre><code class="language-julia hljs">genomes = [&quot;genome1.fasta&quot;, &quot;genome2.fasta&quot;, &quot;genome3.fasta&quot;]
result = Mycelia.build_genome_distance_matrix(genomes, kmer_type=Kmers.DNAKmer{31})
println(&quot;Distance matrix: $(result.distance_matrix)&quot;)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/pangenome-analysis.jl#LL238-L260">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.build_kmer_graph_next-Tuple{Any, AbstractVector{&lt;:Union{FASTX.FASTA.Record, FASTX.FASTQ.Record}}}" href="#Mycelia.build_kmer_graph_next-Tuple{Any, AbstractVector{&lt;:Union{FASTX.FASTA.Record, FASTX.FASTQ.Record}}}"><code>Mycelia.build_kmer_graph_next</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">build_kmer_graph_next(
    kmer_type,
    observations::AbstractVector{&lt;:Union{FASTX.FASTA.Record, FASTX.FASTQ.Record}};
    graph_mode
) -&gt; MetaGraphsNext.MetaGraph{Int64, Graphs.SimpleGraphs.SimpleDiGraph{Int64}, Label, VertexData, EdgeData, Nothing, WeightFunction, Float64} where {Label, VertexData, EdgeData, WeightFunction}
</code></pre><p>Create a next-generation, type-stable k-mer graph using MetaGraphsNext.</p><p>This implementation uses canonical k-mers as vertices with strand-aware edges that respect biological transition constraints for both single-strand and double-strand sequences.</p><p><strong>Arguments</strong></p><ul><li><code>kmer_type</code>: Type of k-mer (e.g., DNAKmer{K})</li><li><code>observations</code>: Vector of FASTA/FASTQ records</li><li><code>graph_mode</code>: <code>SingleStrand</code> for directional sequences, <code>DoubleStrand</code> for DNA (default)</li></ul><p><strong>Returns</strong></p><ul><li><code>MetaGraphsNext.MetaGraph</code> with canonical vertices and strand-aware edges</li></ul><p><strong>Details</strong></p><ul><li><strong>Vertices</strong>: Always canonical k-mers (lexicographically smaller of kmer/reverse_complement)</li><li><strong>Edges</strong>: Strand-aware transitions that respect biological constraints</li><li><strong>SingleStrand mode</strong>: Only forward-strand transitions allowed</li><li><strong>DoubleStrand mode</strong>: Both forward and reverse-complement transitions allowed</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/sequence-graphs-next.jl#LL78">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.build_quality_biosequence_graph-Tuple{Vector{FASTX.FASTQ.Record}}" href="#Mycelia.build_quality_biosequence_graph-Tuple{Vector{FASTX.FASTQ.Record}}"><code>Mycelia.build_quality_biosequence_graph</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">build_quality_biosequence_graph(
    fastq_records::Vector{FASTX.FASTQ.Record};
    graph_mode,
    min_overlap,
    min_quality
) -&gt; MetaGraphsNext.MetaGraph{Int64, Graphs.SimpleGraphs.SimpleDiGraph{Int64}, _A, _B, _C, Nothing, Mycelia.var&quot;#277#278&quot;, Float64} where {_A, _B, _C}
</code></pre><p>Build a quality-aware BioSequence graph directly from FASTQ records.</p><p>This creates a variable-length quality-aware BioSequence graph where vertices are  the input sequences with their quality scores and edges represent quality-weighted  relationships between sequences.</p><p><strong>Arguments</strong></p><ul><li><code>fastq_records</code>: Vector of FASTQ records with quality scores</li><li><code>graph_mode</code>: SingleStrand or DoubleStrand mode (default: DoubleStrand)</li><li><code>min_overlap</code>: Minimum overlap length for creating edges (default: 100)</li><li><code>min_quality</code>: Minimum mean quality to include sequence (default: 20)</li></ul><p><strong>Returns</strong></p><ul><li>MetaGraphsNext.MetaGraph with quality-aware BioSequence vertices</li></ul><p><strong>Example</strong></p><pre><code class="language-julia hljs">records = [FASTX.FASTQ.Record(&quot;seq1&quot;, &quot;ATCGATCGATCG&quot;, &quot;IIIIIIIIIIII&quot;)]
graph = build_quality_biosequence_graph(records)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/fastq-graphs.jl#LL74">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.build_qualmer_graph-Tuple{Vector{FASTX.FASTQ.Record}}" href="#Mycelia.build_qualmer_graph-Tuple{Vector{FASTX.FASTQ.Record}}"><code>Mycelia.build_qualmer_graph</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">build_qualmer_graph(
    fastq_records::Vector{FASTX.FASTQ.Record};
    k,
    graph_mode,
    min_quality,
    min_coverage
) -&gt; MetaGraphsNext.MetaGraph{Int64, Graphs.SimpleGraphs.SimpleDiGraph{Int64}, Label, VertexData, EdgeData, Nothing, WeightFunction, Float64} where {Label, VertexData, EdgeData, WeightFunction}
</code></pre><p>Build a quality-aware k-mer graph from FASTQ records using existing Qualmer functionality. This function leverages the existing qualmer extraction functions and adds graph construction.</p><p><strong>Arguments</strong></p><ul><li><code>fastq_records</code>: Vector of FASTQ records with quality scores</li><li><code>k</code>: K-mer size</li><li><code>graph_mode</code>: SingleStrand or DoubleStrand mode (default: DoubleStrand)</li><li><code>min_quality</code>: Minimum average PHRED quality to include k-mer (default: 10)</li><li><code>min_coverage</code>: Minimum coverage (observations) to include k-mer (default: 1)</li></ul><p><strong>Returns</strong></p><ul><li>MetaGraphsNext.MetaGraph with QualmerVertexData and QualmerEdgeData</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/qualmer-analysis.jl#LL399">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.build_stranded_kmer_graph-Tuple{Any, AbstractVector{&lt;:Union{FASTX.FASTA.Record, FASTX.FASTQ.Record}}}" href="#Mycelia.build_stranded_kmer_graph-Tuple{Any, AbstractVector{&lt;:Union{FASTX.FASTA.Record, FASTX.FASTQ.Record}}}"><code>Mycelia.build_stranded_kmer_graph</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">build_stranded_kmer_graph(
    kmer_type,
    observations::AbstractVector{&lt;:Union{FASTX.FASTA.Record, FASTX.FASTQ.Record}}
) -&gt; MetaGraphs.MetaDiGraph{T, Float64} where T&lt;:Integer
</code></pre><p>Create a weighted, strand-specific kmer (de bruijn) graph from a set of kmers and a series of sequence observations in FASTA format.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/sequence-graphs.jl#LL1">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.calculate_accuracy_metrics-Tuple{Any, Int64}" href="#Mycelia.calculate_accuracy_metrics-Tuple{Any, Int64}"><code>Mycelia.calculate_accuracy_metrics</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Calculate assembly accuracy metrics for reward function. Returns a comprehensive score based on multiple quality indicators.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/intelligent-assembly.jl#LL239-L242">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.calculate_assembly_mapping_metrics-Tuple{Any, Vector{&lt;:FASTX.FASTQ.Record}, String}" href="#Mycelia.calculate_assembly_mapping_metrics-Tuple{Any, Vector{&lt;:FASTX.FASTQ.Record}, String}"><code>Mycelia.calculate_assembly_mapping_metrics</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Calculate assembly mapping metrics for validation reads.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/cross-validation.jl#LL260-L262">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.calculate_assembly_quality_metrics-Tuple{Any}" href="#Mycelia.calculate_assembly_quality_metrics-Tuple{Any}"><code>Mycelia.calculate_assembly_quality_metrics</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">calculate_assembly_quality_metrics(
    qualmer_graph;
    low_confidence_threshold
) -&gt; NamedTuple{(:mean_coverage, :mean_quality, :mean_confidence, :low_confidence_fraction, :total_kmers), &lt;:NTuple{5, Any}}
</code></pre><p>Calculate comprehensive assembly quality metrics for a qualmer graph.</p><p><strong>Arguments</strong></p><ul><li><code>graph</code>: Qualmer graph (MetaGraphsNext with QualmerVertexData)</li><li><code>low_confidence_threshold::Float64=0.95</code>: Threshold for identifying low-confidence k-mers</li></ul><p><strong>Returns</strong></p><ul><li><code>NamedTuple</code>: Assembly quality metrics including coverage, quality, and confidence statistics</li></ul><p><strong>Details</strong></p><p>Calculates mean values for coverage, quality scores, and joint probabilities. Identifies fraction of k-mers below confidence threshold as potential error indicators.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/qualmer-analysis.jl#LL684">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.calculate_assembly_reward" href="#Mycelia.calculate_assembly_reward"><code>Mycelia.calculate_assembly_reward</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Calculate reward for current k-mer processing iteration. Higher rewards indicate better assembly quality progress.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/intelligent-assembly.jl#LL308-L311">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.calculate_bubble_complexity-Tuple{Vector{String}, Vector{String}}" href="#Mycelia.calculate_bubble_complexity-Tuple{Vector{String}, Vector{String}}"><code>Mycelia.calculate_bubble_complexity</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Calculate complexity score for a bubble.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/sequence-graphs-next.jl#LL1385-L1387">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.calculate_degrees-Tuple{MetaGraphsNext.MetaGraph{&lt;:Integer, String, Mycelia.KmerVertexData, Mycelia.KmerEdgeData}}" href="#Mycelia.calculate_degrees-Tuple{MetaGraphsNext.MetaGraph{&lt;:Integer, String, Mycelia.KmerVertexData, Mycelia.KmerEdgeData}}"><code>Mycelia.calculate_degrees</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Calculate in-degrees and out-degrees for all vertices.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/sequence-graphs-next.jl#LL1095-L1097">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.calculate_emission_probability-Tuple{Mycelia.ViterbiState, String, Mycelia.ViterbiConfig}" href="#Mycelia.calculate_emission_probability-Tuple{Mycelia.ViterbiState, String, Mycelia.ViterbiConfig}"><code>Mycelia.calculate_emission_probability</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">calculate_emission_probability(state::ViterbiState, observation::String, config::ViterbiConfig) -&gt; Float64</code></pre><p>Calculate emission probability for a state given an observation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/viterbi-next.jl#LL306-L310">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.calculate_gc_content-Tuple{AbstractString}" href="#Mycelia.calculate_gc_content-Tuple{AbstractString}"><code>Mycelia.calculate_gc_content</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">calculate_gc_content(sequence::AbstractString) -&gt; Float64
</code></pre><p>Calculate GC content from a string sequence.</p><p>Convenience function that accepts string input and converts to appropriate BioSequence. Automatically detects DNA/RNA based on presence of T/U.</p><p><strong>Arguments</strong></p><ul><li><code>sequence::AbstractString</code>: Input DNA or RNA sequence as string</li></ul><p><strong>Returns</strong></p><ul><li><code>Float64</code>: GC content as a percentage (0.0-100.0)</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia hljs"># Calculate GC content from string
gc_percent = calculate_gc_content(&quot;ATCGATCGATCG&quot;)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/utility-functions.jl#LL2232">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.calculate_gc_content-Tuple{BioSequences.LongSequence}" href="#Mycelia.calculate_gc_content-Tuple{BioSequences.LongSequence}"><code>Mycelia.calculate_gc_content</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">calculate_gc_content(
    sequence::BioSequences.LongSequence
) -&gt; Float64
</code></pre><p>Calculate GC content (percentage of G and C bases) from a BioSequence.</p><p>This function calculates the percentage of guanine (G) and cytosine (C) bases in a nucleotide sequence. Works with both DNA and RNA sequences.</p><p><strong>Arguments</strong></p><ul><li><code>sequence::BioSequences.LongSequence</code>: Input DNA or RNA sequence</li></ul><p><strong>Returns</strong></p><ul><li><code>Float64</code>: GC content as a percentage (0.0-100.0)</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia hljs"># Calculate GC content for DNA
dna_seq = BioSequences.LongDNA{4}(&quot;ATCGATCGATCG&quot;)
gc_percent = calculate_gc_content(dna_seq)

# Calculate GC content for RNA
rna_seq = BioSequences.LongRNA{4}(&quot;AUCGAUCGAUCG&quot;) 
gc_percent = calculate_gc_content(rna_seq)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/utility-functions.jl#LL2181">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.calculate_gc_content-Union{Tuple{AbstractVector{T}}, Tuple{T}} where T&lt;:Union{FASTX.FASTA.Record, FASTX.FASTQ.Record}" href="#Mycelia.calculate_gc_content-Union{Tuple{AbstractVector{T}}, Tuple{T}} where T&lt;:Union{FASTX.FASTA.Record, FASTX.FASTQ.Record}"><code>Mycelia.calculate_gc_content</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">calculate_gc_content(
    records::AbstractArray{T&lt;:Union{FASTX.FASTA.Record, FASTX.FASTQ.Record}, 1}
) -&gt; Float64
</code></pre><p>Calculate GC content from FASTA/FASTQ records.</p><p>Processes multiple records and calculates overall GC content across all sequences.</p><p><strong>Arguments</strong></p><ul><li><code>records::AbstractVector{T}</code> where T &lt;: Union{FASTX.FASTA.Record, FASTX.FASTQ.Record}`: Input records</li></ul><p><strong>Returns</strong></p><ul><li><code>Float64</code>: Overall GC content as a percentage (0.0-100.0)</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia hljs"># Calculate GC content from FASTA records
records = collect(FASTX.FASTA.Reader(open(&quot;sequences.fasta&quot;)))
gc_percent = calculate_gc_content(records)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/utility-functions.jl#LL2271">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.calculate_path_support-Tuple{MetaGraphsNext.MetaGraph{&lt;:Integer, String, Mycelia.KmerVertexData, Mycelia.KmerEdgeData}, Vector{String}}" href="#Mycelia.calculate_path_support-Tuple{MetaGraphsNext.MetaGraph{&lt;:Integer, String, Mycelia.KmerVertexData, Mycelia.KmerEdgeData}, Vector{String}}"><code>Mycelia.calculate_path_support</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Calculate support for a path (simplified version).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/sequence-graphs-next.jl#LL1362-L1364">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.calculate_qualmer_likelihood-Tuple{Any, AbstractVector{Int8}, Any}" href="#Mycelia.calculate_qualmer_likelihood-Tuple{Any, AbstractVector{Int8}, Any}"><code>Mycelia.calculate_qualmer_likelihood</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Calculate likelihood of a k-mer given its observed quality scores and qualmer vertex data. Leverages existing qualmer graph quality calculations.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/iterative-assembly.jl#LL533-L536">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.calculate_read_likelihood-Tuple{FASTX.FASTQ.Record, Any, Int64}" href="#Mycelia.calculate_read_likelihood-Tuple{FASTX.FASTQ.Record, Any, Int64}"><code>Mycelia.calculate_read_likelihood</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Calculate likelihood of a FASTQ read given the current graph.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/iterative-assembly.jl#LL444-L446">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.calculate_recommendation_confidence-Tuple{Vector{Float64}, Vector{Float64}}" href="#Mycelia.calculate_recommendation_confidence-Tuple{Vector{Float64}, Vector{Float64}}"><code>Mycelia.calculate_recommendation_confidence</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Calculate confidence in recommendation based on variance across folds.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/cross-validation.jl#LL486-L488">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.calculate_repeat_confidence-Tuple{MetaGraphsNext.MetaGraph{&lt;:Integer, String, Mycelia.KmerVertexData, Mycelia.KmerEdgeData}, Vector{String}, Float64}" href="#Mycelia.calculate_repeat_confidence-Tuple{MetaGraphsNext.MetaGraph{&lt;:Integer, String, Mycelia.KmerVertexData, Mycelia.KmerEdgeData}, Vector{String}, Float64}"><code>Mycelia.calculate_repeat_confidence</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Calculate confidence in repeat identification.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/sequence-graphs-next.jl#LL1648-L1650">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.calculate_sequence_likelihood-Tuple{BioSequences.BioSequence, Vector{Int8}, Any, Int64}" href="#Mycelia.calculate_sequence_likelihood-Tuple{BioSequences.BioSequence, Vector{Int8}, Any, Int64}"><code>Mycelia.calculate_sequence_likelihood</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Calculate quality-aware likelihood of a sequence given the qualmer graph. Uses both k-mer presence and quality-based confidence from qualmer observations.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/iterative-assembly.jl#LL458-L461">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.calculate_sparsity-Tuple{Vector{&lt;:FASTX.FASTQ.Record}, Int64}" href="#Mycelia.calculate_sparsity-Tuple{Vector{&lt;:FASTX.FASTQ.Record}, Int64}"><code>Mycelia.calculate_sparsity</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Calculate k-mer sparsity for a given k-mer size. Returns fraction of possible k-mers that are NOT observed. Higher sparsity indicates errors become singletons.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/intelligent-assembly.jl#LL44-L48">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.calculate_unseen_kmer_penalty-Tuple{AbstractVector{Int8}}" href="#Mycelia.calculate_unseen_kmer_penalty-Tuple{AbstractVector{Int8}}"><code>Mycelia.calculate_unseen_kmer_penalty</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Calculate penalty for unseen k-mers based on their quality scores. High quality unseen k-mers get less penalty than low quality ones.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/iterative-assembly.jl#LL560-L563">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.canonical-Tuple{Mycelia.Qualmer{&lt;:Kmers.Kmer{BioSequences.AminoAcidAlphabet}}}" href="#Mycelia.canonical-Tuple{Mycelia.Qualmer{&lt;:Kmers.Kmer{BioSequences.AminoAcidAlphabet}}}"><code>Mycelia.canonical</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">canonical(
    qmer::Mycelia.Qualmer{&lt;:Kmers.Kmer{BioSequences.AminoAcidAlphabet}}
) -&gt; Mycelia.Qualmer{&lt;:Kmers.Kmer{BioSequences.AminoAcidAlphabet}}
</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/qualmer-analysis.jl#LL41">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.canonical-Union{Tuple{Mycelia.Qualmer{KmerT}}, Tuple{KmerT}} where KmerT&lt;:Union{Kmers.DNAKmer, Kmers.RNAKmer}" href="#Mycelia.canonical-Union{Tuple{Mycelia.Qualmer{KmerT}}, Tuple{KmerT}} where KmerT&lt;:Union{Kmers.DNAKmer, Kmers.RNAKmer}"><code>Mycelia.canonical</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">canonical(
    qmer::Mycelia.Qualmer{KmerT&lt;:Union{Kmers.DNAKmer, Kmers.RNAKmer}}
) -&gt; Mycelia.Qualmer{KmerT} where KmerT&lt;:Kmers.Kmer
</code></pre><p>Get the canonical representation of a DNA qualmer, considering both sequence and quality. For DNA/RNA, this involves potentially reverse-complementing the k-mer and reversing the quality scores accordingly.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/qualmer-analysis.jl#LL22">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.canonicalize_kmer_counts!-Tuple{Any}" href="#Mycelia.canonicalize_kmer_counts!-Tuple{Any}"><code>Mycelia.canonicalize_kmer_counts!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">canonicalize_kmer_counts!(kmer_counts) -&gt; Any
</code></pre><p>Canonicalizes the k-mer counts in the given dictionary.</p><p>This function iterates over the provided dictionary <code>kmer_counts</code>, which maps k-mers to their respective counts. For each k-mer that is not in its canonical form, it converts the k-mer to its canonical form and updates the count in the dictionary accordingly. If the canonical form of the k-mer already exists in the dictionary, their counts are summed. The original non-canonical k-mer is then removed from the dictionary.</p><p><strong>Arguments</strong></p><ul><li><code>kmer_counts::Dict{BioSequences.Kmer, Int}</code>: A dictionary where keys are k-mers and values are their counts.</li></ul><p><strong>Returns</strong></p><ul><li>The input dictionary <code>kmer_counts</code> with all k-mers in their canonical form, sorted by k-mers.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/kmer-analysis.jl#LL1349">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.canonicalize_kmer_counts-Tuple{Any}" href="#Mycelia.canonicalize_kmer_counts-Tuple{Any}"><code>Mycelia.canonicalize_kmer_counts</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">canonicalize_kmer_counts(kmer_counts) -&gt; Any
</code></pre><p>Normalize k-mer counts into a canonical form by creating a non-mutating copy.</p><p><strong>Arguments</strong></p><ul><li><code>kmer_counts</code>: Dictionary or collection of k-mer count data</li></ul><p><strong>Returns</strong></p><ul><li>A new normalized k-mer count collection</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/kmer-analysis.jl#LL1388">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.check_bioconda_env_is_installed-Tuple{Any}" href="#Mycelia.check_bioconda_env_is_installed-Tuple{Any}"><code>Mycelia.check_bioconda_env_is_installed</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">check_bioconda_env_is_installed(pkg) -&gt; Bool
</code></pre><p>Check whether a named Bioconda environment already exists.</p><p><strong>Arguments</strong></p><ul><li><code>pkg::String</code>: Name of the environment.</li></ul><p><strong>Returns</strong></p><p><code>Bool</code> indicating if the environment is present.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/bioconda.jl#LL103">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.check_eulerian_conditions-Tuple{Dict{String, Int64}, Dict{String, Int64}}" href="#Mycelia.check_eulerian_conditions-Tuple{Dict{String, Int64}, Dict{String, Int64}}"><code>Mycelia.check_eulerian_conditions</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Check conditions for Eulerian path existence.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/sequence-graphs-next.jl#LL1119-L1121">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.check_matrix_fits_in_memory-Tuple{Integer}" href="#Mycelia.check_matrix_fits_in_memory-Tuple{Integer}"><code>Mycelia.check_matrix_fits_in_memory</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">check_matrix_fits_in_memory(bytes_needed::Integer; severity::Symbol=:warn)</code></pre><p>Checks whether the specified number of bytes can fit in the computer&#39;s memory.</p><ul><li><code>bytes_needed</code>: The number of bytes required (output from <code>estimate_dense_matrix_memory</code> or <code>estimate_sparse_matrix_memory</code>).</li><li><code>severity</code>: What to do if there is not enough available memory. Can be <code>:warn</code> (default) or <code>:error</code>.</li></ul><p>Returns a named tuple:     (will<em>fit</em>total, will<em>fit</em>available, total<em>memory, free</em>memory, bytes_needed) Where:</p><ul><li><code>will_fit_total</code>: <code>true</code> if the matrix fits in total system memory.</li><li><code>will_fit_available</code>: <code>true</code> if the matrix fits in currently available (free) system memory.</li><li><code>total_memory</code>: Total system RAM in bytes.</li><li><code>free_memory</code>: Currently available system RAM in bytes.</li><li><code>bytes_needed</code>: Bytes requested for the matrix.</li></ul><p>If <code>will_fit_available</code> is false, either warns or errors depending on <code>severity</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/utility-functions.jl#LL113-L131">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.check_memory_limits-Tuple{Any, Int64}" href="#Mycelia.check_memory_limits-Tuple{Any, Int64}"><code>Mycelia.check_memory_limits</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Check if memory usage is within acceptable limits.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/intelligent-assembly.jl#LL156-L158">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.choose_top_n_markers-Tuple{Int64}" href="#Mycelia.choose_top_n_markers-Tuple{Int64}"><code>Mycelia.choose_top_n_markers</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">choose_top_n_markers(N)</code></pre><p>Return a vector of the top N most visually distinct marker symbols for plotting.</p><p><strong>Arguments</strong></p><ul><li><code>N::Int</code>: Number of distinct markers to return (max 17 for best differentiation).</li></ul><p><strong>Returns</strong></p><ul><li><code>Vector{Symbol}</code>: Vector of marker symbol names.</li></ul><p><strong>Example</strong></p><pre><code class="nohighlight hljs">markers = choose_top_n_markers(7)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/utility-functions.jl#LL243-L256">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.chromosome_coverage_table_to_plot-Tuple{Any}" href="#Mycelia.chromosome_coverage_table_to_plot-Tuple{Any}"><code>Mycelia.chromosome_coverage_table_to_plot</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">chromosome_coverage_table_to_plot(cdf) -&gt; Plots.Plot
</code></pre><p>Creates a visualization of chromosome coverage data with statistical thresholds.</p><p><strong>Arguments</strong></p><ul><li><code>cdf::DataFrame</code>: Coverage data frame containing columns:<ul><li><code>index</code>: Chromosome position indices</li><li><code>depth</code>: Coverage depth values</li><li><code>chromosome</code>: Chromosome identifier</li><li><code>mean_coverage</code>: Mean coverage value</li><li><code>std_coverage</code>: Standard deviation of coverage</li><li><code>3σ</code>: Boolean vector indicating +3 sigma regions</li><li><code>-3σ</code>: Boolean vector indicating -3 sigma regions</li></ul></li></ul><p><strong>Returns</strong></p><ul><li>A StatsPlots plot object showing:<ul><li>Raw coverage data (black line)</li><li>Mean coverage and ±1,2,3σ thresholds (rainbow colors)</li><li>Highlighted regions exceeding ±3σ thresholds (red vertical lines)</li></ul></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/plotting-and-visualization.jl#LL1259">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.classify_reads_by_taxonomy-Tuple{}" href="#Mycelia.classify_reads_by_taxonomy-Tuple{}"><code>Mycelia.classify_reads_by_taxonomy</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Classify reads based on taxonomic alignments using individual alignment scoring.</p><p>This function takes taxonomy-aware alignment data and performs classification by:</p><ol><li>Loading the taxonomy-aware alignment data</li><li>Analyzing alignment score distributions per read</li><li>Identifying dominant taxonomic assignments</li><li>Applying conservative taxonomy classification</li></ol><p><strong>Arguments</strong></p><ul><li><code>taxonomy_aware_file</code>: Path to taxonomy-aware alignment file (.tsv.gz or .arrow)</li><li><code>min_relative_proportion::Float64=60.0</code>: Minimum relative proportion threshold for accepting a taxonomic assignment</li><li><code>verbose::Bool=true</code>: Whether to print progress information</li></ul><p><strong>Returns</strong></p><p>A DataFrame with taxonomic classification results including individual alignment metrics</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/taxonomy-and-trees.jl#LL264-L280">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.classify_repeat_type-Tuple{MetaGraphsNext.MetaGraph{&lt;:Integer, String, Mycelia.KmerVertexData, Mycelia.KmerEdgeData}, Vector{String}, Vector{Tuple{String, String}}, Vector{Tuple{String, String}}}" href="#Mycelia.classify_repeat_type-Tuple{MetaGraphsNext.MetaGraph{&lt;:Integer, String, Mycelia.KmerVertexData, Mycelia.KmerEdgeData}, Vector{String}, Vector{Tuple{String, String}}, Vector{Tuple{String, String}}}"><code>Mycelia.classify_repeat_type</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Classify the type of repeat.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/sequence-graphs-next.jl#LL1628-L1630">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.cleanup_directory-Tuple{AbstractString}" href="#Mycelia.cleanup_directory-Tuple{AbstractString}"><code>Mycelia.cleanup_directory</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">cleanup_directory(
    directory::AbstractString;
    verbose,
    force
) -&gt; @NamedTuple{existed::Bool, files_deleted::Int64, bytes_freed::Int64, human_readable_size::String}
</code></pre><p>Clean up a directory by calculating its size and file count, then removing it.</p><p><strong>Arguments</strong></p><ul><li><code>directory::AbstractString</code>: Path to the directory to clean up</li><li><code>verbose::Bool=true</code>: Whether to report cleanup results (default: true)</li><li><code>force::Bool=false</code>: Whether to proceed without confirmation for large directories</li></ul><p><strong>Returns</strong></p><ul><li>Named tuple with fields:<ul><li><code>existed</code>: Whether the directory existed before cleanup</li><li><code>files_deleted</code>: Number of files that were deleted</li><li><code>bytes_freed</code>: Total bytes freed up</li><li><code>human_readable_size</code>: Human-readable representation of bytes freed</li></ul></li></ul><p><strong>Details</strong></p><p>This function will:</p><ol><li>Check if the directory exists and is non-empty</li><li>Calculate the total size and number of files recursively</li><li>Remove the directory and all its contents</li><li>Report the cleanup results unless verbose=false</li></ol><p>For directories larger than 1GB or containing more than 10,000 files, confirmation is required unless force=true.</p><p><strong>Examples</strong></p><pre><code class="language-julia hljs"># Clean up a temporary directory with reporting
result = cleanup_directory(&quot;/tmp/myapp_temp&quot;)

# Silent cleanup
cleanup_directory(&quot;/tmp/cache&quot;, verbose=false)

# Force cleanup of large directory
cleanup_directory(&quot;/tmp/large_data&quot;, force=true)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/utility-functions.jl#LL1962">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.codon_optimize-Tuple{}" href="#Mycelia.codon_optimize-Tuple{}"><code>Mycelia.codon_optimize</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">codon_optimize(
;
    normalized_codon_frequencies,
    protein_sequence,
    n_iterations
)
</code></pre><p>Optimizes the DNA sequence encoding for a given protein sequence using codon usage frequencies.</p><p><strong>Arguments</strong></p><ul><li><code>normalized_codon_frequencies</code>: Dictionary mapping amino acids to their codon frequencies</li><li><code>protein_sequence::BioSequences.LongAA</code>: Target protein sequence to optimize</li><li><code>n_iterations::Integer</code>: Number of optimization iterations to perform</li></ul><p><strong>Algorithm</strong></p><ol><li>Creates initial DNA sequence through reverse translation</li><li>Iteratively generates new sequences by sampling codons based on their frequencies</li><li>Keeps track of the sequence with highest codon usage likelihood</li></ol><p><strong>Returns</strong></p><ul><li><code>BioSequences.LongDNA{2}</code>: Optimized DNA sequence encoding the input protein</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/codon-optimization.jl#LL66">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.codons_to_amino_acids-Tuple{}" href="#Mycelia.codons_to_amino_acids-Tuple{}"><code>Mycelia.codons_to_amino_acids</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">codons_to_amino_acids() -&gt; Dict
</code></pre><p>Creates a mapping between DNA codons and their corresponding amino acids using the standard genetic code.</p><p>Returns a dictionary where:</p><ul><li>Keys are 3-letter DNA codons (e.g., &quot;ATG&quot;)</li><li>Values are the corresponding amino acids from BioSequences.jl</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/codon-optimization.jl#LL141">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.collapse_unbranching_paths-Tuple{MetaGraphsNext.MetaGraph{var&quot;#s35&quot;, Graph} where {var&quot;#s35&quot;&lt;:Graphs.SimpleGraphs.AbstractSimpleGraph, Graph&lt;:Graphs.AbstractGraph{var&quot;#s35&quot;}}}" href="#Mycelia.collapse_unbranching_paths-Tuple{MetaGraphsNext.MetaGraph{var&quot;#s35&quot;, Graph} where {var&quot;#s35&quot;&lt;:Graphs.SimpleGraphs.AbstractSimpleGraph, Graph&lt;:Graphs.AbstractGraph{var&quot;#s35&quot;}}}"><code>Mycelia.collapse_unbranching_paths</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Collapse linear paths (vertices with one incoming and one outgoing edge) into a simpler graph where sequences are concatenated.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/string-graphs.jl#LL78-L81">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.compare_assembly_statistics-Tuple{Dict, Dict}" href="#Mycelia.compare_assembly_statistics-Tuple{Dict, Dict}"><code>Mycelia.compare_assembly_statistics</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Compare statistical properties of intelligent vs iterative assemblies.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/cross-validation.jl#LL340-L342">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.compare_genome_kmer_similarity-Tuple{String, String}" href="#Mycelia.compare_genome_kmer_similarity-Tuple{String, String}"><code>Mycelia.compare_genome_kmer_similarity</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">compare_genome_kmer_similarity(genome1_file::String, genome2_file::String; kmer_type=Kmers.DNAKmer{21}, metric=:js_divergence)</code></pre><p>Compare two genomes using existing k-mer distance metrics.</p><p>Leverages existing distance metric functions to compare genomic similarity between pairs of genomes using various distance measures.</p><p><strong>Arguments</strong></p><ul><li><code>genome1_file</code>: Path to first genome FASTA file</li><li><code>genome2_file</code>: Path to second genome FASTA file  </li><li><code>kmer_type</code>: K-mer type from Kmers.jl (default: <code>Kmers.DNAKmer{21}</code>)</li><li><code>metric</code>: Distance metric (<code>:js_divergence</code>, <code>:cosine</code>, <code>:jaccard</code>)</li></ul><p><strong>Returns</strong></p><ul><li>Named tuple with similarity/distance metrics and k-mer statistics</li></ul><p><strong>Example</strong></p><pre><code class="language-julia hljs">similarity = Mycelia.compare_genome_kmer_similarity(
    &quot;genome1.fasta&quot;, &quot;genome2.fasta&quot;, 
    kmer_type=Kmers.DNAKmer{31}, 
    metric=:js_divergence
)
println(&quot;JS divergence: $(similarity.distance)&quot;)
println(&quot;Shared k-mers: $(similarity.shared_kmers)&quot;)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/pangenome-analysis.jl#LL174-L201">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.concatenate_files-Tuple{}" href="#Mycelia.concatenate_files-Tuple{}"><code>Mycelia.concatenate_files</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">concatenate_files(; files, file)
</code></pre><p>Join fasta files without any regard to record uniqueness.</p><p>A cross-platform version of <code>cat *.fasta &gt; joint.fasta</code></p><p>See merge<em>fasta</em>files</p><p>Concatenate multiple FASTA files into a single output file by simple appending.</p><p><strong>Arguments</strong></p><ul><li><code>files</code>: Vector of paths to input FASTA files</li><li><code>file</code>: Path where the concatenated output will be written</li></ul><p><strong>Returns</strong></p><ul><li>Path to the output concatenated file</li></ul><p><strong>Details</strong></p><p>Platform-independent implementation of <code>cat *.fasta &gt; combined.fasta</code>. Files are processed sequentially with a progress indicator.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/utility-functions.jl#LL945">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.confusion_matrix-Tuple{Any, Any}" href="#Mycelia.confusion_matrix-Tuple{Any, Any}"><code>Mycelia.confusion_matrix</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">confusion_matrix(true_labels, pred_labels)</code></pre><p>Returns the confusion matrix as a Matrix{Int}, row = true, col = predicted. Also returns the list of unique labels in sorted order and a heatmap plot.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/quality-control-and-benchmarking.jl#LL1-L6">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.contbernoulli_pca_epca-Tuple{AbstractMatrix{&lt;:Real}}" href="#Mycelia.contbernoulli_pca_epca-Tuple{AbstractMatrix{&lt;:Real}}"><code>Mycelia.contbernoulli_pca_epca</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">contbernoulli_pca_epca(M::AbstractMatrix{&lt;:Real}; k::Int=0)</code></pre><p>Perform Continuous Bernoulli EPCA on a matrix <code>M</code> (features × samples).</p><p><strong>When to use</strong></p><p>Use for continuous data in the open interval (0, 1), such as probabilities or normalized intensities.</p><p><strong>Keyword arguments</strong></p><ul><li><code>k</code> : desired number of latent dimensions; if <code>k&lt;1</code> defaults to <code>min(n_samples-1, n_features, 10)</code></li></ul><p><strong>Returns</strong></p><p>NamedTuple with fields</p><ul><li><code>model</code>    : the fitted <code>ExpFamilyPCA.ContinuousBernoulliEPCA</code> object  </li><li><code>scores</code>   : k×n_samples matrix of sample scores  </li><li><code>loadings</code> : k×n_features matrix of feature loadings  </li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/dimensionality-reduction.jl#LL429-L445">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.contig_is_circular-Tuple{String, String}" href="#Mycelia.contig_is_circular-Tuple{String, String}"><code>Mycelia.contig_is_circular</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">contig_is_circular(
    graph_file::String,
    contig_name::String
) -&gt; Any
</code></pre><p>Returns bool indicating whether the contig is a circle</p><p>graph<em>file = path to assembly graph.gfa file contig</em>name = name of the contig</p><p>Determine if a contig represents a circular structure in the assembly graph.</p><p>A circular contig is one where the sequence forms a complete loop in the assembly graph, typically representing structures like plasmids, circular chromosomes, or other circular DNA elements.</p><p><strong>Arguments</strong></p><ul><li><code>graph_file::String</code>: Path to the assembly graph in GFA format</li><li><code>contig_name::String</code>: Name/identifier of the contig to check</li></ul><p><strong>Returns</strong></p><ul><li><code>Bool</code>: <code>true</code> if the contig forms a circular structure, <code>false</code> otherwise</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/sequence-graphs.jl#LL2489">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.contig_is_cleanly_assembled-Tuple{String, String}" href="#Mycelia.contig_is_cleanly_assembled-Tuple{String, String}"><code>Mycelia.contig_is_cleanly_assembled</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">contig_is_cleanly_assembled(
    graph_file::String,
    contig_name::String
) -&gt; Bool
</code></pre><p>Returns bool indicating whether the contig is cleanly assembled.</p><p>By cleanly assembled we mean that the contig does not have other contigs attached in the same connected component.</p><p>graph<em>file = path to assembly graph.gfa file contig</em>name = name of the contig</p><p>Check if a contig exists in isolation within its connected component in an assembly graph.</p><p><strong>Arguments</strong></p><ul><li><code>graph_file::String</code>: Path to the assembly graph file in GFA format</li><li><code>contig_name::String</code>: Name/identifier of the contig to check</li></ul><p><strong>Returns</strong></p><ul><li><code>Bool</code>: <code>true</code> if the contig exists alone in its connected component, <code>false</code> otherwise</li></ul><p><strong>Details</strong></p><p>A contig is considered &quot;cleanly assembled&quot; if it appears as a single entry in the  assembly graph&#39;s connected components. This function parses the GFA file and checks the contig&#39;s isolation status using the graph structure.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/sequence-graphs.jl#LL2438">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.convert_legacy_gfa_to_next" href="#Mycelia.convert_legacy_gfa_to_next"><code>Mycelia.convert_legacy_gfa_to_next</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">convert_legacy_gfa_to_next(
    gfa_file::AbstractString
) -&gt; MetaGraphsNext.MetaGraph{Int64, Graphs.SimpleGraphs.SimpleDiGraph{Int64}, _A, _B, _C, Nothing, Mycelia.var&quot;#147#148&quot;, Float64} where {_A, _B, _C}
convert_legacy_gfa_to_next(
    gfa_file::AbstractString,
    graph_mode::Mycelia.GraphMode
) -&gt; MetaGraphsNext.MetaGraph{Int64, Graphs.SimpleGraphs.SimpleDiGraph{Int64}, _A, _B, _C, Nothing, Mycelia.var&quot;#147#148&quot;, Float64} where {_A, _B, _C}
</code></pre><p>Convert a legacy MetaGraphs GFA to next-generation MetaGraphsNext format.</p><p>This convenience function reads a GFA file using the legacy parser and converts it to the new strand-aware format.</p><p><strong>Arguments</strong></p><ul><li><code>gfa_file</code>: Path to GFA file</li><li><code>graph_mode</code>: GraphMode for the output graph</li></ul><p><strong>Returns</strong></p><ul><li>MetaGraphsNext.MetaGraph in strand-aware format</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/sequence-graphs-next.jl#LL931">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.convert_sequence-Tuple{AbstractString}" href="#Mycelia.convert_sequence-Tuple{AbstractString}"><code>Mycelia.convert_sequence</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">convert_sequence(seq::AbstractString) -&gt; Any
</code></pre><p>Converts the given sequence (output from FASTX.sequence) into the appropriate BioSequence type:</p><ul><li>DNA sequences are converted using <code>BioSequences.LongDNA</code></li><li>RNA sequences are converted using <code>BioSequences.LongRNA</code></li><li>AA sequences are converted using <code>BioSequences.LongAA</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/alphabets.jl#LL90">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.copy_to_tempdir-Tuple{String}" href="#Mycelia.copy_to_tempdir-Tuple{String}"><code>Mycelia.copy_to_tempdir</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">copy_to_tempdir(file_path::String) -&gt; String
</code></pre><p>Create a copy of a file in a temporary directory while preserving the original filename.</p><p><strong>Arguments</strong></p><ul><li><code>file_path::String</code>: Path to the source file to be copied</li></ul><p><strong>Returns</strong></p><ul><li><code>String</code>: Path to the newly created temporary file</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/utility-functions.jl#LL1046">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.copy_with_unique_identifier-Tuple{Any, Any, Any}" href="#Mycelia.copy_with_unique_identifier-Tuple{Any, Any, Any}"><code>Mycelia.copy_with_unique_identifier</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">copy_with_unique_identifier(
    infile,
    out_directory,
    unique_identifier;
    force
) -&gt; Any
</code></pre><p>Copy a file to a new location with a unique identifier prepended to the filename.</p><p><strong>Arguments</strong></p><ul><li><code>infile::AbstractString</code>: Path to the source file to copy</li><li><code>out_directory::AbstractString</code>: Destination directory for the copied file</li><li><code>unique_identifier::AbstractString</code>: String to prepend to the filename</li><li><code>force::Bool=true</code>: If true, overwrite existing files</li></ul><p><strong>Returns</strong></p><ul><li><code>String</code>: Path to the newly created file</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/utility-functions.jl#LL1319">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.correct_errors_at_k-Tuple{Any, Int64}" href="#Mycelia.correct_errors_at_k-Tuple{Any, Int64}"><code>Mycelia.correct_errors_at_k</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Perform error correction at the current k-mer size. Returns the number of corrections made.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/intelligent-assembly.jl#LL175-L178">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.correct_errors_next" href="#Mycelia.correct_errors_next"><code>Mycelia.correct_errors_next</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">correct_errors_next(graph::MetaGraph, sequences::Vector, config::ViterbiConfig) -&gt; Vector{FASTX.FASTA.Record}</code></pre><p>Correct errors in sequences using Viterbi algorithm and return corrected FASTA records.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/viterbi-next.jl#LL450-L454">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.count_canonical_kmers-Union{Tuple{KMER_TYPE}, Tuple{Type{KMER_TYPE}, Any}} where KMER_TYPE" href="#Mycelia.count_canonical_kmers-Union{Tuple{KMER_TYPE}, Tuple{Type{KMER_TYPE}, Any}} where KMER_TYPE"><code>Mycelia.count_canonical_kmers</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">count_canonical_kmers(_::Type{KMER_TYPE}, sequences) -&gt; Any
</code></pre><p>Count canonical k-mers in biological sequences. A canonical k-mer is the lexicographically  smaller of a DNA sequence and its reverse complement, ensuring strand-independent counting.</p><p><strong>Arguments</strong></p><ul><li><code>KMER_TYPE</code>: Type parameter specifying the k-mer size and structure</li><li><code>sequences</code>: Iterator of biological sequences to analyze</li></ul><p><strong>Returns</strong></p><ul><li><code>Dict{KMER_TYPE,Int}</code>: Dictionary mapping canonical k-mers to their counts</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/kmer-analysis.jl#LL1403">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.count_kmers-Union{Tuple{KMER_TYPE}, Tuple{Type{KMER_TYPE}, AbstractString}} where KMER_TYPE" href="#Mycelia.count_kmers-Union{Tuple{KMER_TYPE}, Tuple{Type{KMER_TYPE}, AbstractString}} where KMER_TYPE"><code>Mycelia.count_kmers</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">count_kmers(
    _::Type{KMER_TYPE},
    fastx_file::AbstractString
) -&gt; Any
</code></pre><p>Count k-mers in a FASTA/FASTQ file and return their frequencies.</p><p><strong>Arguments</strong></p><ul><li><code>KMER_TYPE</code>: Type parameter specifying the k-mer type (e.g., <code>DNAKmer{K}</code>)</li><li><code>fastx_file</code>: Path to input FASTA/FASTQ file</li></ul><p><strong>Returns</strong></p><ul><li><code>Dict{KMER_TYPE, Int}</code>: Dictionary mapping each k-mer to its frequency</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/kmer-analysis.jl#LL1559">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.count_kmers-Union{Tuple{K}, Tuple{A}, Tuple{Type{Kmers.Mer{K, A}}, BioSequences.LongSequence}} where {A&lt;:BioSequences.AminoAcidAlphabet, K}" href="#Mycelia.count_kmers-Union{Tuple{K}, Tuple{A}, Tuple{Type{Kmers.Mer{K, A}}, BioSequences.LongSequence}} where {A&lt;:BioSequences.AminoAcidAlphabet, K}"><code>Mycelia.count_kmers</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">count_kmers(
    _::Type{Kmers.Kmer{A&lt;:BioSequences.AminoAcidAlphabet, K}},
    sequence::BioSequences.LongSequence
) -&gt; OrderedCollections.OrderedDict{K, Int64} where K&lt;:(Kmers.Kmer{BioSequences.AminoAcidAlphabet, _A, _B} where {_B, _A})
</code></pre><p>Count the frequency of amino acid k-mers in a biological sequence.</p><p><strong>Arguments</strong></p><ul><li><code>Kmers.Kmer{A,K}</code>: Type parameter specifying amino acid alphabet (A) and k-mer length (K)</li><li><code>sequence</code>: Input biological sequence to analyze</li></ul><p><strong>Returns</strong></p><p>A sorted dictionary mapping each k-mer to its frequency count in the sequence.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/kmer-analysis.jl#LL1459">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.count_kmers-Union{Tuple{K}, Tuple{A}, Tuple{Type{Kmers.Mer{K, A}}, BioSequences.LongSequence}} where {A&lt;:BioSequences.DNAAlphabet, K}" href="#Mycelia.count_kmers-Union{Tuple{K}, Tuple{A}, Tuple{Type{Kmers.Mer{K, A}}, BioSequences.LongSequence}} where {A&lt;:BioSequences.DNAAlphabet, K}"><code>Mycelia.count_kmers</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">count_kmers(
    _::Type{Kmers.Kmer{A&lt;:BioSequences.DNAAlphabet, K}},
    sequence::BioSequences.LongSequence
) -&gt; Any
</code></pre><p>Count the frequency of each k-mer in a DNA sequence.</p><p><strong>Arguments</strong></p><ul><li><code>::Type{Kmers.Kmer{A,K}}</code>: K-mer type with alphabet A and length K</li><li><code>sequence::BioSequences.LongSequence</code>: Input DNA sequence to analyze</li></ul><p><strong>Returns</strong></p><p>A sorted dictionary mapping each k-mer to its frequency count in the sequence.</p><p><strong>Type Parameters</strong></p><ul><li><code>A &lt;: BioSequences.DNAAlphabet</code>: DNA alphabet type</li><li><code>K</code>: Length of k-mers</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/kmer-analysis.jl#LL1421">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.count_kmers-Union{Tuple{K}, Tuple{A}, Tuple{Type{Kmers.Mer{K, A}}, BioSequences.LongSequence}} where {A&lt;:BioSequences.RNAAlphabet, K}" href="#Mycelia.count_kmers-Union{Tuple{K}, Tuple{A}, Tuple{Type{Kmers.Mer{K, A}}, BioSequences.LongSequence}} where {A&lt;:BioSequences.RNAAlphabet, K}"><code>Mycelia.count_kmers</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">count_kmers(
    _::Type{Kmers.Kmer{A&lt;:BioSequences.RNAAlphabet, K}},
    sequence::BioSequences.LongSequence
) -&gt; Any
</code></pre><p>Count the frequency of each k-mer in an RNA sequence.</p><p><strong>Arguments</strong></p><ul><li><code>Kmer</code>: Type parameter specifying the k-mer length K and RNA alphabet</li><li><code>sequence</code>: Input RNA sequence to analyze</li></ul><p><strong>Returns</strong></p><ul><li><code>Dict{Kmers.Kmer, Int}</code>: Sorted dictionary mapping each k-mer to its frequency count</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/kmer-analysis.jl#LL1442">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.count_kmers-Union{Tuple{R}, Tuple{KMER_TYPE}, Tuple{Type{KMER_TYPE}, R}} where {KMER_TYPE, R&lt;:Union{FASTX.FASTA.Reader, FASTX.FASTQ.Reader}}" href="#Mycelia.count_kmers-Union{Tuple{R}, Tuple{KMER_TYPE}, Tuple{Type{KMER_TYPE}, R}} where {KMER_TYPE, R&lt;:Union{FASTX.FASTA.Reader, FASTX.FASTQ.Reader}}"><code>Mycelia.count_kmers</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">count_kmers(
    _::Type{KMER_TYPE},
    sequences::Union{FASTX.FASTA.Reader, FASTX.FASTQ.Reader}
) -&gt; Any
</code></pre><p>Counts k-mer occurrences in biological sequences from a FASTA/FASTQ reader.</p><p><strong>Arguments</strong></p><ul><li><code>KMER_TYPE</code>: Type parameter specifying the k-mer length and encoding (e.g., <code>DNAKmer{4}</code> for 4-mers)</li><li><code>sequences</code>: A FASTA or FASTQ reader containing the biological sequences to analyze</li></ul><p><strong>Returns</strong></p><p>A dictionary mapping k-mers to their counts in the input sequences</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/kmer-analysis.jl#LL1522">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.count_kmers-Union{Tuple{R}, Tuple{KMER_TYPE}, Tuple{Type{KMER_TYPE}, R}} where {KMER_TYPE, R&lt;:Union{FASTX.FASTA.Record, FASTX.FASTQ.Record}}" href="#Mycelia.count_kmers-Union{Tuple{R}, Tuple{KMER_TYPE}, Tuple{Type{KMER_TYPE}, R}} where {KMER_TYPE, R&lt;:Union{FASTX.FASTA.Record, FASTX.FASTQ.Record}}"><code>Mycelia.count_kmers</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">count_kmers(
    _::Type{KMER_TYPE},
    record::Union{FASTX.FASTA.Record, FASTX.FASTQ.Record}
) -&gt; Any
</code></pre><p>Count the frequency of amino acid k-mers in a biological sequence.</p><p><strong>Arguments</strong></p><ul><li><code>Kmers.Kmer{A,K}</code>: Type parameter specifying amino acid alphabet (A) and k-mer length (K)</li><li><code>sequence</code>: Input biological sequence to analyze</li></ul><p><strong>Returns</strong></p><p>A sorted dictionary mapping each k-mer to its frequency count in the sequence.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/kmer-analysis.jl#LL1476">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.count_kmers-Union{Tuple{T}, Tuple{KMER_TYPE}, Tuple{Type{KMER_TYPE}, AbstractVector{T}}} where {KMER_TYPE, T&lt;:AbstractString}" href="#Mycelia.count_kmers-Union{Tuple{T}, Tuple{KMER_TYPE}, Tuple{Type{KMER_TYPE}, AbstractVector{T}}} where {KMER_TYPE, T&lt;:AbstractString}"><code>Mycelia.count_kmers</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">count_kmers(
    _::Type{KMER_TYPE},
    fastx_files::AbstractArray{T&lt;:AbstractString, 1}
) -&gt; Any
</code></pre><p>Count k-mers across multiple FASTA/FASTQ files and merge the results.</p><p><strong>Arguments</strong></p><ul><li><code>KMER_TYPE</code>: Type parameter specifying the k-mer length (e.g., <code>DNAKmer{4}</code> for 4-mers)</li><li><code>fastx_files</code>: Vector of paths to FASTA/FASTQ files</li></ul><p><strong>Returns</strong></p><ul><li><code>Dict{KMER_TYPE, Int}</code>: Dictionary mapping k-mers to their total counts across all files</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/kmer-analysis.jl#LL1538">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.count_kmers-Union{Tuple{T}, Tuple{KMER_TYPE}, Tuple{Type{KMER_TYPE}, AbstractVector{T}}} where {KMER_TYPE, T&lt;:Union{FASTX.FASTA.Record, FASTX.FASTQ.Record}}" href="#Mycelia.count_kmers-Union{Tuple{T}, Tuple{KMER_TYPE}, Tuple{Type{KMER_TYPE}, AbstractVector{T}}} where {KMER_TYPE, T&lt;:Union{FASTX.FASTA.Record, FASTX.FASTQ.Record}}"><code>Mycelia.count_kmers</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">count_kmers(
    _::Type{KMER_TYPE},
    records::AbstractArray{T&lt;:Union{FASTX.FASTA.Record, FASTX.FASTQ.Record}, 1}
) -&gt; Any
</code></pre><p>Count k-mers across multiple sequence records and return a sorted frequency table.</p><p><strong>Arguments</strong></p><ul><li><code>KMER_TYPE</code>: Type parameter specifying the k-mer length (e.g., <code>DNAKmer{3}</code> for 3-mers)</li><li><code>records</code>: Vector of FASTA/FASTQ records to analyze</li></ul><p><strong>Returns</strong></p><ul><li><code>Dict{KMER_TYPE, Int}</code>: Sorted dictionary mapping k-mers to their frequencies</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/kmer-analysis.jl#LL1501">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.count_matrix_to_probability_matrix-Tuple{Any}" href="#Mycelia.count_matrix_to_probability_matrix-Tuple{Any}"><code>Mycelia.count_matrix_to_probability_matrix</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">count_matrix_to_probability_matrix(counts_matrix) -&gt; Any
</code></pre><p>Convert a matrix of counts into a probability matrix by normalizing each column to sum to 1.0.</p><p><strong>Arguments</strong></p><ul><li><code>counts_matrix::Matrix{&lt;:Number}</code>: Input matrix where each column represents counts/frequencies</li></ul><p><strong>Returns</strong></p><ul><li><code>Matrix{Float64}</code>: Probability matrix where each column sums to 1.0</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/distance-metrics.jl#LL203">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.count_predicted_genes-Tuple{Any}" href="#Mycelia.count_predicted_genes-Tuple{Any}"><code>Mycelia.count_predicted_genes</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">count_predicted_genes(gff_file)</code></pre><p>Count the number of predicted genes from a GFF file.</p><p>Parses a GFF/GTF file and counts the number of CDS (coding sequence) features, which correspond to predicted genes.</p><p><strong>Arguments</strong></p><ul><li><code>gff_file</code>: Path to GFF/GTF file</li></ul><p><strong>Returns</strong></p><ul><li>Integer count of predicted genes (CDS features)</li></ul><p><strong>See Also</strong></p><ul><li><code>run_pyrodigal</code>: For gene prediction that generates GFF files</li><li><code>parse_transterm_output</code>: For parsing other annotation tool outputs</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/annotation.jl#LL2245-L2262">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.count_records-Tuple{Any}" href="#Mycelia.count_records-Tuple{Any}"><code>Mycelia.count_records</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">count_records(fastx) -&gt; Int64
</code></pre><p>Counts the total number of records in a FASTA/FASTQ file.</p><p><strong>Arguments</strong></p><ul><li><code>fastx</code>: Path to a FASTA or FASTQ file (can be gzipped)</li></ul><p><strong>Returns</strong></p><ul><li>Number of records (sequences) in the file</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/fastx.jl#LL1136">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.countmap_columns-Tuple{Any}" href="#Mycelia.countmap_columns-Tuple{Any}"><code>Mycelia.countmap_columns</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">countmap_columns(table)
</code></pre><p>Generate and display frequency counts for all columns in a DataFrame.</p><p><strong>Arguments</strong></p><ul><li><code>table::DataFrame</code>: Input DataFrame to analyze</li></ul><p><strong>Details</strong></p><p>Iterates through each column in the DataFrame and displays:</p><ol><li>The column name</li><li>A Dict mapping unique values to their frequencies using StatsBase.countmap</li></ol></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/utility-functions.jl#LL1879">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.create_assembly_environment-Tuple{Vector{String}, Vector{String}}" href="#Mycelia.create_assembly_environment-Tuple{Vector{String}, Vector{String}}"><code>Mycelia.create_assembly_environment</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">create_assembly_environment(training_data, validation_data; episode_length=100)</code></pre><p>Create a new reinforcement learning environment for assembly training.</p><p><strong>Arguments</strong></p><ul><li><code>training_data::Vector{String}</code>: Paths to training FASTQ datasets</li><li><code>validation_data::Vector{String}</code>: Paths to validation FASTQ datasets</li><li><code>episode_length::Int</code>: Maximum steps per training episode (default: 100)</li></ul><p><strong>Returns</strong></p><ul><li><code>AssemblyEnvironment</code>: Initialized RL environment ready for training</li></ul><p><strong>Example</strong></p><pre><code class="language-julia hljs">training_files = [&quot;genome1.fastq&quot;, &quot;genome2.fastq&quot;, &quot;genome3.fastq&quot;]
validation_files = [&quot;validation1.fastq&quot;, &quot;validation2.fastq&quot;]
env = create_assembly_environment(training_files, validation_files)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/reinforcement-learning.jl#LL141-L160">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.create_curriculum_schedule-Tuple{}" href="#Mycelia.create_curriculum_schedule-Tuple{}"><code>Mycelia.create_curriculum_schedule</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">create_curriculum_schedule(; stages=4, datasets_per_stage=10)</code></pre><p>Create a curriculum learning schedule that progressively increases difficulty.</p><p><strong>Arguments</strong></p><ul><li><code>stages::Int</code>: Number of curriculum stages (default: 4)</li><li><code>datasets_per_stage::Int</code>: Datasets per stage (default: 10)</li></ul><p><strong>Returns</strong></p><ul><li><code>Vector{Dict}</code>: Curriculum schedule with parameters for each stage</li></ul><p><strong>Example</strong></p><pre><code class="language-julia hljs">curriculum = create_curriculum_schedule(stages=5, datasets_per_stage=15)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/reinforcement-learning.jl#LL973-L989">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.create_database-Tuple{}" href="#Mycelia.create_database-Tuple{}"><code>Mycelia.create_database</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">create_database(; database, address, username, password)
</code></pre><p>Creates a new Neo4j database instance if it doesn&#39;t already exist.</p><p><strong>Arguments</strong></p><ul><li><code>database::String</code>: Name of the database to create</li><li><code>address::String</code>: Neo4j server address (e.g. &quot;neo4j://localhost:7687&quot;)</li><li><code>username::String</code>: Neo4j authentication username (defaults to &quot;neo4j&quot;)</li><li><code>password::String</code>: Neo4j authentication password</li></ul><p><strong>Notes</strong></p><ul><li>Requires system database privileges to execute</li><li>Silently returns if database already exists</li><li>Temporarily switches to system database to perform creation</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/neo4jl.jl#LL511">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.create_dqn_policy-Tuple{}" href="#Mycelia.create_dqn_policy-Tuple{}"><code>Mycelia.create_dqn_policy</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">create_dqn_policy(; state_dim=11, action_dim=3, hidden_dims=[128, 64], learning_rate=0.001, epsilon=0.1)</code></pre><p>Create a Deep Q-Network policy for assembly decisions.</p><p><strong>Arguments</strong></p><ul><li><code>state_dim::Int</code>: Dimension of state representation (default: 11)</li><li><code>action_dim::Int</code>: Number of discrete actions (default: 3 for continue/next/terminate)</li><li><code>hidden_dims::Vector{Int}</code>: Hidden layer sizes (default: [128, 64])</li><li><code>learning_rate::Float64</code>: Learning rate (default: 0.001)</li><li><code>epsilon::Float64</code>: Exploration probability (default: 0.1)</li></ul><p><strong>Returns</strong></p><ul><li><code>DQNPolicy</code>: Initialized policy network</li></ul><p><strong>Example</strong></p><pre><code class="language-julia hljs">policy = create_dqn_policy(hidden_dims=[256, 128, 64])</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/reinforcement-learning.jl#LL601-L620">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.create_hmm_from_graph-Tuple{MetaGraphsNext.MetaGraph{&lt;:Integer, &lt;:Any, String, Mycelia.KmerVertexData, Mycelia.KmerEdgeData}, Mycelia.ViterbiConfig}" href="#Mycelia.create_hmm_from_graph-Tuple{MetaGraphsNext.MetaGraph{&lt;:Integer, &lt;:Any, String, Mycelia.KmerVertexData, Mycelia.KmerEdgeData}, Mycelia.ViterbiConfig}"><code>Mycelia.create_hmm_from_graph</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">create_hmm_from_graph(graph::MetaGraph, config::ViterbiConfig) -&gt; (states, transitions, emissions)</code></pre><p>Create Hidden Markov Model parameters from a k-mer graph structure.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/viterbi-next.jl#LL96-L100">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.create_kfold_partitions-Tuple{Vector{&lt;:FASTX.FASTQ.Record}, Int64, Float64}" href="#Mycelia.create_kfold_partitions-Tuple{Vector{&lt;:FASTX.FASTQ.Record}, Int64, Float64}"><code>Mycelia.create_kfold_partitions</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Create k-fold partitions with validation holdout for cross-validation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/cross-validation.jl#LL167-L169">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.create_node_constraints-Tuple{Any}" href="#Mycelia.create_node_constraints-Tuple{Any}"><code>Mycelia.create_node_constraints</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">create_node_constraints(
    graph;
    address,
    username,
    password,
    database
)
</code></pre><p>Creates unique identifier constraints for each node type in a Neo4j database.</p><p><strong>Arguments</strong></p><ul><li><code>graph</code>: A MetaGraph containing nodes with TYPE properties</li><li><code>address</code>: Neo4j server address</li><li><code>username</code>: Neo4j username (default: &quot;neo4j&quot;)</li><li><code>password</code>: Neo4j password</li><li><code>database</code>: Neo4j database name (default: &quot;neo4j&quot;)</li></ul><p><strong>Details</strong></p><p>Extracts unique node types from the graph and creates Neo4j constraints ensuring each node of a given type has a unique identifier property.</p><p>Failed constraint creation attempts are silently skipped.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/neo4jl.jl#LL247">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.create_tarchive-Tuple{}" href="#Mycelia.create_tarchive-Tuple{}"><code>Mycelia.create_tarchive</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">create_tarchive(; directory, tarchive)
</code></pre><p>Creates a gzipped tar archive of the specified directory along with verification files.</p><p><strong>Arguments</strong></p><ul><li><code>directory</code>: Source directory path to archive</li><li><code>tarchive</code>: Optional output archive path (defaults to directory name with .tar.gz extension)</li></ul><p><strong>Generated Files</strong></p><ul><li><code>{tarchive}</code>: The compressed tar archive</li><li><code>{tarchive}.log</code>: Contents listing of the archive</li><li><code>{tarchive}.hashdeep.dfxml</code>: Cryptographic hashes (MD5, SHA1, SHA256) of the archive</li></ul><p><strong>Returns</strong></p><ul><li>Path to the created tar archive file</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/utility-functions.jl#LL1200">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.cross_validation_summary-Tuple{Dict}" href="#Mycelia.cross_validation_summary-Tuple{Dict}"><code>Mycelia.cross_validation_summary</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Generate cross-validation summary report.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/cross-validation.jl#LL550-L552">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.current_unix_datetime-Tuple{}" href="#Mycelia.current_unix_datetime-Tuple{}"><code>Mycelia.current_unix_datetime</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">current_unix_datetime() -&gt; Int64
</code></pre><p>Get the current time as a Unix timestamp (seconds since epoch).</p><p><strong>Returns</strong></p><ul><li><code>Int</code>: Current time as an integer Unix timestamp (seconds since January 1, 1970 UTC)</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia hljs">unix_time = current_unix_datetime()
# =&gt; 1709071368 (example value, will differ based on current time)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/utility-functions.jl#LL925">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.cypher-Tuple{Any}" href="#Mycelia.cypher-Tuple{Any}"><code>Mycelia.cypher</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">cypher(
    cmd;
    address,
    username,
    password,
    format,
    database
) -&gt; Cmd
</code></pre><p>Constructs a command to execute Neo4j Cypher queries via cypher-shell.</p><p><strong>Arguments</strong></p><ul><li><code>cmd</code>: The Cypher query command to execute</li><li><code>address::String=&quot;neo4j://localhost:7687&quot;</code>: Neo4j server address</li><li><code>username::String=&quot;neo4j&quot;</code>: Neo4j authentication username</li><li><code>password::String=&quot;password&quot;</code>: Neo4j authentication password </li><li><code>format::String=&quot;auto&quot;</code>: Output format (auto, verbose, or plain)</li><li><code>database::String=&quot;neo4j&quot;</code>: Target Neo4j database name</li></ul><p><strong>Returns</strong></p><ul><li><code>Cmd</code>: A command object ready for execution</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/neo4jl.jl#LL457">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.dataframe_convert_dicts_to_json-Tuple{Any}" href="#Mycelia.dataframe_convert_dicts_to_json-Tuple{Any}"><code>Mycelia.dataframe_convert_dicts_to_json</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">dataframe_convert_dicts_to_json(df) -&gt; Any
</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/utility-functions.jl#LL579">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.dataframe_replace_nothing_with_missing-Tuple{DataFrames.DataFrame}" href="#Mycelia.dataframe_replace_nothing_with_missing-Tuple{DataFrames.DataFrame}"><code>Mycelia.dataframe_replace_nothing_with_missing</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">dataframe_replace_nothing_with_missing(df::DataFrames.DataFrame) -&gt; DataFrames.DataFrame</code></pre><p>Return the DataFrame with all <code>nothing</code> values replaced by <code>missing</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/utility-functions.jl#LL98-L102">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.dataframe_to_ndjson-Tuple{DataFrames.DataFrame}" href="#Mycelia.dataframe_to_ndjson-Tuple{DataFrames.DataFrame}"><code>Mycelia.dataframe_to_ndjson</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">dataframe_to_ndjson(df::DataFrame; outfile::Union{String,Nothing}=nothing)</code></pre><p>Converts a DataFrame <code>df</code> into a newline-delimited JSON (NDJSON) string. Each line in the returned string represents one DataFrame row in JSON format, suitable for upload to Google BigQuery.</p><p><strong>Keyword Arguments</strong></p><ul><li><code>outfile::Union{String,Nothing}</code>: If provided, writes the resulting NDJSON to the file path given.</li></ul><p><strong>Examples</strong></p><p>```julia using DataFrames, Dates</p><p><strong>Sample DataFrame</strong></p><p>df = DataFrame(     id = [1, 2, 3],     name = [&quot;Alice&quot;, &quot;Bob&quot;, &quot;Carol&quot;],     created = [DateTime(2025, 4, 8, 14, 30), DateTime(2025, 4, 8, 15, 0), missing] )</p><p>ndjson<em>str = dataframe</em>to<em>ndjson(df) println(ndjson</em>str)</p><p><strong>Optionally, write to a file</strong></p><p>dataframe<em>to</em>ndjson(df; outfile=&quot;output.ndjson&quot;)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/utility-functions.jl#LL609-L635">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.deduplicate_fasta_file-Tuple{Any, Any}" href="#Mycelia.deduplicate_fasta_file-Tuple{Any, Any}"><code>Mycelia.deduplicate_fasta_file</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">deduplicate_fasta_file(in_fasta, out_fasta) -&gt; Any
</code></pre><p>Remove duplicate sequences from a FASTA file while preserving headers.</p><p><strong>Arguments</strong></p><ul><li><code>in_fasta</code>: Path to input FASTA file</li><li><code>out_fasta</code>: Path where deduplicated FASTA will be written</li></ul><p><strong>Returns</strong></p><p>Path to the output FASTA file (same as <code>out_fasta</code> parameter)</p><p><strong>Details</strong></p><ul><li>Sequences are considered identical if they match exactly (case-sensitive)</li><li>For duplicate sequences, keeps the first header encountered</li><li>Input sequences are sorted by identifier before deduplication</li><li>Preserves the original sequence formatting</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/fastx.jl#LL990">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.detect_alphabet-Tuple{AbstractString}" href="#Mycelia.detect_alphabet-Tuple{AbstractString}"><code>Mycelia.detect_alphabet</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">detect_alphabet(seq::AbstractString) -&gt; Symbol
</code></pre><p>Determines the alphabet of a sequence. The function scans through <code>seq</code> only once:</p><ul><li>If a &#39;T&#39; or &#39;t&#39; is found (and no &#39;U/u&#39;), the sequence is classified as DNA.</li><li>If a &#39;U&#39; or &#39;u&#39; is found (and no &#39;T/t&#39;), it is classified as RNA.</li><li>If both T and U occur, an error is thrown.</li><li>If a character outside the canonical nucleotide and ambiguity codes is encountered, the sequence is assumed to be protein.</li><li>If neither T nor U are found, the sequence is assumed to be DNA.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/alphabets.jl#LL16">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.detect_alphabet-Tuple{BioSequences.LongAA}" href="#Mycelia.detect_alphabet-Tuple{BioSequences.LongAA}"><code>Mycelia.detect_alphabet</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">detect_alphabet(sequence::BioSequences.LongAA) -&gt; Symbol
</code></pre><p>Detect the alphabet of a <code>LongAA</code> sequence.</p><p>Always returns <code>:AA</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/alphabets.jl#LL79">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.detect_alphabet-Tuple{BioSequences.LongDNA}" href="#Mycelia.detect_alphabet-Tuple{BioSequences.LongDNA}"><code>Mycelia.detect_alphabet</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">detect_alphabet(sequence::BioSequences.LongDNA) -&gt; Symbol
</code></pre><p>Detect the alphabet of a <code>LongDNA</code> sequence.</p><p>Always returns <code>:DNA</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/alphabets.jl#LL56">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.detect_alphabet-Tuple{BioSequences.LongRNA}" href="#Mycelia.detect_alphabet-Tuple{BioSequences.LongRNA}"><code>Mycelia.detect_alphabet</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">detect_alphabet(sequence::BioSequences.LongRNA) -&gt; Symbol
</code></pre><p>Detect the alphabet of a <code>LongRNA</code> sequence.</p><p>Always returns <code>:RNA</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/alphabets.jl#LL68">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.detect_and_extract_sequence-Tuple{Union{FASTX.FASTA.Record, FASTX.FASTQ.Record}}" href="#Mycelia.detect_and_extract_sequence-Tuple{Union{FASTX.FASTA.Record, FASTX.FASTQ.Record}}"><code>Mycelia.detect_and_extract_sequence</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">detect_and_extract_sequence(
    record::Union{FASTX.FASTA.Record, FASTX.FASTQ.Record}
) -&gt; Tuple{Symbol, Union{BioSequences.LongAA, BioSequences.LongDNA{4}, BioSequences.LongRNA{4}}}
</code></pre><p>Detect alphabet and extract typed sequence from FASTX record in one step.</p><p>Convenience function that combines alphabet detection with type-safe sequence extraction, ideal for workflows that need to determine sequence type once at the beginning.</p><p><strong>Arguments</strong></p><ul><li><code>record::Union{FASTX.FASTA.Record, FASTX.FASTQ.Record}</code>: Input sequence record</li></ul><p><strong>Returns</strong></p><ul><li><code>Tuple{Symbol, BioSequences.BioSequence}</code>: (alphabet<em>symbol, typed</em>sequence)</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia hljs">record = FASTX.FASTQ.Record(&quot;read1&quot;, &quot;ATCG&quot;, &quot;IIII&quot;)
alphabet, sequence = detect_and_extract_sequence(record)
# alphabet = :DNA, sequence = LongDNA{4} object</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/utility-functions.jl#LL2147">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.detect_bubbles_next-Tuple{MetaGraphsNext.MetaGraph{&lt;:Integer, String, Mycelia.KmerVertexData, Mycelia.KmerEdgeData}}" href="#Mycelia.detect_bubbles_next-Tuple{MetaGraphsNext.MetaGraph{&lt;:Integer, String, Mycelia.KmerVertexData, Mycelia.KmerEdgeData}}"><code>Mycelia.detect_bubbles_next</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">detect_bubbles_next(graph::MetaGraphsNext.MetaGraph, min_bubble_length::Int=2, max_bubble_length::Int=100) -&gt; Vector{BubbleStructure}</code></pre><p>Detect bubble structures (alternative paths) in the assembly graph.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/sequence-graphs-next.jl#LL1214-L1218">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.detect_sequence_extension-Tuple{Union{FASTX.FASTA.Record, FASTX.FASTQ.Record}}" href="#Mycelia.detect_sequence_extension-Tuple{Union{FASTX.FASTA.Record, FASTX.FASTQ.Record}}"><code>Mycelia.detect_sequence_extension</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">detect_sequence_extension(
    record::Union{FASTX.FASTA.Record, FASTX.FASTQ.Record}
) -&gt; String
</code></pre><p>Detect sequence type from input and suggest appropriate file extension.</p><p><strong>Arguments</strong></p><ul><li><code>record</code>: A FASTA/FASTQ record</li><li><code>sequence</code>: A string or BioSequence containing sequence data</li></ul><p><strong>Returns</strong></p><ul><li><code>String</code>: Suggested file extension:<ul><li>&quot;.fna&quot; for DNA</li><li>&quot;.frn&quot; for RNA</li><li>&quot;.faa&quot; for protein</li><li>&quot;.fa&quot; for unrecognized sequences</li></ul></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/fastx.jl#LL883">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.determine_fasta_coverage_from_bam-Tuple{Any}" href="#Mycelia.determine_fasta_coverage_from_bam-Tuple{Any}"><code>Mycelia.determine_fasta_coverage_from_bam</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">determine_fasta_coverage_from_bam(bam) -&gt; Any
</code></pre><p>Calculate per-base genomic coverage from a BAM file using bedtools.</p><p><strong>Arguments</strong></p><ul><li><code>bam::String</code>: Path to input BAM file</li></ul><p><strong>Returns</strong></p><ul><li><code>String</code>: Path to the generated coverage file (<code>.coverage.txt</code>)</li></ul><p><strong>Details</strong></p><p>Uses bedtools genomecov to compute per-base coverage. Creates a coverage file  with the format: &lt;chromosome&gt; &lt;position&gt; &lt;coverage_depth&gt;.  If the coverage file already exists, returns the existing file path.</p><p><strong>Dependencies</strong></p><p>Requires bedtools (automatically installed in conda environment)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/xam.jl#LL373">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.determine_max_canonical_kmers-Tuple{Any, Any}" href="#Mycelia.determine_max_canonical_kmers-Tuple{Any, Any}"><code>Mycelia.determine_max_canonical_kmers</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">determine_max_canonical_kmers(k, ALPHABET) -&gt; Any
</code></pre><p>Calculate the maximum number of possible canonical k-mers for a given alphabet.</p><p><strong>Arguments</strong></p><ul><li><code>k::Integer</code>: Length of k-mer</li><li><code>ALPHABET::Vector{Char}</code>: Character set (nucleotides or amino acids)</li></ul><p><strong>Returns</strong></p><ul><li><code>Int</code>: Maximum number of possible canonical k-mers</li></ul><p><strong>Details</strong></p><ul><li>For amino acids (AA_ALPHABET): returns total possible k-mers</li><li>For nucleotides: returns half of total possible k-mers (canonical form)</li><li>Requires odd k-mer length for nucleotide alphabets</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/kmer-analysis.jl#LL1306">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.determine_max_possible_kmers-Tuple{Any, Any}" href="#Mycelia.determine_max_possible_kmers-Tuple{Any, Any}"><code>Mycelia.determine_max_possible_kmers</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">determine_max_possible_kmers(k, ALPHABET) -&gt; Any
</code></pre><p>Calculate the total number of possible unique k-mers that can be generated from a given alphabet.</p><p><strong>Arguments</strong></p><ul><li><code>k</code>: Length of k-mers to consider</li><li><code>ALPHABET</code>: Vector containing the allowed characters/symbols</li></ul><p><strong>Returns</strong></p><ul><li>Integer representing the maximum number of possible unique k-mers (|Σ|ᵏ)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/kmer-analysis.jl#LL1333">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.determine_primary_contig-Tuple{Any}" href="#Mycelia.determine_primary_contig-Tuple{Any}"><code>Mycelia.determine_primary_contig</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">determine_primary_contig(qualimap_results) -&gt; Any
</code></pre><p>Determines the contig with the greatest number of total bases mapping to it</p><p>Identify the primary contig based on mapping coverage from Qualimap results.</p><p><strong>Arguments</strong></p><ul><li><code>qualimap_results::DataFrame</code>: DataFrame containing Qualimap alignment statistics with  columns &quot;Contig&quot; and &quot;Mapped bases&quot;</li></ul><p><strong>Returns</strong></p><ul><li><code>String</code>: Name of the contig with the highest number of mapped bases</li></ul><p><strong>Description</strong></p><p>Takes Qualimap alignment results and determines which contig has the most total bases  mapped to it, which often indicates the main chromosomal assembly.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/sequence-graphs.jl#LL2354">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.determine_read_lengths-Tuple{Any}" href="#Mycelia.determine_read_lengths-Tuple{Any}"><code>Mycelia.determine_read_lengths</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">determine_read_lengths(
    fastq_file;
    total_reads
) -&gt; Vector{Int64}
</code></pre><p>Calculate sequence lengths for reads in a FASTQ file.</p><p><strong>Arguments</strong></p><ul><li><code>fastq_file::String</code>: Path to input FASTQ file</li><li><code>total_reads::Integer=Inf</code>: Number of reads to process (defaults to all reads)</li></ul><p><strong>Returns</strong></p><ul><li><code>Vector{Int}</code>: Array containing the length of each sequence read</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/fastx.jl#LL1155">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.dictvec_to_dataframe-Tuple{Vector{&lt;:AbstractDict}}" href="#Mycelia.dictvec_to_dataframe-Tuple{Vector{&lt;:AbstractDict}}"><code>Mycelia.dictvec_to_dataframe</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">dictvec_to_dataframe(dictvec::Vector{&lt;:AbstractDict}; symbol_columns::Bool = true)</code></pre><p>Convert a vector of dictionaries (with possibly non-uniform keys and any key type) into a DataFrame. Missing keys in a row are filled with <code>missing</code>.</p><p><strong>Arguments</strong></p><ul><li><code>dictvec</code>: Vector of dictionaries.</li><li><code>symbol_columns</code>: If true (default), columns are named as Symbols (when possible), else as raw keys.</li></ul><p><strong>Returns</strong></p><ul><li><code>DataFrames.DataFrame</code> with columns as the union of all keys.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/utility-functions.jl#LL330-L342">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.distance_matrix_to_newick-Tuple{}" href="#Mycelia.distance_matrix_to_newick-Tuple{}"><code>Mycelia.distance_matrix_to_newick</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">distance_matrix_to_newick(
;
    distance_matrix,
    labels,
    outfile
)
</code></pre><p>Create distance matrix from a column-major counts matrix (features as rows and entities as columns) where distance is a proportional to total feature count magnitude (size) and cosine similarity (relative frequency)</p><p>Convert a distance matrix into a Newick tree format using UPGMA hierarchical clustering.</p><p><strong>Arguments</strong></p><ul><li><code>distance_matrix</code>: Square matrix of pairwise distances between entities</li><li><code>labels</code>: Vector of labels corresponding to the entities in the distance matrix</li><li><code>outfile</code>: Path where the Newick tree file will be written</li></ul><p><strong>Returns</strong></p><ul><li>Path to the generated Newick tree file</li></ul><p><strong>Details</strong></p><p>Performs hierarchical clustering using the UPGMA (average linkage) method and  converts the resulting dendrogram into Newick tree format. The branch lengths  in the tree represent the heights from the clustering.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/distance-metrics.jl#LL222">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.document_frequency-Tuple{Any}" href="#Mycelia.document_frequency-Tuple{Any}"><code>Mycelia.document_frequency</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">document_frequency(
    documents
) -&gt; Dict{T, Int64} where T&lt;:(SubString{_A} where _A)
</code></pre><p>Calculate the document frequency of tokens across a collection of documents.</p><p><strong>Arguments</strong></p><ul><li><code>documents</code>: Collection of text documents where each document is a string</li></ul><p><strong>Returns</strong></p><ul><li>Dictionary mapping each unique token to the number of documents it appears in</li></ul><p><strong>Description</strong></p><p>Computes how many documents contain each unique token. Each document is tokenized  by splitting on whitespace. Tokens are counted only once per document, regardless  of how many times they appear within that document.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/clustering.jl#LL390">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.download_bandage" href="#Mycelia.download_bandage"><code>Mycelia.download_bandage</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">download_bandage() -&gt; String
download_bandage(outdir) -&gt; Any
</code></pre><p>Downloads and installs Bandage, a bioinformatics visualization tool for genome assembly graphs.</p><p><strong>Arguments</strong></p><ul><li><code>outdir=&quot;/usr/local/bin&quot;</code>: Target installation directory for the Bandage executable</li></ul><p><strong>Returns</strong></p><ul><li>Path to the installed Bandage executable</li></ul><p><strong>Details</strong></p><ul><li>Downloads Bandage v0.8.1 for Ubuntu</li><li>Installs required system dependencies (libxcb-glx0, libx11-xcb-dev, libfontconfig, libgl1-mesa-glx)</li><li>Attempts installation with sudo, falls back to root if sudo fails</li><li>Skips download if Bandage is already installed at target location</li></ul><p><strong>Dependencies</strong></p><p>Requires system commands: wget, unzip, apt</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/utility-functions.jl#LL1008">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.download_blast_db-Tuple{}" href="#Mycelia.download_blast_db-Tuple{}"><code>Mycelia.download_blast_db</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">download_blast_db(; db, dbdir, source, wait)
</code></pre><p>Smart downloading of blast dbs depending on interactive, non interactive context</p><p>For a list of all available databases, run: <code>Mycelia.list_blastdbs()</code></p><p>Downloads and sets up BLAST databases from various sources.</p><p><strong>Arguments</strong></p><ul><li><code>db</code>: Name of the BLAST database to download</li><li><code>dbdir</code>: Directory to store the downloaded database (default: &quot;~/workspace/blastdb&quot;)</li><li><code>source</code>: Download source - one of [&quot;&quot;, &quot;aws&quot;, &quot;gcp&quot;, &quot;ncbi&quot;]. Empty string auto-detects fastest source</li><li><code>wait</code>: Whether to wait for download completion (default: true)</li></ul><p><strong>Returns</strong></p><ul><li>String path to the downloaded database directory</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/reference-databases.jl#LL1335">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.download_genome_by_accession-Tuple{}" href="#Mycelia.download_genome_by_accession-Tuple{}"><code>Mycelia.download_genome_by_accession</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">download_genome_by_accession(
;
    accession,
    outdir,
    compressed
)
</code></pre><p>Downloads a genomic sequence from NCBI&#39;s nucleotide database by its accession number.</p><p><strong>Arguments</strong></p><ul><li><code>accession::String</code>: NCBI nucleotide accession number (e.g. &quot;NC_045512&quot;)</li><li><code>outdir::String</code>: Output directory path. Defaults to current directory</li><li><code>compressed::Bool</code>: If true, compresses output file with gzip. Defaults to true</li></ul><p><strong>Returns</strong></p><ul><li><code>String</code>: Path to the downloaded file (.fna or .fna.gz)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/reference-databases.jl#LL1130">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.download_genome_by_ftp-Tuple{}" href="#Mycelia.download_genome_by_ftp-Tuple{}"><code>Mycelia.download_genome_by_ftp</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">download_genome_by_ftp(; ftp, outdir)
</code></pre><p>Downloads a genome file from NCBI FTP server to the specified directory.</p><p><strong>Arguments</strong></p><ul><li><code>ftp::String</code>: NCBI FTP path for the genome (e.g. &quot;ftp://ftp.ncbi.nlm.nih.gov/.../&quot;)</li><li><code>outdir::String</code>: Output directory path. Defaults to current working directory.</li></ul><p><strong>Returns</strong></p><ul><li><code>String</code>: Path to the downloaded file</li></ul><p><strong>Notes</strong></p><ul><li>If the target file already exists, returns the existing file path without re-downloading</li><li>Downloads the genomic.fna.gz version of the genome</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/reference-databases.jl#LL1172">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.download_mmseqs_db-Tuple{}" href="#Mycelia.download_mmseqs_db-Tuple{}"><code>Mycelia.download_mmseqs_db</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">download_mmseqs_db(; db, dbdir, force, wait)
</code></pre><p>Downloads and sets up MMseqs2 reference databases for sequence searching and analysis.</p><p><strong>Arguments</strong></p><ul><li><code>db::String</code>: Name of database to download (see table below)</li><li><code>dbdir::String</code>: Directory to store the downloaded database (default: &quot;~/workspace/mmseqs&quot;)</li><li><code>force::Bool</code>: If true, force re-download even if database exists (default: false)</li><li><code>wait::Bool</code>: If true, wait for download to complete (default: true)</li></ul><p><strong>Returns</strong></p><ul><li>Path to the downloaded database as a String</li></ul><p><strong>Available Databases</strong></p><table><tr><th style="text-align: right">Database</th><th style="text-align: right">Type</th><th style="text-align: right">Taxonomy</th><th style="text-align: right">Description</th></tr><tr><td style="text-align: right">UniRef100</td><td style="text-align: right">Aminoacid</td><td style="text-align: right">Yes</td><td style="text-align: right">UniProt Reference Clusters - 100% identity</td></tr><tr><td style="text-align: right">UniRef90</td><td style="text-align: right">Aminoacid</td><td style="text-align: right">Yes</td><td style="text-align: right">UniProt Reference Clusters - 90% identity</td></tr><tr><td style="text-align: right">UniRef50</td><td style="text-align: right">Aminoacid</td><td style="text-align: right">Yes</td><td style="text-align: right">UniProt Reference Clusters - 50% identity</td></tr><tr><td style="text-align: right">UniProtKB</td><td style="text-align: right">Aminoacid</td><td style="text-align: right">Yes</td><td style="text-align: right">Universal Protein Knowledge Base</td></tr><tr><td style="text-align: right">NR</td><td style="text-align: right">Aminoacid</td><td style="text-align: right">Yes</td><td style="text-align: right">NCBI Non-redundant proteins</td></tr><tr><td style="text-align: right">NT</td><td style="text-align: right">Nucleotide</td><td style="text-align: right">No</td><td style="text-align: right">NCBI Nucleotide collection</td></tr><tr><td style="text-align: right">GTDB</td><td style="text-align: right">Aminoacid</td><td style="text-align: right">Yes</td><td style="text-align: right">Genome Taxonomy Database</td></tr><tr><td style="text-align: right">PDB</td><td style="text-align: right">Aminoacid</td><td style="text-align: right">No</td><td style="text-align: right">Protein Data Bank structures</td></tr><tr><td style="text-align: right">Pfam-A.full</td><td style="text-align: right">Profile</td><td style="text-align: right">No</td><td style="text-align: right">Protein family alignments</td></tr><tr><td style="text-align: right">SILVA</td><td style="text-align: right">Nucleotide</td><td style="text-align: right">Yes</td><td style="text-align: right">Ribosomal RNA database</td></tr></table><pre><code class="nohighlight hljs">  Name                  Type            Taxonomy        Url                                                           
- UniRef100             Aminoacid            yes        https://www.uniprot.org/help/uniref
- UniRef90              Aminoacid            yes        https://www.uniprot.org/help/uniref
- UniRef50              Aminoacid            yes        https://www.uniprot.org/help/uniref
- UniProtKB             Aminoacid            yes        https://www.uniprot.org/help/uniprotkb
- UniProtKB/TrEMBL      Aminoacid            yes        https://www.uniprot.org/help/uniprotkb
- UniProtKB/Swiss-Prot  Aminoacid            yes        https://uniprot.org
- NR                    Aminoacid            yes        https://ftp.ncbi.nlm.nih.gov/blast/db/FASTA
- NT                    Nucleotide             -        https://ftp.ncbi.nlm.nih.gov/blast/db/FASTA
- GTDB                  Aminoacid            yes        https://gtdb.ecogenomic.org
- PDB                   Aminoacid              -        https://www.rcsb.org
- PDB70                 Profile                -        https://github.com/soedinglab/hh-suite
- Pfam-A.full           Profile                -        https://pfam.xfam.org
- Pfam-A.seed           Profile                -        https://pfam.xfam.org
- Pfam-B                Profile                -        https://xfam.wordpress.com/2020/06/30/a-new-pfam-b-is-released
- CDD                   Profile                -        https://www.ncbi.nlm.nih.gov/Structure/cdd/cdd.shtml
- eggNOG                Profile                -        http://eggnog5.embl.de
- VOGDB                 Profile                -        https://vogdb.org
- dbCAN2                Profile                -        http://bcb.unl.edu/dbCAN2
- SILVA                 Nucleotide           yes        https://www.arb-silva.de
- Resfinder             Nucleotide             -        https://cge.cbs.dtu.dk/services/ResFinder
- Kalamari              Nucleotide           yes        https://github.com/lskatz/Kalamari</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/reference-databases.jl#LL2748">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.download_sequence_by_accession-Tuple{}" href="#Mycelia.download_sequence_by_accession-Tuple{}"><code>Mycelia.download_sequence_by_accession</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">download_sequence_by_accession(
;
    accession,
    outdir,
    database,
    format,
    suffix,
    compressed
)
</code></pre><p>Download a sequence from NCBI by accession number with flexible format options.</p><p><strong>Arguments</strong></p><ul><li><code>accession::String</code>: NCBI accession number</li><li><code>outdir::String</code>: Output directory</li><li><code>database::String</code>: NCBI database (&quot;nuccore&quot;, &quot;protein&quot;, etc.)</li><li><code>format::String</code>: Output format (&quot;fasta&quot;, &quot;fasta<em>cds</em>na&quot;, &quot;fasta<em>cds</em>aa&quot;, etc.)</li><li><code>suffix::String</code>: File suffix to append to accession for filename</li><li><code>compressed::Bool</code>: Whether to gzip compress the output (default: true)</li></ul><p><strong>Returns</strong></p><ul><li><code>String</code>: Path to the downloaded file</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/reference-databases.jl#LL3061">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.download_sra_data-Tuple{String}" href="#Mycelia.download_sra_data-Tuple{String}"><code>Mycelia.download_sra_data</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Downloads sequencing reads from NCBI&#39;s Sequence Read Archive (SRA).</p><p>Downloads reads using fasterq-dump. The function automatically detects whether the data is single-end or paired-end and returns appropriate file paths. Users should apply quality control based on their knowledge of the data type.</p><p><strong>Arguments</strong></p><ul><li><code>srr_identifier</code>: SRA run identifier (e.g., &quot;SRR1234567&quot;)</li><li><code>outdir</code>: Output directory for downloaded files (default: current directory)</li></ul><p><strong>Returns</strong></p><p>Named tuple with:</p><ul><li><code>srr_id</code>: The SRA identifier</li><li><code>outdir</code>: Output directory path</li><li><code>files</code>: Vector of downloaded file paths (1 file for single-end, 2 for paired-end)</li><li><code>is_paired</code>: Boolean indicating if data is paired-end</li></ul><p><strong>Example</strong></p><pre><code class="language-julia hljs"># Download SRA data
result = Mycelia.download_sra_data(&quot;SRR1234567&quot;, outdir=&quot;./data&quot;)

# Apply appropriate QC based on data type
if result.is_paired
    # Paired-end data - use paired-end QC
    Mycelia.trim_galore_paired(forward_reads=result.files[1], reverse_reads=result.files[2])
else
    # Single-end data - use single-end QC
    Mycelia.qc_filter_short_reads_fastp(input=result.files[1])
end</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/reference-databases.jl#LL945-L977">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.download_viroid_reference_data-Tuple{String}" href="#Mycelia.download_viroid_reference_data-Tuple{String}"><code>Mycelia.download_viroid_reference_data</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">download_viroid_reference_data(
    viroid_name::String;
    outdir,
    download_genome,
    download_cds,
    download_protein,
    max_sequences
) -&gt; @NamedTuple{genome_files::Vector{String}, cds_files::Vector{String}, protein_files::Vector{String}, output_directory::String}
</code></pre><p>Download comprehensive viroid reference data including genome, CDS, and protein sequences.</p><p><strong>Arguments</strong></p><ul><li><code>viroid_name::String</code>: Name or search term for the viroid (e.g., &quot;Potato spindle tuber viroid&quot;)</li><li><code>outdir::String</code>: Output directory for downloaded files (default: current directory)</li><li><code>download_genome::Bool</code>: Download genomic DNA sequence (default: true)</li><li><code>download_cds::Bool</code>: Download CDS transcript sequences (default: true) </li><li><code>download_protein::Bool</code>: Download protein (FAA) sequences (default: true)</li><li><code>max_sequences::Int</code>: Maximum number of sequences per type (default: 10)</li></ul><p><strong>Returns</strong></p><ul><li><code>NamedTuple</code>: Paths to downloaded files (genome<em>files, cds</em>files, protein_files)</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia hljs"># Download all data for Potato spindle tuber viroid
files = download_viroid_reference_data(&quot;Potato spindle tuber viroid&quot;, &quot;viroid_data/&quot;)

# Download only genome sequences for general viroid search
files = download_viroid_reference_data(&quot;viroid&quot;, &quot;viroid_genomes/&quot;; 
                                     download_cds=false, download_protein=false)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/reference-databases.jl#LL2932">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.draw_dendrogram_tree-Tuple{MetaGraphs.MetaDiGraph}" href="#Mycelia.draw_dendrogram_tree-Tuple{MetaGraphs.MetaDiGraph}"><code>Mycelia.draw_dendrogram_tree</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">draw_dendrogram_tree(
    mg::MetaGraphs.MetaDiGraph;
    width,
    height,
    fontsize,
    margins,
    mergenodesize,
    lineweight,
    filename
) -&gt; Luxor.Drawing
</code></pre><p>Draw a dendrogram visualization of hierarchical clustering results stored in a MetaDiGraph.</p><p><strong>Arguments</strong></p><ul><li><code>mg::MetaGraphs.MetaDiGraph</code>: Graph containing hierarchical clustering results. Must have <code>:hcl</code> in graph properties with clustering data and vertex properties containing <code>:x</code>, <code>:y</code> coordinates.</li></ul><p><strong>Keywords</strong></p><ul><li><code>width::Integer=500</code>: Width of output image in pixels</li><li><code>height::Integer=500</code>: Height of output image in pixels </li><li><code>fontsize::Integer=12</code>: Font size for node labels in points</li><li><code>margins::Float64</code>: Margin size in pixels, defaults to min(width,height)/20</li><li><code>mergenodesize::Float64=1</code>: Size of circular nodes at merge points</li><li><code>lineweight::Float64=1</code>: Thickness of dendrogram lines</li><li><code>filename::String</code>: Output filename, defaults to timestamp with .dendrogram.png extension</li></ul><p><strong>Returns</strong></p><p>Nothing, but saves dendrogram image to disk and displays preview.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/plotting-and-visualization.jl#LL1051">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.draw_radial_tree-Tuple{MetaGraphs.MetaDiGraph}" href="#Mycelia.draw_radial_tree-Tuple{MetaGraphs.MetaDiGraph}"><code>Mycelia.draw_radial_tree</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">draw_radial_tree(
    mg::MetaGraphs.MetaDiGraph;
    width,
    height,
    fontsize,
    margins,
    mergenodesize,
    lineweight,
    filename
) -&gt; Luxor.Drawing
</code></pre><p>Draw a radial hierarchical clustering tree visualization and save it as an image file.</p><p><strong>Arguments</strong></p><ul><li><code>mg::MetaGraphs.MetaDiGraph</code>: A meta directed graph containing hierarchical clustering data with required graph properties <code>:hcl</code> containing clustering information.</li></ul><p><strong>Keywords</strong></p><ul><li><code>width::Int=500</code>: Width of the output image in pixels</li><li><code>height::Int=500</code>: Height of the output image in pixels</li><li><code>fontsize::Int=12</code>: Font size for node labels</li><li><code>margins::Float64</code>: Margin size (automatically calculated as min(width,height)/20)</li><li><code>mergenodesize::Float64=1</code>: Size of the merge point nodes</li><li><code>lineweight::Float64=1</code>: Thickness of the connecting lines</li><li><code>filename::String</code>: Output filename (defaults to timestamp with &quot;.radial.png&quot; suffix)</li></ul><p><strong>Details</strong></p><p>The function creates a radial visualization of hierarchical clustering results where:</p><ul><li>Leaf nodes are arranged in a circle with labels</li><li>Internal nodes represent merge points</li><li>Connections show the hierarchical structure through arcs and lines</li></ul><p>The visualization is saved as a PNG file and automatically previewed.</p><p><strong>Required Graph Properties</strong></p><p>The input graph must have:</p><ul><li><code>mg.gprops[:hcl].labels</code>: Vector of leaf node labels</li><li><code>mg.gprops[:hcl].order</code>: Vector of ordered leaf nodes</li><li><code>mg.gprops[:hcl].merges</code>: Matrix of merge operations</li><li><code>mg.vprops[v][:x]</code>: X coordinate for each vertex</li><li><code>mg.vprops[v][:y]</code>: Y coordinate for each vertex</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/plotting-and-visualization.jl#LL1136">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.drop_empty_columns!-Tuple{DataFrames.AbstractDataFrame}" href="#Mycelia.drop_empty_columns!-Tuple{DataFrames.AbstractDataFrame}"><code>Mycelia.drop_empty_columns!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">drop_empty_columns!(
    df::DataFrames.AbstractDataFrame
) -&gt; DataFrames.AbstractDataFrame
</code></pre><p>Identify all columns that have only missing or empty values, and remove those columns from the dataframe <em>in-place</em>.</p><p>Returns a modified version of the original dataframe. </p><p>See also: drop<em>empty</em>columns</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/utility-functions.jl#LL1147">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.drop_empty_columns-Tuple{DataFrames.AbstractDataFrame}" href="#Mycelia.drop_empty_columns-Tuple{DataFrames.AbstractDataFrame}"><code>Mycelia.drop_empty_columns</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">drop_empty_columns(df::DataFrames.AbstractDataFrame) -&gt; Any
</code></pre><p>Identify all columns that have only missing or empty values, and remove those columns from the dataframe.</p><p>Returns a modified copy of the dataframe.</p><p>See also: drop<em>empty</em>columns!</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/utility-functions.jl#LL1131">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.edge_path_to_sequence-Tuple{Any, Any}" href="#Mycelia.edge_path_to_sequence-Tuple{Any, Any}"><code>Mycelia.edge_path_to_sequence</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">edge_path_to_sequence(kmer_graph, edge_path) -&gt; Any
</code></pre><p>Converts a path of edges in a kmer graph into a DNA sequence by concatenating overlapping kmers.</p><p><strong>Arguments</strong></p><ul><li><code>kmer_graph</code>: A directed graph where vertices represent kmers and edges represent overlaps</li><li><code>edge_path</code>: Vector of edges representing a path through the graph</li></ul><p><strong>Returns</strong></p><p>A <code>BioSequences.LongDNASeq</code> containing the merged sequence represented by the path</p><p><strong>Details</strong></p><p>The function:</p><ol><li>Takes the first kmer from the source vertex of first edge</li><li>For each edge, handles orientation (forward/reverse complement)</li><li>Verifies overlaps between consecutive kmers</li><li>Concatenates unique bases to build final sequence</li></ol></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/sequence-graphs.jl#LL199">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.edge_probability-Tuple{Any, Any}" href="#Mycelia.edge_probability-Tuple{Any, Any}"><code>Mycelia.edge_probability</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">edge_probability(stranded_kmer_graph, edge) -&gt; Any
</code></pre><p>Calculate the probability of traversing a specific edge in a stranded k-mer graph.</p><p>The probability is computed as the ratio of this edge&#39;s coverage weight to the sum of all outgoing edge weights from the source vertex.</p><pre><code class="language-julia hljs">edge_probability(stranded_kmer_graph, edge) -&gt; Any
</code></pre><p><strong>Arguments</strong></p><ul><li><code>stranded_kmer_graph</code>: A directed graph where edges represent k-mer connections</li><li><code>edge</code>: The edge for which to calculate the probability</li></ul><p><strong>Returns</strong></p><ul><li><code>Float64</code>: Probability in range [0,1] representing likelihood of traversing this edge Returns 0.0 if sum of all outgoing edge weights is zero</li></ul><p><strong>Note</strong></p><p>Probability is based on the :coverage property of edges, using their length as weights</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/sequence-graphs.jl#LL165">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.edgemer_to_vertex_kmers-Tuple{Any}" href="#Mycelia.edgemer_to_vertex_kmers-Tuple{Any}"><code>Mycelia.edgemer_to_vertex_kmers</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">edgemer_to_vertex_kmers(
    edgemer
) -&gt; Tuple{Kmers.Kmer{BioSequences.DNAAlphabet{2}}, Kmers.Kmer{BioSequences.DNAAlphabet{2}}}
</code></pre><p>Convert an edgemer to two vertex kmers.</p><p>This function takes an edgemer (a sequence of DNA nucleotides) and converts it into two vertex kmers.  A kmer is a substring of length k from a DNA sequence. The first kmer is created from the first  n-1 elements of the edgemer, and the second kmer is created from the last n-1 elements of the edgemer.</p><p><strong>Arguments</strong></p><ul><li><code>edgemer::AbstractVector{T}</code>: A vector of DNA nucleotides where T is a subtype of <code>BioSequences.DNAAlphabet{2}</code>.</li></ul><p><strong>Returns</strong></p><ul><li><code>Tuple{Kmers.Kmer{BioSequences.DNAAlphabet{2}}, Kmers.Kmer{BioSequences.DNAAlphabet{2}}}</code>: A tuple containing two kmers.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/sequence-graphs.jl#LL2669">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.ensure_next_graph-Tuple{Any}" href="#Mycelia.ensure_next_graph-Tuple{Any}"><code>Mycelia.ensure_next_graph</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ensure_next_graph(graph) -&gt; Any
</code></pre><p>Automatically convert legacy graphs to next-generation format if needed.</p><p>This is a convenience function that checks the graph type and converts if necessary.</p><p><strong>Arguments</strong></p><ul><li><code>graph</code>: Graph in either legacy or next-generation format</li></ul><p><strong>Returns</strong></p><ul><li><code>MetaGraphsNext.MetaGraph</code>: Graph in next-generation format</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/sequence-graphs-next.jl#LL502">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.equally_spaced_samples-Tuple{Any, Any}" href="#Mycelia.equally_spaced_samples-Tuple{Any, Any}"><code>Mycelia.equally_spaced_samples</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">equally_spaced_samples(vector, n) -&gt; Any
</code></pre><p>Sample <code>n</code> equally spaced elements from <code>vector</code>.</p><p><strong>Arguments</strong></p><ul><li><code>vector</code>: Input vector to sample from</li><li><code>n</code>: Number of samples to return (must be positive)</li></ul><p><strong>Returns</strong></p><p>A vector containing <code>n</code> equally spaced elements from the input vector.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/utility-functions.jl#LL1626">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.equivalent_fasta_sequences-Tuple{Any, Any}" href="#Mycelia.equivalent_fasta_sequences-Tuple{Any, Any}"><code>Mycelia.equivalent_fasta_sequences</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">equivalent_fasta_sequences(fasta_1, fasta_2) -&gt; Bool
</code></pre><p>Compare two FASTA files to determine if they contain the same set of sequences, regardless of sequence order.</p><p><strong>Arguments</strong></p><ul><li><code>fasta_1::String</code>: Path to first FASTA file</li><li><code>fasta_2::String</code>: Path to second FASTA file</li></ul><p><strong>Returns</strong></p><ul><li><code>Bool</code>: <code>true</code> if both files contain exactly the same sequences, <code>false</code> otherwise</li></ul><p><strong>Details</strong></p><p>Performs a set-based comparison of DNA sequences by hashing each sequence. Sequence order differences between files do not affect the result.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/fastx.jl#LL936">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.error_rate_to_q_value-Tuple{Any}" href="#Mycelia.error_rate_to_q_value-Tuple{Any}"><code>Mycelia.error_rate_to_q_value</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">error_rate_to_q_value(error_rate) -&gt; Any
</code></pre><p>Convert a sequencing error probability to a Phred quality score (Q-value).</p><p>The calculation uses the standard Phred formula: Q = -10 * log₁₀(error_rate)</p><p><strong>Arguments</strong></p><ul><li><code>error_rate::Float64</code>: Probability of error (between 0 and 1)</li></ul><p><strong>Returns</strong></p><ul><li><code>q_value::Float64</code>: Phred quality score</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/fastx.jl#LL1201">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.errors_are_singletons-Tuple{Vector{&lt;:FASTX.FASTQ.Record}, Int64}" href="#Mycelia.errors_are_singletons-Tuple{Vector{&lt;:FASTX.FASTQ.Record}, Int64}"><code>Mycelia.errors_are_singletons</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Analyze k-mer coverage distribution to detect if errors are singletons. Returns true if low-coverage k-mers (likely errors) are well-separated from high-coverage ones.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/intelligent-assembly.jl#LL76-L79">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.estimate_copy_number-Tuple{MetaGraphsNext.MetaGraph{&lt;:Integer, String, Mycelia.KmerVertexData, Mycelia.KmerEdgeData}, Vector{String}}" href="#Mycelia.estimate_copy_number-Tuple{MetaGraphsNext.MetaGraph{&lt;:Integer, String, Mycelia.KmerVertexData, Mycelia.KmerEdgeData}, Vector{String}}"><code>Mycelia.estimate_copy_number</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Estimate copy number for repeat region.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/sequence-graphs-next.jl#LL1600-L1602">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.estimate_dense_matrix_memory-Tuple" href="#Mycelia.estimate_dense_matrix_memory-Tuple"><code>Mycelia.estimate_dense_matrix_memory</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">estimate_dense_matrix_memory(nrows::Integer, ncols::Integer)
estimate_dense_matrix_memory(T::DataType, nrows::Integer, ncols::Integer)</code></pre><p>Estimate the memory required (in bytes) for a dense matrix.</p><ul><li>If <code>T</code> is provided, estimate memory for a matrix with element type <code>T</code>.</li><li>If <code>T</code> is not provided, defaults to Float64.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/utility-functions.jl#LL171-L179">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.estimate_genome_size_from_kmers-Tuple{Union{AbstractString, BioSequences.LongSequence}, Integer}" href="#Mycelia.estimate_genome_size_from_kmers-Tuple{Union{AbstractString, BioSequences.LongSequence}, Integer}"><code>Mycelia.estimate_genome_size_from_kmers</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">estimate_genome_size_from_kmers(
    sequence::Union{AbstractString, BioSequences.LongSequence},
    k::Integer
) -&gt; Dict
</code></pre><p>Estimate genome size from k-mer analysis using total k-mer count.</p><p>This function estimates genome size using the basic relationship:  genome<em>size ≈ total</em>kmers - k + 1, where total_kmers is the sum of all k-mer  counts. This is a simple estimation method; more sophisticated approaches  accounting for sequencing depth, repeats, and errors may be more accurate.</p><p><strong>Arguments</strong></p><ul><li><code>sequence::Union{BioSequences.LongSequence, AbstractString}</code>: Input sequence or string</li><li><code>k::Integer</code>: K-mer size for analysis</li></ul><p><strong>Returns</strong></p><ul><li><code>Dict{String, Any}</code>: Dictionary containing:<ul><li>&quot;unique_kmers&quot;: Number of unique k-mers observed</li><li>&quot;total_kmers&quot;: Total k-mer count (sum of all frequencies)</li><li>&quot;estimated<em>genome</em>size&quot;: Estimated genome size</li><li>&quot;actual_size&quot;: Length of input sequence (if provided)</li></ul></li></ul><p><strong>Examples</strong></p><pre><code class="language-julia hljs"># Estimate genome size from a sequence
sequence = &quot;ATCGATCGATCGATCG&quot;
result = estimate_genome_size_from_kmers(sequence, 5)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/kmer-analysis.jl#LL2153">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.estimate_genome_size_from_kmers-Union{Tuple{T}, Tuple{AbstractVector{T}, Integer}} where T&lt;:Union{FASTX.FASTA.Record, FASTX.FASTQ.Record}" href="#Mycelia.estimate_genome_size_from_kmers-Union{Tuple{T}, Tuple{AbstractVector{T}, Integer}} where T&lt;:Union{FASTX.FASTA.Record, FASTX.FASTQ.Record}"><code>Mycelia.estimate_genome_size_from_kmers</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">estimate_genome_size_from_kmers(
    records::AbstractArray{T&lt;:Union{FASTX.FASTA.Record, FASTX.FASTQ.Record}, 1},
    k::Integer
)
</code></pre><p>Estimate genome size from FASTQ/FASTA records using k-mer analysis.</p><p>Overload for processing FASTQ or FASTA records directly.</p><p><strong>Arguments</strong></p><ul><li><code>records::AbstractVector{T}</code> where T &lt;: Union{FASTX.FASTA.Record, FASTX.FASTQ.Record}`: Input records</li><li><code>k::Integer</code>: K-mer size for analysis</li></ul><p><strong>Returns</strong></p><ul><li><code>Dict{String, Any}</code>: Dictionary with k-mer statistics and genome size estimate</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/kmer-analysis.jl#LL2214">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.estimate_memory_usage-Tuple{Int64, Int64}" href="#Mycelia.estimate_memory_usage-Tuple{Int64, Int64}"><code>Mycelia.estimate_memory_usage</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Estimate memory usage for a graph with given number of k-mers. Provides rough estimate for memory monitoring.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/intelligent-assembly.jl#LL135-L138">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.estimate_sparse_matrix_memory-Tuple" href="#Mycelia.estimate_sparse_matrix_memory-Tuple"><code>Mycelia.estimate_sparse_matrix_memory</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">estimate_sparse_matrix_memory(nrows::Integer, ncols::Integer; nnz=nothing, density=nothing)
estimate_sparse_matrix_memory(T::DataType, nrows::Integer, ncols::Integer; nnz=nothing, density=nothing)</code></pre><p>Estimate the memory required (in bytes) for a sparse matrix in CSC format.</p><ul><li>If <code>T</code> is provided, estimate memory for a matrix with element type <code>T</code>.</li><li>If <code>T</code> is not provided, defaults to Float64.</li><li>You must specify either <code>nnz</code> (number of non-zeros) or <code>density</code> (proportion of non-zeros, between 0 and 1).</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/utility-functions.jl#LL195-L204">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.estimate_transition_probabilities-Tuple{MetaGraphsNext.MetaGraph{&lt;:Integer, String, Mycelia.KmerVertexData, Mycelia.KmerEdgeData}, Vector}" href="#Mycelia.estimate_transition_probabilities-Tuple{MetaGraphsNext.MetaGraph{&lt;:Integer, String, Mycelia.KmerVertexData, Mycelia.KmerEdgeData}, Vector}"><code>Mycelia.estimate_transition_probabilities</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">estimate_transition_probabilities(graph::MetaGraph, sequences::Vector) -&gt; Matrix{Float64}</code></pre><p>Estimate transition probabilities from observed sequences in the graph.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/viterbi-next.jl#LL165-L169">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.evaluate_assembly_agent-Tuple{Mycelia.DQNPolicy, Vector{String}}" href="#Mycelia.evaluate_assembly_agent-Tuple{Mycelia.DQNPolicy, Vector{String}}"><code>Mycelia.evaluate_assembly_agent</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">evaluate_assembly_agent(policy::DQNPolicy, validation_data::Vector{String}; episodes=10)</code></pre><p>Evaluate a trained assembly agent on validation data.</p><p><strong>Arguments</strong></p><ul><li><code>policy::DQNPolicy</code>: Trained policy to evaluate</li><li><code>validation_data::Vector{String}</code>: Validation FASTQ files</li><li><code>episodes::Int</code>: Number of evaluation episodes (default: 10)</li></ul><p><strong>Returns</strong></p><ul><li><code>Dict{String, Float64}</code>: Evaluation metrics including mean reward, assembly quality, etc.</li></ul><p><strong>Example</strong></p><pre><code class="language-julia hljs"># metrics = evaluate_assembly_agent(trained_policy, validation_files)
# println(&quot;Mean reward: $(metrics[&quot;mean_reward&quot;])&quot;)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/reinforcement-learning.jl#LL768-L786">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.evaluate_classification-Tuple{Any, Any}" href="#Mycelia.evaluate_classification-Tuple{Any, Any}"><code>Mycelia.evaluate_classification</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">evaluate_classification(true_labels, pred_labels)</code></pre><p>Runs confusion<em>matrix, precision</em>recall_f1, and accuracy. Pretty-prints macro metrics and accuracy. Returns a named tuple with all results and plots.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/quality-control-and-benchmarking.jl#LL114-L120">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.execute_continue_k_action-Tuple{Mycelia.AssemblyEnvironment, Mycelia.AssemblyAction}" href="#Mycelia.execute_continue_k_action-Tuple{Mycelia.AssemblyEnvironment, Mycelia.AssemblyAction}"><code>Mycelia.execute_continue_k_action</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">execute_continue_k_action(env::AssemblyEnvironment, action::AssemblyAction)</code></pre><p>Execute a &quot;continue with current k&quot; action by performing error correction iterations.</p><p><strong>Arguments</strong></p><ul><li><code>env::AssemblyEnvironment</code>: Current environment</li><li><code>action::AssemblyAction</code>: Action specifying correction parameters</li></ul><p><strong>Returns</strong></p><ul><li><code>RewardComponents</code>: Reward breakdown for the action</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/reinforcement-learning.jl#LL317-L328">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.execute_next_k_action-Tuple{Mycelia.AssemblyEnvironment, Mycelia.AssemblyAction}" href="#Mycelia.execute_next_k_action-Tuple{Mycelia.AssemblyEnvironment, Mycelia.AssemblyAction}"><code>Mycelia.execute_next_k_action</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">execute_next_k_action(env::AssemblyEnvironment, action::AssemblyAction)</code></pre><p>Execute a &quot;move to next k&quot; action by progressing to the next prime k-mer size.</p><p><strong>Arguments</strong></p><ul><li><code>env::AssemblyEnvironment</code>: Current environment</li><li><code>action::AssemblyAction</code>: Action specifying progression parameters</li></ul><p><strong>Returns</strong></p><ul><li><code>RewardComponents</code>: Reward breakdown for the action</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/reinforcement-learning.jl#LL418-L429">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.execute_terminate_action-Tuple{Mycelia.AssemblyEnvironment, Mycelia.AssemblyAction}" href="#Mycelia.execute_terminate_action-Tuple{Mycelia.AssemblyEnvironment, Mycelia.AssemblyAction}"><code>Mycelia.execute_terminate_action</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">execute_terminate_action(env::AssemblyEnvironment, action::AssemblyAction)</code></pre><p>Execute a &quot;terminate assembly&quot; action and assess final assembly quality.</p><p><strong>Arguments</strong></p><ul><li><code>env::AssemblyEnvironment</code>: Current environment</li><li><code>action::AssemblyAction</code>: Termination action</li></ul><p><strong>Returns</strong></p><ul><li><code>RewardComponents</code>: Final reward breakdown including assembly quality assessment</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/reinforcement-learning.jl#LL493-L504">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.export_blast_db-Tuple{}" href="#Mycelia.export_blast_db-Tuple{}"><code>Mycelia.export_blast_db</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">export_blast_db(; path_to_db, fasta)
</code></pre><p>Export sequences from a BLAST database to a gzipped FASTA file.</p><p><strong>Arguments</strong></p><ul><li><code>path_to_db</code>: Path to the BLAST database</li><li><code>fasta</code>: Output path for the gzipped FASTA file (default: <code>path_to_db * &quot;.fna.gz&quot;</code>)</li></ul><p><strong>Details</strong></p><p>Uses conda&#39;s BLAST environment to extract sequences using <code>blastdbcmd</code>. The output is automatically compressed using <code>pigz</code>. If the output file already exists, the function will skip extraction.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/reference-databases.jl#LL2530">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.export_blast_db_taxonomy_table-Tuple{}" href="#Mycelia.export_blast_db_taxonomy_table-Tuple{}"><code>Mycelia.export_blast_db_taxonomy_table</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">export_blast_db_taxonomy_table(; path_to_db, outfile)
</code></pre><p>Exports a taxonomy mapping table from a BLAST database in seqid2taxid format.</p><p><strong>Arguments</strong></p><ul><li><code>path_to_db::String</code>: Path to the BLAST database</li><li><code>outfile::String</code>: Output file path (defaults to input path + &quot;.seqid2taxid.txt.gz&quot;)</li></ul><p><strong>Returns</strong></p><ul><li><code>String</code>: Path to the created output file</li></ul><p><strong>Details</strong></p><p>Creates a compressed tab-delimited file mapping sequence IDs to taxonomy IDs. Uses blastdbcmd without GI identifiers for better cross-referencing compatibility. If the output file already exists, returns the path without regenerating.</p><p><strong>Dependencies</strong></p><p>Requires BLAST+ tools installed via Bioconda.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/reference-databases.jl#LL2576">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.extract_pacbiosample_information-Tuple{Any}" href="#Mycelia.extract_pacbiosample_information-Tuple{Any}"><code>Mycelia.extract_pacbiosample_information</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">extract_pacbiosample_information(
    xml
) -&gt; DataFrames.DataFrame
</code></pre><p>Extract biosample and barcode information from a PacBio XML metadata file.</p><p><strong>Arguments</strong></p><ul><li><code>xml</code>: Path to PacBio XML metadata file</li></ul><p><strong>Returns</strong></p><p>DataFrame with two columns:</p><ul><li><code>BioSampleName</code>: Name of the biological sample</li><li><code>BarcodeName</code>: Associated DNA barcode identifier</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/utility-functions.jl#LL1269">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.extract_typed_sequence-Tuple{Union{FASTX.FASTA.Record, FASTX.FASTQ.Record}, Type{&lt;:BioSequences.BioSequence}}" href="#Mycelia.extract_typed_sequence-Tuple{Union{FASTX.FASTA.Record, FASTX.FASTQ.Record}, Type{&lt;:BioSequences.BioSequence}}"><code>Mycelia.extract_typed_sequence</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">extract_typed_sequence(
    record::Union{FASTX.FASTA.Record, FASTX.FASTQ.Record},
    sequence_type::Type{&lt;:BioSequences.BioSequence}
) -&gt; Any
</code></pre><p>Extract sequence from FASTX record using dynamically determined type.</p><p>This function provides type-safe sequence extraction by using the appropriate BioSequence type, avoiding hardcoded sequence types and string conversions.</p><p><strong>Arguments</strong></p><ul><li><code>record::Union{FASTX.FASTA.Record, FASTX.FASTQ.Record}</code>: Input sequence record</li><li><code>sequence_type::Type{&lt;:BioSequences.BioSequence}</code>: Target BioSequence type</li></ul><p><strong>Returns</strong></p><ul><li><code>BioSequences.BioSequence</code>: Typed sequence from the record</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia hljs">record = FASTX.FASTQ.Record(&quot;read1&quot;, &quot;ATCG&quot;, &quot;IIII&quot;)
seq_type = alphabet_to_biosequence_type(:DNA)
sequence = extract_typed_sequence(record, seq_type)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/utility-functions.jl#LL2120">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.fasta_and_gff_to_genbank-Tuple{}" href="#Mycelia.fasta_and_gff_to_genbank-Tuple{}"><code>Mycelia.fasta_and_gff_to_genbank</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">fasta_and_gff_to_genbank(; fasta, gff, genbank)
</code></pre><p>Convert FASTA sequence and GFF annotation files to GenBank format using EMBOSS seqret.</p><p><strong>Arguments</strong></p><ul><li><code>fasta::String</code>: Path to input FASTA file containing sequence data</li><li><code>gff::String</code>: Path to input GFF file containing genomic features</li><li><code>genbank::String</code>: Path for output GenBank file</li></ul><p><strong>Details</strong></p><p>Requires EMBOSS toolkit (installed via Bioconda). The function will:</p><ol><li>Create necessary output directories</li><li>Run seqret to combine sequence and features</li><li>Generate a GenBank format file at the specified location</li></ol></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/genome-features.jl#LL284">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.fasta_genome_size-Tuple{Any}" href="#Mycelia.fasta_genome_size-Tuple{Any}"><code>Mycelia.fasta_genome_size</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">fasta_genome_size(fasta_file) -&gt; Any
</code></pre><p>Calculate the total size (in bases) of all sequences in a FASTA file.</p><p><strong>Arguments</strong></p><ul><li><code>fasta_file::AbstractString</code>: Path to the FASTA file</li></ul><p><strong>Returns</strong></p><ul><li><code>Int</code>: Sum of lengths of all sequences in the FASTA file</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/fastx.jl#LL1219">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.fasta_list_to_dense_kmer_counts-Tuple{}" href="#Mycelia.fasta_list_to_dense_kmer_counts-Tuple{}"><code>Mycelia.fasta_list_to_dense_kmer_counts</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">fasta_list_to_dense_kmer_counts(
;
    fasta_list,
    k,
    alphabet,
    temp_dir_parent,
    count_element_type,
    result_file,
    force,
    cleanup_temp
)
</code></pre><p>Create a dense k-mer counts table for a set of FASTA files, with disk-backed temporary storage,  custom element type, robust error handling, and optional output file caching.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/kmer-analysis.jl#LL1578">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.fasta_list_to_sparse_kmer_counts-Tuple{}" href="#Mycelia.fasta_list_to_sparse_kmer_counts-Tuple{}"><code>Mycelia.fasta_list_to_sparse_kmer_counts</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">fasta_list_to_sparse_kmer_counts(
;
    fasta_list,
    k,
    alphabet,
    temp_dir_parent,
    count_element_type,
    rarefaction_data_filename,
    rarefaction_plot_basename,
    show_rarefaction_plot,
    result_file,
    out_dir,
    force,
    rarefaction_plot_kwargs...
)
</code></pre><p>Create a sparse kmer counts table (SparseMatrixCSC) from a list of FASTA files using a 3-pass approach. Pass 1 (Parallel): Counts kmers per file and writes to temporary JLD2 files. Pass 2 (Serial): Aggregates unique kmers, max count, nnz per file, and rarefaction data from temp files.                  Generates and saves a k-mer rarefaction plot. Pass 3 (Parallel): Reads temporary counts again to construct the final sparse matrix.</p><p>Optionally, a results filename can be provided to save/load the output. If the file exists and <code>force</code> is false, the result is loaded and returned. If <code>force</code> is true or the file does not exist, results are computed and saved.</p><p><strong>Output Directory Behavior</strong></p><ul><li>All auxiliary output files (e.g., rarefaction data, plots) are written to a common output directory.</li><li>By default, this is:<ul><li>The value of <code>out_dir</code> if provided.</li><li>Otherwise, the directory containing <code>result_file</code> (if provided and has a directory component).</li><li>Otherwise, the current working directory (<code>pwd()</code>).</li></ul></li><li>If you provide an absolute path for an output file (e.g. <code>rarefaction_data_filename</code>), that path is used directly.</li><li>If both <code>out_dir</code> and a relative filename are given, the file is written to <code>out_dir</code>.</li></ul><p><strong>Arguments</strong></p><ul><li><code>fasta_list::AbstractVector{&lt;:AbstractString}</code>: A list of paths to FASTA files.</li><li><code>k::Integer</code>: The length of the kmer.</li><li><code>alphabet::Symbol</code>: The alphabet type (:AA, :DNA, :RNA).</li><li><code>temp_dir_parent::AbstractString</code>: Parent directory for creating the temporary working directory. Defaults to <code>Base.tempdir()</code>.</li><li><code>count_element_type::Union{Type{&lt;:Unsigned}, Nothing}</code>: Optional. Specifies the unsigned integer type for the counts. If <code>nothing</code> (default), the smallest <code>UInt</code> type capable of holding the maximum observed count is used.</li><li><code>rarefaction_data_filename::AbstractString</code>: Filename for the TSV output of rarefaction data. If a relative path, will be written to <code>out_dir</code>.</li><li><code>rarefaction_plot_basename::AbstractString</code>: Basename for the output rarefaction plots. If a relative path, will be written to <code>out_dir</code>.</li><li><code>show_rarefaction_plot::Bool</code>: Whether to display the rarefaction plot after generation. Defaults to <code>true</code>.</li><li><code>result_file::Union{Nothing, AbstractString}</code>: Optional. If provided, path to a file to save/load the full results (kmers, counts, etc) as a JLD2 file.</li><li><code>out_dir::Union{Nothing, AbstractString}</code>: Optional. Output directory for auxiliary outputs. Defaults as described above.</li><li><code>force::Bool</code>: If true, recompute and overwrite the output file even if it exists. Defaults to <code>false</code>.</li><li><code>rarefaction_plot_kwargs...</code>: Keyword arguments to pass to <code>plot_kmer_rarefaction</code> for plot customization.</li></ul><p><strong>Returns</strong></p><ul><li><code>NamedTuple{(:kmers, :counts, :rarefaction_data_path)}</code>:<ul><li><code>kmers</code>: A sorted <code>Vector</code> of unique kmer objects.</li><li><code>counts</code>: A <code>SparseArrays.SparseMatrixCSC{V, Int}</code> storing kmer counts.</li><li><code>rarefaction_data_path</code>: Path to the saved TSV file with rarefaction data.</li></ul></li></ul><p><strong>Raises</strong></p><ul><li><code>ErrorException</code>: If input <code>fasta_list</code> is empty, alphabet is invalid, or required Kmer/counting functions are not found.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/kmer-analysis.jl#LL922">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.fasta_table_to_fasta-Tuple{Any}" href="#Mycelia.fasta_table_to_fasta-Tuple{Any}"><code>Mycelia.fasta_table_to_fasta</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">fasta_table_to_fasta(fasta_df) -&gt; Any
</code></pre><p>Convert a DataFrame containing FASTA sequence information into a vector of FASTA records.</p><p><strong>Arguments</strong></p><ul><li><code>fasta_df::DataFrame</code>: DataFrame with columns &quot;identifier&quot;, &quot;description&quot;, and &quot;sequence&quot;</li></ul><p><strong>Returns</strong></p><ul><li><code>Vector{FASTX.FASTA.Record}</code>: Vector of FASTA records</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/fastx.jl#LL1079">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.fasta_to_reference_kmer_counts-Tuple{}" href="#Mycelia.fasta_to_reference_kmer_counts-Tuple{}"><code>Mycelia.fasta_to_reference_kmer_counts</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">fasta_to_reference_kmer_counts(; kmer_type, fasta)
</code></pre><p>Counts k-mer occurrences in a FASTA file, considering both forward and reverse complement sequences.</p><p><strong>Arguments</strong></p><ul><li><code>kmer_type</code>: Type specification for k-mers (e.g., <code>DNAKmer{21}</code>)</li><li><code>fasta</code>: Path to FASTA file containing reference sequences</li></ul><p><strong>Returns</strong></p><ul><li><code>Dict{kmer_type, Int}</code>: Dictionary mapping each k-mer to its total count across all sequences</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/kmer-analysis.jl#LL385">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.fasta_to_table-Tuple{Any}" href="#Mycelia.fasta_to_table-Tuple{Any}"><code>Mycelia.fasta_to_table</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">fasta_to_table(fasta) -&gt; DataFrames.DataFrame
</code></pre><p>Convert a FASTA file/record iterator to a DataFrame.</p><p><strong>Arguments</strong></p><ul><li><code>fasta</code>: FASTA record iterator from FASTX.jl</li></ul><p><strong>Returns</strong></p><ul><li><code>DataFrame</code> with columns:<ul><li><code>identifier</code>: Sequence identifiers</li><li><code>description</code>: Full sequence descriptions </li><li><code>sequence</code>: Biological sequences as strings</li></ul></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/fastx.jl#LL1055">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.fasta_xam_mapping_stats-Tuple{}" href="#Mycelia.fasta_xam_mapping_stats-Tuple{}"><code>Mycelia.fasta_xam_mapping_stats</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">fasta_xam_mapping_stats(; fasta, xam)
</code></pre><p>Calculate mapping statistics by comparing sequence alignments (BAM/SAM) to a reference FASTA.</p><p><strong>Arguments</strong></p><ul><li><code>fasta::String</code>: Path to reference FASTA file</li><li><code>xam::String</code>: Path to alignment file (BAM or SAM format)</li></ul><p><strong>Returns</strong></p><p>DataFrame with columns:</p><ul><li><code>contig</code>: Reference sequence name</li><li><code>contig_length</code>: Length of reference sequence</li><li><code>total_aligned_bases</code>: Total number of bases aligned to reference</li><li><code>mean_depth</code>: Average depth of coverage (total<em>aligned</em>bases/contig_length)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/xam.jl#LL275">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.fastani_list-Tuple{}" href="#Mycelia.fastani_list-Tuple{}"><code>Mycelia.fastani_list</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">fastani_list(
;
    query_list,
    reference_list,
    outfile,
    threads,
    force
) -&gt; Union{Nothing, Base.Process}
</code></pre><p>Run fastani with a query and reference list</p><p>Calculate Average Nucleotide Identity (ANI) between genome sequences using FastANI.</p><p><strong>Arguments</strong></p><ul><li><code>query_list::String</code>: Path to file containing list of query genome paths (one per line)</li><li><code>reference_list::String</code>: Path to file containing list of reference genome paths (one per line)</li><li><code>outfile::String</code>: Path to output file that will contain ANI results</li><li><code>threads::Int=Sys.CPU_THREADS</code>: Number of parallel threads to use</li><li><code>force::Bool=false</code>: If true, rerun analysis even if output file exists</li></ul><p><strong>Output</strong></p><p>Generates a tab-delimited file with columns:</p><ul><li>Query genome</li><li>Reference genome  </li><li>ANI value (%)</li><li>Count of bidirectional fragment mappings</li><li>Total query fragments</li></ul><p><strong>Notes</strong></p><ul><li>Requires FastANI to be available via Bioconda</li><li>Automatically sets up required conda environment</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/sequence-comparison.jl#LL397">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.fasterq_dump-Tuple{}" href="#Mycelia.fasterq_dump-Tuple{}"><code>Mycelia.fasterq_dump</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">fasterq_dump(
;
    outdir,
    srr_identifier
) -&gt; NamedTuple{(:forward_reads, :reverse_reads, :unpaired_reads), &lt;:Tuple{Union{Missing, String}, Union{Missing, String}, Union{Missing, String}}}
</code></pre><p>Download and compress sequencing reads from the SRA database using fasterq-dump.</p><p><strong>Arguments</strong></p><ul><li><code>outdir::String=&quot;&quot;</code>: Output directory for the FASTQ files. Defaults to current directory.</li><li><code>srr_identifier::String=&quot;&quot;</code>: SRA run accession number (e.g., &quot;SRR12345678&quot;)</li></ul><p><strong>Returns</strong></p><p>Named tuple containing paths to the generated files:</p><ul><li><code>forward_reads</code>: Path to forward reads file (*_1.fastq.gz) or <code>missing</code></li><li><code>reverse_reads</code>: Path to reverse reads file (*_2.fastq.gz) or <code>missing</code></li><li><code>unpaired_reads</code>: Path to unpaired reads file (*.fastq.gz) or <code>missing</code></li></ul><p><strong>Outputs</strong></p><p>Creates compressed FASTQ files in the output directory:</p><ul><li><code>{srr_identifier}_1.fastq.gz</code>: Forward reads (for paired-end data)</li><li><code>{srr_identifier}_2.fastq.gz</code>: Reverse reads (for paired-end data)</li><li><code>{srr_identifier}.fastq.gz</code>: Unpaired reads (for single-end data)</li></ul><p><strong>Dependencies</strong></p><p>Requires:</p><ul><li><code>fasterq-dump</code> from the SRA Toolkit (installed via Conda)</li><li><code>gzip</code> for compression</li></ul><p><strong>Notes</strong></p><ul><li>Skips download if output files already exist</li><li>Uses up to 4 threads or system maximum, whichever is lower</li><li>Allocates 1GB memory for processing</li><li>Skips technical reads</li><li>Handles both paired-end and single-end data automatically</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/reference-databases.jl#LL852">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.fasterq_dump_parallel-Tuple{Vector{String}}" href="#Mycelia.fasterq_dump_parallel-Tuple{Vector{String}}"><code>Mycelia.fasterq_dump_parallel</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Parallel FASTQ dump for multiple SRA files.</p><p>Converts multiple SRA files to FASTQ format in parallel. More efficient than sequential processing for large batches.</p><p><strong>Arguments</strong></p><ul><li><code>srr_identifiers</code>: Vector of SRA run identifiers</li><li><code>outdir</code>: Output directory for FASTQ files (default: current directory)</li><li><code>max_parallel</code>: Maximum number of parallel conversions (default: 2)</li></ul><p><strong>Returns</strong></p><p>Vector of named tuples with conversion results</p><p><strong>Example</strong></p><pre><code class="language-julia hljs">runs = [&quot;SRR1234567&quot;, &quot;SRR1234568&quot;]
results = Mycelia.fasterq_dump_parallel(runs, outdir=&quot;./fastq_data&quot;)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/reference-databases.jl#LL1071-L1090">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.fastq_record-Tuple{}" href="#Mycelia.fastq_record-Tuple{}"><code>Mycelia.fastq_record</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">fastq_record(; identifier, sequence, quality_scores)
</code></pre><p>Construct a FASTX FASTQ record from its components.</p><p><strong>Arguments</strong></p><ul><li><code>identifier::String</code>: The sequence identifier without the &#39;@&#39; prefix</li><li><code>sequence::String</code>: The nucleotide sequence</li><li><code>quality_scores::Vector{Int}</code>: Quality scores (0-93) as raw integers</li></ul><p><strong>Returns</strong></p><ul><li><code>FASTX.FASTQRecord</code>: A parsed FASTQ record</li></ul><p><strong>Notes</strong></p><ul><li>Quality scores are automatically capped at 93 to ensure FASTQ compatibility</li><li>Quality scores are converted to ASCII by adding 33 (Phred+33 encoding)</li><li>The record is constructed in standard FASTQ format with four lines:<ol><li>Header line (@ + identifier)</li><li>Sequence</li><li>Plus line</li><li>Quality scores (ASCII encoded)</li></ol></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/fastx.jl#LL1318">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.fastx2normalized_table-Tuple{Any}" href="#Mycelia.fastx2normalized_table-Tuple{Any}"><code>Mycelia.fastx2normalized_table</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">fastx2normalized_table(fastx::AbstractString) -&gt; DataFrames.DataFrame</code></pre><pre><code class="language-julia hljs">fastx2normalized_table(fastx) -&gt; DataFrames.DataFrame
</code></pre><p>Read a FASTA or FASTQ file and convert its records into a normalized <code>DataFrames.DataFrame</code> where each row represents a sequence record and columns provide standardized metadata and sequence statistics.</p><p><strong>Arguments</strong></p><ul><li><code>fastx::AbstractString</code>: Path to a FASTA or FASTQ file. The file must exist and be non-empty. The file type is inferred from the filename using <code>Mycelia.FASTA_REGEX</code> and <code>Mycelia.FASTQ_REGEX</code>.</li></ul><p><strong>Returns</strong></p><ul><li><code>DataFrames.DataFrame</code>: A data frame where each row contains information for a record from the input file, and columns include:<ul><li><code>fastx_path</code>: Basename of the input file.</li><li><code>fastx_sha256</code>: Aggregated SHA256 hash of all record SHA256s in the file.</li><li><code>record_identifier</code>: Identifier from the record header.</li><li><code>record_description</code>: Description from the record header.</li><li><code>record_sha256</code>: SHA256 hash of the record sequence.</li><li><code>record_quality</code>: Vector of quality scores (<code>Vector{Float64}</code>) for FASTQ, or <code>missing</code> for FASTA.</li><li><code>record_alphabet</code>: Sorted, joined string of unique, uppercase characters in the record sequence.</li><li><code>record_type</code>: Alphabet type detected by <code>Mycelia.detect_alphabet</code> (e.g., <code>:DNA</code>, <code>:RNA</code>, etc.).</li><li><code>mean_record_quality</code>: Mean quality score (for FASTQ), or <code>missing</code> (for FASTA).</li><li><code>median_record_quality</code>: Median quality score (for FASTQ), or <code>missing</code> (for FASTA).</li><li><code>record_length</code>: Length of the sequence.</li><li><code>record_sequence</code>: The sequence string itself.</li></ul></li></ul><p><strong>Notes</strong></p><ul><li>The function asserts that the file exists and is not empty.</li><li>File type is determined by regex matching on the filename.</li><li>For FASTA files, quality-related columns are set to <code>missing</code>.</li><li>For FASTQ files, quality scores are extracted and statistics are computed.</li><li>Record SHA256 hashes are aggregated to compute a file-level SHA256 via <code>Mycelia.metasha256</code>.</li><li>Requires the following namespaces: <code>DataFrames</code>, <code>Statistics</code>, <code>Mycelia</code>, <code>FASTX</code>, and <code>Base.basename</code>.</li><li>The function returns the columns in the order: <code>fastx_path</code>, <code>fastx_sha256</code>, followed by all other record columns.</li></ul><p><strong>Example</strong></p><pre><code class="language-julia hljs">import DataFrames
import Mycelia
import FASTX

table = fastx2normalized_table(&quot;example.fasta&quot;)
DataFrames.first(table, 3)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/fastx.jl#LL613-L660">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.fastx_stats-Tuple{Any}" href="#Mycelia.fastx_stats-Tuple{Any}"><code>Mycelia.fastx_stats</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">fastx_stats(fastx) -&gt; DataFrames.DataFrame
</code></pre><p>Calculate basic statistics for FASTQ/FASTA sequence files using seqkit.</p><p><strong>Arguments</strong></p><ul><li><code>fastq::String</code>: Path to input FASTQ/FASTA file</li></ul><p><strong>Details</strong></p><p>Automatically installs and uses seqkit from Bioconda to compute sequence statistics including number of sequences, total bases, GC content, average length, etc.</p><p><strong>Dependencies</strong></p><ul><li>Requires Conda and Bioconda channel</li><li>Installs seqkit package if not present</li></ul><p><strong>Returns</strong></p><p>Returns a DataFrame of the table</p><p>https://bioinf.shenwei.me/seqkit/usage/#stats</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/fastx.jl#LL586">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.fastx_to_contig_lengths-Tuple{Any}" href="#Mycelia.fastx_to_contig_lengths-Tuple{Any}"><code>Mycelia.fastx_to_contig_lengths</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">fastx_to_contig_lengths(
    fastx
) -&gt; OrderedCollections.OrderedDict
</code></pre><p>Generate detailed mapping statistics for each reference sequence/contig in a XAM (SAM/BAM/CRAM) file.</p><p><strong>Arguments</strong></p><ul><li><code>xam</code>: Path to XAM file or XAM object</li></ul><p><strong>Returns</strong></p><p>A DataFrame with per-contig statistics including:</p><ul><li><code>n_aligned_reads</code>: Number of aligned reads</li><li><code>total_aligned_bases</code>: Sum of alignment lengths</li><li><code>total_alignment_score</code>: Sum of alignment scores</li><li>Mapping quality statistics (mean, std, median)</li><li>Alignment length statistics (mean, std, median)</li><li>Alignment score statistics (mean, std, median)</li><li>Percent mismatches statistics (mean, std, median)</li></ul><p>Note: Only primary alignments (isprimary=true) and mapped reads (ismapped=true) are considered.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/fastx.jl#LL1347">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.fastx_to_kmer_graph-Tuple{Any, AbstractString}" href="#Mycelia.fastx_to_kmer_graph-Tuple{Any, AbstractString}"><code>Mycelia.fastx_to_kmer_graph</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">fastx_to_kmer_graph(
    KMER_TYPE,
    fastx::AbstractString
) -&gt; MetaGraphs.MetaGraph
</code></pre><p>Constructs a k-mer graph from a single FASTX format string.</p><p><strong>Arguments</strong></p><ul><li><code>KMER_TYPE</code>: The k-mer type specification (e.g., DNAKmer{K} where K is k-mer length)</li><li><code>fastx::AbstractString</code>: Input sequence in FASTX format (FASTA or FASTQ)</li></ul><p><strong>Returns</strong></p><ul><li><code>KmerGraph</code>: A directed graph where vertices are k-mers and edges represent overlaps</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/sequence-graphs.jl#LL2597">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.fastx_to_kmer_graph-Tuple{Any, AbstractVector{&lt;:AbstractString}}" href="#Mycelia.fastx_to_kmer_graph-Tuple{Any, AbstractVector{&lt;:AbstractString}}"><code>Mycelia.fastx_to_kmer_graph</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">fastx_to_kmer_graph(
    KMER_TYPE,
    fastxs::AbstractVector{&lt;:AbstractString}
) -&gt; MetaGraphs.MetaGraph
</code></pre><p>Create an in-memory kmer-graph that records:</p><ul><li>all kmers</li><li>counts</li><li>all <em>observed</em> edges between kmers</li><li>edge orientations</li><li>edge counts</li></ul><p>Construct a kmer-graph from one or more FASTX files (FASTA/FASTQ).</p><p><strong>Arguments</strong></p><ul><li><code>KMER_TYPE</code>: Type for kmer representation (e.g., <code>DNAKmer{K}</code>)</li><li><code>fastxs</code>: Vector of paths to FASTX files</li></ul><p><strong>Returns</strong></p><p>A <code>MetaGraph</code> where:</p><ul><li>Vertices represent unique kmers with properties:<ul><li><code>:kmer</code> =&gt; The kmer sequence</li><li><code>:count</code> =&gt; Number of occurrences</li></ul></li><li>Edges represent observed kmer adjacencies with properties:<ul><li><code>:orientation</code> =&gt; Relative orientation of connected kmers</li><li><code>:count</code> =&gt; Number of observed transitions</li></ul></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/sequence-graphs.jl#LL2541">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.fibonacci_numbers_less_than-Tuple{Int64}" href="#Mycelia.fibonacci_numbers_less_than-Tuple{Int64}"><code>Mycelia.fibonacci_numbers_less_than</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">fibonacci_numbers_less_than(
    n::Int64
) -&gt; Union{Vector{Any}, Vector{Int64}}
</code></pre><p>Generate a sequence of Fibonacci numbers strictly less than the input value.</p><p><strong>Arguments</strong></p><ul><li><code>n::Int</code>: Upper bound (exclusive) for the Fibonacci sequence</li></ul><p><strong>Returns</strong></p><ul><li><code>Vector{Int}</code>: Array containing Fibonacci numbers less than n</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/kmer-analysis.jl#LL2028">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.filesize_human_readable-Tuple{Any}" href="#Mycelia.filesize_human_readable-Tuple{Any}"><code>Mycelia.filesize_human_readable</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">filesize_human_readable(f) -&gt; Any
</code></pre><p>Gets the size of a file and returns it in a human-readable format.</p><p><strong>Arguments</strong></p><ul><li><code>f</code>: The path to the file, either as a <code>String</code> or an <code>AbstractString</code>.</li></ul><p><strong>Returns</strong></p><p>A string representing the file size in a human-readable format (e.g., &quot;3.40 MB&quot;).</p><p><strong>Details</strong></p><p>This function internally uses <code>filesize(f)</code> to get the file size in bytes, then leverages <code>Base.format_bytes</code> to convert it into a human-readable format with appropriate units (KB, MB, GB, etc.).</p><p><strong>Examples</strong></p><pre><code class="language-julia hljs">julia&gt; filesize_human_readable(&quot;my_image.jpg&quot;)
&quot;2.15 MB&quot;</code></pre><p>See Also</p><ul><li>filesize: Gets the size of a file in bytes.</li><li>Base.format_bytes: Converts a byte count into a human-readable string. </li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/utility-functions.jl#LL1339">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.finalize_assembly" href="#Mycelia.finalize_assembly"><code>Mycelia.finalize_assembly</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Finalize assembly by combining information from all k-mer sizes. Phase 5.1b: Enhanced with accuracy metrics and reward tracking.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/intelligent-assembly.jl#LL536-L539">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.finalize_cross_validation-Tuple{Dict, Dict, Dict, Dict, Float64, String}" href="#Mycelia.finalize_cross_validation-Tuple{Dict, Dict, Dict, Dict, Float64, String}"><code>Mycelia.finalize_cross_validation</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Finalize cross-validation results with comprehensive summary.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/cross-validation.jl#LL518-L520">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.finalize_iterative_assembly-Tuple{String, Vector{Int64}, Dict{Int64, Vector{Dict{Symbol, Any}}}, Float64}" href="#Mycelia.finalize_iterative_assembly-Tuple{String, Vector{Int64}, Dict{Int64, Vector{Dict{Symbol, Any}}}, Float64}"><code>Mycelia.finalize_iterative_assembly</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Finalize iterative assembly by combining results from all k-mer sizes and iterations.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/iterative-assembly.jl#LL749-L751">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.find_bubble_paths-Tuple{MetaGraphsNext.MetaGraph{&lt;:Integer, String, Mycelia.KmerVertexData, Mycelia.KmerEdgeData}, String, Vector{String}, Int64, Int64}" href="#Mycelia.find_bubble_paths-Tuple{MetaGraphsNext.MetaGraph{&lt;:Integer, String, Mycelia.KmerVertexData, Mycelia.KmerEdgeData}, String, Vector{String}, Int64, Int64}"><code>Mycelia.find_bubble_paths</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Find potential bubble paths from an entry vertex.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/sequence-graphs-next.jl#LL1273-L1275">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.find_connected_components-Tuple{MetaGraphsNext.MetaGraph{var&quot;#s36&quot;, Graph} where {var&quot;#s36&quot;&lt;:Graphs.SimpleGraphs.AbstractSimpleGraph, Graph&lt;:Graphs.AbstractGraph{var&quot;#s36&quot;}}}" href="#Mycelia.find_connected_components-Tuple{MetaGraphsNext.MetaGraph{var&quot;#s36&quot;, Graph} where {var&quot;#s36&quot;&lt;:Graphs.SimpleGraphs.AbstractSimpleGraph, Graph&lt;:Graphs.AbstractGraph{var&quot;#s36&quot;}}}"><code>Mycelia.find_connected_components</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Find all connected components in the graph. Returns a vector of vectors of vertex indices.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/string-graphs.jl#LL57-L60">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.find_connected_components-Tuple{MetaGraphsNext.MetaGraph{var&quot;#s36&quot;, Graph} where {var&quot;#s36&quot;&lt;:Graphs.SimpleGraphs.SimpleDiGraph, Graph&lt;:Graphs.AbstractGraph{var&quot;#s36&quot;}}}" href="#Mycelia.find_connected_components-Tuple{MetaGraphsNext.MetaGraph{var&quot;#s36&quot;, Graph} where {var&quot;#s36&quot;&lt;:Graphs.SimpleGraphs.SimpleDiGraph, Graph&lt;:Graphs.AbstractGraph{var&quot;#s36&quot;}}}"><code>Mycelia.find_connected_components</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Specialized method for directed graphs using weakly connected components. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/string-graphs.jl#LL66">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.find_connected_components-Tuple{MetaGraphsNext.MetaGraph{var&quot;#s36&quot;, Graph} where {var&quot;#s36&quot;&lt;:Graphs.SimpleGraphs.SimpleGraph, Graph&lt;:Graphs.AbstractGraph{var&quot;#s36&quot;}}}" href="#Mycelia.find_connected_components-Tuple{MetaGraphsNext.MetaGraph{var&quot;#s36&quot;, Graph} where {var&quot;#s36&quot;&lt;:Graphs.SimpleGraphs.SimpleGraph, Graph&lt;:Graphs.AbstractGraph{var&quot;#s36&quot;}}}"><code>Mycelia.find_connected_components</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Specialized method for undirected graphs. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/string-graphs.jl#LL72">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.find_contigs_next-Tuple{MetaGraphsNext.MetaGraph{&lt;:Integer, String, Mycelia.KmerVertexData, Mycelia.KmerEdgeData}}" href="#Mycelia.find_contigs_next-Tuple{MetaGraphsNext.MetaGraph{&lt;:Integer, String, Mycelia.KmerVertexData, Mycelia.KmerEdgeData}}"><code>Mycelia.find_contigs_next</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">find_contigs_next(graph::MetaGraphsNext.MetaGraph, min_contig_length::Int=500) -&gt; Vector{ContigPath}</code></pre><p>Extract linear contigs from the assembly graph.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/sequence-graphs-next.jl#LL1739-L1743">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.find_eulerian_path_from_vertex-Tuple{MetaGraphsNext.MetaGraph{&lt;:Integer, String, Mycelia.KmerVertexData, Mycelia.KmerEdgeData}, String, Dict{String, Int64}, Dict{String, Int64}}" href="#Mycelia.find_eulerian_path_from_vertex-Tuple{MetaGraphsNext.MetaGraph{&lt;:Integer, String, Mycelia.KmerVertexData, Mycelia.KmerEdgeData}, String, Dict{String, Int64}, Dict{String, Int64}}"><code>Mycelia.find_eulerian_path_from_vertex</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Find Eulerian path starting from a specific vertex using Hierholzer&#39;s algorithm.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/sequence-graphs-next.jl#LL1167-L1169">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.find_eulerian_paths_next-Tuple{MetaGraphsNext.MetaGraph{&lt;:Integer, String, Mycelia.KmerVertexData, Mycelia.KmerEdgeData}}" href="#Mycelia.find_eulerian_paths_next-Tuple{MetaGraphsNext.MetaGraph{&lt;:Integer, String, Mycelia.KmerVertexData, Mycelia.KmerEdgeData}}"><code>Mycelia.find_eulerian_paths_next</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">find_eulerian_paths_next(graph::MetaGraphsNext.MetaGraph) -&gt; Vector{Vector{String}}</code></pre><p>Find Eulerian paths in the assembly graph. An Eulerian path visits every edge exactly once.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/sequence-graphs-next.jl#LL1062-L1066">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.find_eulerian_start_vertices-Tuple{Dict{String, Int64}, Dict{String, Int64}, Any}" href="#Mycelia.find_eulerian_start_vertices-Tuple{Dict{String, Int64}, Dict{String, Int64}, Any}"><code>Mycelia.find_eulerian_start_vertices</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Find valid starting vertices for Eulerian paths.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/sequence-graphs-next.jl#LL1153-L1155">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.find_fasta_files-Tuple{String}" href="#Mycelia.find_fasta_files-Tuple{String}"><code>Mycelia.find_fasta_files</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">find_fasta_files(input_path::String) -&gt; Vector{String}</code></pre><p>Find all FASTA files in a directory or return single file if path is a file.</p><p>Uses the existing <code>FASTA_REGEX</code> constant to identify FASTA files.</p><p><strong>Arguments</strong></p><ul><li><code>input_path</code>: Path to directory or single FASTA file</li></ul><p><strong>Returns</strong></p><ul><li>Vector of FASTA file paths</li></ul><p><strong>Example</strong></p><pre><code class="language-julia hljs">fasta_files = find_fasta_files(&quot;./genomes/&quot;)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/fastx.jl#LL1-L18">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.find_initial_k-Tuple{Vector{&lt;:FASTX.FASTQ.Record}}" href="#Mycelia.find_initial_k-Tuple{Vector{&lt;:FASTX.FASTQ.Record}}"><code>Mycelia.find_initial_k</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Find the optimal starting k-mer size using sparsity detection. Only considers prime k-mer sizes for optimal performance.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/intelligent-assembly.jl#LL112-L115">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.find_limited_path-Tuple{MetaGraphsNext.MetaGraph{&lt;:Integer, String, Mycelia.KmerVertexData, Mycelia.KmerEdgeData}, String, Int64}" href="#Mycelia.find_limited_path-Tuple{MetaGraphsNext.MetaGraph{&lt;:Integer, String, Mycelia.KmerVertexData, Mycelia.KmerEdgeData}, String, Int64}"><code>Mycelia.find_limited_path</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Find a limited-length path from a starting vertex.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/sequence-graphs-next.jl#LL1324-L1326">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.find_linear_path-Tuple{MetaGraphsNext.MetaGraph{&lt;:Integer, String, Mycelia.KmerVertexData, Mycelia.KmerEdgeData}, String, Set{String}}" href="#Mycelia.find_linear_path-Tuple{MetaGraphsNext.MetaGraph{&lt;:Integer, String, Mycelia.KmerVertexData, Mycelia.KmerEdgeData}, String, Set{String}}"><code>Mycelia.find_linear_path</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Find a linear path through the graph.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/sequence-graphs-next.jl#LL1778-L1780">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.find_matching_prefix-Tuple{String, String}" href="#Mycelia.find_matching_prefix-Tuple{String, String}"><code>Mycelia.find_matching_prefix</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">find_matching_prefix(
    filename1::String,
    filename2::String;
    strip_trailing_delimiters
) -&gt; String
</code></pre><p>Find the longest common prefix between two filenames.</p><p><strong>Arguments</strong></p><ul><li><code>filename1::String</code>: First filename to compare</li><li><code>filename2::String</code>: Second filename to compare</li></ul><p><strong>Keywords</strong></p><ul><li><code>strip_trailing_delimiters::Bool=true</code>: If true, removes trailing dots, hyphens, and underscores from the result</li></ul><p><strong>Returns</strong></p><ul><li><code>String</code>: The longest common prefix found between the filenames</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/utility-functions.jl#LL1385">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.find_nonempty_columns-Tuple{Any}" href="#Mycelia.find_nonempty_columns-Tuple{Any}"><code>Mycelia.find_nonempty_columns</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">find_nonempty_columns(df) -&gt; Any
</code></pre><p>Identify all columns that have only missing or empty values</p><p>Returns as a bit array</p><p>See also: drop<em>empty</em>columns, drop<em>empty</em>columns!</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/utility-functions.jl#LL1117">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.find_optimal_sequence_path-Tuple{FASTX.FASTQ.Record, Any, Int64}" href="#Mycelia.find_optimal_sequence_path-Tuple{FASTX.FASTQ.Record, Any, Int64}"><code>Mycelia.find_optimal_sequence_path</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Find optimal sequence path through graph using maximum likelihood principles. Returns improved sequence and likelihood improvement score.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/iterative-assembly.jl#LL406-L409">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.find_path_convergence-Tuple{Vector{String}, Vector{String}}" href="#Mycelia.find_path_convergence-Tuple{Vector{String}, Vector{String}}"><code>Mycelia.find_path_convergence</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Find where two paths converge.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/sequence-graphs-next.jl#LL1349-L1351">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.find_primes_in_range-Tuple{Int64, Int64}" href="#Mycelia.find_primes_in_range-Tuple{Int64, Int64}"><code>Mycelia.find_primes_in_range</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Find all primes in a range (convenience function).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/intelligent-assembly.jl#LL33-L35">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.find_quality_weighted_path-Tuple{Any, Any}" href="#Mycelia.find_quality_weighted_path-Tuple{Any, Any}"><code>Mycelia.find_quality_weighted_path</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">find_quality_weighted_path(
    graph,
    start_vertex;
    max_path_length
) -&gt; Vector
</code></pre><p>Find a quality-weighted path through a qualmer graph starting from a given vertex. Uses joint probability as the primary weighting factor for path selection.</p><p><strong>Arguments</strong></p><ul><li><code>graph</code>: Qualmer graph (MetaGraphsNext with QualmerVertexData)</li><li><code>start_vertex</code>: Starting vertex for path traversal</li><li><code>max_path_length::Int=1000</code>: Maximum path length to prevent infinite loops</li></ul><p><strong>Returns</strong></p><ul><li><code>Vector{Int}</code>: Path as sequence of vertex indices</li></ul><p><strong>Details</strong></p><p>At each step, selects the unvisited neighbor with the highest joint probability. Terminates when no unvisited neighbors are available or max length is reached.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/qualmer-analysis.jl#LL639">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.find_repeat_candidates-Tuple{Dict{String, Int64}, Dict{String, Int64}}" href="#Mycelia.find_repeat_candidates-Tuple{Dict{String, Int64}, Dict{String, Int64}}"><code>Mycelia.find_repeat_candidates</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Find vertices that could be part of repeat regions.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/sequence-graphs-next.jl#LL1501-L1503">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.find_resampling_stretches-Tuple{}" href="#Mycelia.find_resampling_stretches-Tuple{}"><code>Mycelia.find_resampling_stretches</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">find_resampling_stretches(
;
    record_kmer_solidity,
    solid_branching_kmer_indices
)
</code></pre><p>Identifies sequence regions that require resampling based on kmer solidity patterns.</p><p><strong>Arguments</strong></p><ul><li><code>record_kmer_solidity::BitVector</code>: Boolean array where <code>true</code> indicates solid kmers</li><li><code>solid_branching_kmer_indices::Vector{Int}</code>: Indices of solid branching kmers</li></ul><p><strong>Returns</strong></p><ul><li><code>Vector{UnitRange{Int64}}</code>: Array of ranges (start:stop) indicating stretches that need resampling</li></ul><p><strong>Details</strong></p><p>Finds continuous stretches of non-solid kmers and extends them to the nearest solid branching kmers on either side. These stretches represent regions that need resampling.</p><p>If a stretch doesn&#39;t have solid branching kmers on both sides, it is excluded from the result. Duplicate ranges are removed from the final output.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/sequence-graphs.jl#LL322">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.find_true_ranges-Tuple{AbstractVector{Bool}}" href="#Mycelia.find_true_ranges-Tuple{AbstractVector{Bool}}"><code>Mycelia.find_true_ranges</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">find_true_ranges(
    bool_vec::AbstractVector{Bool};
    min_length
) -&gt; Vector
</code></pre><p>Finds contiguous ranges of <code>true</code> values in a boolean vector.</p><p><strong>Arguments</strong></p><ul><li><code>bool_vec::AbstractVector{Bool}</code>: Input boolean vector to analyze</li><li><code>min_length=1</code>: Minimum length requirement for a range to be included</li></ul><p><strong>Returns</strong></p><p>Vector of tuples <code>(start, end)</code> where each tuple represents the indices of a contiguous range of <code>true</code> values meeting the minimum length requirement.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/utility-functions.jl#LL1600">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.first_of_each_group-Tuple{DataFrames.GroupedDataFrame{DataFrames.DataFrame}}" href="#Mycelia.first_of_each_group-Tuple{DataFrames.GroupedDataFrame{DataFrames.DataFrame}}"><code>Mycelia.first_of_each_group</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">first_of_each_group(
    gdf::DataFrames.GroupedDataFrame{DataFrames.DataFrame}
) -&gt; Any
</code></pre><p>Return a DataFrame containing the first row from each group in a GroupedDataFrame.</p><p><strong>Arguments</strong></p><ul><li><code>gdf::GroupedDataFrame</code>: A grouped DataFrame created using <code>groupby</code></li></ul><p><strong>Returns</strong></p><ul><li><code>DataFrame</code>: A new DataFrame containing first row from each group</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/utility-functions.jl#LL1720">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.frequency_matrix_to_bray_curtis_distance_matrix-Tuple{Any}" href="#Mycelia.frequency_matrix_to_bray_curtis_distance_matrix-Tuple{Any}"><code>Mycelia.frequency_matrix_to_bray_curtis_distance_matrix</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">frequency_matrix_to_bray_curtis_distance_matrix(counts_table)</code></pre><p>Pairwise Bray-Curtis distance between columns of <code>counts_table</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/distance-metrics.jl#LL360-L364">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.frequency_matrix_to_cosine_distance_matrix-Tuple{Any}" href="#Mycelia.frequency_matrix_to_cosine_distance_matrix-Tuple{Any}"><code>Mycelia.frequency_matrix_to_cosine_distance_matrix</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">frequency_matrix_to_cosine_distance_matrix(probability_matrix)</code></pre><p>Pairwise cosine distance between columns of <code>probability_matrix</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/distance-metrics.jl#LL330-L334">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.frequency_matrix_to_euclidean_distance_matrix-Tuple{Any}" href="#Mycelia.frequency_matrix_to_euclidean_distance_matrix-Tuple{Any}"><code>Mycelia.frequency_matrix_to_euclidean_distance_matrix</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">frequency_matrix_to_euclidean_distance_matrix(counts_table)</code></pre><p>Pairwise Euclidean distance between columns of <code>counts_table</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/distance-metrics.jl#LL322-L326">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.frequency_matrix_to_jaccard_distance_matrix-Tuple{Any}" href="#Mycelia.frequency_matrix_to_jaccard_distance_matrix-Tuple{Any}"><code>Mycelia.frequency_matrix_to_jaccard_distance_matrix</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">frequency_matrix_to_jaccard_distance_matrix(matrix)</code></pre><p>Thresholds the input matrix at <code>&gt;0</code> to obtain a binary matrix, then computes pairwise Jaccard distance between columns. Accepts any numeric matrix.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/distance-metrics.jl#LL348-L353">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.frequency_matrix_to_jensen_shannon_distance_matrix-Tuple{Any}" href="#Mycelia.frequency_matrix_to_jensen_shannon_distance_matrix-Tuple{Any}"><code>Mycelia.frequency_matrix_to_jensen_shannon_distance_matrix</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">frequency_matrix_to_jensen_shannon_distance_matrix(probability_matrix)</code></pre><p>Pairwise Jensen-Shannon divergence between columns of <code>probability_matrix</code>.</p><p><strong>Arguments</strong></p><ul><li><code>probability_matrix</code>: Matrix where each column is a probability distribution (sums to 1.0).</li></ul><p><strong>Returns</strong></p><ul><li>Symmetric matrix of Jensen-Shannon divergence values between columns.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/distance-metrics.jl#LL368-L378">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.gamma_pca_epca-Tuple{AbstractMatrix{&lt;:Real}}" href="#Mycelia.gamma_pca_epca-Tuple{AbstractMatrix{&lt;:Real}}"><code>Mycelia.gamma_pca_epca</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">gamma_pca_epca(M::AbstractMatrix{&lt;:Real}; k::Int=0)</code></pre><p>Perform Gamma EPCA on a matrix <code>M</code> (features × samples).</p><p><strong>When to use</strong></p><p>Use for positive continuous data, such as rates, times, or strictly positive measurements.</p><p><strong>Keyword arguments</strong></p><ul><li><code>k</code> : desired number of latent dimensions; if <code>k&lt;1</code> defaults to <code>min(n_samples-1, n_features, 10)</code></li></ul><p><strong>Returns</strong></p><p>NamedTuple with fields</p><ul><li><code>model</code>    : the fitted <code>ExpFamilyPCA.GammaEPCA</code> object  </li><li><code>scores</code>   : k×n_samples matrix of sample scores  </li><li><code>loadings</code> : k×n_features matrix of feature loadings  </li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/dimensionality-reduction.jl#LL468-L484">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.gaussian_pca_epca-Tuple{AbstractMatrix{&lt;:Real}}" href="#Mycelia.gaussian_pca_epca-Tuple{AbstractMatrix{&lt;:Real}}"><code>Mycelia.gaussian_pca_epca</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">gaussian_pca_epca(M::AbstractMatrix{&lt;:Real}; k::Int=0)</code></pre><p>Perform Gaussian EPCA on a matrix <code>M</code> (features × samples).</p><p><strong>When to use</strong></p><p>Use for real-valued continuous data (centered, can be negative or positive), such as normalized or standardized measurements.</p><p><strong>Keyword arguments</strong></p><ul><li><code>k</code> : desired number of latent dimensions; if <code>k&lt;1</code> defaults to <code>min(n_samples-1, n_features, 10)</code></li></ul><p><strong>Returns</strong></p><p>NamedTuple with fields</p><ul><li><code>model</code>    : the fitted <code>ExpFamilyPCA.GaussianEPCA</code> object  </li><li><code>scores</code>   : k×n_samples matrix of sample scores  </li><li><code>loadings</code> : k×n_features matrix of feature loadings  </li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/dimensionality-reduction.jl#LL507-L523">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.genbank_to_codon_frequencies-Tuple{Any}" href="#Mycelia.genbank_to_codon_frequencies-Tuple{Any}"><code>Mycelia.genbank_to_codon_frequencies</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">genbank_to_codon_frequencies(
    genbank;
    allow_all
) -&gt; Dict{BioSymbols.AminoAcid, Dict{Kmers.Kmer{BioSequences.DNAAlphabet{2}, 3, 1}, Int64}}
</code></pre><p>Analyze codon usage frequencies from genes in a GenBank file.</p><p><strong>Arguments</strong></p><ul><li><code>genbank</code>: Path to GenBank format file containing genomic sequences and annotations</li><li><code>allow_all</code>: If true, initializes frequencies for all possible codons with count=1 (default: true)</li></ul><p><strong>Returns</strong></p><p>Nested dictionary mapping amino acids to their corresponding codon usage counts:</p><ul><li>Outer key: AminoAcid (including stop codon)</li><li>Inner key: DNACodon</li><li>Value: Count of codon occurrences</li></ul><p><strong>Details</strong></p><ul><li>Only processes genes marked as &#39;:misc_feature&#39; in the GenBank file</li><li>Analyzes both forward and reverse complement sequences</li><li>Determines coding strand based on presence of stop codons and start codons</li><li>Skips ambiguous sequences that cannot be confidently oriented</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/codon-optimization.jl#LL156">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.genbank_to_fasta-Tuple{}" href="#Mycelia.genbank_to_fasta-Tuple{}"><code>Mycelia.genbank_to_fasta</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">genbank_to_fasta(; genbank, fasta, force)
</code></pre><p>Convert a GenBank format file to FASTA format using EMBOSS seqret.</p><p><strong>Arguments</strong></p><ul><li><code>genbank</code>: Path to input GenBank format file</li><li><code>fasta</code>: Optional output FASTA file path (defaults to input path with .fna extension)</li><li><code>force</code>: If true, overwrites existing output file (defaults to false)</li></ul><p><strong>Returns</strong></p><p>Path to the output FASTA file</p><p><strong>Notes</strong></p><ul><li>Requires EMBOSS suite (installed automatically via Conda)</li><li>Will not regenerate output if it already exists unless force=true</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/fastx.jl#LL1450">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.generate_all_possible_canonical_kmers-Tuple{Any, Any}" href="#Mycelia.generate_all_possible_canonical_kmers-Tuple{Any, Any}"><code>Mycelia.generate_all_possible_canonical_kmers</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">generate_all_possible_canonical_kmers(k, alphabet) -&gt; Any
</code></pre><p>Create distance matrix from a column-major counts matrix (features as rows and entities as columns) where distance is a proportional to total feature count magnitude (size) and cosine similarity (relative frequency)</p><p>Generate all possible canonical k-mers of length <code>k</code> from the given <code>alphabet</code>.</p><p>For DNA/RNA sequences, returns unique canonical k-mers where each k-mer is represented by the lexicographically smaller of itself and its reverse complement. For amino acid sequences, returns all possible k-mers without canonicalization.</p><p><strong>Arguments</strong></p><ul><li><code>k</code>: Length of k-mers to generate</li><li><code>alphabet</code>: Vector of BioSymbols (DNA, RNA or AminoAcid)</li></ul><p><strong>Returns</strong></p><ul><li>Vector of k-mers, canonicalized for DNA/RNA alphabets</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/kmer-analysis.jl#LL1936">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.generate_all_possible_kmers-Tuple{Any, Any}" href="#Mycelia.generate_all_possible_kmers-Tuple{Any, Any}"><code>Mycelia.generate_all_possible_kmers</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">generate_all_possible_kmers(k, alphabet) -&gt; Any
</code></pre><p>Create distance matrix from a column-major counts matrix (features as rows and entities as columns) where distance is a proportional to total feature count magnitude (size) and cosine similarity (relative frequency)</p><p>Generate a sorted list of all possible k-mers for a given alphabet.</p><p><strong>Arguments</strong></p><ul><li><code>k::Integer</code>: Length of k-mers to generate</li><li><code>alphabet</code>: Collection of symbols (DNA, RNA, or amino acids) from BioSymbols</li></ul><p><strong>Returns</strong></p><ul><li>Sorted Vector of Kmers of the appropriate type (DNA, RNA, or amino acid)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/kmer-analysis.jl#LL1906">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.generate_alternative_qualmer_paths-Tuple{FASTX.FASTQ.Record, Any, Int64}" href="#Mycelia.generate_alternative_qualmer_paths-Tuple{FASTX.FASTQ.Record, Any, Int64}"><code>Mycelia.generate_alternative_qualmer_paths</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Generate alternative qualmer paths through the graph using quality-aware probabilistic sampling.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/iterative-assembly.jl#LL1059-L1061">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.generate_and_save_kmer_counts-Tuple{}" href="#Mycelia.generate_and_save_kmer_counts-Tuple{}"><code>Mycelia.generate_and_save_kmer_counts</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">generate_and_save_kmer_counts(; 
    bioalphabet, 
    fastas, 
    k, 
    output_dir=pwd(),
    filename=nothing
)</code></pre><p>Generates and saves k-mer counts for a list of FASTA files for a single k.</p><p><strong>Keyword Arguments</strong></p><ul><li><code>bioalphabet</code>: Alphabet type (e.g., :DNA).</li><li><code>fastas</code>: List of FASTA file paths.</li><li><code>k</code>: Value of k (e.g., 9).</li><li><code>output_dir</code>: (optional) Directory to write output files (default: current directory).</li><li><code>filename</code>: (optional) Full file name for output (default:    <code>&quot;{Mycelia.normalized_current_date()}.{lowercase(string(bioalphabet))}{k}mers.jld2&quot;</code>).</li></ul><p><strong>Output</strong></p><p>Saves a .jld2 file with the specified file name in <code>output_dir</code> if it does not already exist.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/kmer-analysis.jl#LL841-L862">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.generate_binary_matrix-Tuple{Int64, Int64, Float64}" href="#Mycelia.generate_binary_matrix-Tuple{Int64, Int64, Float64}"><code>Mycelia.generate_binary_matrix</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Generate a binary (Bernoulli) matrix with given dimensions and probability.</p><p><strong>Arguments</strong></p><ul><li><code>n_features::Int</code>: Number of features (rows)</li><li><code>n_samples::Int</code>: Number of samples (columns)</li><li><code>p::Float64</code>: Probability of 1 in the Bernoulli distribution</li></ul><p><strong>Returns</strong></p><ul><li><code>Matrix{Bool}</code>: Binary matrix with dimensions (n<em>features, n</em>samples)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/simulation.jl#LL323-L333">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.generate_consensus_pangenome-Tuple{Dict, Dict, Dict, String}" href="#Mycelia.generate_consensus_pangenome-Tuple{Dict, Dict, Dict, String}"><code>Mycelia.generate_consensus_pangenome</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Generate consensus pangenome from cross-validation results.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/cross-validation.jl#LL390-L392">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.generate_contig_sequence-Tuple{MetaGraphsNext.MetaGraph{&lt;:Integer, String, Mycelia.KmerVertexData, Mycelia.KmerEdgeData}, Vector{String}}" href="#Mycelia.generate_contig_sequence-Tuple{MetaGraphsNext.MetaGraph{&lt;:Integer, String, Mycelia.KmerVertexData, Mycelia.KmerEdgeData}, Vector{String}}"><code>Mycelia.generate_contig_sequence</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Generate sequence for a contig path.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/sequence-graphs-next.jl#LL1836-L1838">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.generate_coverage_profile-Tuple{MetaGraphsNext.MetaGraph{&lt;:Integer, String, Mycelia.KmerVertexData, Mycelia.KmerEdgeData}, Vector{String}}" href="#Mycelia.generate_coverage_profile-Tuple{MetaGraphsNext.MetaGraph{&lt;:Integer, String, Mycelia.KmerVertexData, Mycelia.KmerEdgeData}, Vector{String}}"><code>Mycelia.generate_coverage_profile</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Generate coverage profile for a contig path.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/sequence-graphs-next.jl#LL1857-L1859">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.generate_kmer_alternatives-Tuple{Any, Any, Type{&lt;:BioSequences.BioSequence}}" href="#Mycelia.generate_kmer_alternatives-Tuple{Any, Any, Type{&lt;:BioSequences.BioSequence}}"><code>Mycelia.generate_kmer_alternatives</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Generate alternative k-mers for improvement attempts using proper k-mer objects.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/iterative-assembly.jl#LL579-L581">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.generate_paired_end_reads-NTuple{4, Any}" href="#Mycelia.generate_paired_end_reads-NTuple{4, Any}"><code>Mycelia.generate_paired_end_reads</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">generate_paired_end_reads(reference_seq, coverage, read_length, insert_size; error_rate=0.01)</code></pre><p>Generate realistic paired-end sequencing reads from a reference sequence.</p><p>Simulates paired-end Illumina sequencing with realistic insert sizes, read lengths, and optional sequencing errors for assembly benchmarking.</p><p><strong>Arguments</strong></p><ul><li><code>reference_seq</code>: Reference sequence (BioSequences.LongDNA{4})</li><li><code>coverage</code>: Target sequencing coverage depth</li><li><code>read_length</code>: Length of each read in base pairs</li><li><code>insert_size</code>: Insert size between paired reads</li><li><code>error_rate</code>: Sequencing error rate (default: 0.01)</li></ul><p><strong>Returns</strong></p><ul><li>Tuple of (forward<em>reads, reverse</em>reads) as vectors of BioSequences.LongDNA{4}</li></ul><p><strong>See Also</strong></p><ul><li><code>simulate_illumina_paired_reads</code>: For more sophisticated read simulation using ART</li><li><code>introduce_sequencing_errors</code>: For adding realistic sequencing errors</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/simulation.jl#LL743-L764">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.generate_poisson_matrix-Tuple{Int64, Int64, Float64}" href="#Mycelia.generate_poisson_matrix-Tuple{Int64, Int64, Float64}"><code>Mycelia.generate_poisson_matrix</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Generate a Poisson matrix with given dimensions and rate parameter.</p><p><strong>Arguments</strong></p><ul><li><code>n_features::Int</code>: Number of features (rows)</li><li><code>n_samples::Int</code>: Number of samples (columns)</li><li><code>λ::Float64</code>: Rate parameter for the Poisson distribution</li></ul><p><strong>Returns</strong></p><ul><li><code>Matrix{Int}</code>: Poisson matrix with dimensions (n<em>features, n</em>samples)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/simulation.jl#LL338-L348">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.generate_polished_sequence-Tuple{Vector{Mycelia.ViterbiState}, Vector{String}, Mycelia.ViterbiConfig}" href="#Mycelia.generate_polished_sequence-Tuple{Vector{Mycelia.ViterbiState}, Vector{String}, Mycelia.ViterbiConfig}"><code>Mycelia.generate_polished_sequence</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">generate_polished_sequence(states::Vector{ViterbiState}, observations::Vector{String}, 
                          config::ViterbiConfig) -&gt; (String, Vector{Tuple{Int, String, String}})</code></pre><p>Generate polished sequence and track corrections made.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/viterbi-next.jl#LL346-L351">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.generate_prime_k_sequence" href="#Mycelia.generate_prime_k_sequence"><code>Mycelia.generate_prime_k_sequence</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Generate sequence of prime k-mer sizes starting from min_k.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/intelligent-assembly.jl#LL26-L28">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.generate_recommendation_reasoning-Tuple{Float64, Float64}" href="#Mycelia.generate_recommendation_reasoning-Tuple{Float64, Float64}"><code>Mycelia.generate_recommendation_reasoning</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Generate reasoning for assembly approach recommendation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/cross-validation.jl#LL471-L473">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.generate_taxa_abundances_plot-Tuple{DataFrames.DataFrame}" href="#Mycelia.generate_taxa_abundances_plot-Tuple{DataFrames.DataFrame}"><code>Mycelia.generate_taxa_abundances_plot</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">generate_taxa_abundances_plot(
    joint_reads_to_taxon_lineage_table::DataFrames.DataFrame;
    taxa_level::String,
    top_n::Int = 30,
    kwargs...
)</code></pre><p>Convenience wrapper function to generate taxa abundance visualization with default parameters and save to a file if requested.</p><p><strong>Arguments</strong></p><ul><li><code>joint_reads_to_taxon_lineage_table</code>: DataFrame with sample_id and taxonomic assignments</li><li><code>taxa_level</code>: Taxonomic level to analyze</li><li><code>top_n</code>: Number of top taxa to display individually</li><li><code>kwargs...</code>: Additional parameters to pass to plot<em>taxa</em>abundances</li></ul><p><strong>Returns</strong></p><ul><li><code>fig</code>: CairoMakie figure object</li><li><code>ax</code>: CairoMakie axis object</li><li><code>taxa_colors</code>: Dictionary mapping taxa to their assigned colors</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/plotting-and-visualization.jl#LL489-L510">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.generate_test_fastq_data-Tuple{Int64, Int64, String}" href="#Mycelia.generate_test_fastq_data-Tuple{Int64, Int64, String}"><code>Mycelia.generate_test_fastq_data</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">generate_test_fastq_data(n_reads::Int, read_length::Int, filename::String)</code></pre><p>Generate test FASTQ data for benchmarking purposes.</p><p>Creates a FASTQ file with random DNA sequences and realistic quality scores suitable for performance testing and validation.</p><p><strong>Arguments</strong></p><ul><li><code>n_reads::Int</code>: Number of reads to generate</li><li><code>read_length::Int</code>: Length of each read in base pairs</li><li><code>filename::String</code>: Output filename for the FASTQ file</li></ul><p><strong>Details</strong></p><ul><li>Generates random DNA sequences using BioSequences.randdnaseq</li><li>Assigns realistic quality scores (Phred+33 encoding, range 20-40)</li><li>Uses existing Mycelia I/O functions for consistency</li></ul><p><strong>See Also</strong></p><ul><li><code>Mycelia.write_fastq</code>: For writing FASTQ records</li><li><code>Mycelia.fastq_record</code>: For creating FASTQ records</li><li><code>Mycelia.simulate_illumina_paired_reads</code>: For more sophisticated read simulation</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/simulation.jl#LL665-L687">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.generate_test_genome_with_genes" href="#Mycelia.generate_test_genome_with_genes"><code>Mycelia.generate_test_genome_with_genes</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">generate_test_genome_with_genes(genome_size, gene_density=0.02)</code></pre><p>Generate a test genome with simulated gene positions for annotation benchmarking.</p><p>Creates a random DNA sequence with estimated gene positions based on gene density, suitable for testing gene prediction algorithms.</p><p><strong>Arguments</strong></p><ul><li><code>genome_size</code>: Size of the genome in base pairs</li><li><code>gene_density</code>: Proportion of genome that consists of genes (default: 0.02)</li></ul><p><strong>Returns</strong></p><ul><li>Tuple of (genome<em>sequence, gene</em>positions) where gene_positions is a vector of (start, end) tuples</li></ul><p><strong>See Also</strong></p><ul><li><code>random_fasta_record</code>: For generating random FASTA sequences</li><li><code>save_genome_as_fasta</code>: For saving genomes to FASTA format</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/simulation.jl#LL873-L891">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.generate_test_sequences" href="#Mycelia.generate_test_sequences"><code>Mycelia.generate_test_sequences</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">generate_test_sequences(genome_size::Int, n_sequences::Int=1)</code></pre><p>Generate test DNA sequences for k-mer analysis benchmarking.</p><p>Creates random DNA sequences suitable for k-mer counting and analysis performance testing.</p><p><strong>Arguments</strong></p><ul><li><code>genome_size::Int</code>: Size of each generated sequence in base pairs</li><li><code>n_sequences::Int</code>: Number of sequences to generate (default: 1)</li></ul><p><strong>Returns</strong></p><ul><li>Vector of <code>BioSequences.LongDNA{4}</code> sequences</li></ul><p><strong>See Also</strong></p><ul><li><code>random_fasta_record</code>: For generating FASTA records with random sequences</li><li><code>BioSequences.randdnaseq</code>: For generating random DNA sequences</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/simulation.jl#LL713-L730">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.generate_test_sequences-Tuple{Mycelia.BenchmarkConfig}" href="#Mycelia.generate_test_sequences-Tuple{Mycelia.BenchmarkConfig}"><code>Mycelia.generate_test_sequences</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">generate_test_sequences(
    config::Mycelia.BenchmarkConfig
) -&gt; Vector{FASTX.FASTA.Record}
</code></pre><p>Generate synthetic DNA sequences for benchmarking.</p><p><strong>Arguments</strong></p><ul><li><code>config</code>: BenchmarkConfig with test parameters</li></ul><p><strong>Returns</strong></p><ul><li>Vector of FASTA records for testing</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/performance-benchmarks.jl#LL33">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.generate_training_datasets-Tuple{}" href="#Mycelia.generate_training_datasets-Tuple{}"><code>Mycelia.generate_training_datasets</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">generate_training_datasets(; n_datasets=20, genome_sizes=[10000, 50000, 100000], 
                          error_rates=[0.001, 0.01, 0.05], coverage_levels=[20, 30, 50])</code></pre><p>Generate diverse training datasets for RL agent training.</p><p>This function creates simulated genomic datasets with varying characteristics to provide comprehensive training scenarios for the RL agent.</p><p><strong>Arguments</strong></p><ul><li><code>n_datasets::Int</code>: Total number of datasets to generate (default: 20)</li><li><code>genome_sizes::Vector{Int}</code>: Range of genome sizes to simulate (default: [10K, 50K, 100K])</li><li><code>error_rates::Vector{Float64}</code>: Range of sequencing error rates (default: [0.1%, 1%, 5%])</li><li><code>coverage_levels::Vector{Int}</code>: Range of coverage depths (default: [20x, 30x, 50x])</li></ul><p><strong>Returns</strong></p><ul><li><code>Vector{String}</code>: Paths to generated training FASTQ files</li></ul><p><strong>Example</strong></p><pre><code class="language-julia hljs">training_files = generate_training_datasets(n_datasets=50, genome_sizes=[50000, 100000, 200000])</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/reinforcement-learning.jl#LL836-L858">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.generate_transterm_coordinates_from_fasta-Tuple{Any}" href="#Mycelia.generate_transterm_coordinates_from_fasta-Tuple{Any}"><code>Mycelia.generate_transterm_coordinates_from_fasta</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">generate_transterm_coordinates_from_fasta(fasta) -&gt; Any
</code></pre><p>Generate minimal coordinate files required for TransTermHP analysis from FASTA sequences.</p><p>Creates artificial gene annotations at sequence boundaries to enable TransTermHP to run without real gene annotations. For each sequence in the FASTA file, generates two single-base-pair &quot;genes&quot; at positions 1-2 and (L-1)-L, where L is sequence length.</p><p><strong>Arguments</strong></p><ul><li><code>fasta</code>: Path to input FASTA file containing sequences to analyze</li></ul><p><strong>Returns</strong></p><ul><li>Path to generated coordinate file (original path with &quot;.coords&quot; extension)</li></ul><p><strong>Format</strong></p><p>Generated coordinate file follows TransTermHP format: gene_id start stop chromosome</p><p>where chromosome matches FASTA sequence identifiers.</p><p>See also: <a href="#Mycelia.run_transterm-Tuple{}"><code>run_transterm</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/annotation.jl#LL1556">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.generate_transterm_coordinates_from_gff-Tuple{Any}" href="#Mycelia.generate_transterm_coordinates_from_gff-Tuple{Any}"><code>Mycelia.generate_transterm_coordinates_from_gff</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">generate_transterm_coordinates_from_gff(gff_file) -&gt; Any
</code></pre><p>Convert a GFF file to a coordinates file compatible with TransTermHP format.</p><p><strong>Arguments</strong></p><ul><li><code>gff_file::String</code>: Path to input GFF file</li></ul><p><strong>Processing</strong></p><ul><li>Converts 1-based to 0-based coordinates</li><li>Extracts gene IDs from the attributes field</li><li>Retains columns: gene_id, start, end, seqid</li></ul><p><strong>Returns</strong></p><ul><li>Path to the generated coordinates file (original filename with &#39;.coords&#39; suffix)</li></ul><p><strong>Output Format</strong></p><p>Space-delimited file with columns: gene_id, start, end, seqid</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/annotation.jl#LL1643">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.get_base_extension-Tuple{String}" href="#Mycelia.get_base_extension-Tuple{String}"><code>Mycelia.get_base_extension</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_base_extension(filename::String) -&gt; String
</code></pre><p>Extract the base file extension from a filename, handling compressed files.</p><p>For regular files, returns the last extension. For gzipped files, returns the extension before .gz.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/utility-functions.jl#LL1581">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.get_biosequence_alphabet-Tuple{T} where T&lt;:BioSequences.BioSequence" href="#Mycelia.get_biosequence_alphabet-Tuple{T} where T&lt;:BioSequences.BioSequence"><code>Mycelia.get_biosequence_alphabet</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_biosequence_alphabet(s::BioSequences.BioSequence) -&gt; Any
</code></pre><p>Return the alphabet associated with a <code>BioSequence</code> type.</p><p><strong>Arguments</strong></p><ul><li><code>s::BioSequences.BioSequence</code>: A subtype instance.</li></ul><p><strong>Returns</strong></p><p><code>BioSymbols.Alphabet</code> of the sequence type.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/alphabets.jl#LL1">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.get_correct_quality-Tuple{Symbol, Int64, Int64}" href="#Mycelia.get_correct_quality-Tuple{Symbol, Int64, Int64}"><code>Mycelia.get_correct_quality</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_correct_quality(tech::Symbol, pos::Int, read_length::Int) -&gt; Int</code></pre><p>Simulates a Phred quality score (using the Sanger convention) for a correctly observed base. For Illumina, the quality score is modeled to decay linearly from ~40 at the start to ~20 at the end of the read. For other technologies, the score is sampled from a normal distribution with parameters typical for that platform.</p><p>Returns an integer quality score.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/simulation.jl#LL1054-L1062">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.get_error_quality-Tuple{Symbol}" href="#Mycelia.get_error_quality-Tuple{Symbol}"><code>Mycelia.get_error_quality</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_error_quality(tech::Symbol) -&gt; Int</code></pre><p>Simulates a Phred quality score (using the Sanger convention) for a base observed with an error. Error bases are assigned lower quality scores than correctly observed bases. For Illumina, scores typically range between 5 and 15; for nanopore and pacbio, slightly lower values are used; and for ultima, a modest quality score is assigned.</p><p>Returns an integer quality score.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/simulation.jl#LL1082-L1091">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.get_fastq_contigs-Tuple{Mycelia.AssemblyResult}" href="#Mycelia.get_fastq_contigs-Tuple{Mycelia.AssemblyResult}"><code>Mycelia.get_fastq_contigs</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_fastq_contigs(result::AssemblyResult) -&gt; Vector{FASTX.FASTQ.Record}</code></pre><p>Extract quality-aware FASTQ contigs from assembly result if available. Returns empty vector if no quality information was preserved during assembly.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/assembly.jl#LL282-L287">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.get_genbank-Tuple{}" href="#Mycelia.get_genbank-Tuple{}"><code>Mycelia.get_genbank</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_genbank(
;
    db,
    accession,
    ftp
) -&gt; Union{Nothing, GenomicAnnotations.GenBank.Reader}
</code></pre><p>Get dna (db = &quot;nuccore&quot;) or protein (db = &quot;protein&quot;) sequences from NCBI or get fasta directly from FTP site</p><p>Retrieve GenBank records from NCBI or directly from an FTP site.</p><p><strong>Arguments</strong></p><ul><li><code>db::String</code>: NCBI database to query (&quot;nuccore&quot; for nucleotide or &quot;protein&quot; for protein sequences)</li><li><code>accession::String</code>: NCBI accession number for the sequence</li><li><code>ftp::String</code>: Direct FTP URL to a GenBank file (gzipped)</li></ul><p><strong>Returns</strong></p><ul><li><code>GenomicAnnotations.GenBank.Reader</code>: A reader object containing the GenBank record</li></ul><p><strong>Details</strong></p><p>When using NCBI queries (<code>db</code> and <code>accession</code>), the function implements rate limiting  (0.5s sleep) to comply with NCBI&#39;s API restrictions of max 2 requests per second.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/reference-databases.jl#LL2335">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.get_gff-Tuple{}" href="#Mycelia.get_gff-Tuple{}"><code>Mycelia.get_gff</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_gff(; db, accession, ftp) -&gt; Any
</code></pre><p>Get dna (db = &quot;nuccore&quot;) or protein (db = &quot;protein&quot;) sequences from NCBI or get fasta directly from FTP site</p><p>Retrieve GFF3 formatted genomic feature data from NCBI or direct FTP source.</p><p><strong>Arguments</strong></p><ul><li><code>db::String</code>: NCBI database to query (&quot;nuccore&quot; for DNA or &quot;protein&quot; for protein sequences)</li><li><code>accession::String</code>: NCBI accession number</li><li><code>ftp::String</code>: Direct FTP URL to GFF3 file (typically gzipped)</li></ul><p><strong>Returns</strong></p><ul><li><code>IO</code>: IOBuffer containing uncompressed GFF3 data</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/genome-features.jl#LL255">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.get_in_neighbors-Tuple{MetaGraphsNext.MetaGraph{&lt;:Integer, String, Mycelia.KmerVertexData, Mycelia.KmerEdgeData}, String}" href="#Mycelia.get_in_neighbors-Tuple{MetaGraphsNext.MetaGraph{&lt;:Integer, String, Mycelia.KmerVertexData, Mycelia.KmerEdgeData}, String}"><code>Mycelia.get_in_neighbors</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Get incoming neighbors of a vertex.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/sequence-graphs-next.jl#LL1259-L1261">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.get_kmer_index-Tuple{Any, Any}" href="#Mycelia.get_kmer_index-Tuple{Any, Any}"><code>Mycelia.get_kmer_index</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_kmer_index(kmers, kmer) -&gt; Any
</code></pre><p>Returns the index position of a given k-mer in a sorted list of k-mers.</p><p><strong>Arguments</strong></p><ul><li><code>kmers</code>: A sorted vector of k-mers to search within</li><li><code>kmer</code>: The k-mer sequence to find</li></ul><p><strong>Returns</strong></p><p>Integer index position where <code>kmer</code> is found in <code>kmers</code></p><p><strong>Throws</strong></p><ul><li><code>AssertionError</code>: If the k-mer is not found in the list</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/sequence-graphs.jl#LL237">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.get_local_subgraph-Tuple{MetaGraphsNext.MetaGraph{&lt;:Integer, String, Mycelia.KmerVertexData, Mycelia.KmerEdgeData}, String, Int64}" href="#Mycelia.get_local_subgraph-Tuple{MetaGraphsNext.MetaGraph{&lt;:Integer, String, Mycelia.KmerVertexData, Mycelia.KmerEdgeData}, String, Int64}"><code>Mycelia.get_local_subgraph</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Get local subgraph around a vertex.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/sequence-graphs-next.jl#LL1565-L1567">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.get_out_neighbors-Tuple{MetaGraphsNext.MetaGraph{&lt;:Integer, String, Mycelia.KmerVertexData, Mycelia.KmerEdgeData}, String}" href="#Mycelia.get_out_neighbors-Tuple{MetaGraphsNext.MetaGraph{&lt;:Integer, String, Mycelia.KmerVertexData, Mycelia.KmerEdgeData}, String}"><code>Mycelia.get_out_neighbors</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Get outgoing neighbors of a vertex.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/sequence-graphs-next.jl#LL1245-L1247">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.get_phred_scores-Tuple{FASTX.FASTQ.Record}" href="#Mycelia.get_phred_scores-Tuple{FASTX.FASTQ.Record}"><code>Mycelia.get_phred_scores</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_phred_scores(
    record::FASTX.FASTQ.Record
) -&gt; Vector{UInt8}
</code></pre><p>Get numerical PHRED quality scores from a FASTQ record.</p><p>This is a convenience wrapper around FASTX.quality_scores() that returns the quality scores as a Vector{UInt8} representing PHRED scores.</p><p><strong>Arguments</strong></p><ul><li><code>record::FASTX.FASTQ.Record</code>: FASTQ record to extract quality scores from</li></ul><p><strong>Returns</strong></p><ul><li><code>Vector{UInt8}</code>: PHRED quality scores (0-based, where 0 = lowest quality, 40+ = highest quality)</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia hljs">record = FASTX.FASTQ.Record(&quot;read1&quot;, &quot;ATCG&quot;, &quot;IIII&quot;)
scores = get_phred_scores(record)  # Returns [40, 40, 40, 40]</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/fastx.jl#LL1475">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.get_qualmer_statistics-Tuple{MetaGraphsNext.MetaGraph}" href="#Mycelia.get_qualmer_statistics-Tuple{MetaGraphsNext.MetaGraph}"><code>Mycelia.get_qualmer_statistics</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_qualmer_statistics(
    graph::MetaGraphsNext.MetaGraph
) -&gt; Dict{String, Any}
</code></pre><p>Get comprehensive statistics about a qualmer graph.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/qualmer-analysis.jl#LL596">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.get_sequence-Tuple{}" href="#Mycelia.get_sequence-Tuple{}"><code>Mycelia.get_sequence</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_sequence(
;
    db,
    accession,
    ftp
) -&gt; Union{Nothing, FASTX.FASTA.Reader}
</code></pre><p>Get dna (db = &quot;nuccore&quot;) or protein (db = &quot;protein&quot;) sequences from NCBI or get fasta directly from FTP site</p><p>Retrieve FASTA format sequences from NCBI databases or direct FTP URLs.</p><p><strong>Arguments</strong></p><ul><li><code>db::String</code>: NCBI database type (&quot;nuccore&quot; for DNA or &quot;protein&quot; for protein sequences)</li><li><code>accession::String</code>: NCBI sequence accession number</li><li><code>ftp::String</code>: Direct FTP URL to a FASTA file (alternative to db/accession pair)</li></ul><p><strong>Returns</strong></p><ul><li><code>FASTX.FASTA.Reader</code>: Reader object containing the requested sequence(s)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/reference-databases.jl#LL2068">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.get_viroid_species_list-Tuple{}" href="#Mycelia.get_viroid_species_list-Tuple{}"><code>Mycelia.get_viroid_species_list</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_viroid_species_list() -&gt; Vector{String}
</code></pre><p>Get a comprehensive list of well-characterized viroid species for reference data download.</p><p><strong>Returns</strong></p><ul><li><code>Vector{String}</code>: List of viroid species names suitable for NCBI searches</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia hljs">viroid_species = get_viroid_species_list()
for species in viroid_species[1:5]  # Download first 5 species
    download_viroid_reference_data(species, &quot;viroid_references/$species/&quot;)
end</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/reference-databases.jl#LL3143">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.gfa_to_fasta-Tuple{}" href="#Mycelia.gfa_to_fasta-Tuple{}"><code>Mycelia.gfa_to_fasta</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">gfa_to_fasta(; gfa, fasta)
</code></pre><p>Convert a GFA (Graphical Fragment Assembly) file to FASTA format.</p><p><strong>Arguments</strong></p><ul><li><code>gfa::String</code>: Path to input GFA file</li><li><code>fasta::String=gfa * &quot;.fna&quot;</code>: Path for output FASTA file. Defaults to input filename with &quot;.fna&quot; extension</li></ul><p><strong>Returns</strong></p><ul><li><code>String</code>: Path to the generated FASTA file</li></ul><p><strong>Details</strong></p><p>Uses gfatools (via Conda) to perform the conversion. The function will:</p><ol><li>Ensure gfatools is available in the Conda environment</li><li>Execute the conversion using gfatools gfa2fa</li><li>Write sequences to the specified FASTA file</li></ol></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/sequence-graphs.jl#LL287">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.gfa_to_structure_table-Tuple{Any}" href="#Mycelia.gfa_to_structure_table-Tuple{Any}"><code>Mycelia.gfa_to_structure_table</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">gfa_to_structure_table(
    gfa
) -&gt; NamedTuple{(:contig_table, :records), &lt;:Tuple{DataFrames.DataFrame, Any}}
</code></pre><p>Convert a GFA (Graphical Fragment Assembly) file into a structured representation.</p><p><strong>Arguments</strong></p><ul><li><code>gfa</code>: Path to GFA file or GFA content as string</li></ul><p><strong>Returns</strong></p><p>Named tuple containing:</p><ul><li><code>contig_table</code>: DataFrame with columns:<ul><li><code>connected_component</code>: Integer ID for each component</li><li><code>contigs</code>: Comma-separated list of contig IDs</li><li><code>is_circular</code>: Boolean indicating if component forms a cycle</li><li><code>is_closed</code>: Boolean indicating if single contig forms a cycle</li><li><code>lengths</code>: Comma-separated list of contig lengths</li></ul></li><li><code>records</code>: FASTA records from the GFA</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/sequence-graphs.jl#LL616">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.githash-Tuple{}" href="#Mycelia.githash-Tuple{}"><code>Mycelia.githash</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">githash(; short) -&gt; SubString{String}
</code></pre><p>Returns the current git commit hash of the repository.</p><p><strong>Arguments</strong></p><ul><li><code>short::Bool=false</code>: If true, returns abbreviated 8-character hash</li></ul><p><strong>Returns</strong></p><p>A string containing the git commit hash (full 40 characters by default)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/utility-functions.jl#LL1098">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.graph_to_gfa-Tuple{}" href="#Mycelia.graph_to_gfa-Tuple{}"><code>Mycelia.graph_to_gfa</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">graph_to_gfa(; graph, outfile)
</code></pre><p>Convert a Mycelia graph to GFA (Graphical Fragment Assembly) format.</p><p>Writes a graph to GFA format, including:</p><ul><li>Header (H) line with GFA version</li><li>Segment (S) lines for each vertex with sequence and depth</li><li>Link (L) lines for edges with overlap size and orientations</li></ul><p><strong>Arguments</strong></p><ul><li><code>graph</code>: MetaGraph containing sequence vertices and their relationships</li><li><code>outfile</code>: Path where the GFA file should be written</li></ul><p><strong>Returns</strong></p><ul><li>Path to the written GFA file</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/sequence-graphs.jl#LL852">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.has_quality_information-Tuple{Mycelia.AssemblyResult}" href="#Mycelia.has_quality_information-Tuple{Mycelia.AssemblyResult}"><code>Mycelia.has_quality_information</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">has_quality_information(result::AssemblyResult) -&gt; Bool</code></pre><p>Check if the assembly result preserves quality information from the original reads.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/assembly.jl#LL292-L296">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.hclust_to_metagraph-Tuple{Clustering.Hclust}" href="#Mycelia.hclust_to_metagraph-Tuple{Clustering.Hclust}"><code>Mycelia.hclust_to_metagraph</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">hclust_to_metagraph(
    hcl::Clustering.Hclust
) -&gt; MetaGraphs.MetaDiGraph{Int64, Float64}
</code></pre><p>Convert a hierarchical clustering tree into a directed metagraph representation.</p><p><strong>Arguments</strong></p><ul><li><code>hcl::Clustering.Hclust</code>: Hierarchical clustering result object</li></ul><p><strong>Returns</strong></p><ul><li><code>MetaGraphs.MetaDiGraph</code>: Directed graph with metadata representing the clustering hierarchy</li></ul><p><strong>Graph Properties</strong></p><p>The resulting graph contains the following vertex properties:</p><ul><li><code>:hclust_id</code>: String identifier for each node</li><li><code>:height</code>: Height/distance at each merge point (0.0 for leaves)</li><li><code>:x</code>: Horizontal position for visualization (0-1 range)</li><li><code>:y</code>: Vertical position based on normalized height</li><li><code>:hcl</code>: Original clustering object (stored as graph property)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/clustering.jl#LL32">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.heirarchically_cluster_distance_matrix-Tuple{Any}" href="#Mycelia.heirarchically_cluster_distance_matrix-Tuple{Any}"><code>Mycelia.heirarchically_cluster_distance_matrix</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">heirarchically_cluster_distance_matrix(
    distance_matrix
) -&gt; Clustering.Hclust
</code></pre><p>Performs hierarchical clustering on a distance matrix using Ward&#39;s linkage method.</p><p><strong>Arguments</strong></p><ul><li><code>distance_matrix::Matrix{&lt;:Real}</code>: A symmetric distance/dissimilarity matrix</li></ul><p><strong>Returns</strong></p><ul><li><code>HierarchicalCluster</code>: A hierarchical clustering object from Clustering.jl</li></ul><p><strong>Details</strong></p><p>Uses Ward&#39;s method (minimum variance) for clustering, which:</p><ul><li>Minimizes total within-cluster variance</li><li>Produces compact, spherical clusters</li><li>Works well for visualization in radial layouts</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/clustering.jl#LL96">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.identify_optimal_number_of_clusters-Tuple{Any}" href="#Mycelia.identify_optimal_number_of_clusters-Tuple{Any}"><code>Mycelia.identify_optimal_number_of_clusters</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">identify_optimal_number_of_clusters(
    distance_matrix;
    min_k,
    max_k
) -&gt; Any
</code></pre><p>Identifies the optimal number of clusters using hierarchical clustering and maximizing the average silhouette score, displaying progress.</p><p>Uses Clustering.clustering_quality for score calculation.</p><p>Args:     distance_matrix: A square matrix of pairwise distances between items.</p><p>Returns:     A tuple containing:     - hcl: The hierarchical clustering result object.     - optimal<em>number</em>of_clusters: The inferred optimal number of clusters (k).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/clustering.jl#LL126">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.identify_potential_errors-Tuple{Any}" href="#Mycelia.identify_potential_errors-Tuple{Any}"><code>Mycelia.identify_potential_errors</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">identify_potential_errors(
    graph;
    min_coverage,
    min_quality,
    min_confidence
) -&gt; Vector{Int64}
</code></pre><p>Identify potential sequencing errors based on quality scores and coverage patterns.</p><p><strong>Arguments</strong></p><ul><li><code>graph</code>: Qualmer graph (MetaGraphsNext with QualmerVertexData)</li><li><code>min_coverage::Int=2</code>: Minimum coverage for reliable k-mers</li><li><code>min_quality::Float64=20.0</code>: Minimum mean quality score</li><li><code>min_confidence::Float64=0.95</code>: Minimum joint probability threshold</li></ul><p><strong>Returns</strong></p><ul><li><code>Vector{Int}</code>: Vertex indices of potential error k-mers</li></ul><p><strong>Details</strong></p><p>Identifies k-mers that are likely errors based on:</p><ul><li>Low coverage (singleton or few observations)</li><li>Low quality scores</li><li>Low joint probability (low confidence)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/qualmer-analysis.jl#LL731">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.ids_to_accessions-Tuple{Vector{String}, String}" href="#Mycelia.ids_to_accessions-Tuple{Vector{String}, String}"><code>Mycelia.ids_to_accessions</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ids_to_accessions(
    ids::Vector{String},
    database::String
) -&gt; Union{Vector{String}, Vector{T} where T&lt;:(SubString{_A} where _A)}
</code></pre><p>Convert NCBI sequence IDs to accession numbers.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/reference-databases.jl#LL2895">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.improve_read_likelihood-Tuple{FASTX.FASTQ.Record, Any, Int64}" href="#Mycelia.improve_read_likelihood-Tuple{FASTX.FASTQ.Record, Any, Int64}"><code>Mycelia.improve_read_likelihood</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Improve likelihood of a single read using maximum likelihood path finding. Returns improved read and boolean indicating if improvement was made.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/iterative-assembly.jl#LL380-L383">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.improve_read_set_likelihood-Tuple{Vector{&lt;:FASTX.FASTQ.Record}, Any, Int64}" href="#Mycelia.improve_read_set_likelihood-Tuple{Vector{&lt;:FASTX.FASTQ.Record}, Any, Int64}"><code>Mycelia.improve_read_set_likelihood</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Improve likelihood of entire read set using current graph and k-mer size. Returns updated reads and count of improvements made. Uses memory-efficient batch processing for large datasets.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/iterative-assembly.jl#LL303-L307">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.include_all_files-Tuple{AbstractString}" href="#Mycelia.include_all_files-Tuple{AbstractString}"><code>Mycelia.include_all_files</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">include_all_files(dir::AbstractString; pattern)
</code></pre><p>Recursively include all files matching a pattern in a directory and its subdirectories.</p><p><strong>Arguments</strong></p><ul><li><code>dir::AbstractString</code>: Directory path to search recursively</li><li><code>pattern::Regex=r&quot;\.jl$&quot;</code>: Regular expression pattern to match files (defaults to .jl files)</li></ul><p><strong>Details</strong></p><p>Files are processed in sorted order within each directory. This is useful for  loading test files, examples, or other Julia modules in a predictable order.</p><p><strong>Examples</strong></p><pre><code class="language-julia hljs"># Include all Julia files in a directory tree
include_all_files(&quot;test/modules&quot;)

# Include all text files
include_all_files(&quot;docs&quot;, r&quot;\.txt$&quot;)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/utility-functions.jl#LL1899">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.install_hashdeep-Tuple{}" href="#Mycelia.install_hashdeep-Tuple{}"><code>Mycelia.install_hashdeep</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">install_hashdeep() -&gt; Union{Nothing, Base.Process}
</code></pre><p>Ensures the hashdeep utility is installed on the system.</p><p>Checks if hashdeep is available in PATH and attempts to install it via apt package manager if not found. Will try with sudo privileges first, then without sudo if that fails.</p><p><strong>Details</strong></p><ul><li>Checks PATH for existing hashdeep executable</li><li>Attempts installation using apt package manager</li><li>Requires a Debian-based Linux distribution</li></ul><p><strong>Returns</strong></p><ul><li>Nothing, but prints status messages during execution</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/utility-functions.jl#LL1170">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.introduce_sequencing_errors-Tuple{Any, Any}" href="#Mycelia.introduce_sequencing_errors-Tuple{Any, Any}"><code>Mycelia.introduce_sequencing_errors</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">introduce_sequencing_errors(sequence, error_rate)</code></pre><p>Introduce realistic sequencing errors into a DNA sequence.</p><p>Simulates substitutions (70%), insertions (15%), and deletions (15%) at the specified error rate for realistic sequencing simulation.</p><p><strong>Arguments</strong></p><ul><li><code>sequence</code>: Input DNA sequence (BioSequences.LongDNA{4})</li><li><code>error_rate</code>: Probability of error per base</li></ul><p><strong>Returns</strong></p><ul><li>Modified sequence with introduced errors (BioSequences.LongDNA{4})</li></ul><p><strong>See Also</strong></p><ul><li><code>observe</code>: For more sophisticated error modeling with quality scores</li><li><code>mutate_string</code>: For string-based mutation operations</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/simulation.jl#LL796-L814">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.introduce_sequencing_errors-Tuple{Vector, Float64}" href="#Mycelia.introduce_sequencing_errors-Tuple{Vector, Float64}"><code>Mycelia.introduce_sequencing_errors</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">introduce_sequencing_errors(reads::Vector, error_rate::Float64)</code></pre><p>Introduce realistic sequencing errors into a set of reads.</p><p><strong>Arguments</strong></p><ul><li><code>reads::Vector</code>: Vector of FASTQ records</li><li><code>error_rate::Float64</code>: Error rate (0.0 to 1.0)</li></ul><p><strong>Returns</strong></p><ul><li><code>Vector</code>: Reads with introduced errors</li></ul><p><strong>Example</strong></p><pre><code class="language-julia hljs">error_reads = introduce_sequencing_errors(clean_reads, 0.01)  # 1% error rate</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/reinforcement-learning.jl#LL921-L937">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.is_equivalent-Tuple{Any, Any}" href="#Mycelia.is_equivalent-Tuple{Any, Any}"><code>Mycelia.is_equivalent</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">is_equivalent(a, b) -&gt; Any
</code></pre><p>Check if two biological sequences are equivalent, considering both direct and reverse complement matches.</p><p><strong>Arguments</strong></p><ul><li><code>a</code>: First biological sequence (BioSequence or compatible type)</li><li><code>b</code>: Second biological sequence (BioSequence or compatible type)</li></ul><p><strong>Returns</strong></p><ul><li><code>Bool</code>: <code>true</code> if sequences are identical or if one is the reverse complement of the other, <code>false</code> otherwise</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/alignments-and-mapping.jl#LL361">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.is_isolated_vertex-Tuple{MetaGraphsNext.MetaGraph{&lt;:Integer, String, Mycelia.KmerVertexData, Mycelia.KmerEdgeData}, String}" href="#Mycelia.is_isolated_vertex-Tuple{MetaGraphsNext.MetaGraph{&lt;:Integer, String, Mycelia.KmerVertexData, Mycelia.KmerEdgeData}, String}"><code>Mycelia.is_isolated_vertex</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Check if a vertex is isolated (no edges).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/sequence-graphs-next.jl#LL1942-L1944">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.is_legacy_graph-Tuple{Any}" href="#Mycelia.is_legacy_graph-Tuple{Any}"><code>Mycelia.is_legacy_graph</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">is_legacy_graph(graph) -&gt; Bool
</code></pre><p>Check if a graph is using the legacy MetaGraphs format.</p><p><strong>Arguments</strong></p><ul><li><code>graph</code>: Graph to check</li></ul><p><strong>Returns</strong></p><ul><li><code>Bool</code>: true if legacy format, false if next-generation format</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/sequence-graphs-next.jl#LL487">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.is_valid_bubble-Tuple{MetaGraphsNext.MetaGraph{&lt;:Integer, String, Mycelia.KmerVertexData, Mycelia.KmerEdgeData}, Mycelia.BubbleStructure}" href="#Mycelia.is_valid_bubble-Tuple{MetaGraphsNext.MetaGraph{&lt;:Integer, String, Mycelia.KmerVertexData, Mycelia.KmerEdgeData}, Mycelia.BubbleStructure}"><code>Mycelia.is_valid_bubble</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Check if a bubble structure is valid.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/sequence-graphs-next.jl#LL1401-L1403">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.is_valid_path-Tuple{MetaGraphsNext.MetaGraph{&lt;:Integer, String, Mycelia.KmerVertexData, Mycelia.KmerEdgeData}, Vector{String}}" href="#Mycelia.is_valid_path-Tuple{MetaGraphsNext.MetaGraph{&lt;:Integer, String, Mycelia.KmerVertexData, Mycelia.KmerEdgeData}, Vector{String}}"><code>Mycelia.is_valid_path</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Check if a path is valid in the graph.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/sequence-graphs-next.jl#LL1421-L1423">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.isolate_normalized_primary_contig-Tuple{Any, Any, Any, Any, Int64}" href="#Mycelia.isolate_normalized_primary_contig-Tuple{Any, Any, Any, Any, Int64}"><code>Mycelia.isolate_normalized_primary_contig</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">isolate_normalized_primary_contig(
    assembled_fasta,
    assembled_gfa,
    qualimap_report_txt,
    identifier,
    k::Int64;
    primary_contig_fasta
) -&gt; String
</code></pre><p>Primary contig is defined as the contig with the most bases mapped to it</p><p>In the context of picking out phage from metagenomic assemblies the longest contig is often bacteria whereas the highest coverage contigs are often primer-dimers or other PCR amplification artifacts.</p><p>Taking the contig that has the most bases mapped to it as a product of length * depth is cherry picked as our phage</p><p>Isolates and exports the primary contig from an assembly based on coverage depth × length.</p><p>The primary contig is defined as the contig with the highest total mapped bases  (coverage depth × length). This method helps identify potential phage contigs in  metagenomic assemblies, avoiding both long bacterial contigs and short high-coverage  PCR artifacts.</p><p><strong>Arguments</strong></p><ul><li><code>assembled_fasta</code>: Path to the assembled contigs in FASTA format</li><li><code>assembled_gfa</code>: Path to the assembly graph in GFA format</li><li><code>qualimap_report_txt</code>: Path to Qualimap coverage report</li><li><code>identifier</code>: String identifier for the output file</li><li><code>k</code>: Integer representing k-mer size used in assembly</li><li><code>primary_contig_fasta</code>: Optional output filepath (default: &quot;{identifier}.primary_contig.fna&quot;)</li></ul><p><strong>Returns</strong></p><ul><li>Path to the output FASTA file containing the primary contig</li></ul><p><strong>Notes</strong></p><ul><li>For circular contigs, removes the k-mer closure scar if detected</li><li>Trims k bases from the end if they match the first k bases</li><li>Uses coverage × length to avoid both long bacterial contigs and short PCR artifacts</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/sequence-graphs.jl#LL2378">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.iterative_assembly_summary-Tuple{Dict}" href="#Mycelia.iterative_assembly_summary-Tuple{Dict}"><code>Mycelia.iterative_assembly_summary</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Generate summary report of iterative assembly process.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/iterative-assembly.jl#LL812-L814">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.iterative_polishing" href="#Mycelia.iterative_polishing"><code>Mycelia.iterative_polishing</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">iterative_polishing(
    fastq
) -&gt; Vector{T} where T&lt;:(NamedTuple{(:fastq, :k), &lt;:Tuple{Any, Any}})
iterative_polishing(
    fastq,
    max_k
) -&gt; Vector{T} where T&lt;:(NamedTuple{(:fastq, :k), &lt;:Tuple{Any, Any}})
iterative_polishing(
    fastq,
    max_k,
    plot
) -&gt; Vector{T} where T&lt;:(NamedTuple{(:fastq, :k), &lt;:Tuple{Any, Any}})
</code></pre><p>Performs iterative error correction on FASTQ sequences using progressively larger k-mer sizes.</p><p>Starting with the default k-mer size, this function repeatedly applies polishing steps, incrementing the k-mer size until either reaching max_k or encountering instability.</p><p><strong>Arguments</strong></p><ul><li><code>fastq</code>: Path to input FASTQ file or FastqRecord object</li><li><code>max_k</code>: Maximum k-mer size to attempt (default: 89)</li><li><code>plot</code>: Whether to generate diagnostic plots (default: false)</li></ul><p><strong>Returns</strong></p><p>Vector of polishing results, where each element contains:</p><ul><li>k: k-mer size used</li><li>fastq: resulting polished sequences</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/viterbi-polishing-and-error-correction.jl#LL1014">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.jaccard_distance-Tuple{AbstractMatrix{&lt;:Integer}}" href="#Mycelia.jaccard_distance-Tuple{AbstractMatrix{&lt;:Integer}}"><code>Mycelia.jaccard_distance</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Compute the Jaccard distance between columns of a binary matrix.</p><p><strong>Arguments</strong></p><ul><li><code>M::AbstractMatrix{&lt;:Integer}</code>: Binary matrix where rows are features and columns are samples</li></ul><p><strong>Returns</strong></p><ul><li><code>Matrix{Float64}</code>: Symmetric distance matrix with Jaccard distances</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/distance-metrics.jl#LL2-L10">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.jaccard_distance-Tuple{Any, Any}" href="#Mycelia.jaccard_distance-Tuple{Any, Any}"><code>Mycelia.jaccard_distance</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">jaccard_distance(set1, set2) -&gt; Any
</code></pre><p>Calculate the Jaccard distance between two sets, which is the complement of the Jaccard similarity.</p><p>The Jaccard distance is defined as: <span>$J_d(A,B) = 1 - J_s(A,B) = 1 - \frac{|A ∩ B|}{|A ∪ B|}$</span></p><p><strong>Arguments</strong></p><ul><li><code>set1</code>: First set to compare</li><li><code>set2</code>: Second set to compare</li></ul><p><strong>Returns</strong></p><ul><li><code>Float64</code>: A value in [0,1] where 0 indicates identical sets and 1 indicates disjoint sets</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/distance-metrics.jl#LL127">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.jaccard_similarity-Tuple{Any, Any}" href="#Mycelia.jaccard_similarity-Tuple{Any, Any}"><code>Mycelia.jaccard_similarity</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">jaccard_similarity(set1, set2) -&gt; Any
</code></pre><p>Compute the Jaccard similarity coefficient between two sets.</p><p>The Jaccard similarity is defined as the size of the intersection divided by the size of the union of two sets:</p><pre><code class="nohighlight hljs">J(A,B) = |A ∩ B| / |A ∪ B|</code></pre><p><strong>Arguments</strong></p><ul><li><code>set1</code>: First set for comparison</li><li><code>set2</code>: Second set for comparison</li></ul><p><strong>Returns</strong></p><ul><li><code>Float64</code>: A value between 0.0 and 1.0, where:<ul><li>1.0 indicates identical sets</li><li>0.0 indicates completely disjoint sets</li></ul></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/distance-metrics.jl#LL104">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.jellyfish_count-Tuple{}" href="#Mycelia.jellyfish_count-Tuple{}"><code>Mycelia.jellyfish_count</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">jellyfish_count(
;
    fastx,
    k,
    threads,
    max_mem,
    canonical,
    outfile,
    conda_check
)
</code></pre><p>Count k-mers in a FASTA/FASTQ file using Jellyfish.</p><p><strong>Arguments</strong></p><ul><li><code>fastx::String</code>: Path to input FASTA/FASTQ file (can be gzipped)</li><li><code>k::Integer</code>: k-mer length</li><li><code>threads::Integer=Sys.CPU_THREADS</code>: Number of threads to use</li><li><code>max_mem::Integer=Int(Sys.free_memory())</code>: Maximum memory in bytes (defaults to system free memory)</li><li><code>canonical::Bool=false</code>: Whether to count canonical k-mers (both strands combined)</li><li><code>outfile::String=auto</code>: Output filename (auto-generated based on input and parameters)</li><li><code>conda_check::Bool=true</code>: Whether to verify Jellyfish conda installation</li></ul><p><strong>Returns</strong></p><ul><li><code>String</code>: Path to gzipped TSV file containing k-mer counts</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/kmer-analysis.jl#LL209">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.jellyfish_counts_to_kmer_frequency_histogram" href="#Mycelia.jellyfish_counts_to_kmer_frequency_histogram"><code>Mycelia.jellyfish_counts_to_kmer_frequency_histogram</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">jellyfish_counts_to_kmer_frequency_histogram(
    jellyfish_counts_file
) -&gt; Any
jellyfish_counts_to_kmer_frequency_histogram(
    jellyfish_counts_file,
    outfile
) -&gt; Any
</code></pre><p>Convert a Jellyfish k-mer count file into a frequency histogram.</p><p><strong>Arguments</strong></p><ul><li><code>jellyfish_counts_file::String</code>: Path to the gzipped TSV file containing Jellyfish k-mer counts</li><li><code>outfile::String=replace(jellyfish_counts_file, r&quot;\.tsv\.gz$&quot; =&gt; &quot;.count_histogram.tsv&quot;)</code>: Optional output file path</li></ul><p><strong>Returns</strong></p><ul><li><code>String</code>: Path to the generated histogram file</li></ul><p><strong>Description</strong></p><p>Processes a Jellyfish k-mer count file to create a frequency histogram where:</p><ul><li>Column 1: Number of k-mers that share the same count</li><li>Column 2: The count they share</li></ul><p>Uses system sorting with LC_ALL=C for optimal performance on large files.</p><p>Notes</p><ul><li>Requires gzip, sort, uniq, and sed command line tools</li><li>Uses intermediate disk storage for sorting large files</li><li>Skips processing if output file already exists</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/kmer-analysis.jl#LL285">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.jitter-Tuple{Any, Any}" href="#Mycelia.jitter-Tuple{Any, Any}"><code>Mycelia.jitter</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">jitter(x, n) -&gt; Any
</code></pre><p>Add random noise to create a vector of jittered values.</p><p>Generates <code>n</code> values by adding random noise to the input value <code>x</code>.  The noise is uniformly distributed between -1/3 and 1/3.</p><p><strong>Arguments</strong></p><ul><li><code>x</code>: Base value to add jitter to</li><li><code>n</code>: Number of jittered values to generate</li></ul><p><strong>Returns</strong></p><ul><li>Vector of length <code>n</code> containing jittered values around <code>x</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/plotting-and-visualization.jl#LL960">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.join_fastqs_with_uuid-Tuple{Vector{String}}" href="#Mycelia.join_fastqs_with_uuid-Tuple{Vector{String}}"><code>Mycelia.join_fastqs_with_uuid</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">join_fastqs_with_uuid(
    fastq_files::Vector{String};
    fastq_out::String
    tsv_out::String
)</code></pre><p>Note: does not keep track of paired-end data - assumes single end reads</p><p>Designed primarily to allow joint mapping of many long-read samples</p><p>Given a collection of fastq files, creates:</p><ul><li>A gzipped TSV mapping original file and read_id to a new UUID per read</li><li>A gzipped joint fastq file with the new UUID as read header</li></ul><p>Returns: Tuple of output file paths (tsv<em>out, fastq</em>out)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/fastx.jl#LL33-L49">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.joint_base_quality_score-Tuple{Vector{Float64}}" href="#Mycelia.joint_base_quality_score-Tuple{Vector{Float64}}"><code>Mycelia.joint_base_quality_score</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">joint_base_quality_score(
    error_probabilities::Vector{Float64}
) -&gt; Float64
</code></pre><p>Calculate the quality score for a single base given multiple observations.</p><p>This function implements the &quot;Converting to Error Probabilities and Combining&quot; method:</p><ol><li>Takes error probabilities from multiple reads covering the same base</li><li>Calculates probability of ALL reads being wrong by multiplying probabilities</li><li>Calculates final Phred score from this combined probability</li></ol><p>To avoid numerical underflow with very small probabilities, the calculation is performed in log space.</p><p><strong>Arguments</strong></p><ul><li><code>error_probabilities::Vector{Float64}</code>: Vector of error probabilities from  multiple reads covering the same base position</li></ul><p><strong>Returns</strong></p><ul><li><code>Float64</code>: Phred quality score representing the combined confidence</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/kmer-analysis.jl#LL125">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.joint_qualmer_probability-Tuple{Vector{&lt;:Mycelia.Qualmer}}" href="#Mycelia.joint_qualmer_probability-Tuple{Vector{&lt;:Mycelia.Qualmer}}"><code>Mycelia.joint_qualmer_probability</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">joint_qualmer_probability(
    qualmers::Vector{&lt;:Mycelia.Qualmer};
    use_log_space
) -&gt; Float64
</code></pre><p>Calculate joint probability that multiple observations of the same k-mer are all correct. For independent observations of the same k-mer sequence, this represents our confidence that the k-mer truly exists in the data.</p><p><strong>Arguments</strong></p><ul><li><code>qualmers</code>: Vector of Qualmer observations of the same k-mer sequence</li><li><code>use_log_space</code>: Use log-space arithmetic for numerical stability (default: true)</li></ul><p><strong>Returns</strong></p><ul><li>Float64: Joint probability that all observations are correct</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/qualmer-analysis.jl#LL211">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.jsonl_to_dataframe-Tuple{String}" href="#Mycelia.jsonl_to_dataframe-Tuple{String}"><code>Mycelia.jsonl_to_dataframe</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">jsonl_to_dataframe(filepath::String) -&gt; DataFrames.DataFrame
</code></pre><pre><code class="nohighlight hljs">jsonl_to_dataframe(filepath::String) -&gt; DataFrame</code></pre><p>Parse a JSONL (or gzipped JSONL) file and return a DataFrame. Internally calls <code>parse_jsonl</code> for validation and parsing. Ensures that all rows have the same set of keys by inserting <code>missing</code> for any absent field before constructing the DataFrame.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/utility-functions.jl#LL1476">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.k_ladder-Tuple{}" href="#Mycelia.k_ladder-Tuple{}"><code>Mycelia.k_ladder</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">k_ladder(
;
    max_k,
    seed_primes,
    ratio,
    min_fractional_gap,
    read_length,
    read_margin,
    only_odd,
    return_unique,
    min_k
) -&gt; Vector{Int64}
</code></pre><p>Generate a √2-scaled ladder of odd primes for k-mer-based assembly / error-screening.</p><p>Starts with a user-supplied list of <code>seed_primes</code> (default <strong>[3, 5, 7]</strong>), then iteratively multiplies the last accepted <em>k</em> by <code>ratio</code> (default <code>sqrt(2)</code>), rounds <strong>up</strong> to the next odd prime, and appends it <strong>only if</strong> it differs from the previous accepted prime by at least <code>min_fractional_gap</code>.</p><p><strong>Keyword arguments</strong></p><ul><li><code>max_k::Int = 10_000</code>          : Absolute upper bound.</li><li><code>seed_primes::Vector{Int}</code>     : Initial primes (e.g. <code>[3,5,7]</code> for protein,                                  <code>[11,13,17]</code> for nucleotides).</li><li><code>ratio::Float64 = sqrt(2)</code>     : Target geometric growth factor.</li><li><code>min_fractional_gap::Float64 = 0.30</code> : Minimum (k<em>new − k</em>prev)/k_prev to skip                                        “sister” primes.</li><li><code>read_length::Union{Int,Nothing} = nothing</code> : If set, cap at                                              <code>read_length − read_margin</code>.</li><li><code>read_margin::Int = 20</code>        : Safety margin for short-read data.</li><li><code>only_odd::Bool = true</code>        : Force odd <em>k</em> (recommended).</li><li><code>return_unique::Bool = true</code>   : De-duplicate before returning.</li><li><code>min_k::Int = 3</code>               : Drop any <em>k</em> below this after generation.</li></ul><p><strong>Returns</strong></p><p><code>Vector{Int}</code> — ascending prime <em>k</em> values suitable for <code>-k</code>/<code>--k-list</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/kmer-analysis.jl#LL2083">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.kmer_counts_dict_to_vector-Tuple{Any, Any}" href="#Mycelia.kmer_counts_dict_to_vector-Tuple{Any, Any}"><code>Mycelia.kmer_counts_dict_to_vector</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">kmer_counts_dict_to_vector(
    kmer_to_index_map,
    kmer_counts
) -&gt; Any
</code></pre><p>Convert a dictionary of k-mer counts to a fixed-length numeric vector based on a predefined mapping.</p><p><strong>Arguments</strong></p><ul><li><code>kmer_to_index_map</code>: Dictionary mapping k-mer sequences to their corresponding vector indices</li><li><code>kmer_counts</code>: Dictionary containing k-mer sequences and their occurrence counts</li></ul><p><strong>Returns</strong></p><ul><li>A vector where each position corresponds to a k-mer count, with zeros for absent k-mers</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/kmer-analysis.jl#LL1885">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.kmer_counts_to_cosine_similarity-Tuple{Any, Any}" href="#Mycelia.kmer_counts_to_cosine_similarity-Tuple{Any, Any}"><code>Mycelia.kmer_counts_to_cosine_similarity</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">kmer_counts_to_cosine_similarity(
    kmer_counts_1,
    kmer_counts_2
) -&gt; Any
</code></pre><p>Calculate the cosine similarity between two k-mer count dictionaries.</p><p><strong>Arguments</strong></p><ul><li><code>kmer_counts_1::Dict{String,Int}</code>: First dictionary mapping k-mer sequences to their counts</li><li><code>kmer_counts_2::Dict{String,Int}</code>: Second dictionary mapping k-mer sequences to their counts</li></ul><p><strong>Returns</strong></p><ul><li><code>Float64</code>: Cosine distance between the two k-mer count vectors, in range [0,1] where 0 indicates identical distributions and 1 indicates maximum dissimilarity</li></ul><p><strong>Details</strong></p><p>Converts k-mer count dictionaries into vectors using a unified set of keys, then computes cosine distance. Missing k-mers are treated as count 0. Result is invariant to input order and total counts (normalized internally).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/distance-metrics.jl#LL48">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.kmer_counts_to_js_divergence-Tuple{Any, Any}" href="#Mycelia.kmer_counts_to_js_divergence-Tuple{Any, Any}"><code>Mycelia.kmer_counts_to_js_divergence</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">kmer_counts_to_js_divergence(
    kmer_counts_1,
    kmer_counts_2
) -&gt; Any
</code></pre><p>Calculate the Jensen-Shannon divergence between two k-mer frequency distributions.</p><p><strong>Arguments</strong></p><ul><li><code>kmer_counts_1</code>: Dictionary mapping k-mers to their counts in first sequence</li><li><code>kmer_counts_2</code>: Dictionary mapping k-mers to their counts in second sequence</li></ul><p><strong>Returns</strong></p><ul><li>Normalized Jensen-Shannon divergence score between 0 and 1, where:<ul><li>0 indicates identical distributions</li><li>1 indicates maximally different distributions</li></ul></li></ul><p><strong>Notes</strong></p><ul><li>The measure is symmetric: JS(P||Q) = JS(Q||P)</li><li>Counts are automatically normalized to probability distributions</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/distance-metrics.jl#LL74">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.kmer_counts_to_merqury_qv-Union{Tuple{}, Tuple{N}, Tuple{k}} where {k, N}" href="#Mycelia.kmer_counts_to_merqury_qv-Union{Tuple{}, Tuple{N}, Tuple{k}} where {k, N}"><code>Mycelia.kmer_counts_to_merqury_qv</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">kmer_counts_to_merqury_qv(
;
    raw_data_counts,
    assembly_counts
)
</code></pre><p>Calculate assembly Quality Value (QV) score using the Merqury method.</p><p>Estimates base-level accuracy by comparing k-mer distributions between raw sequencing data and assembly. Higher QV scores indicate better assembly quality.</p><p><strong>Arguments</strong></p><ul><li><code>raw_data_counts::AbstractDict{Kmers.DNAKmer{k,N}, Int}</code>: K-mer counts from raw sequencing data</li><li><code>assembly_counts::AbstractDict{Kmers.DNAKmer{k,N}, Int}</code>: K-mer counts from assembly</li></ul><p><strong>Returns</strong></p><ul><li><code>Float64</code>: Quality Value score in Phred scale (-10log₁₀(error rate))</li></ul><p><strong>Method</strong></p><p>QV is calculated using:</p><ol><li>Ktotal = number of unique kmers in assembly</li><li>Kshared = number of kmers shared between raw data and assembly</li><li>P = (Kshared/Ktotal)^(1/k) = estimated base-level accuracy</li><li>QV = -10log₁₀(1-P)</li></ol><p><strong>Reference</strong></p><p>Rhie et al. &quot;Merqury: reference-free quality, completeness, and phasing assessment for genome assemblies&quot; Genome Biology (2020)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/kmer-analysis.jl#LL458">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.kmer_graph_to_biosequence_graph-Tuple{MetaGraphsNext.MetaGraph}" href="#Mycelia.kmer_graph_to_biosequence_graph-Tuple{MetaGraphsNext.MetaGraph}"><code>Mycelia.kmer_graph_to_biosequence_graph</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">kmer_graph_to_biosequence_graph(
    kmer_graph::MetaGraphsNext.MetaGraph;
    min_path_length
) -&gt; MetaGraphsNext.MetaGraph{Int64, Graphs.SimpleGraphs.SimpleDiGraph{Int64}, _A, _B, _C, Nothing, Mycelia.var&quot;#270#272&quot;, Float64} where {_A, _B, _C}
</code></pre><p>Convert a k-mer graph to a BioSequence graph by collapsing linear paths.</p><p>This is the primary method for creating BioSequence graphs from k-mer graphs, following the 6-graph hierarchy where BioSequence graphs are simplifications of k-mer graphs.</p><p><strong>Arguments</strong></p><ul><li><code>kmer_graph</code>: MetaGraphsNext k-mer graph to convert</li><li><code>min_path_length</code>: Minimum path length to keep (default: 2)</li></ul><p><strong>Returns</strong></p><ul><li>MetaGraphsNext.MetaGraph with BioSequence vertices</li></ul><p><strong>Example</strong></p><pre><code class="language-julia hljs"># Start with k-mer graph
kmer_graph = build_kmer_graph_next(BioSequences.DNAKmer{31}, fasta_records)

# Convert to BioSequence graph
biosequence_graph = kmer_graph_to_biosequence_graph(kmer_graph)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/fasta-graphs.jl#LL120">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.kmer_path_to_biosequence-Tuple{Vector{&lt;:Kmers.Kmer}}" href="#Mycelia.kmer_path_to_biosequence-Tuple{Vector{&lt;:Kmers.Kmer}}"><code>Mycelia.kmer_path_to_biosequence</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Convert k-mer path back to BioSequence.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/iterative-assembly.jl#LL1238-L1240">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.kmer_path_to_sequence-Tuple{Any}" href="#Mycelia.kmer_path_to_sequence-Tuple{Any}"><code>Mycelia.kmer_path_to_sequence</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">kmer_path_to_sequence(kmer_path) -&gt; Any
</code></pre><p>Convert a path of overlapping k-mers into a single DNA sequence.</p><p><strong>Arguments</strong></p><ul><li><code>kmer_path</code>: Vector of k-mers (DNA sequences) where each consecutive pair overlaps by k-1 bases</li></ul><p><strong>Returns</strong></p><ul><li><code>BioSequences.LongDNA{2}</code>: Assembled DNA sequence from the k-mer path</li></ul><p><strong>Description</strong></p><p>Reconstructs the original DNA sequence by joining k-mers, validating that consecutive k-mers  overlap correctly. The first k-mer is used in full, then each subsequent k-mer contributes  its last base.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/sequence-graphs.jl#LL258">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.kmer_quality_score" href="#Mycelia.kmer_quality_score"><code>Mycelia.kmer_quality_score</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">kmer_quality_score(base_qualities::Vector{Float64}) -&gt; Any
kmer_quality_score(
    base_qualities::Vector{Float64},
    method::Symbol
) -&gt; Any
</code></pre><p>Calculate kmer quality score using the specified aggregation method.</p><p>Available methods:</p><ul><li><code>:min</code>: Use the minimum base quality (default)</li><li><code>:mean</code>: Use the mean of all base qualities</li><li><code>:geometric</code>: Use the geometric mean (appropriate for probabilities)</li><li><code>:harmonic</code>: Use the harmonic mean (emphasizes lower values)</li></ul><p><strong>Arguments</strong></p><ul><li><code>base_qualities::Vector{Float64}</code>: Vector of quality scores for each base</li><li><code>method::Symbol</code>: Method to use for aggregation</li></ul><p><strong>Returns</strong></p><ul><li><code>Float64</code>: Overall quality score for the kmer</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/kmer-analysis.jl#LL165">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.kmer_space_size" href="#Mycelia.kmer_space_size"><code>Mycelia.kmer_space_size</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">kmer_space_size(k::Integer) -&gt; Any
kmer_space_size(k::Integer, alphabet_size::Integer) -&gt; Any
</code></pre><p>Calculate the theoretical k-mer space size for a given k-mer length and alphabet size.</p><p><strong>Arguments</strong></p><ul><li><code>k::Integer</code>: K-mer length</li><li><code>alphabet_size::Integer=4</code>: Size of the alphabet (defaults to 4 for DNA: A,C,G,T)</li></ul><p><strong>Returns</strong></p><ul><li><code>Integer</code>: Total number of possible k-mers (alphabet_size^k)</li></ul><p><strong>Details</strong></p><p>For DNA sequences (alphabet_size=4), this computes 4^k. Useful for:</p><ul><li>Memory estimation for k-mer analysis</li><li>Parameter validation and selection</li><li>Understanding computational complexity</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia hljs"># DNA 3-mers: 4^3 = 64 possible k-mers
kmer_space_size(3)

# Protein 5-mers: 20^5 = 3,200,000 possible k-mers  
kmer_space_size(5, 20)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/utility-functions.jl#LL1931">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.ks-Tuple{}" href="#Mycelia.ks-Tuple{}"><code>Mycelia.ks</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ks(; min, max) -&gt; Vector{Int64}
</code></pre><p>Generates a specialized sequence of prime numbers combining:</p><ul><li>Odd primes up to 23 (flip_point)</li><li>Primes nearest to Fibonacci numbers above 23 up to max</li></ul><p><strong>Arguments</strong></p><ul><li><code>min::Int=0</code>: Lower bound for the sequence</li><li><code>max::Int=10_000</code>: Upper bound for the sequence</li></ul><p><strong>Returns</strong></p><p>Vector of Int containing the specialized prime sequence</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/kmer-analysis.jl#LL2055">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.lawrencium_sbatch-Tuple{}" href="#Mycelia.lawrencium_sbatch-Tuple{}"><code>Mycelia.lawrencium_sbatch</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">lawrencium_sbatch(
;
    job_name,
    mail_user,
    mail_type,
    logdir,
    partition,
    qos,
    account,
    nodes,
    ntasks,
    time,
    cpus_per_task,
    mem_gb,
    cmd
)
</code></pre><p>Submit a job to SLURM scheduler on Lawrence Berkeley Lab&#39;s Lawrencium cluster.</p><p><strong>Arguments</strong></p><ul><li><code>job_name</code>: Name identifier for the SLURM job</li><li><code>mail_user</code>: Email address for job notifications</li><li><code>mail_type</code>: Notification type (&quot;ALL&quot;, &quot;BEGIN&quot;, &quot;END&quot;, &quot;FAIL&quot;, or &quot;NONE&quot;)</li><li><code>logdir</code>: Directory for SLURM output and error logs</li><li><code>partition</code>: Lawrencium compute partition</li><li><code>qos</code>: Quality of Service level</li><li><code>account</code>: Project account for billing</li><li><code>nodes</code>: Number of nodes to allocate</li><li><code>ntasks</code>: Number of tasks to spawn</li><li><code>time</code>: Wall time limit in format &quot;days-hours:minutes:seconds&quot;</li><li><code>cpus_per_task</code>: CPU cores per task</li><li><code>mem_gb</code>: Memory per node in GB</li><li><code>cmd</code>: Shell command to execute</li></ul><p><strong>Returns</strong></p><ul><li><code>true</code> if submission was successful</li></ul><p><strong>Note</strong></p><p>Function includes 5-second delays before and after submission for queue stability.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/slurm-sbatch.jl#LL1">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.legacy_to_next_graph" href="#Mycelia.legacy_to_next_graph"><code>Mycelia.legacy_to_next_graph</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">legacy_to_next_graph(
    legacy_graph
) -&gt; MetaGraphsNext.MetaGraph{Int64, Graphs.SimpleGraphs.SimpleDiGraph{Int64}, _A, _B, _C, Nothing, Mycelia.var&quot;#147#148&quot;, Float64} where {_A, _B, _C}
legacy_to_next_graph(
    legacy_graph,
    kmer_type
) -&gt; MetaGraphsNext.MetaGraph{Int64, Graphs.SimpleGraphs.SimpleDiGraph{Int64}, _A, _B, _C, Nothing, Mycelia.var&quot;#147#148&quot;, Float64} where {_A, _B, _C}
</code></pre><p>Convert a legacy MetaGraphs-based k-mer graph to the next-generation MetaGraphsNext format.</p><p>This function provides a migration path from the deprecated MetaGraphs.jl implementation to the new type-stable MetaGraphsNext.jl format.</p><p><strong>Arguments</strong></p><ul><li><code>legacy_graph</code>: MetaGraphs.MetaDiGraph from the old implementation</li></ul><p><strong>Returns</strong></p><ul><li><code>MetaGraphsNext.MetaGraph</code> with equivalent structure and type-stable metadata</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/sequence-graphs-next.jl#LL358">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.list_blastdbs-Tuple{}" href="#Mycelia.list_blastdbs-Tuple{}"><code>Mycelia.list_blastdbs</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">list_blastdbs(; source) -&gt; DataFrames.DataFrame
</code></pre><p>Lists available BLAST databases from the specified source.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/reference-databases.jl#LL1223">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.list_classes-Tuple{}" href="#Mycelia.list_classes-Tuple{}"><code>Mycelia.list_classes</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">list_classes() -&gt; DataFrames.DataFrame
</code></pre><p>Returns an array of all taxonomic classes in the database.</p><p>Classes represent a major taxonomic rank between phylum and order in biological classification.</p><p><strong>Returns</strong></p><ul><li><code>Vector{String}</code>: Array of class names sorted alphabetically</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/taxonomy-and-trees.jl#LL763">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.list_databases-Tuple{}" href="#Mycelia.list_databases-Tuple{}"><code>Mycelia.list_databases</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">list_databases(; address, username, password)
</code></pre><p>Lists all available Neo4j databases on the specified server.</p><p><strong>Arguments</strong></p><ul><li><code>address::String</code>: Neo4j server address (e.g. &quot;neo4j://localhost:7687&quot;)</li><li><code>username::String=&quot;neo4j&quot;</code>: Neo4j authentication username</li><li><code>password::String</code>: Neo4j authentication password</li></ul><p><strong>Returns</strong></p><ul><li><code>DataFrame</code>: Contains database information with columns typically including:<ul><li>name: Database name</li><li>address: Database address</li><li>role: Database role (e.g., primary, secondary)</li><li>status: Current status (e.g., online, offline)</li><li>default: Boolean indicating if it&#39;s the default database</li></ul></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/neo4jl.jl#LL486">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.list_families-Tuple{}" href="#Mycelia.list_families-Tuple{}"><code>Mycelia.list_families</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">list_families() -&gt; DataFrames.DataFrame
</code></pre><p>Returns a sorted vector of all family names present in the database.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/taxonomy-and-trees.jl#LL792">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.list_full_taxonomy-Tuple{}" href="#Mycelia.list_full_taxonomy-Tuple{}"><code>Mycelia.list_full_taxonomy</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">list_full_taxonomy() -&gt; DataFrames.DataFrame
</code></pre><p>Retrieves and formats the complete NCBI taxonomy hierarchy into a structured DataFrame.</p><p><strong>Details</strong></p><ul><li>Automatically sets up taxonkit environment and downloads taxonomy database if needed</li><li>Starts from root taxid (1) and includes all descendant taxa</li><li>Reformats lineage information into separate columns for each taxonomic rank</li></ul><p><strong>Returns</strong></p><p>DataFrame with columns:</p><ul><li><code>taxid</code>: Taxonomy identifier</li><li><code>lineage</code>: Full taxonomic lineage string</li><li><code>taxid_lineage</code>: Lineage with taxonomy IDs</li><li>Individual rank columns:<ul><li>superkingdom, kingdom, phylum, class, order, family, genus, species</li><li>corresponding taxid columns (e.g., superkingdom_taxid)</li></ul></li></ul><p><strong>Dependencies</strong></p><p>Requires taxonkit (installed automatically via Bioconda)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/taxonomy-and-trees.jl#LL560">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.list_genera-Tuple{}" href="#Mycelia.list_genera-Tuple{}"><code>Mycelia.list_genera</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">list_genera() -&gt; DataFrames.DataFrame
</code></pre><p>Returns a sorted vector of all genera names present in the database.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/taxonomy-and-trees.jl#LL801">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.list_kingdoms-Tuple{}" href="#Mycelia.list_kingdoms-Tuple{}"><code>Mycelia.list_kingdoms</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">list_kingdoms() -&gt; DataFrames.DataFrame
</code></pre><p>Lists all taxonomic kingdoms in the database.</p><p>Returns a vector of kingdom names as strings. Kingdoms represent the highest major taxonomic rank in biological classification.</p><p><strong>Returns</strong></p><ul><li><code>Vector{String}</code>: Array of kingdom names</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/taxonomy-and-trees.jl#LL739">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.list_orders-Tuple{}" href="#Mycelia.list_orders-Tuple{}"><code>Mycelia.list_orders</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">list_orders() -&gt; DataFrames.DataFrame
</code></pre><p>Lists all orders in the taxonomic database.</p><p>Returns a vector of strings containing valid order names according to current mycological taxonomy. Uses the underlying <code>list_rank()</code> function with rank=&quot;order&quot;.</p><p><strong>Returns</strong></p><ul><li><code>Vector{String}</code>: Alphabetically sorted list of order names</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/taxonomy-and-trees.jl#LL777">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.list_phylums-Tuple{}" href="#Mycelia.list_phylums-Tuple{}"><code>Mycelia.list_phylums</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">list_phylums() -&gt; DataFrames.DataFrame
</code></pre><p>Returns a sorted list of all unique phyla in the database.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/taxonomy-and-trees.jl#LL754">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.list_rank-Tuple{Any}" href="#Mycelia.list_rank-Tuple{Any}"><code>Mycelia.list_rank</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">list_rank(rank) -&gt; DataFrames.DataFrame
</code></pre><p>List all taxonomic entries at the specified rank level.</p><p><strong>Arguments</strong></p><ul><li><code>rank::String</code>: Taxonomic rank to query. Must be one of:<ul><li>&quot;top&quot; (top level)</li><li>&quot;superkingdom&quot;/&quot;domain&quot;  </li><li>&quot;kingdom&quot;</li><li>&quot;phylum&quot; </li><li>&quot;class&quot;</li><li>&quot;order&quot;</li><li>&quot;family&quot;</li><li>&quot;genus&quot;</li><li>&quot;species&quot;</li></ul></li></ul><p><strong>Returns</strong></p><p>DataFrame with columns:</p><ul><li><code>taxid</code>: NCBI taxonomy ID</li><li><code>name</code>: Scientific name at the specified rank</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/taxonomy-and-trees.jl#LL677">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.list_ranks-Tuple{}" href="#Mycelia.list_ranks-Tuple{}"><code>Mycelia.list_ranks</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">list_ranks(; synonyms) -&gt; Vector{String}
</code></pre><p>Return an ordered list of taxonomic ranks from highest (top) to lowest (species).</p><p><strong>Arguments</strong></p><ul><li><code>synonyms::Bool=false</code>: If true, includes alternative names for certain ranks (e.g. &quot;domain&quot; for &quot;superkingdom&quot;)</li></ul><p><strong>Returns</strong></p><ul><li><code>Vector{String}</code>: An array of taxonomic rank names in hierarchical order</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/taxonomy-and-trees.jl#LL618">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.list_species-Tuple{}" href="#Mycelia.list_species-Tuple{}"><code>Mycelia.list_species</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">list_species() -&gt; DataFrames.DataFrame
</code></pre><p>Returns a sorted vector of all species names present in the database.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/taxonomy-and-trees.jl#LL810">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.list_subtaxa-Tuple{Any}" href="#Mycelia.list_subtaxa-Tuple{Any}"><code>Mycelia.list_subtaxa</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">list_subtaxa(taxid) -&gt; Vector{Int64}
</code></pre><p>Returns an array of Integer taxon IDs representing all sub-taxa under the specified taxonomic ID.</p><p><strong>Arguments</strong></p><ul><li><code>taxid</code>: NCBI taxonomy identifier for the parent taxon</li></ul><p><strong>Returns</strong></p><p>Vector{Int} containing all descendant taxon IDs</p><p><strong>Details</strong></p><ul><li>Requires taxonkit to be installed via Bioconda</li><li>Automatically sets up taxonkit database if not present</li><li>Uses local taxonomy database in ~/.taxonkit/</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/taxonomy-and-trees.jl#LL826">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.list_superkingdoms-Tuple{}" href="#Mycelia.list_superkingdoms-Tuple{}"><code>Mycelia.list_superkingdoms</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">list_superkingdoms() -&gt; DataFrames.DataFrame
</code></pre><p>Returns an array of all taxonomic superkingdoms (e.g., Bacteria, Archaea, Eukaryota).</p><p><strong>Returns</strong></p><ul><li><code>Vector{String}</code>: Array containing names of all superkingdoms in the taxonomy database</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/taxonomy-and-trees.jl#LL727">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.list_toplevel-Tuple{}" href="#Mycelia.list_toplevel-Tuple{}"><code>Mycelia.list_toplevel</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">list_toplevel() -&gt; DataFrames.DataFrame
</code></pre><p>Returns a DataFrame containing the top-level taxonomic nodes.</p><p>The DataFrame has two fixed rows representing the most basic taxonomic classifications:</p><ul><li>taxid=0: &quot;unclassified&quot;</li><li>taxid=1: &quot;root&quot;</li></ul><p><strong>Returns</strong></p><p>DataFrame     Columns:     - taxid::Int : Taxonomic identifier     - name::String : Node name</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/taxonomy-and-trees.jl#LL657">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.load_blast_db_taxonomy_table-Tuple{Any}" href="#Mycelia.load_blast_db_taxonomy_table-Tuple{Any}"><code>Mycelia.load_blast_db_taxonomy_table</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">load_blast_db_taxonomy_table(
    compressed_blast_db_taxonomy_table_file
) -&gt; DataFrames.DataFrame
</code></pre><p>Loads a BLAST database taxonomy mapping table from a gzipped file into a DataFrame.</p><p><strong>Arguments</strong></p><ul><li><code>compressed_blast_db_taxonomy_table_file::String</code>: Path to a gzipped file containing BLAST taxonomy mappings</li></ul><p><strong>Returns</strong></p><ul><li><code>DataFrame</code>: A DataFrame with columns <code>:sequence_id</code> and <code>:taxid</code> containing the sequence-to-taxonomy mappings</li></ul><p><strong>Format</strong></p><p>Input file should be a space-delimited text file (gzipped) with two columns:</p><ol><li>sequence identifier</li><li>taxonomy identifier (taxid)</li></ol></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/reference-databases.jl#LL2607">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.load_df_jld2-Tuple{String}" href="#Mycelia.load_df_jld2-Tuple{String}"><code>Mycelia.load_df_jld2</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">load_df_jld2(filename::String; key) -&gt; Any
</code></pre><pre><code class="nohighlight hljs">load_df_jld2(filename::String; key::String=&quot;dataframe&quot;) -&gt; DataFrames.DataFrame</code></pre><p>Load a DataFrame from a JLD2 file.</p><p><strong>Arguments</strong></p><ul><li><code>filename</code>: Path to the JLD2 file (will add .jld2 extension if not present)</li><li><code>key</code>: The name of the dataset within the JLD2 file (defaults to &quot;dataframe&quot;)</li></ul><p><strong>Returns</strong></p><ul><li>The loaded DataFrame</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia hljs">df = load_df_jld2(&quot;mydata&quot;)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/utility-functions.jl#LL832">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.load_genbank_metadata-Tuple{}" href="#Mycelia.load_genbank_metadata-Tuple{}"><code>Mycelia.load_genbank_metadata</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">load_genbank_metadata() -&gt; DataFrames.DataFrame
</code></pre><p>Load metadata for GenBank sequences into a DataFrame.</p><p>This is a convenience wrapper around <code>load_ncbi_metadata(&quot;genbank&quot;)</code> that specifically loads metadata from the GenBank database.</p><p><strong>Returns</strong></p><ul><li><code>DataFrame</code>: Contains metadata fields like accession numbers, taxonomy,</li></ul><p>and sequence information from GenBank.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/reference-databases.jl#LL2008">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.load_graph-Tuple{Any}" href="#Mycelia.load_graph-Tuple{Any}"><code>Mycelia.load_graph</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">load_graph(file) -&gt; Any
</code></pre><p>Load a graph structure from a serialized file.</p><p><strong>Arguments</strong></p><ul><li><code>file::AbstractString</code>: Path to the file containing the serialized graph data</li></ul><p><strong>Returns</strong></p><ul><li>The deserialized graph object</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/sequence-graphs.jl#LL929">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.load_graph-Tuple{String}" href="#Mycelia.load_graph-Tuple{String}"><code>Mycelia.load_graph</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">load_graph(file::String) -&gt; Any
</code></pre><p>Loads a graph object from a serialized file.</p><p><strong>Arguments</strong></p><ul><li><code>file::String</code>: Path to the file containing the serialized graph data. The file should have been created using <code>save_graph</code>.</li></ul><p><strong>Returns</strong></p><ul><li>The deserialized graph object stored under the &quot;graph&quot; key.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/sequence-graphs.jl#LL725">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.load_jellyfish_counts-Tuple{Any}" href="#Mycelia.load_jellyfish_counts-Tuple{Any}"><code>Mycelia.load_jellyfish_counts</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">load_jellyfish_counts(jellyfish_counts) -&gt; Any
</code></pre><p>Load k-mer counts from a Jellyfish output file into a DataFrame.</p><p><strong>Arguments</strong></p><ul><li><code>jellyfish_counts::String</code>: Path to a gzipped TSV file (*.jf.tsv.gz) containing Jellyfish k-mer counts</li></ul><p><strong>Returns</strong></p><ul><li><code>DataFrame</code>: Table with columns:<ul><li><code>kmer</code>: Biologically encoded k-mers as <code>DNAKmer{k}</code> objects</li><li><code>count</code>: Integer count of each k-mer&#39;s occurrences</li></ul></li></ul><p><strong>Notes</strong></p><ul><li>Input file must be a gzipped TSV with exactly two columns (k-mer sequences and counts)</li><li>K-mer length is automatically detected from the first entry</li><li>Filename must end with &#39;.jf.tsv.gz&#39;</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/kmer-analysis.jl#LL328">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.load_jld2-Tuple{Any}" href="#Mycelia.load_jld2-Tuple{Any}"><code>Mycelia.load_jld2</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">load_jld2(filename) -&gt; Any
</code></pre><p>Load data stored in a JLD2 file format.</p><p><strong>Arguments</strong></p><ul><li><code>filename::String</code>: Path to the JLD2 file to load</li></ul><p><strong>Returns</strong></p><ul><li><code>Dict</code>: Dictionary containing the loaded data structures</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/utility-functions.jl#LL1864">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.load_kmer_results-Tuple{AbstractString}" href="#Mycelia.load_kmer_results-Tuple{AbstractString}"><code>Mycelia.load_kmer_results</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">load_kmer_results(
    filename::AbstractString
) -&gt; Union{Nothing, NamedTuple{(:kmers, :counts, :fasta_list, :metadata), &lt;:Tuple{Any, Any, Any, Dict{String, Any}}}}
</code></pre><p>Load kmer counting results previously saved with <code>save_kmer_results</code>.</p><p><strong>Arguments</strong></p><ul><li><code>filename::AbstractString</code>: Path to the input JLD2 file.</li></ul><p><strong>Returns</strong></p><ul><li><code>NamedTuple</code>: Contains the loaded <code>kmers</code>, <code>counts</code>, <code>fasta_list</code>, and <code>metadata</code>. Returns <code>nothing</code> if the file cannot be loaded or essential keys are missing.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/kmer-analysis.jl#LL54">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.load_matrix_jld2-Tuple{Any}" href="#Mycelia.load_matrix_jld2-Tuple{Any}"><code>Mycelia.load_matrix_jld2</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">load_matrix_jld2(filename) -&gt; Any
</code></pre><p>Loads a matrix from a JLD2 file.</p><p><strong>Arguments</strong></p><ul><li><code>filename::String</code>: Path to the JLD2 file containing the matrix under the key &quot;matrix&quot;</li></ul><p><strong>Returns</strong></p><ul><li><code>Matrix</code>: The loaded matrix data</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/utility-functions.jl#LL1849">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.load_ncbi_metadata-Tuple{String}" href="#Mycelia.load_ncbi_metadata-Tuple{String}"><code>Mycelia.load_ncbi_metadata</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">load_ncbi_metadata(db::String) -&gt; DataFrames.DataFrame
</code></pre><p>Load and parse NCBI assembly summary metadata (GenBank/RefSeq), using a daily cache.</p><p>Checks for <code>homedir()/workspace/.ncbi/YYYY-MM-DD.assembly_summary_{db}.txt</code>. Uses the cache if valid (exists, readable, not empty). Otherwise, downloads from NCBI using <code>Downloads.download()</code>, caches the result (replacing any previous version for the <em>same day</em>), and then parses the cached file.</p><p>Handles NCBI&#39;s header format and uses CSV.jl for parsing.</p><p><strong>Arguments</strong></p><ul><li><code>db::String</code>: Database source (&quot;genbank&quot; or &quot;refseq&quot;).</li></ul><p><strong>Returns</strong></p><ul><li><code>DataFrames.DataFrame</code>: Parsed metadata table.</li></ul><p><strong>Errors</strong></p><ul><li>Throws <code>ArgumentError</code> for invalid <code>db</code>.</li><li>Throws error if cache directory cannot be created.</li><li>Throws error if data cannot be obtained from cache or download.</li><li>Rethrows errors from <code>Downloads.download</code> or CSV parsing.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/reference-databases.jl#LL1832">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.load_ncbi_taxonomy-Tuple{}" href="#Mycelia.load_ncbi_taxonomy-Tuple{}"><code>Mycelia.load_ncbi_taxonomy</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">load_ncbi_taxonomy(
;
    path_to_taxdump
) -&gt; MetaGraphs.MetaDiGraph{T, Float64} where T&lt;:Integer
</code></pre><p>Downloads and constructs a MetaDiGraph representation of the NCBI taxonomy database.</p><p><strong>Arguments</strong></p><ul><li><code>path_to_taxdump</code>: Directory path where taxonomy files will be downloaded and extracted</li></ul><p><strong>Returns</strong></p><ul><li><code>MetaDiGraph</code>: A directed graph where:<ul><li>Vertices represent taxa with properties:<ul><li><code>:tax_id</code>: NCBI taxonomy identifier</li><li><code>:scientific_name</code>, <code>:common_name</code>, etc.: Name properties</li><li><code>:rank</code>: Taxonomic rank</li><li><code>:division_id</code>, <code>:division_cde</code>, <code>:division_name</code>: Division information</li></ul></li><li>Edges represent parent-child relationships in the taxonomy</li></ul></li></ul><p><strong>Dependencies</strong></p><p>Requires internet connection for initial download. Uses DataFrames, MetaGraphs, and ProgressMeter.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/reference-databases.jl#LL2103">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.load_refseq_metadata-Tuple{}" href="#Mycelia.load_refseq_metadata-Tuple{}"><code>Mycelia.load_refseq_metadata</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">load_refseq_metadata() -&gt; DataFrames.DataFrame
</code></pre><p>Loads NCBI RefSeq metadata into a DataFrame. RefSeq is NCBI&#39;s curated collection  of genomic, transcript and protein sequences.</p><p><strong>Returns</strong></p><ul><li><code>DataFrame</code>: Contains metadata columns including accession numbers, taxonomic information,</li></ul><p>and sequence details from RefSeq.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/reference-databases.jl#LL1994">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.local_blast_database_info-Tuple{}" href="#Mycelia.local_blast_database_info-Tuple{}"><code>Mycelia.local_blast_database_info</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">local_blast_database_info(; blastdbs_dir) -&gt; Any
</code></pre><p>Query information about local BLAST databases and return a formatted summary.</p><p><strong>Arguments</strong></p><ul><li><code>blastdbs_dir::String</code>: Directory containing BLAST databases (default: &quot;~/workspace/blastdb&quot;)</li></ul><p><strong>Returns</strong></p><ul><li><code>DataFrame</code> with columns:<ul><li>BLAST database path</li><li>BLAST database molecule type</li><li>BLAST database title</li><li>date of last update</li><li>number of bases/residues</li><li>number of sequences</li><li>number of bytes</li><li>BLAST database format version</li><li>human readable size</li></ul></li></ul><p><strong>Dependencies</strong></p><p>Requires NCBI BLAST+ tools. Will attempt to install via apt-get if not present.</p><p><strong>Side Effects</strong></p><ul><li>May install system packages (ncbi-blast+, perl-doc) using sudo/apt-get</li><li>Filters out numbered database fragments from results</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/reference-databases.jl#LL1273">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.logistic_pca_epca-Tuple{AbstractMatrix{Bool}}" href="#Mycelia.logistic_pca_epca-Tuple{AbstractMatrix{Bool}}"><code>Mycelia.logistic_pca_epca</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">logistic_pca_epca(M::AbstractMatrix{Bool}; k::Int=0)</code></pre><p>Synonym for <code>bernoulli_pca_epca(M; k=k)</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/dimensionality-reduction.jl#LL181-L185">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.mash_distance_from_jaccard-Tuple{Float64, Int64}" href="#Mycelia.mash_distance_from_jaccard-Tuple{Float64, Int64}"><code>Mycelia.mash_distance_from_jaccard</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mash_distance_from_jaccard(jaccard_index::Float64, kmer_size::Int)</code></pre><p>Calculates the Mash distance (an estimate of Average Nucleotide Identity) from a given Jaccard Index and k-mer size.</p><p><strong>Arguments</strong></p><ul><li><code>jaccard_index::Float64</code>: The Jaccard similarity between the two k-mer sets. Must be between 0.0 and 1.0.</li><li><code>kmer_size::Int</code>: The length of k-mers used to calculate the Jaccard index.</li></ul><p><strong>Returns</strong></p><ul><li><code>Float64</code>: The estimated Mash distance <code>D</code>. The estimated ANI would be <code>1.0 - D</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/sequence-comparison.jl#LL95-L107">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.maximum_weight_walk_next-Tuple{MetaGraphsNext.MetaGraph, String, Int64}" href="#Mycelia.maximum_weight_walk_next-Tuple{MetaGraphsNext.MetaGraph, String, Int64}"><code>Mycelia.maximum_weight_walk_next</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">maximum_weight_walk_next(
    graph::MetaGraphsNext.MetaGraph,
    start_vertex::String,
    max_steps::Int64;
    weight_function
) -&gt; Mycelia.GraphPath
</code></pre><p>Perform a maximum weight walk prioritizing highest confidence edges.</p><p>This greedy algorithm always chooses the edge with the highest weight (coverage) at each step, useful for finding high-confidence assembly paths.</p><p><strong>Arguments</strong></p><ul><li><code>graph</code>: MetaGraphsNext k-mer graph</li><li><code>start_vertex</code>: Starting vertex label</li><li><code>max_steps</code>: Maximum steps to take</li><li><code>weight_function</code>: Function to extract weight from edge data (default: uses edge.weight)</li></ul><p><strong>Returns</strong></p><ul><li><code>GraphPath</code>: Path following maximum weight edges</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/sequence-graphs-next.jl#LL2174">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.merge_and_map_single_end_samples-Tuple{}" href="#Mycelia.merge_and_map_single_end_samples-Tuple{}"><code>Mycelia.merge_and_map_single_end_samples</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">merge_and_map_single_end_samples(; 
    fasta_reference::AbstractString, 
    fastq_list::Vector{&lt;:AbstractString}, 
    minimap_index::AbstractString, 
    mapping_type::AbstractString,
    outbase::AbstractString = &quot;results&quot;,
    outformats::Vector{&lt;:AbstractString} = [&quot;.tsv.gz&quot;, &quot;.jld2&quot;]
) -&gt; DataFrames.DataFrame</code></pre><p>Merge and map single-end sequencing samples, then output results in one or more formats.</p><p><strong>Arguments</strong></p><ul><li><code>fasta_reference</code>: Path to the reference FASTA file.</li><li><code>fastq_list</code>: Vector of paths to input FASTQ files to be merged.</li><li><code>minimap_index</code>: Path to the minimap2 index file (.mmi).</li><li><code>mapping_type</code>: Mapping type string for minimap2 (e.g., &quot;map-ont&quot;).</li><li><code>outbase</code>: Base name (optionally including path) for output files (default: <code>Mycelia.normalized_current_date() * &quot;.joint-minimap-mapping-results&quot;</code>).</li><li><code>outformats</code>: Vector of output file formats to write results to. Supported: <code>&quot;.tsv.gz&quot;</code>, <code>&quot;.jld2&quot;</code>.</li></ul><p><strong>Description</strong></p><p>This function merges provided FASTQ files and assigns unique UUIDs to reads, maps the merged FASTQ against the provided reference using minimap2, reads mapping and UUID tables, joins them into a single DataFrame, writes this table to all requested output formats with filenames constructed from the <code>outbase</code> and the appropriate extension, and returns the resulting joined DataFrame.</p><p><strong>Output Files</strong></p><ul><li><code>.tsv.gz</code>: Tab-separated, gzip-compressed table of results.</li><li><code>&quot;.jld2&quot;</code>: JLD2 file containing results.</li></ul><p><strong>Returns</strong></p><ul><li>The joined results as a <code>DataFrames.DataFrame</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/sequence-comparison.jl#LL1-L30">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.merge_colors-Tuple{Any, Any}" href="#Mycelia.merge_colors-Tuple{Any, Any}"><code>Mycelia.merge_colors</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">merge_colors(c1, c2) -&gt; Any
</code></pre><p>Merge two colors by calculating their minimal color difference vector.</p><p><strong>Arguments</strong></p><ul><li><code>c1::Color</code>: First color input</li><li><code>c2::Color</code>: Second color input </li></ul><p><strong>Returns</strong></p><ul><li>If colors are equal, returns the input color</li><li>Otherwise returns the color difference vector (c1-c2 or c2-c1) with minimal RGB sum</li></ul><p><strong>Details</strong></p><p>Calculates two difference vectors:</p><ul><li>mix_a = c1 - c2 </li><li>mix_b = c2 - c1</li></ul><p>Returns the difference vector with the smallest sum of RGB components.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/plotting-and-visualization.jl#LL1355">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.merge_fasta_files-Tuple{}" href="#Mycelia.merge_fasta_files-Tuple{}"><code>Mycelia.merge_fasta_files</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">merge_fasta_files(; fasta_files, fasta_file)
</code></pre><p>Join fasta files while adding origin prefixes to the identifiers.</p><p>Does not guarantee uniqueness but will warn if conflicts arise</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/fastx.jl#LL961">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.merge_overlapping_repeats-Tuple{Vector{Mycelia.RepeatRegion}}" href="#Mycelia.merge_overlapping_repeats-Tuple{Vector{Mycelia.RepeatRegion}}"><code>Mycelia.merge_overlapping_repeats</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Merge overlapping repeat regions.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/sequence-graphs-next.jl#LL1660-L1662">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.merge_repeat_regions-Tuple{Vector{Mycelia.RepeatRegion}}" href="#Mycelia.merge_repeat_regions-Tuple{Vector{Mycelia.RepeatRegion}}"><code>Mycelia.merge_repeat_regions</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Merge multiple repeat regions into one.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/sequence-graphs-next.jl#LL1708-L1710">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.merge_xam_with_taxonomies-Tuple{}" href="#Mycelia.merge_xam_with_taxonomies-Tuple{}"><code>Mycelia.merge_xam_with_taxonomies</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Merge XAM alignment data with taxonomic information and calculate alignment metrics.</p><p>This function processes XAM alignment data by:</p><ol><li>Loading an accession-to-taxid mapping table</li><li>Left-joining alignment data with taxonomic IDs</li><li>Retrieving full taxonomic lineage information</li><li>Calculating percent identity scores</li><li>Calculating relative alignment score proportions per read</li><li>Writing results to cached files</li></ol><p><strong>Arguments</strong></p><ul><li><code>xam</code>: Path to XAM file or XAM data structure</li><li><code>accession2taxid_file</code>: Path to accession-to-taxid mapping file (.tsv.gz or .arrow)</li><li><code>output_prefix</code>: Prefix for output files (.tsv.gz and .arrow). Defaults to &quot;xam&quot;</li><li><code>verbose::Bool=true</code>: Whether to print progress information</li><li><code>force_recalculate::Bool=false</code>: Whether to force recalculation even if cached files exist</li></ul><p><strong>Returns</strong></p><p>A NamedTuple with paths to the output files: (tsv<em>out, arrow</em>out)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/taxonomy-and-trees.jl#LL59-L79">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.metasha256-Tuple{Vector{&lt;:AbstractString}}" href="#Mycelia.metasha256-Tuple{Vector{&lt;:AbstractString}}"><code>Mycelia.metasha256</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">metasha256(
    vector_of_sha256s::Vector{&lt;:AbstractString}
) -&gt; String
</code></pre><p>Compute a single SHA256 hash from multiple SHA256 hashes.</p><p>Takes a vector of hex-encoded SHA256 hashes and produces a new SHA256 hash by:</p><ol><li>Sorting the input hashes lexicographically</li><li>Concatenating them in sorted order</li><li>Computing a new SHA256 hash over the concatenated data</li></ol><p><strong>Arguments</strong></p><ul><li><code>vector_of_sha256s</code>: Vector of hex-encoded SHA256 hash strings</li></ul><p><strong>Returns</strong></p><ul><li>A hex-encoded string representing the computed meta-hash</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/utility-functions.jl#LL1557">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.minimap_index-Tuple{}" href="#Mycelia.minimap_index-Tuple{}"><code>Mycelia.minimap_index</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">minimap_index(
;
    fasta,
    mapping_type,
    mem_gb,
    threads,
    as_string,
    denominator
)
</code></pre><p>Create a minimap2 index for the provided reference sequence.</p><p><strong>Arguments</strong></p><ul><li><code>fasta::String</code>: Path to the reference FASTA.</li><li><code>mapping_type::String</code>: Preset (e.g. <code>&quot;map-hifi&quot;</code>).</li><li><code>mem_gb::Real</code>: Memory available in GB.</li><li><code>threads::Integer</code>: Number of threads.</li><li><code>as_string::Bool=false</code>: If true, return the command string instead of <code>Cmd</code>.</li><li><code>denominator::Real</code>: Scaling factor passed to <code>system_mem_to_minimap_index_size</code>.</li></ul><p><strong>Returns</strong></p><p>Named tuple <code>(cmd, outfile)</code> where <code>outfile</code> is the generated <code>.mmi</code> index path.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/alignments-and-mapping.jl#LL481">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.minimap_map-Tuple{}" href="#Mycelia.minimap_map-Tuple{}"><code>Mycelia.minimap_map</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">minimap_map(
;
    fasta,
    fastq,
    mapping_type,
    as_string,
    mem_gb,
    threads,
    denominator
)
</code></pre><p>Generate minimap2 alignment commands for sequence mapping.</p><p>aligning and compressing. No sorting or filtering.</p><p>Use shell_only=true to get string command to submit to SLURM</p><p>Creates a command to align reads in FASTQ format to a reference FASTA using minimap2,  followed by SAM compression with pigz. Handles resource allocation and conda environment setup.</p><p><strong>Arguments</strong></p><ul><li><code>fasta</code>: Path to reference FASTA file</li><li><code>fastq</code>: Path to query FASTQ file</li><li><code>mapping_type</code>: Alignment preset (&quot;map-hifi&quot;, &quot;map-ont&quot;, &quot;map-pb&quot;, &quot;sr&quot;, or &quot;lr:hq&quot;)</li><li><code>as_string</code>: If true, returns shell command as string; if false, returns command array</li><li><code>mem_gb</code>: Available memory in GB for indexing (defaults to system free memory)</li><li><code>threads</code>: Number of CPU threads to use (defaults to system threads)</li><li><code>denominator</code>: Divisor for calculating minimap2 index size</li></ul><p><strong>Returns</strong></p><p>Named tuple containing:</p><ul><li><code>cmd</code>: Shell command (as string or array)</li><li><code>outfile</code>: Path to compressed output SAM file</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/alignments-and-mapping.jl#LL567">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.minimap_map_paired_end_with_index-Tuple{}" href="#Mycelia.minimap_map_paired_end_with_index-Tuple{}"><code>Mycelia.minimap_map_paired_end_with_index</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">minimap_map_paired_end_with_index(
;
    forward,
    reverse,
    mem_gb,
    threads,
    outdir,
    as_string,
    denominator,
    fasta,
    index_file
)
</code></pre><p>Map paired-end reads to a reference sequence using minimap2.</p><p><strong>Arguments</strong></p><ul><li><code>fasta::String</code>: Path to reference FASTA file</li><li><code>forward::String</code>: Path to forward reads FASTQ file</li><li><code>reverse::String</code>: Path to reverse reads FASTQ file</li><li><code>mem_gb::Integer</code>: Available system memory in GB</li><li><code>threads::Integer</code>: Number of threads to use</li><li><code>outdir::String</code>: Output directory (defaults to forward reads directory)</li><li><code>as_string::Bool=false</code>: Return command as string instead of Cmd array</li><li><code>mapping_type::String=&quot;sr&quot;</code>: Minimap2 preset [&quot;map-hifi&quot;, &quot;map-ont&quot;, &quot;map-pb&quot;, &quot;sr&quot;, &quot;lr:hq&quot;]</li><li><code>denominator::Float64</code>: Memory scaling factor for index size</li></ul><p><strong>Returns</strong></p><p>Named tuple containing:</p><ul><li><code>cmd</code>: Command(s) to execute (String or Array{Cmd})</li><li><code>outfile</code>: Path to compressed output SAM file (*.sam.gz)</li></ul><p><strong>Notes</strong></p><ul><li>Requires minimap2, samtools, and pigz conda environments</li><li>Automatically compresses output using pigz</li><li>Index file must exist at <code>$(fasta).x$(mapping_type).I$(index_size).mmi</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/alignments-and-mapping.jl#LL623">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.minimap_map_with_index-Tuple{}" href="#Mycelia.minimap_map_with_index-Tuple{}"><code>Mycelia.minimap_map_with_index</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">minimap_map_with_index(
;
    fasta,
    mapping_type,
    fastq,
    index_file,
    mem_gb,
    threads,
    as_string,
    denominator
)
</code></pre><p>Map reads using an existing minimap2 index file.</p><p><strong>Arguments</strong></p><ul><li><code>fasta</code>: Path to the reference FASTA (used only if an index must be created).</li><li><code>mapping_type</code>: Minimap2 preset.</li><li><code>fastq</code>: Input reads.</li><li><code>index_file::String=&quot;&quot;</code>: Optional prebuilt index path. If empty, one is created.</li><li><code>mem_gb</code>, <code>threads</code>, <code>as_string</code>, <code>denominator</code>: Parameters forwarded to <code>minimap_index</code>.</li></ul><p><strong>Returns</strong></p><p>Named tuple <code>(cmd, outfile)</code> producing a BAM file from the mapping.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/alignments-and-mapping.jl#LL513">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.mmseqs_pairwise_search-Tuple{}" href="#Mycelia.mmseqs_pairwise_search-Tuple{}"><code>Mycelia.mmseqs_pairwise_search</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mmseqs_pairwise_search(; fasta, output)
</code></pre><p>Perform all-vs-all sequence search using MMseqs2&#39;s easy-search command.</p><p><strong>Arguments</strong></p><ul><li><code>fasta::String</code>: Path to input FASTA file containing sequences to compare</li><li><code>output::String</code>: Output directory path (default: input filename + &quot;.mmseqs<em>easy</em>search_pairwise&quot;)</li></ul><p><strong>Returns</strong></p><ul><li><code>String</code>: Path to the output directory</li></ul><p><strong>Details</strong></p><p>Executes MMseqs2 with sensitive search parameters (7 sensitivity steps) and outputs results in  tabular format with the following columns:</p><ul><li>query, qheader: Query sequence ID and header</li><li>target, theader: Target sequence ID and header  </li><li>pident: Percentage sequence identity</li><li>fident: Fraction of identical matches</li><li>nident: Number of identical matches</li><li>alnlen: Alignment length</li><li>mismatch: Number of mismatches</li><li>gapopen: Number of gap openings</li><li>qstart, qend, qlen: Query sequence coordinates and length</li><li>tstart, tend, tlen: Target sequence coordinates and length</li><li>evalue: Expected value</li><li>bits: Bit score</li></ul><p>Requires MMseqs2 to be available through Bioconda.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/alignments-and-mapping.jl#LL1032">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.mutate_sequence-Tuple{Any}" href="#Mycelia.mutate_sequence-Tuple{Any}"><code>Mycelia.mutate_sequence</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mutate_sequence(reference_sequence) -&gt; Tuple{Any, Any}
</code></pre><p>Generate a single random mutation in an amino acid sequence.</p><p><strong>Arguments</strong></p><ul><li><code>reference_sequence</code>: Input amino acid sequence to be mutated</li></ul><p><strong>Returns</strong></p><ul><li><code>mutant_sequence</code>: The sequence after applying the mutation</li><li><code>haplotype</code>: A <code>SequenceVariation.Haplotype</code> object containing the mutation details</li></ul><p><strong>Details</strong></p><p>Performs one of three possible mutation types:</p><ul><li>Substitution: Replace one amino acid with another</li><li>Insertion: Insert 1+ random amino acids at a position</li><li>Deletion: Remove 1+ amino acids from a position</li></ul><p>Insertion and deletion sizes follow a truncated Poisson distribution (λ=1, min=1).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/simulation.jl#LL560">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.mycelia_assemble-Tuple{Vector{&lt;:FASTX.FASTQ.Record}}" href="#Mycelia.mycelia_assemble-Tuple{Vector{&lt;:FASTX.FASTQ.Record}}"><code>Mycelia.mycelia_assemble</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Main Mycelia intelligent assembly algorithm. Implements iterative prime k-mer progression with error correction.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/intelligent-assembly.jl#LL402-L405">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.mycelia_cross_validation-Tuple{String}" href="#Mycelia.mycelia_cross_validation-Tuple{String}"><code>Mycelia.mycelia_cross_validation</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Main cross-validation function for hybrid assembly quality assessment. Compares intelligent vs iterative assembly approaches across multiple validation folds.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/cross-validation.jl#LL19-L22">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.mycelia_iterative_assemble-Tuple{String}" href="#Mycelia.mycelia_iterative_assemble-Tuple{String}"><code>Mycelia.mycelia_iterative_assemble</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Main iterative maximum likelihood assembly function. Processes entire read sets per iteration with complete FASTQ I/O tracking. Enhanced with performance optimizations, caching, and progress tracking.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/iterative-assembly.jl#LL18-L22">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.n_maximally_distinguishable_colors-Tuple{Any}" href="#Mycelia.n_maximally_distinguishable_colors-Tuple{Any}"><code>Mycelia.n_maximally_distinguishable_colors</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">n_maximally_distinguishable_colors(n) -&gt; Any
</code></pre><p>Generate <code>n</code> colors that are maximally distinguishable from each other.</p><p><strong>Arguments</strong></p><ul><li><code>n::Integer</code>: The number of distinct colors to generate</li></ul><p><strong>Returns</strong></p><p>A vector of <code>n</code> RGB colors that are optimized for maximum perceptual distinction, using white (RGB(1,1,1)) and black (RGB(0,0,0)) as anchor colors.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/plotting-and-visualization.jl#LL1000">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.name2taxid-Tuple{Any}" href="#Mycelia.name2taxid-Tuple{Any}"><code>Mycelia.name2taxid</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">name2taxid(name) -&gt; DataFrames.DataFrame
</code></pre><p>Convert scientific name(s) to NCBI taxonomy ID(s) using taxonkit.</p><p><strong>Arguments</strong></p><ul><li><code>name::AbstractString</code>: Scientific name(s) to query. Can be a single name or multiple names separated by newlines.</li></ul><p><strong>Returns</strong></p><ul><li><code>DataFrame</code> with columns:<ul><li><code>name</code>: Input scientific name</li><li><code>taxid</code>: NCBI taxonomy ID</li><li><code>rank</code>: Taxonomic rank (e.g., &quot;species&quot;, &quot;genus&quot;)</li></ul></li></ul><p><strong>Dependencies</strong></p><p>Requires taxonkit package (installed automatically via Bioconda)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/taxonomy-and-trees.jl#LL848">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.names2taxids-Tuple{AbstractVector{&lt;:AbstractString}}" href="#Mycelia.names2taxids-Tuple{AbstractVector{&lt;:AbstractString}}"><code>Mycelia.names2taxids</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">names2taxids(names::AbstractVector{&lt;:AbstractString}) -&gt; Any
</code></pre><p>Convert a vector of species/taxon names to their corresponding NCBI taxonomy IDs.</p><p><strong>Arguments</strong></p><ul><li><code>names::AbstractVector{&lt;:AbstractString}</code>: Vector of scientific names or common names</li></ul><p><strong>Returns</strong></p><ul><li><code>Vector{Int}</code>: Vector of NCBI taxonomy IDs corresponding to the input names</li></ul><p>Progress is displayed using ProgressMeter.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/taxonomy-and-trees.jl#LL1123">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.ncbi_ftp_path_to_url-Tuple{}" href="#Mycelia.ncbi_ftp_path_to_url-Tuple{}"><code>Mycelia.ncbi_ftp_path_to_url</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ncbi_ftp_path_to_url(; ftp_path, extension)
</code></pre><p>Constructs a complete NCBI FTP URL by combining a base FTP path with a file extension.</p><p><strong>Arguments</strong></p><ul><li><code>ftp_path::String</code>: Base FTP directory path for the resource</li><li><code>extension::String</code>: File extension to append to the resource name</li></ul><p><strong>Returns</strong></p><ul><li><code>String</code>: Complete FTP URL path to the requested resource</li></ul><p>Extensions include:</p><ul><li>genomic.fna.gz</li><li>genomic.gff.gz</li><li>protein.faa.gz</li><li>assembly_report.txt</li><li>assembly_stats.txt</li><li>cds<em>from</em>genomic.fna.gz</li><li>feature_count.txt.gz</li><li>feature_table.txt.gz</li><li>genomic.gbff.gz</li><li>genomic.gtf.gz</li><li>protein.gpff.gz</li><li>translated_cds.faa.gz</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/reference-databases.jl#LL2024">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.ncbi_genome_download_accession-Tuple{}" href="#Mycelia.ncbi_genome_download_accession-Tuple{}"><code>Mycelia.ncbi_genome_download_accession</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ncbi_genome_download_accession(
;
    accession,
    outdir,
    outpath,
    include_string
)
</code></pre><p>Download an accession using NCBI datasets command line tool</p><p>the .zip download output to outpath will be unzipped</p><p>returns the outfolder</p><p>ncbi&#39;s default include string is  include_string = &quot;gff3,rna,cds,protein,genome,seq-report&quot;</p><p>Downloads and extracts a genome from NCBI using the datasets command line tool.</p><p><strong>Arguments</strong></p><ul><li><code>accession</code>: NCBI accession number for the genome</li><li><code>outdir</code>: Directory where files will be downloaded (defaults to current directory)</li><li><code>outpath</code>: Full path for the temporary zip file (defaults to <code>outdir/accession.zip</code>)</li><li><code>include_string</code>: Data types to download (defaults to all &quot;gff3,rna,cds,protein,genome,seq-report&quot;).</li></ul><p><strong>Returns</strong></p><ul><li>Path to the extracted genome data directory</li></ul><p><strong>Notes</strong></p><ul><li>Requires the ncbi-datasets-cli conda package (automatically installed if missing)</li><li>Downloaded zip file is automatically removed after extraction</li><li>If output folder already exists, download is skipped</li><li>Data is extracted to <code>outdir/accession/ncbi_dataset/data/accession</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/reference-databases.jl#LL2230">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.ncbi_taxon_summary-Tuple{Any}" href="#Mycelia.ncbi_taxon_summary-Tuple{Any}"><code>Mycelia.ncbi_taxon_summary</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ncbi_taxon_summary(taxa_id) -&gt; DataFrames.DataFrame
</code></pre><p>Retrieve taxonomic information for a given NCBI taxonomy ID.</p><p><strong>Arguments</strong></p><ul><li><code>taxa_id</code>: NCBI taxonomy identifier (integer)</li></ul><p><strong>Returns</strong></p><ul><li><code>DataFrame</code>: Taxonomy summary containing fields like tax_id, rank, species, etc.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/reference-databases.jl#LL2556">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.nearest_prime-Tuple{Int64}" href="#Mycelia.nearest_prime-Tuple{Int64}"><code>Mycelia.nearest_prime</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">nearest_prime(n::Int64) -&gt; Int64
</code></pre><p>Find the closest prime number to the given integer <code>n</code>.</p><p>Returns the nearest prime number to <code>n</code>. If two prime numbers are equally distant  from <code>n</code>, returns the smaller one.</p><p><strong>Arguments</strong></p><ul><li><code>n::Int</code>: The input integer to find the nearest prime for</li></ul><p><strong>Returns</strong></p><ul><li><code>Int</code>: The closest prime number to <code>n</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/kmer-analysis.jl#LL2001">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.negbin_pca_epca-Tuple{AbstractMatrix{&lt;:Integer}}" href="#Mycelia.negbin_pca_epca-Tuple{AbstractMatrix{&lt;:Integer}}"><code>Mycelia.negbin_pca_epca</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">negbin_pca_epca(M::AbstractMatrix{&lt;:Integer};
               k::Int=0,
               r::Int=1)</code></pre><p>Perform Negative-Binomial EPCA on a count matrix <code>M</code> (features × samples).</p><p><strong>When to use</strong></p><p>Use for overdispersed count data (variance &gt; mean), such as RNA-seq or metagenomic counts.</p><p><strong>Keyword arguments</strong></p><ul><li><code>k</code> : desired number of latent dimensions; if <code>k&lt;1</code> defaults to <code>min(n_samples-1, n_features, 10)</code></li><li><code>r</code> : known NB “number of successes” parameter</li></ul><p><strong>Returns</strong></p><p>NamedTuple with fields</p><ul><li><code>model</code>    : the fitted <code>ExpFamilyPCA.NegativeBinomialEPCA</code> object  </li><li><code>scores</code>   : k×n_samples matrix of sample scores  </li><li><code>loadings</code> : k×n_features matrix of feature loadings  </li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/dimensionality-reduction.jl#LL262-L281">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.nersc_sbatch-Tuple{}" href="#Mycelia.nersc_sbatch-Tuple{}"><code>Mycelia.nersc_sbatch</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">nersc_sbatch(
;
    job_name,
    mail_user,
    mail_type,
    logdir,
    scriptdir,
    qos,
    nodes,
    ntasks,
    time,
    cpus_per_task,
    mem_gb,
    cmd,
    constraint
)
</code></pre><p>Submit a batch job to NERSC&#39;s SLURM workload manager.</p><p><strong>Arguments</strong></p><ul><li><code>job_name</code>: Identifier for the SLURM job</li><li><code>mail_user</code>: Email address for job notifications</li><li><code>mail_type</code>: Notification type (&quot;ALL&quot;, &quot;BEGIN&quot;, &quot;END&quot;, &quot;FAIL&quot;, or &quot;NONE&quot;)</li><li><code>logdir</code>: Directory for storing job output/error logs</li><li><code>scriptdir</code>: Directory for storing generated SLURM scripts</li><li><code>qos</code>: Quality of Service level (&quot;regular&quot;, &quot;premium&quot;, or &quot;preempt&quot;)</li><li><code>nodes</code>: Number of nodes to allocate</li><li><code>ntasks</code>: Number of tasks to run</li><li><code>time</code>: Maximum wall time in format &quot;days-HH:MM:SS&quot;</li><li><code>cpus_per_task</code>: CPU cores per task</li><li><code>mem_gb</code>: Memory per node in GB</li><li><code>cmd</code>: Command(s) to execute (String or Vector{String})</li><li><code>constraint</code>: Node type constraint (&quot;cpu&quot; or &quot;gpu&quot;)</li></ul><p><strong>Returns</strong></p><ul><li><code>true</code> if job submission succeeds</li><li><code>false</code> if submission fails</li></ul><p><strong>QoS Options</strong></p><ul><li>regular: Standard priority queue</li><li>premium: High priority queue (5x throughput limit)</li><li>preempt: Reduced credit usage but jobs may be interrupted</li></ul><p>https://docs.nersc.gov/jobs/policy/ https://docs.nersc.gov/systems/perlmutter/architecture/#cpu-nodes</p><p>default is to use shared qos</p><p>use</p><ul><li>regular</li><li>preempt (reduced credit usage but not guaranteed to finish)</li><li>premium (priorty runs limited to 5x throughput)</li></ul><p>https://docs.nersc.gov/systems/perlmutter/running-jobs/#tips-and-tricks</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/slurm-sbatch.jl#LL212">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.nersc_sbatch_shared-Tuple{}" href="#Mycelia.nersc_sbatch_shared-Tuple{}"><code>Mycelia.nersc_sbatch_shared</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">nersc_sbatch_shared(
;
    job_name,
    mail_user,
    mail_type,
    logdir,
    qos,
    nodes,
    ntasks,
    time,
    cpus_per_task,
    mem_gb,
    cmd,
    constraint
)
</code></pre><p>Submit a job to NERSC&#39;s SLURM scheduler using the shared QOS (Quality of Service).</p><p><strong>Arguments</strong></p><ul><li><code>job_name</code>: Identifier for the job</li><li><code>mail_user</code>: Email address for job notifications</li><li><code>mail_type</code>: Notification type (&quot;ALL&quot;, &quot;BEGIN&quot;, &quot;END&quot;, &quot;FAIL&quot;, &quot;REQUEUE&quot;, &quot;STAGE_OUT&quot;)</li><li><code>logdir</code>: Directory for storing job output and error logs</li><li><code>qos</code>: Quality of Service level (&quot;shared&quot;, &quot;regular&quot;, &quot;preempt&quot;, &quot;premium&quot;)</li><li><code>nodes</code>: Number of nodes to allocate</li><li><code>ntasks</code>: Number of tasks to run</li><li><code>time</code>: Maximum wall time in format &quot;days-hours:minutes:seconds&quot;</li><li><code>cpus_per_task</code>: Number of CPUs per task</li><li><code>mem_gb</code>: Memory per node in GB (default: 2GB per CPU)</li><li><code>cmd</code>: Command to execute</li><li><code>constraint</code>: Node type constraint (&quot;cpu&quot; or &quot;gpu&quot;)</li></ul><p><strong>Resource Limits</strong></p><ul><li>Maximum memory per node: 512GB</li><li>Maximum cores per node: 128</li><li>Default memory allocation: 2GB per CPU requested</li></ul><p><strong>QOS Options</strong></p><ul><li>shared: Default QOS for shared node usage</li><li>regular: Standard priority</li><li>preempt: Reduced credit usage but preemptible</li><li>premium: 5x throughput priority (limited usage)</li></ul><p><strong>Returns</strong></p><p><code>true</code> if job submission succeeds</p><p>https://docs.nersc.gov/jobs/policy/ https://docs.nersc.gov/systems/perlmutter/architecture/#cpu-nodes</p><p>default is to use shared qos</p><p>use</p><ul><li>regular</li><li>preempt (reduced credit usage but not guaranteed to finish)</li><li>premium (priority runs limited to 5x throughput)</li></ul><p>max request is 512Gb memory and 128 cores per node</p><p>https://docs.nersc.gov/systems/perlmutter/running-jobs/#tips-and-tricks</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/slurm-sbatch.jl#LL128">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.next_prime_k-Tuple{Int64}" href="#Mycelia.next_prime_k-Tuple{Int64}"><code>Mycelia.next_prime_k</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Find the next prime number greater than current_k. For k-mer progression, we prefer odd numbers and especially primes.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/intelligent-assembly.jl#LL17-L20">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.node_type_to_dataframe-Tuple{}" href="#Mycelia.node_type_to_dataframe-Tuple{}"><code>Mycelia.node_type_to_dataframe</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">node_type_to_dataframe(; node_type, graph)
</code></pre><p>Convert all nodes of a specific type in a MetaGraph to a DataFrame representation.</p><p><strong>Arguments</strong></p><ul><li><code>node_type</code>: The type of nodes to extract from the graph</li><li><code>graph</code>: A MetaGraph containing the nodes</li></ul><p><strong>Returns</strong></p><p>A DataFrame where:</p><ul><li>Each row represents a node of the specified type</li><li>Columns correspond to all unique properties found across nodes</li><li>Values are JSON-serialized strings for consistency</li></ul><p><strong>Notes</strong></p><ul><li>All values are normalized through JSON serialization</li><li>Dictionary values receive double JSON encoding</li><li>The TYPE column is converted using <code>type_to_string</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/neo4jl.jl#LL104">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.normalize_codon_frequencies-Tuple{Any}" href="#Mycelia.normalize_codon_frequencies-Tuple{Any}"><code>Mycelia.normalize_codon_frequencies</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">normalize_codon_frequencies(
    codon_frequencies
) -&gt; Dict{BioSymbols.AminoAcid, Dict{Kmers.Kmer{BioSequences.DNAAlphabet{2}, 3, 1}, Float64}}
</code></pre><p>Normalizes codon frequencies for each amino acid such that frequencies sum to 1.0.</p><p><strong>Arguments</strong></p><ul><li><code>codon_frequencies</code>: Nested dictionary mapping amino acids to their codon frequency distributions</li></ul><p><strong>Returns</strong></p><ul><li>Normalized codon frequencies where values for each amino acid sum to 1.0</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/codon-optimization.jl#LL229">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.normalize_countmap-Tuple{Any}" href="#Mycelia.normalize_countmap-Tuple{Any}"><code>Mycelia.normalize_countmap</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">normalize_countmap(countmap) -&gt; Dict
</code></pre><p>Normalize a dictionary of counts into a probability distribution where values sum to 1.0.</p><p><strong>Arguments</strong></p><ul><li><code>countmap::Dict</code>: Dictionary mapping keys to count values</li></ul><p><strong>Returns</strong></p><ul><li><code>Dict</code>: New dictionary with same keys but values normalized by total sum</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/utility-functions.jl#LL1303">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.normalize_distance_matrix-Tuple{Any}" href="#Mycelia.normalize_distance_matrix-Tuple{Any}"><code>Mycelia.normalize_distance_matrix</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">normalize_distance_matrix(distance_matrix) -&gt; Any
</code></pre><p>Create distance matrix from a column-major counts matrix (features as rows and entities as columns) where distance is a proportional to total feature count magnitude (size) and cosine similarity (relative frequency)</p><p>Normalize a distance matrix by dividing all elements by the maximum non-NaN value.</p><p><strong>Arguments</strong></p><ul><li><code>distance_matrix</code>: A matrix of distance values that may contain <code>NaN</code>, <code>nothing</code>, or <code>missing</code> values</li></ul><p><strong>Returns</strong></p><ul><li>Normalized distance matrix with values scaled to [0, 1] range</li></ul><p><strong>Details</strong></p><ul><li>Filters out <code>NaN</code>, <code>nothing</code>, and <code>missing</code> values when finding the maximum</li><li>All elements are divided by the same maximum value to preserve relative distances</li><li>If all values are NaN/nothing/missing, may return NaN values</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/distance-metrics.jl#LL156">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.normalize_kmer_counts-Tuple{Any}" href="#Mycelia.normalize_kmer_counts-Tuple{Any}"><code>Mycelia.normalize_kmer_counts</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">normalize_kmer_counts(
    kmer_counts
) -&gt; OrderedCollections.OrderedDict
</code></pre><p>Convert raw k‑mer counts into normalized frequencies.</p><p><strong>Arguments</strong></p><ul><li><code>kmer_counts::Dict</code>: Mapping of k-mers to counts.</li></ul><p><strong>Returns</strong></p><p><code>OrderedDict</code> with values scaled so the sum equals 1.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/codon-optimization.jl#LL254">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.normalize_vcf-Tuple{}" href="#Mycelia.normalize_vcf-Tuple{}"><code>Mycelia.normalize_vcf</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">normalize_vcf(; reference_fasta, vcf_file)
</code></pre><p>Normalize a VCF file using bcftools norm, with automated handling of compression and indexing.</p><p><strong>Arguments</strong></p><ul><li><code>reference_fasta::String</code>: Path to the reference FASTA file used for normalization</li><li><code>vcf_file::String</code>: Path to input VCF file (can be gzipped or uncompressed)</li></ul><p><strong>Returns</strong></p><ul><li><code>String</code>: Path to the normalized, sorted, and compressed output VCF file (*.sorted.normalized.vcf.gz)</li></ul><p><strong>Notes</strong></p><ul><li>Requires bioconda packages: htslib, tabix, bcftools</li><li>Creates intermediate files with extensions .tbi for indices</li><li>Skips processing if output file already exists</li><li>Performs left-alignment and normalization of variants</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/variant-analysis.jl#LL2">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.normalized_current_date-Tuple{}" href="#Mycelia.normalized_current_date-Tuple{}"><code>Mycelia.normalized_current_date</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">normalized_current_date() -&gt; String
</code></pre><p>Returns the current date as a normalized string with all non-word characters removed.</p><p>The output format is based on ISO datetime (YYYYMMDD) but strips any special characters like hyphens, colons or dots.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/utility-functions.jl#LL1086">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.normalized_current_datetime-Tuple{}" href="#Mycelia.normalized_current_datetime-Tuple{}"><code>Mycelia.normalized_current_datetime</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">normalized_current_datetime() -&gt; String
</code></pre><p>Returns the current date and time as a normalized string with all non-word characters removed.</p><p>The output format is based on ISO datetime (YYYYMMDDThhmmss) but strips any special characters like hyphens, colons or dots.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/utility-functions.jl#LL1074">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.observe-Tuple{R} where R&lt;:Union{FASTX.FASTA.Record, FASTX.FASTQ.Record}" href="#Mycelia.observe-Tuple{R} where R&lt;:Union{FASTX.FASTA.Record, FASTX.FASTQ.Record}"><code>Mycelia.observe</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">observe(
    record::Union{FASTX.FASTA.Record, FASTX.FASTQ.Record};
    error_rate
)
</code></pre><p>Simulate sequencing of a DNA/RNA record by introducing random errors at the specified rate.</p><p><strong>Arguments</strong></p><ul><li><code>record</code>: A FASTA or FASTQ record containing the sequence to be &quot;observed&quot;</li><li><code>error_rate</code>: Probability of error at each position (default: 0.0)</li></ul><p><strong>Returns</strong></p><p>A new FASTQ.Record with:</p><ul><li>Random UUID as identifier</li><li>Original record&#39;s description </li><li>Modified sequence with introduced errors</li><li>Generated quality scores</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/simulation.jl#LL507">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.observe-Union{Tuple{BioSequences.LongSequence{T}}, Tuple{T}} where T" href="#Mycelia.observe-Union{Tuple{BioSequences.LongSequence{T}}, Tuple{T}} where T"><code>Mycelia.observe</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">observe(sequence::BioSequences.LongSequence{T}; error_rate=nothing, tech::Symbol=:illumina) where T</code></pre><p>Simulates the “observation” of a biological polymer (DNA, RNA, or protein) by introducing realistic errors along with base‐quality scores. The simulation takes into account both random and systematic error components. In particular, for technologies:</p><ul><li><strong>illumina</strong>: (mostly substitution errors) the per‐base quality decays along the read (from ~Q40 at the start to ~Q20 at the end);</li><li><strong>nanopore</strong>: errors are more frequent and include both substitutions and indels (with overall lower quality scores, and an extra “homopolymer” penalty);</li><li><strong>pacbio</strong>: errors are dominated by indels (with quality scores typical of raw reads);</li><li><strong>ultima</strong>: (UG 100/ppmSeq™) correct bases are assigned very high quality (~Q60) while errors are extremely rare and, if they occur, are given a modest quality.</li></ul><p>An error is introduced at each position with a (possibly position‐dependent) probability. For Illumina, the error probability increases along the read; additionally, if a base is part of a homopolymer run (length ≥ 3) and the chosen technology is one that struggles with homopolymers (nanopore, pacbio, ultima), then the local error probability is multiplied by a constant factor.</p><p>Returns a tuple <code>(new_seq, quality_scores)</code> where:</p><ul><li><code>new_seq</code> is a <code>BioSequences.LongSequence{T}</code> containing the “observed” sequence (which may be longer or shorter than the input if insertions or deletions occur), and </li><li><code>quality_scores</code> is a vector of integers representing the Phred quality scores (using the Sanger convention) for each base in the output sequence.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/simulation.jl#LL933-L949">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.open_fastx-Tuple{AbstractString}" href="#Mycelia.open_fastx-Tuple{AbstractString}"><code>Mycelia.open_fastx</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">open_fastx(path::AbstractString) -&gt; Any
</code></pre><p>Open and return a reader for FASTA or FASTQ format files.</p><p><strong>Arguments</strong></p><ul><li><code>path::AbstractString</code>: Path to input file. Can be:<ul><li>Local file path</li><li>HTTP/FTP URL</li><li>Gzip compressed (.gz extension)</li></ul></li></ul><p><strong>Supported formats</strong></p><ul><li>FASTA (.fasta, .fna, .faa, .fa)</li><li>FASTQ (.fastq, .fq)</li></ul><p><strong>Returns</strong></p><ul><li><code>FASTX.FASTA.Reader</code> for FASTA files</li><li><code>FASTX.FASTQ.Reader</code> for FASTQ files</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/fastx.jl#LL1371">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.open_genbank-Tuple{Any}" href="#Mycelia.open_genbank-Tuple{Any}"><code>Mycelia.open_genbank</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">open_genbank(
    genbank_file
) -&gt; Vector{GenomicAnnotations.Record}
</code></pre><p>Opens and parses a GenBank format file containing genomic sequence and annotation data.</p><p><strong>Arguments</strong></p><ul><li><code>genbank_file::AbstractString</code>: Path to the GenBank (.gb or .gbk) file</li></ul><p><strong>Returns</strong></p><ul><li><code>Vector{GenomicAnnotations.Chromosome}</code>: Vector containing parsed chromosome data</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/genome-features.jl#LL335">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.open_gff-Tuple{String}" href="#Mycelia.open_gff-Tuple{String}"><code>Mycelia.open_gff</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">open_gff(path::String) -&gt; Any
</code></pre><p>Opens a GFF (General Feature Format) file for reading.</p><p><strong>Arguments</strong></p><ul><li><code>path::String</code>: Path to GFF file. Can be:<ul><li>Local file path</li><li>HTTP/FTP URL (FTP URLs are automatically converted to HTTP)</li><li>Gzipped file (automatically decompressed)</li></ul></li></ul><p><strong>Returns</strong></p><ul><li><code>IO</code>: An IO stream ready to read the GFF content</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/genome-features.jl#LL97">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.optimal_subsequence_length-Tuple{}" href="#Mycelia.optimal_subsequence_length-Tuple{}"><code>Mycelia.optimal_subsequence_length</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">optimal_subsequence_length(
;
    error_rate,
    threshold,
    sequence_length,
    plot_result
)
</code></pre><p>Calculate the optimal subsequence length based on error rate distribution.</p><p><strong>Arguments</strong></p><ul><li><code>error_rate</code>: Single error rate or array of error rates (between 0 and 1)</li><li><code>threshold</code>: Desired probability that a subsequence is error-free (default: 0.95)</li><li><code>sequence_length</code>: Maximum sequence length to consider for plotting</li><li><code>plot_result</code>: If true, returns a plot of probability vs. length</li></ul><p><strong>Returns</strong></p><ul><li>If <code>plot_result=false</code>: Integer representing optimal subsequence length</li><li>If <code>plot_result=true</code>: Tuple of (optimal_length, plot)</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia hljs"># Single error rate
optimal_subsequence_length(error_rate=0.01)

# Array of error rates
optimal_subsequence_length(error_rate=[0.01, 0.02, 0.01])

# With more stringent threshold
optimal_subsequence_length(error_rate=0.01, threshold=0.99)

# Generate plot
length, p = optimal_subsequence_length(error_rate=0.01, plot_result=true)
Plots.display(p)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/plotting-and-visualization.jl#LL856">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.pairwise_distance_matrix-Tuple{Any}" href="#Mycelia.pairwise_distance_matrix-Tuple{Any}"><code>Mycelia.pairwise_distance_matrix</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">pairwise_distance_matrix(
    matrix;
    dist_func = Distances.euclidean,
    show_progress = true,
    progress_desc = &quot;Computing distances&quot;
)</code></pre><p>Compute a symmetric pairwise distance matrix between columns of <code>matrix</code> using the supplied distance function.</p><p><strong>Arguments</strong></p><ul><li><code>matrix</code>: Column-major matrix (features as rows, entities as columns)</li><li><code>dist_func</code>: Function of the form <code>f(a, b)</code> returning the distance between two vectors (default: <code>Distances.euclidean</code>)</li><li><code>show_progress</code>: Display progress bar if true (default: true)</li><li><code>progress_desc</code>: Progress bar description (default: &quot;Computing distances&quot;)</li></ul><p><strong>Returns</strong></p><ul><li>Symmetric N×N matrix of pairwise distances between columns (entities)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/distance-metrics.jl#LL270-L288">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.parallel_pyrodigal-Tuple{Vector{String}}" href="#Mycelia.parallel_pyrodigal-Tuple{Vector{String}}"><code>Mycelia.parallel_pyrodigal</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">parallel_pyrodigal(normalized_fastas::Vector{String})</code></pre><p>Runs Mycelia.run_pyrodigal on a list of FASTA files in parallel using Threads.</p><p>Args:     normalized_fastas: A vector of strings, where each string is a path to a FASTA file.</p><p>Returns:     A tuple containing two elements:     1. successes (Vector{Tuple{String, Any}}): A vector of tuples, where each tuple contains the        filename and the result returned by a successful Mycelia.run<em>pyrodigal call.     2. failures (Vector{Tuple{String, String}}): A vector of tuples, where each tuple contains the        filename and the error message string for a failed Mycelia.run</em>pyrodigal call.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/annotation.jl#LL1138-L1152">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.parse_blast_report-Tuple{Any}" href="#Mycelia.parse_blast_report-Tuple{Any}"><code>Mycelia.parse_blast_report</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">parse_blast_report(blast_report) -&gt; DataFrames.DataFrame
</code></pre><p>Expects output type 7 from BLAST, default output type 6 doesn&#39;t have the header comments and won&#39;t auto-parse</p><p>Parse a BLAST output file into a structured DataFrame.</p><p><strong>Arguments</strong></p><ul><li><code>blast_report::AbstractString</code>: Path to a BLAST output file in format 7 (tabular with comments)</li></ul><p><strong>Returns</strong></p><ul><li><code>DataFrame</code>: Table containing BLAST results with columns matching the header fields. Returns empty DataFrame if no hits found.</li></ul><p><strong>Details</strong></p><ul><li>Requires BLAST output format 7 (<code>-outfmt 7</code>), which includes header comments</li><li>Handles missing values (encoded as &quot;N/A&quot;) automatically</li><li>Infers column types based on BLAST field names</li><li>Supports standard BLAST tabular fields including sequence IDs, scores, alignments and taxonomic information</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/alignments-and-mapping.jl#LL1221">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.parse_gfa-Tuple{Any}" href="#Mycelia.parse_gfa-Tuple{Any}"><code>Mycelia.parse_gfa</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">parse_gfa(gfa) -&gt; MetaGraphs.MetaGraph{Int64, Float64}
</code></pre><p>Parse a GFA (Graphical Fragment Assembly) file into a MetaGraph representation.</p><p><strong>Arguments</strong></p><ul><li><code>gfa</code>: Path to GFA format file</li></ul><p><strong>Returns</strong></p><p>A <code>MetaGraph</code> where:</p><ul><li>Vertices represent segments (contigs)</li><li>Edges represent links between segments</li><li>Vertex properties include <code>:id</code> with segment identifiers</li><li>Graph property <code>:records</code> contains the original FASTA records</li></ul><p><strong>Format Support</strong></p><p>Handles standard GFA v1 lines:</p><ul><li><code>H</code>: Header lines (skipped)</li><li><code>S</code>: Segments (stored as nodes with FASTA records)</li><li><code>L</code>: Links (stored as edges)</li><li><code>P</code>: Paths (stored in paths dictionary)</li><li><code>A</code>: HiFiAsm specific lines (skipped)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/sequence-graphs.jl#LL548">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.parse_jsonl-Tuple{String}" href="#Mycelia.parse_jsonl-Tuple{String}"><code>Mycelia.parse_jsonl</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">parse_jsonl(filepath::String) -&gt; Vector{Dict{String, Any}}
</code></pre><pre><code class="nohighlight hljs">parse_jsonl(filepath::String) -&gt; Vector{Dict{String,Any}}</code></pre><p>Validate and parse a JSON Lines file (either .ndjson/.jsonl, optionally gzipped) into a vector of dictionaries, reporting progress in bytes processed.</p><p>Validations performed:   • Extension must be one of: .jsonl, .ndjson, .jsonl.gz, .ndjson.gz   • File must exist   • File size must be non-zero</p><p>Progress meter shows bytes read from the underlying file (compressed bytes for .gz). No second full pass is needed.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/utility-functions.jl#LL1418">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.parse_mmseqs_easy_taxonomy_lca_tsv-Tuple{Any}" href="#Mycelia.parse_mmseqs_easy_taxonomy_lca_tsv-Tuple{Any}"><code>Mycelia.parse_mmseqs_easy_taxonomy_lca_tsv</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">parse_mmseqs_easy_taxonomy_lca_tsv(
    lca_tsv
) -&gt; DataFrames.DataFrame
</code></pre><p>Parse the taxonomic Last Common Ancestor (LCA) TSV output from MMseqs2&#39;s easy-taxonomy workflow.</p><p><strong>Arguments</strong></p><ul><li><code>lca_tsv</code>: Path to the TSV file containing MMseqs2 taxonomy results</li></ul><p><strong>Returns</strong></p><p>DataFrame with columns:</p><ul><li><code>contig_id</code>: Sequence identifier</li><li><code>taxon_id</code>: NCBI taxonomy identifier </li><li><code>taxon_rank</code>: Taxonomic rank (e.g. species, genus)</li><li><code>taxon_name</code>: Scientific name</li><li><code>fragments_retained</code>: Number of fragments kept</li><li><code>fragments_taxonomically_assigned</code>: Number of fragments with taxonomy</li><li><code>fragments_in_agreement_with_assignment</code>: Fragments matching contig taxonomy</li><li><code>support -log(E-value)</code>: Statistical support score</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/taxonomy-and-trees.jl#LL1236">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.parse_mmseqs_easy_taxonomy_tophit_report-Tuple{Any}" href="#Mycelia.parse_mmseqs_easy_taxonomy_tophit_report-Tuple{Any}"><code>Mycelia.parse_mmseqs_easy_taxonomy_tophit_report</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">parse_mmseqs_easy_taxonomy_tophit_report(
    tophit_report
) -&gt; DataFrames.DataFrame
</code></pre><p>Parse an MMseqs2 easy-taxonomy tophit report into a structured DataFrame.</p><p><strong>Arguments</strong></p><ul><li><code>tophit_report::String</code>: Path to the MMseqs2 easy-taxonomy tophit report file (tab-delimited)</li></ul><p><strong>Returns</strong></p><ul><li><code>DataFrame</code>: A DataFrame with columns:<ul><li><code>target_id</code>: Target sequence identifier</li><li><code>number of sequences aligning to target</code>: Count of aligned sequences</li><li><code>unique coverage of target</code>: Ratio of uniqueAlignedResidues to targetLength</li><li><code>Target coverage</code>: Ratio of alignedResidues to targetLength</li><li><code>Average sequence identity</code>: Mean sequence identity</li><li><code>taxon_id</code>: Taxonomic identifier</li><li><code>taxon_rank</code>: Taxonomic rank</li><li><code>taxon_name</code>: Species name and lineage</li></ul></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/taxonomy-and-trees.jl#LL1195">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.parse_mmseqs_tophit_aln-Tuple{Any}" href="#Mycelia.parse_mmseqs_tophit_aln-Tuple{Any}"><code>Mycelia.parse_mmseqs_tophit_aln</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">parse_mmseqs_tophit_aln(tophit_aln) -&gt; DataFrames.DataFrame
</code></pre><p>Parse MMseqs2 tophit alignment output file into a structured DataFrame.</p><p><strong>Arguments</strong></p><ul><li><code>tophit_aln::AbstractString</code>: Path to tab-delimited MMseqs2 alignment output file</li></ul><p><strong>Returns</strong></p><p>DataFrame with columns:</p><ul><li><code>query</code>: Query sequence/profile identifier</li><li><code>target</code>: Target sequence/profile identifier  </li><li><code>percent identity</code>: Sequence identity percentage</li><li><code>alignment length</code>: Length of alignment</li><li><code>number of mismatches</code>: Count of mismatched positions</li><li><code>number of gaps</code>: Count of gap openings</li><li><code>query start</code>: Start position in query sequence</li><li><code>query end</code>: End position in query sequence</li><li><code>target start</code>: Start position in target sequence</li><li><code>target end</code>: End position in target sequence</li><li><code>evalue</code>: E-value of alignment</li><li><code>bit score</code>: Bit score of alignment</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/alignments-and-mapping.jl#LL1659">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.parse_qualimap_contig_coverage-Tuple{Any}" href="#Mycelia.parse_qualimap_contig_coverage-Tuple{Any}"><code>Mycelia.parse_qualimap_contig_coverage</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">parse_qualimap_contig_coverage(
    qualimap_report_txt
) -&gt; DataFrames.DataFrame
</code></pre><p>Parse contig coverage statistics from a Qualimap BAM QC report file.</p><p><strong>Arguments</strong></p><ul><li><code>qualimap_report_txt::String</code>: Path to Qualimap bamqc report text file</li></ul><p><strong>Returns</strong></p><ul><li><code>DataFrame</code>: Coverage statistics with columns:<ul><li><code>Contig</code>: Contig identifier</li><li><code>Length</code>: Contig length in bases</li><li><code>Mapped bases</code>: Number of bases mapped to contig</li><li><code>Mean coverage</code>: Average coverage depth</li><li><code>Standard Deviation</code>: Standard deviation of coverage</li><li><code>% Mapped bases</code>: Percentage of total mapped bases on this contig</li></ul></li></ul><p><strong>Supported Assemblers</strong></p><p>Handles output from both SPAdes and MEGAHIT assemblers:</p><ul><li>SPAdes format: NODE<em>X</em>length<em>Y</em>cov_Z</li><li>MEGAHIT format: kXX_Y </li></ul><p>Parse the contig coverage information from qualimap bamqc text report, which looks like the following:</p><pre><code class="nohighlight hljs"># this is spades
&gt;&gt;&gt;&gt;&gt;&gt;&gt; Coverage per contig

	NODE_1_length_107478_cov_9.051896	107478	21606903	201.0355886786133	60.39424208607496
	NODE_2_length_5444_cov_1.351945	5444	153263	28.152645113886848	5.954250612823136
	NODE_3_length_1062_cov_0.154390	1062	4294	4.043314500941619	1.6655384692688975
	NODE_4_length_776_cov_0.191489	776	3210	4.13659793814433	2.252009588980858

# below is megahit
&gt;&gt;&gt;&gt;&gt;&gt;&gt; Coverage per contig

	k79_175	235	3862	16.43404255319149	8.437436249612457
	k79_89	303	3803	12.551155115511552	5.709975376279777
	k79_262	394	6671	16.931472081218274	7.579217802849293
	k79_90	379	1539	4.060686015831134	1.2929729111266581
	k79_91	211	3749	17.767772511848342	11.899185693011933
	k79_0	2042	90867	44.49902056807052	18.356525483516613</code></pre><p>To make this more robust, consider reading in the names of the contigs from the assembled fasta</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/alignments-and-mapping.jl#LL1296">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.parse_rtg_eval_output-Tuple{Any}" href="#Mycelia.parse_rtg_eval_output-Tuple{Any}"><code>Mycelia.parse_rtg_eval_output</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">parse_rtg_eval_output(f) -&gt; DataFrames.DataFrame
</code></pre><p>Parse RTG evaluation output from a gzipped tab-separated file.</p><p><strong>Arguments</strong></p><ul><li><code>f</code>: Path to a gzipped TSV file containing RTG evaluation output</li></ul><p><strong>Format</strong></p><p>Expected file format:</p><ul><li>Header line starting with &#39;#&#39; and tab-separated column names</li><li>Data rows in tab-separated format</li><li>Empty files return a DataFrame with empty columns matching header</li></ul><p><strong>Returns</strong></p><p>A DataFrame where:</p><ul><li>Column names are taken from the header line (stripped of &#39;#&#39;)</li><li>Data is parsed as Float64 values</li><li>Empty files result in empty columns preserving header structure</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/variant-analysis.jl#LL129">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.parse_transterm_output-Tuple{Any}" href="#Mycelia.parse_transterm_output-Tuple{Any}"><code>Mycelia.parse_transterm_output</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">parse_transterm_output(
    transterm_output
) -&gt; DataFrames.DataFrame
</code></pre><p>Parse TransTerm terminator prediction output into a structured DataFrame.</p><p>Takes a TransTerm output file path and returns a DataFrame containing parsed terminator predictions. Each row represents one predicted terminator with the following columns:</p><ul><li><code>chromosome</code>: Identifier of the sequence being analyzed</li><li><code>term_id</code>: Unique terminator identifier (e.g. &quot;TERM 19&quot;)</li><li><code>start</code>: Start position of the terminator</li><li><code>stop</code>: End position of the terminator</li><li><code>strand</code>: Strand orientation (&quot;+&quot; or &quot;-&quot;)</li><li><code>location</code>: Context type, where:<ul><li>G/g = in gene interior (≥50bp from ends)</li><li>F/f = between two +strand genes</li><li>R/r = between two -strand genes</li><li>T = between ends of +strand and -strand genes</li><li>H = between starts of +strand and -strand genes</li><li>N = none of the above</li></ul>Lowercase indicates opposite strand from region</li><li><code>confidence</code>: Overall confidence score (0-100)</li><li><code>hairpin_score</code>: Hairpin structure score</li><li><code>tail_score</code>: Tail sequence score  </li><li><code>notes</code>: Additional annotations (e.g. &quot;bidir&quot;)</li></ul><p><strong>Arguments</strong></p><ul><li><code>transterm_output::AbstractString</code>: Path to TransTerm output file</li></ul><p><strong>Returns</strong></p><ul><li><code>DataFrame</code>: Parsed terminator predictions with columns as described above</li></ul><p>See TransTerm HP documentation for details on scoring and location codes.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/annotation.jl#LL2108">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.parse_virsorter_score_tsv-Tuple{Any}" href="#Mycelia.parse_virsorter_score_tsv-Tuple{Any}"><code>Mycelia.parse_virsorter_score_tsv</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">parse_virsorter_score_tsv(
    virsorter_score_tsv
) -&gt; DataFrames.DataFrame
</code></pre><p>Parse a VirSorter score TSV file and return a DataFrame.</p><p><strong>Arguments</strong></p><ul><li><code>virsorter_score_tsv::String</code>: The file path to the VirSorter score TSV file.</li></ul><p><strong>Returns</strong></p><ul><li><code>DataFrame</code>: A DataFrame containing the parsed data from the TSV file. If the file is empty, returns a DataFrame with the appropriate headers but no data.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/annotation.jl#LL2226">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.parse_xam_to_summary_table-Tuple{Any}" href="#Mycelia.parse_xam_to_summary_table-Tuple{Any}"><code>Mycelia.parse_xam_to_summary_table</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">parse_xam_to_summary_table(xam) -&gt; DataFrames.DataFrame
</code></pre><p>Parse a SAM/BAM file into a summary DataFrame containing alignment metadata.</p><p><strong>Arguments</strong></p><ul><li><code>xam::AbstractString</code>: Path to input SAM (.sam), BAM (.bam), or gzipped SAM (.sam.gz) file</li></ul><p><strong>Returns</strong></p><p>DataFrame with columns:</p><ul><li><code>template</code>: Read name</li><li><code>flag</code>: SAM flag</li><li><code>reference</code>: Reference sequence name</li><li><code>position</code>: Alignment position range (start:end)</li><li><code>mappingquality</code>: Mapping quality score</li><li><code>alignment_score</code>: Alignment score (AS tag)</li><li><code>isprimary</code>: Whether alignment is primary</li><li><code>alignlength</code>: Length of the alignment</li><li><code>ismapped</code>: Whether read is mapped</li><li><code>mismatches</code>: Number of mismatches (NM tag)</li></ul><p>Note: Only mapped reads are included in the output DataFrame.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/xam.jl#LL468">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.path_to_sequence-Tuple{Any, Any}" href="#Mycelia.path_to_sequence-Tuple{Any, Any}"><code>Mycelia.path_to_sequence</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">path_to_sequence(kmers, path) -&gt; Any
</code></pre><p>Convert a path through k-mers into a single DNA sequence.</p><p>Takes a vector of k-mers and a path representing the order to traverse them, reconstructs the original sequence by joining the k-mers according to the path. The first k-mer is used in full, then only the last nucleotide from each subsequent k-mer is added.</p><p><strong>Arguments</strong></p><ul><li><code>kmers</code>: Vector of DNA k-mers (as LongDNA{4})</li><li><code>path</code>: Vector of tuples representing the path through the k-mers</li></ul><p><strong>Returns</strong></p><ul><li><code>LongDNA{4}</code>: The reconstructed DNA sequence</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/sequence-graphs.jl#LL140">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.pca_transform-Tuple{AbstractMatrix{&lt;:Real}}" href="#Mycelia.pca_transform-Tuple{AbstractMatrix{&lt;:Real}}"><code>Mycelia.pca_transform</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">pca_transform(
  M::AbstractMatrix{&lt;:Real};
  k::Int = 0,
  var_prop::Float64 = 1.0
)</code></pre><p>Perform standard PCA on <code>M</code> (features × samples), returning enough PCs to either:</p><ul><li>match a user‐supplied <code>k &gt; 0</code>, or  </li><li>explain at least <code>var_prop</code> of the total variance (0 &lt; var_prop ≤ 1).  </li></ul><p>By default (<code>k=0, var_prop=1.0</code>), this will capture <strong>all</strong> variance, i.e. use <code>min(n_samples-1, n_features)</code> components.</p><p><strong>When to use</strong></p><p>Use for real-valued, continuous, and approximately Gaussian data. PCA is most suitable when features are linearly related and data is centered and scaled. Not ideal for count, binary, or highly skewed data.</p><p><strong>Returns</strong></p><p>A NamedTuple with fields</p><ul><li><code>model</code>    : the fitted <code>MultivariateStats.PCA</code> object  </li><li><code>scores</code>   : k×n_samples matrix of PC scores  </li><li><code>loadings</code> : k×n_features matrix of PC loadings  </li><li><code>chosen_k</code> : the number of components actually used</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/dimensionality-reduction.jl#LL101-L126">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.pcoa_from_dist-Tuple{AbstractMatrix{&lt;:Real}}" href="#Mycelia.pcoa_from_dist-Tuple{AbstractMatrix{&lt;:Real}}"><code>Mycelia.pcoa_from_dist</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">pcoa_from_dist(D::AbstractMatrix{&lt;:Real}; maxoutdim::Int = 2)</code></pre><p>Perform Principal Coordinates Analysis directly from a precomputed distance matrix <code>D</code> (n<em>samples×n</em>samples).</p><p><strong>Keyword arguments</strong></p><ul><li><code>maxoutdim</code> : target embedding dimension (default=2)</li></ul><p><strong>Returns</strong></p><p>NamedTuple with fields</p><ul><li><code>model</code>      : the fitted <code>MultivariateStats.MDS</code> model  </li><li><code>coordinates</code>: maxoutdim×n_samples matrix of embedded coordinates  </li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/dimensionality-reduction.jl#LL321-L334">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.phred_to_error_probability-Tuple{UInt8}" href="#Mycelia.phred_to_error_probability-Tuple{UInt8}"><code>Mycelia.phred_to_error_probability</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">phred_to_error_probability(phred_score::UInt8) -&gt; Float64
</code></pre><p>Convert PHRED quality score to error probability.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/qualmer-analysis.jl#LL186">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.phred_to_probability-Tuple{UInt8}" href="#Mycelia.phred_to_probability-Tuple{UInt8}"><code>Mycelia.phred_to_probability</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">phred_to_probability(phred_score::UInt8) -&gt; Float64
</code></pre><p>Convert PHRED quality score to probability of correctness. PHRED score Q relates to error probability P by: Q = -10 * log10(P) Therefore, correctness probability = 1 - P = 1 - 10^(-Q/10)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/qualmer-analysis.jl#LL167">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.pixels_to_points-Tuple{Any}" href="#Mycelia.pixels_to_points-Tuple{Any}"><code>Mycelia.pixels_to_points</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">pixels_to_points(pixels) -&gt; Any
</code></pre><p>Convert pixel measurements to point measurements using the standard 4:3 ratio.</p><p>Points are the standard unit for typography (1 point = 1/72 inch), while pixels are  used for screen measurements. This conversion uses the conventional 4:3 ratio where  3 points equal 4 pixels.</p><p><strong>Arguments</strong></p><ul><li><code>pixels</code>: The number of pixels to convert</li></ul><p><strong>Returns</strong></p><ul><li>The equivalent measurement in points</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/plotting-and-visualization.jl#LL1017">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.plot_embeddings-Tuple{Any}" href="#Mycelia.plot_embeddings-Tuple{Any}"><code>Mycelia.plot_embeddings</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Plot embeddings with optional true and fitted cluster labels using Makie.jl,  with legend outside, and color by fit labels, shape by true labels.</p><p><strong>Arguments</strong></p><ul><li><code>embeddings::Matrix{&lt;:Real}</code>: 2D embedding matrix where each column is a data point</li><li><code>title::String</code>: Title of the plot</li><li><code>xlabel::String</code>: Label for the x-axis</li><li><code>ylabel::String</code>: Label for the y-axis</li><li><code>true_labels::Vector{&lt;:Integer}</code>: Vector of true cluster labels (optional)</li><li><code>fit_labels::Vector{&lt;:Integer}</code>: Vector of fitted cluster labels (optional)</li></ul><p><strong>Returns</strong></p><ul><li><code>Makie.Figure</code>: Figure object that can be displayed or saved</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/plotting-and-visualization.jl#LL123-L137">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.plot_graph-Tuple{Any}" href="#Mycelia.plot_graph-Tuple{Any}"><code>Mycelia.plot_graph</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">plot_graph(graph) -&gt; Any
</code></pre><p>Creates a visualization of a kmer graph where nodes represent kmers and their sizes reflect counts.</p><p><strong>Arguments</strong></p><ul><li><code>graph</code>: A MetaGraph where vertices have <code>:kmer</code> and <code>:count</code> properties</li></ul><p><strong>Returns</strong></p><ul><li>A Plots.jl plot object showing the graph visualization</li></ul><p><strong>Details</strong></p><ul><li>Node sizes are scaled based on kmer counts</li><li>Plot dimensions scale logarithmically with number of vertices</li><li>Each node is labeled with its kmer sequence</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/plotting-and-visualization.jl#LL1457">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.plot_kmer_frequency_spectra-Tuple{Any}" href="#Mycelia.plot_kmer_frequency_spectra-Tuple{Any}"><code>Mycelia.plot_kmer_frequency_spectra</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">plot_kmer_frequency_spectra(
    counts;
    log_scale,
    kwargs...
) -&gt; Plots.Plot
</code></pre><p>Plots a histogram of kmer counts against # of kmers with those counts</p><p>Returns the plot object for adding additional layers and saving</p><p>Creates a scatter plot visualizing the k-mer frequency spectrum - the relationship between k-mer frequencies and how many k-mers occur at each frequency.</p><p><strong>Arguments</strong></p><ul><li><code>counts::AbstractVector{&lt;:Integer}</code>: Vector of k-mer counts/frequencies</li><li><code>log_scale::Union{Function,Nothing} = log2</code>: Function to apply logarithmic scaling to both axes. Set to <code>nothing</code> to use linear scaling.</li><li><code>kwargs...</code>: Additional keyword arguments passed to <code>StatsPlots.plot()</code></li></ul><p><strong>Returns</strong></p><ul><li><code>Plots.Plot</code>: A scatter plot object that can be further modified or saved</li></ul><p><strong>Details</strong></p><p>The x-axis shows k-mer frequencies (how many times each k-mer appears), while the y-axis shows how many distinct k-mers appear at each frequency. Both axes are log-scaled by default using log2.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/plotting-and-visualization.jl#LL1490">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.plot_kmer_rarefaction-Tuple{AbstractString}" href="#Mycelia.plot_kmer_rarefaction-Tuple{AbstractString}"><code>Mycelia.plot_kmer_rarefaction</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">plot_kmer_rarefaction(
    rarefaction_data_path::AbstractString;
    output_dir,
    output_basename,
    display_plot,
    fig_size,
    title,
    xlabel,
    ylabel,
    line_color,
    line_style,
    marker,
    markersize,
    axis_kwargs...
) -&gt; Union{Nothing, Makie.Figure}
</code></pre><p>Plots a k-mer rarefaction curve from data stored in a TSV file. The TSV file should contain two columns:</p><ol><li>Number of FASTA files processed.</li><li>Cumulative unique k-mers observed at that point.</li></ol><p>The plot is displayed and saved in PNG, PDF, and SVG formats.</p><p><strong>Arguments</strong></p><ul><li><code>rarefaction_data_path::AbstractString</code>: Path to the TSV file containing rarefaction data.</li><li><code>output_dir::AbstractString</code>: Directory where the output plots will be saved. Defaults to the directory of <code>rarefaction_data_path</code>.</li><li><code>output_basename::AbstractString</code>: Basename for the output plot files (without extension). Defaults to the basename of <code>rarefaction_data_path</code> without its original extension.</li><li><code>display_plot::Bool</code>: Whether to display the plot interactively. Defaults to <code>true</code>.</li></ul><p><strong>Keyword Arguments</strong></p><ul><li><code>fig_size::Tuple{Int, Int}</code>: Size of the output figure, e.g., <code>(1000, 750)</code>.</li><li><code>title::AbstractString</code>: Title of the plot.</li><li><code>xlabel::AbstractString</code>: Label for the x-axis.</li><li><code>ylabel::AbstractString</code>: Label for the y-axis.</li><li><code>line_color</code>: Color of the plotted line.</li><li><code>line_style</code>: Style of the plotted line (e.g. <code>:dash</code>, <code>:dot</code>).</li><li><code>marker</code>: Marker style for points (e.g. <code>:circle</code>, <code>:xcross</code>).</li><li><code>markersize::Number</code>: Size of the markers.</li><li>Any other keyword arguments will be passed to <code>Makie.Axis</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/plotting-and-visualization.jl#LL747">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.plot_optimal_cluster_assessment_results-Tuple{Any}" href="#Mycelia.plot_optimal_cluster_assessment_results-Tuple{Any}"><code>Mycelia.plot_optimal_cluster_assessment_results</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">plot_optimal_cluster_assessment_results(
    clustering_results
) -&gt; Any
</code></pre><p>Visualizes cluster assessment metrics and saves the resulting plots.</p><p><strong>Arguments</strong></p><ul><li><code>clustering_results</code>: A named tuple containing:<ul><li><code>ks_assessed</code>: Vector of k values tested</li><li><code>within_cluster_sum_of_squares</code>: Vector of WCSS scores</li><li><code>silhouette_scores</code>: Vector of silhouette scores</li><li><code>optimal_number_of_clusters</code>: Integer indicating optimal k</li></ul></li></ul><p><strong>Details</strong></p><p>Creates two plots:</p><ol><li>Within-cluster sum of squares (WCSS) vs number of clusters</li><li>Silhouette scores vs number of clusters</li></ol><p>Both plots include a vertical line indicating the optimal number of clusters.</p><p><strong>Outputs</strong></p><p>Saves two SVG files in the project directory:</p><ul><li><code>wcss.svg</code>: WCSS plot</li><li><code>silhouette.svg</code>: Silhouette scores plot</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/plotting-and-visualization.jl#LL1389">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.plot_per_base_quality-Tuple{String}" href="#Mycelia.plot_per_base_quality-Tuple{String}"><code>Mycelia.plot_per_base_quality</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">plot_per_base_quality(fastq_file::String; max_position::Union{Int,Nothing}=nothing, sample_size::Union{Int,Nothing}=nothing)</code></pre><p>Create per-base quality boxplots for FASTQ data, similar to FastQC output.</p><p><strong>Arguments</strong></p><ul><li><code>fastq_file::String</code>: Path to FASTQ file to analyze</li><li><code>max_position::Union{Int,Nothing}=nothing</code>: Maximum read position to plot (default: auto-detect from data)</li><li><code>sample_size::Union{Int,Nothing}=nothing</code>: Number of reads to sample for analysis (default: use all reads)</li></ul><p><strong>Returns</strong></p><ul><li><code>Plots.Plot</code>: Boxplot showing quality distribution at each base position</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia hljs"># Basic per-base quality plot
p = Mycelia.plot_per_base_quality(&quot;reads.fastq&quot;)

# Plot first 100 positions only, sampling 10000 reads
p = Mycelia.plot_per_base_quality(&quot;reads.fastq&quot;, max_position=100, sample_size=10000)</code></pre><p><strong>Notes</strong></p><ul><li>Quality scores are displayed in Phred scale</li><li>Green zone: Q&gt;=30 (high quality)</li><li>Yellow zone: Q20-29 (medium quality)  </li><li>Red zone: Q&lt;20 (low quality)</li><li>For large files, consider using sample_size to improve performance</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/plotting-and-visualization.jl#LL1537-L1565">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.plot_taxa_abundances-Tuple{DataFrames.DataFrame, String}" href="#Mycelia.plot_taxa_abundances-Tuple{DataFrames.DataFrame, String}"><code>Mycelia.plot_taxa_abundances</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">plot_taxa_abundances(
    df::DataFrames.DataFrame, 
    taxa_level::String; 
    top_n::Int = 10,
    sample_id_col::String = &quot;sample_id&quot;,
    filter_taxa::Union{Vector{Union{String, Missing}}, Nothing} = nothing,
    figure_width::Int = 1500,
    figure_height::Int = 1000,
    bar_width::Float64 = 0.7,
    x_rotation::Int = 45,
    sort_samples::Bool = true,
    color_seed::Union{Int, Nothing} = nothing,
    legend_fontsize::Float64 = 12.0,
    legend_itemsize::Float64 = 12.0,
    legend_padding::Float64 = 5.0,
    legend_rowgap::Float64 = 1.0,
    legend_labelwidth::Union{Nothing, Float64} = nothing,
    legend_titlesize::Float64 = 15.0,
    legend_nbanks::Int = 1
)</code></pre><p>Create a stacked bar chart showing taxa relative abundances for each sample.</p><p><strong>Arguments</strong></p><ul><li><code>df</code>: DataFrame with sample_id and taxonomic assignments at different levels</li><li><code>taxa_level</code>: Taxonomic level to analyze (e.g., &quot;genus&quot;, &quot;species&quot;)</li><li><code>top_n</code>: Number of top taxa to display individually, remainder grouped as &quot;Other&quot;</li><li><code>sample_id_col</code>: Column name containing sample identifiers</li><li><code>filter_taxa</code>: Taxa to exclude from visualization (default: nothing - no filtering)</li><li><code>figure_width</code>: Width of the figure in pixels</li><li><code>figure_height</code>: Height of the figure in pixels</li><li><code>bar_width</code>: Width of each bar (between 0 and 1)</li><li><code>x_rotation</code>: Rotation angle for x-axis labels in degrees</li><li><code>sort_samples</code>: Whether to sort samples alphabetically</li><li><code>color_seed</code>: Seed for reproducible color generation</li><li><code>legend_fontsize</code>: Font size for legend entries</li><li><code>legend_itemsize</code>: Size of the colored marker/icon in the legend</li><li><code>legend_padding</code>: Padding around legend elements</li><li><code>legend_rowgap</code>: Space between legend rows</li><li><code>legend_labelwidth</code>: Maximum width for legend labels (truncation)</li><li><code>legend_titlesize</code>: Font size for legend title</li><li><code>legend_nbanks</code>: Number of legend columns</li></ul><p><strong>Returns</strong></p><ul><li><code>fig</code>: CairoMakie figure object</li><li><code>ax</code>: CairoMakie axis object</li><li><code>taxa_colors</code>: Dictionary mapping taxa to their assigned colors</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/plotting-and-visualization.jl#LL176-L224">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.points_to_pixels-Tuple{Any}" href="#Mycelia.points_to_pixels-Tuple{Any}"><code>Mycelia.points_to_pixels</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">points_to_pixels(points) -&gt; Any
</code></pre><p>Convert typographic points to pixels using a 4:3 ratio (1 point = 4/3 pixels).</p><p><strong>Arguments</strong></p><ul><li><code>points</code>: Size in typographic points (pt)</li></ul><p><strong>Returns</strong></p><ul><li>Size in pixels (px)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/plotting-and-visualization.jl#LL1036">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.poisson_pca_epca-Tuple{AbstractMatrix{&lt;:Integer}}" href="#Mycelia.poisson_pca_epca-Tuple{AbstractMatrix{&lt;:Integer}}"><code>Mycelia.poisson_pca_epca</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>poisson<em>pca</em>epca(M::AbstractMatrix{&lt;:Integer}; k::Int=0)</p><p>Perform Poisson EPCA on a count matrix <code>M</code> (features × samples).</p><p><strong>When to use</strong></p><p>Use for non-negative integer count data, such as raw event or read counts.</p><p><strong>Returns</strong></p><p>A NamedTuple with</p><ul><li><code>model</code>    : the fitted <code>ExpFamilyPCA.PoissonEPCA</code> object  </li><li><code>scores</code>   : k×n_samples matrix of low‐dimensional sample scores  </li><li><code>loadings</code> : k×n_features matrix of feature loadings  </li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/dimensionality-reduction.jl#LL221-L234">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.polish_assembly-Tuple{Mycelia.AssemblyResult, Any}" href="#Mycelia.polish_assembly-Tuple{Mycelia.AssemblyResult, Any}"><code>Mycelia.polish_assembly</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">polish_assembly(assembly::AssemblyResult, reads; iterations=3) -&gt; AssemblyResult</code></pre><p>Polish assembled contigs using quality-aware error correction.</p><p><strong>Arguments</strong></p><ul><li><code>assembly</code>: Initial assembly result to polish</li><li><code>reads</code>: Original reads for polishing (FASTQ with quality scores preferred)</li><li><code>iterations</code>: Number of polishing iterations (default: 3)</li></ul><p><strong>Returns</strong></p><ul><li><code>AssemblyResult</code>: Polished assembly with improved accuracy</li></ul><p><strong>Details</strong></p><p>Uses Phase 2 enhanced Viterbi algorithms with quality score integration for:</p><ul><li>Error correction based on k-mer graph traversals</li><li>Consensus calling from multiple observations</li><li>Iterative improvement until convergence</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/assembly.jl#LL387-L405">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.polish_fastq-Tuple{}" href="#Mycelia.polish_fastq-Tuple{}"><code>Mycelia.polish_fastq</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">polish_fastq(; fastq, k)
</code></pre><p>Polish FASTQ reads using a k-mer graph-based approach to correct potential sequencing errors.</p><p><strong>Arguments</strong></p><ul><li><code>fastq::String</code>: Path to input FASTQ file</li><li><code>k::Int=1</code>: Initial k-mer size parameter. Final assembly k-mer size may differ.</li></ul><p><strong>Process</strong></p><ol><li>Builds a directed k-mer graph from input reads</li><li>Processes each read through the graph to find optimal paths</li><li>Writes corrected reads to a new FASTQ file</li><li>Automatically compresses output with gzip</li></ol><p><strong>Returns</strong></p><p>Named tuple with:</p><ul><li><code>fastq::String</code>: Path to output gzipped FASTQ file</li><li><code>k::Int</code>: Final assembly k-mer size used</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/viterbi-polishing-and-error-correction.jl#LL970">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.polish_sequence_next" href="#Mycelia.polish_sequence_next"><code>Mycelia.polish_sequence_next</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">polish_sequence_next(graph::MetaGraph, sequence::String, config::ViterbiConfig) -&gt; ViterbiPath</code></pre><p>Polish a single sequence using Viterbi algorithm on k-mer graph.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/viterbi-next.jl#LL425-L429">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.position_wise_joint_probability-Tuple{Vector{&lt;:Mycelia.Qualmer}}" href="#Mycelia.position_wise_joint_probability-Tuple{Vector{&lt;:Mycelia.Qualmer}}"><code>Mycelia.position_wise_joint_probability</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">position_wise_joint_probability(
    qualmers::Vector{&lt;:Mycelia.Qualmer};
    use_log_space
) -&gt; Float64
</code></pre><p>Calculate position-wise joint probability for multiple qualmer observations. This is more sophisticated than <code>joint_qualmer_probability</code> as it considers the quality at each position across all observations.</p><p><strong>Arguments</strong></p><ul><li><code>qualmers</code>: Vector of Qualmer observations of the same k-mer sequence</li><li><code>use_log_space</code>: Use log-space arithmetic for numerical stability (default: true)</li></ul><p><strong>Returns</strong></p><ul><li>Float64: Position-wise joint probability</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/qualmer-analysis.jl#LL254">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.precision_recall_f1-Tuple{Any, Any}" href="#Mycelia.precision_recall_f1-Tuple{Any, Any}"><code>Mycelia.precision_recall_f1</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">precision_recall_f1(true_labels, pred_labels)</code></pre><p>Returns dictionaries mapping each label to its precision, recall, and F1 score. Also returns macro-averaged (unweighted mean) precision, recall, F1, and a grouped bar plot.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/quality-control-and-benchmarking.jl#LL22-L27">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.prefetch-Tuple{}" href="#Mycelia.prefetch-Tuple{}"><code>Mycelia.prefetch</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">prefetch(; SRR, outdir)
</code></pre><p>Downloads Sequence Read Archive (SRA) data using the prefetch tool from sra-tools.</p><p><strong>Arguments</strong></p><ul><li><code>SRR</code>: SRA accession number (e.g., &quot;SRR12345678&quot;)</li><li><code>outdir</code>: Directory where the downloaded data will be saved. Defaults to current directory.</li></ul><p><strong>Notes</strong></p><ul><li>Requires sra-tools which will be installed in a Conda environment</li><li>Downloads are saved in .sra format</li><li>Internet connection required</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/reference-databases.jl#LL826">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.prefetch_sra_runs-Tuple{Vector{String}}" href="#Mycelia.prefetch_sra_runs-Tuple{Vector{String}}"><code>Mycelia.prefetch_sra_runs</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Prefetches multiple SRA runs in parallel.</p><p>Downloads SRA run files (.sra) to local storage without converting to FASTQ. Useful for batch downloading before processing with fasterq-dump.</p><p><strong>Arguments</strong></p><ul><li><code>srr_identifiers</code>: Vector of SRA run identifiers</li><li><code>outdir</code>: Output directory for prefetched files (default: current directory)</li><li><code>max_parallel</code>: Maximum number of parallel downloads (default: 4)</li></ul><p><strong>Returns</strong></p><p>Vector of named tuples with prefetch results for each SRA run</p><p><strong>Example</strong></p><pre><code class="language-julia hljs">runs = [&quot;SRR1234567&quot;, &quot;SRR1234568&quot;, &quot;SRR1234569&quot;]
results = Mycelia.prefetch_sra_runs(runs, outdir=&quot;./sra_data&quot;)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/reference-databases.jl#LL1012-L1031">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.probabilistic_walk_next-Tuple{MetaGraphsNext.MetaGraph, String, Int64}" href="#Mycelia.probabilistic_walk_next-Tuple{MetaGraphsNext.MetaGraph, String, Int64}"><code>Mycelia.probabilistic_walk_next</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">probabilistic_walk_next(
    graph::MetaGraphsNext.MetaGraph,
    start_vertex::String,
    max_steps::Int64;
    seed
) -&gt; Mycelia.GraphPath
</code></pre><p>Perform a probabilistic walk through the strand-aware k-mer graph.</p><p>This algorithm follows edges based on their probability weights, respecting strand orientation constraints. The walk continues until max_steps is reached or no valid transitions are available.</p><p><strong>Arguments</strong></p><ul><li><code>graph</code>: MetaGraphsNext k-mer graph with strand-aware edges</li><li><code>start_vertex</code>: Starting k-mer (vertex label)</li><li><code>max_steps</code>: Maximum number of steps to take</li><li><code>seed</code>: Random seed for reproducibility (optional)</li></ul><p><strong>Returns</strong></p><ul><li><code>GraphPath</code>: Complete path with probability information</li></ul><p><strong>Algorithm</strong></p><ol><li>Start at given vertex with forward strand orientation</li><li>At each step, calculate transition probabilities based on edge weights</li><li>Sample next vertex according to probabilities</li><li>Update cumulative probability and continue</li><li>Respect strand orientation constraints from edge metadata</li></ol><p><strong>Example</strong></p><pre><code class="language-julia hljs">graph = build_kmer_graph_next(DNAKmer{15}, observations)
path = probabilistic_walk_next(graph, &quot;ATCGATCGATCGATC&quot;, 100)
println(&quot;Assembled sequence: $(path.sequence)&quot;)
println(&quot;Path probability: $(path.total_probability)&quot;)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/sequence-graphs-next.jl#LL2007">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.process_fastq_record-Tuple{}" href="#Mycelia.process_fastq_record-Tuple{}"><code>Mycelia.process_fastq_record</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">process_fastq_record(
;
    record,
    kmer_graph,
    yen_k_shortest_paths_and_weights,
    yen_k
)
</code></pre><p>Process and error-correct a FASTQ sequence record using a kmer graph and path resampling.</p><p><strong>Arguments</strong></p><ul><li><code>record</code>: FASTQ record containing the sequence to process</li><li><code>kmer_graph</code>: MetaGraph containing the kmer network and associated properties</li><li><code>yen_k_shortest_paths_and_weights</code>: Cache of pre-computed k-shortest paths between nodes</li><li><code>yen_k</code>: Number of alternative paths to consider during resampling (default: 3)</li></ul><p><strong>Description</strong></p><p>Performs error correction by:</p><ol><li>Trimming low-quality sequence ends</li><li>Identifying stretches requiring resampling between solid branching kmers</li><li>Selecting alternative paths through the kmer graph based on:<ul><li>Path quality scores</li><li>Transition likelihoods</li><li>Path length similarity to original sequence</li></ul></li></ol><p><strong>Returns</strong></p><ul><li>Modified FASTQ record with error-corrected sequence and updated quality scores</li><li>Original record if no error correction was needed</li></ul><p><strong>Required Graph Properties</strong></p><p>The kmer_graph must contain the following properties:</p><ul><li>:ordered_kmers</li><li>:likely<em>valid</em>kmer_indices  </li><li>:kmer_indices</li><li>:branching_nodes</li><li>:assembly_k</li><li>:transition_likelihoods</li><li>:kmer<em>mean</em>quality</li><li>:kmer<em>total</em>quality</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/viterbi-polishing-and-error-correction.jl#LL791">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.q_value_to_error_rate-Tuple{Any}" href="#Mycelia.q_value_to_error_rate-Tuple{Any}"><code>Mycelia.q_value_to_error_rate</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">q_value_to_error_rate(q_value) -&gt; Any
</code></pre><p>Convert a Phred quality score (Q-value) to a probability of error.</p><p><strong>Arguments</strong></p><ul><li><code>q_value</code>: Phred quality score, typically ranging from 0 to 40</li></ul><p><strong>Returns</strong></p><ul><li>Error probability in range [0,1], where 0 indicates highest confidence</li></ul><p>A Q-value of 10 corresponds to an error rate of 0.1 (10%), while a Q-value of  30 corresponds to an error rate of 0.001 (0.1%).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/fastx.jl#LL1182">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.qc_filter_long_reads_fastplong-Tuple{}" href="#Mycelia.qc_filter_long_reads_fastplong-Tuple{}"><code>Mycelia.qc_filter_long_reads_fastplong</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">qc_filter_long_reads_fastplong(
;
    in_fastq,
    report_title,
    out_fastq,
    html_report,
    json_report,
    min_length,
    max_length
)
</code></pre><p>Perform QC filtering on long-read FASTQ files using fastplong.</p><p><strong>Arguments</strong></p><ul><li><code>in_fastq::String</code>: Path to the input FASTQ file.</li><li><code>out_fastq::String</code>: Path to the output FASTQ file.</li><li><code>quality_threshold::Int</code>: Minimum average quality to retain a read (default 10).</li><li><code>min_length::Int</code>: Minimum read length (default 1000).</li><li><code>max_length::Int=0</code>: Maximum read length (default 0, no maximum).</li></ul><p><strong>Returns</strong></p><ul><li><code>String</code>: Path to the filtered FASTQ file.</li></ul><p><strong>Details</strong></p><p>This function uses fastplong to filter long reads based on quality and length criteria. It is optimized for Oxford Nanopore, PacBio, or similar long-read datasets.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/fastx.jl#LL464">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.qc_filter_long_reads_filtlong-Tuple{}" href="#Mycelia.qc_filter_long_reads_filtlong-Tuple{}"><code>Mycelia.qc_filter_long_reads_filtlong</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">qc_filter_long_reads_filtlong(
;
    in_fastq,
    out_fastq,
    min_mean_q,
    keep_percent
)
</code></pre><p>Filter and process long reads from a FASTQ file using Filtlong.</p><p>This function filters long sequencing reads based on quality and length criteria,  then compresses the output using pigz.</p><p><strong>Arguments</strong></p><ul><li><code>in_fastq::String</code>: Path to the input FASTQ file.</li><li><code>out_fastq::String</code>: Path to the output filtered and compressed FASTQ file.   Defaults to the input filename with &quot;.filtlong.fq.gz&quot; appended.</li><li><code>min_mean_q::Int</code>: Minimum mean quality score for reads to be kept. Default is 20.</li><li><code>keep_percent::Int</code>: Percentage of reads to keep after filtering. Default is 95.</li></ul><p><strong>Returns</strong></p><ul><li><code>out_fastq</code></li></ul><p><strong>Details</strong></p><p>This function uses Filtlong to filter long reads and pigz for compression. It requires the Bioconda environment for Filtlong to be set up, which is handled internally.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/fastx.jl#LL512">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.qc_filter_short_reads_fastp-Tuple{}" href="#Mycelia.qc_filter_short_reads_fastp-Tuple{}"><code>Mycelia.qc_filter_short_reads_fastp</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">qc_filter_short_reads_fastp(
;
    forward_reads,
    reverse_reads,
    out_forward,
    out_reverse,
    report_title,
    html,
    json
)
</code></pre><p>Perform quality control (QC) filtering and trimming on short-read FASTQ files using fastp.</p><p><strong>Arguments</strong></p><ul><li><code>in_fastq::String</code>: Path to the input FASTQ file.</li><li><code>out_fastq::String</code>: Path to the output FASTQ file.</li><li><code>adapter_seq::String</code>: Adapter sequence to trim.</li><li><code>quality_threshold::Int</code>: Minimum phred score for trimming (default 20).</li><li><code>min_length::Int</code>: Minimum read length to retain (default 50).</li></ul><p><strong>Returns</strong></p><ul><li><code>String</code>: Path to the filtered and trimmed FASTQ file.</li></ul><p><strong>Details</strong></p><p>This function uses fastp to remove adapter contamination, trim low‐quality bases from the 3′ end, and discard reads shorter than <code>min_length</code>. It’s a simple wrapper that executes the external fastp command.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/fastx.jl#LL296">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.quality_biosequence_graph_to_fastq" href="#Mycelia.quality_biosequence_graph_to_fastq"><code>Mycelia.quality_biosequence_graph_to_fastq</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">quality_biosequence_graph_to_fastq(
    graph::MetaGraphsNext.MetaGraph
) -&gt; Vector{FASTX.FASTQ.Record}
quality_biosequence_graph_to_fastq(
    graph::MetaGraphsNext.MetaGraph,
    output_file::Union{Nothing, AbstractString}
) -&gt; Vector{FASTX.FASTQ.Record}
</code></pre><p>Convert quality-aware BioSequence vertices back to FASTQ records.</p><p>This function demonstrates the key feature of FASTQ graphs - they maintain per-base  quality information and can be converted back to FASTQ format.</p><p><strong>Arguments</strong></p><ul><li><code>graph</code>: Quality-aware BioSequence graph</li><li><code>output_file</code>: Path to output FASTQ file (optional)</li></ul><p><strong>Returns</strong></p><ul><li>Vector of FASTX.FASTQ.Record objects</li></ul><p><strong>Example</strong></p><pre><code class="language-julia hljs"># Convert graph back to FASTQ
fastq_records = quality_biosequence_graph_to_fastq(graph)

# Or write directly to file
quality_biosequence_graph_to_fastq(graph, &quot;output.fastq&quot;)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/fastq-graphs.jl#LL241">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.quality_string_to_phred-Tuple{AbstractString}" href="#Mycelia.quality_string_to_phred-Tuple{AbstractString}"><code>Mycelia.quality_string_to_phred</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">quality_string_to_phred(
    quality_string::AbstractString
) -&gt; Vector{UInt8}
</code></pre><p>Convert FASTQ quality string to numerical PHRED scores.</p><p><strong>Arguments</strong></p><ul><li><code>quality_string::AbstractString</code>: Quality string from FASTQ record (e.g., &quot;IIII&quot;)</li></ul><p><strong>Returns</strong></p><ul><li><code>Vector{UInt8}</code>: PHRED quality scores</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia hljs">scores = quality_string_to_phred(&quot;IIII&quot;)  # Returns [40, 40, 40, 40]
scores = quality_string_to_phred(&quot;!#%+&quot;)  # Returns [0, 2, 4, 10]</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/fastx.jl#LL1499">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.qualmer_correctness_probability-Tuple{Mycelia.Qualmer}" href="#Mycelia.qualmer_correctness_probability-Tuple{Mycelia.Qualmer}"><code>Mycelia.qualmer_correctness_probability</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">qualmer_correctness_probability(
    qmer::Mycelia.Qualmer
) -&gt; Float64
</code></pre><p>Calculate joint probability that a single qualmer is correct. For a k-mer with quality scores [q1, q2, ..., qk], the joint probability that all positions are correct is: ∏(1 - 10^(-qi/10))</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/qualmer-analysis.jl#LL195">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.qualmer_graph_to_quality_biosequence_graph-Tuple{MetaGraphsNext.MetaGraph}" href="#Mycelia.qualmer_graph_to_quality_biosequence_graph-Tuple{MetaGraphsNext.MetaGraph}"><code>Mycelia.qualmer_graph_to_quality_biosequence_graph</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">qualmer_graph_to_quality_biosequence_graph(
    qualmer_graph::MetaGraphsNext.MetaGraph;
    min_path_length
) -&gt; MetaGraphsNext.MetaGraph{Int64, Graphs.SimpleGraphs.SimpleDiGraph{Int64}, _A, _B, _C, Nothing, Mycelia.var&quot;#280#282&quot;, Float64} where {_A, _B, _C}
</code></pre><p>Convert a Qualmer graph to a quality-aware BioSequence graph by collapsing linear paths.</p><p>This is the primary method for creating quality-aware BioSequence graphs from Qualmer graphs, following the 6-graph hierarchy where FASTQ graphs are simplifications of Qualmer graphs with quality retention.</p><p><strong>Arguments</strong></p><ul><li><code>qualmer_graph</code>: MetaGraphsNext Qualmer graph to convert</li><li><code>min_path_length</code>: Minimum path length to keep (default: 2)</li></ul><p><strong>Returns</strong></p><ul><li>MetaGraphsNext.MetaGraph with quality-aware BioSequence vertices</li></ul><p><strong>Example</strong></p><pre><code class="language-julia hljs"># Start with qualmer graph
qualmer_graph = build_qualmer_graph(fastq_records)

# Convert to quality-aware BioSequence graph
quality_graph = qualmer_graph_to_quality_biosequence_graph(qualmer_graph)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/fastq-graphs.jl#LL154">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.qualmer_path_to_biosequence-Tuple{Vector{&lt;:Mycelia.Qualmer}}" href="#Mycelia.qualmer_path_to_biosequence-Tuple{Vector{&lt;:Mycelia.Qualmer}}"><code>Mycelia.qualmer_path_to_biosequence</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Convert qualmer path back to BioSequence and quality vector. Returns a named tuple with sequence and quality_scores.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/iterative-assembly.jl#LL1203-L1206">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.qualmers_canonical-Tuple{FASTX.FASTQ.Record, Int64}" href="#Mycelia.qualmers_canonical-Tuple{FASTX.FASTQ.Record, Int64}"><code>Mycelia.qualmers_canonical</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">qualmers_canonical(
    record::FASTX.FASTQ.Record,
    k::Int64
) -&gt; Base.Generator
</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/qualmer-analysis.jl#LL121">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.qualmers_canonical-Union{Tuple{K}, Tuple{BioSequences.LongAA, AbstractVector{&lt;:Integer}, Val{K}}} where K" href="#Mycelia.qualmers_canonical-Union{Tuple{K}, Tuple{BioSequences.LongAA, AbstractVector{&lt;:Integer}, Val{K}}} where K"><code>Mycelia.qualmers_canonical</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">qualmers_canonical(
    sequence::BioSequences.LongAA,
    quality::AbstractVector{&lt;:Integer},
    _::Val{K}
) -&gt; Base.Generator{I, F} where {I&lt;:(Base.Iterators.Enumerate{I} where I&lt;:(Kmers.FwAAMers{_A, BioSequences.LongAA} where _A)), F&lt;:(Mycelia.var&quot;#228#229&quot;{_A, &lt;:AbstractVector{var&quot;#s36&quot;}} where {_A, var&quot;#s36&quot;&lt;:Integer})}
</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/qualmer-analysis.jl#LL105">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.qualmers_canonical-Union{Tuple{K}, Tuple{N}, Tuple{BioSequences.LongDNA{N}, AbstractVector{&lt;:Integer}, Val{K}}} where {N, K}" href="#Mycelia.qualmers_canonical-Union{Tuple{K}, Tuple{N}, Tuple{BioSequences.LongDNA{N}, AbstractVector{&lt;:Integer}, Val{K}}} where {N, K}"><code>Mycelia.qualmers_canonical</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">qualmers_canonical(
    sequence::BioSequences.LongSequence{BioSequences.DNAAlphabet{N}},
    quality::AbstractVector{&lt;:Integer},
    _::Val{K}
) -&gt; Base.Generator{I, F} where {I&lt;:(Base.Iterators.Enumerate{I} where I&lt;:(Kmers.CanonicalKmers{A, _A, S} where {A&lt;:(BioSequences.DNAAlphabet), _A, S&lt;:(BioSequences.LongDNA)})), F&lt;:(Mycelia.var&quot;#234#235&quot;{_A, &lt;:AbstractVector{var&quot;#s34&quot;}} where {_A, var&quot;#s34&quot;&lt;:Integer})}
</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/qualmer-analysis.jl#LL93">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.qualmers_fw-Tuple{FASTX.FASTQ.Record, Int64}" href="#Mycelia.qualmers_fw-Tuple{FASTX.FASTQ.Record, Int64}"><code>Mycelia.qualmers_fw</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">qualmers_fw(
    record::FASTX.FASTQ.Record,
    k::Int64
) -&gt; Base.Generator
</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/qualmer-analysis.jl#LL112">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.qualmers_fw-Union{Tuple{K}, Tuple{A}, Tuple{BioSequences.LongSequence{A}, AbstractVector{&lt;:Integer}, Val{K}}} where {A, K}" href="#Mycelia.qualmers_fw-Union{Tuple{K}, Tuple{A}, Tuple{BioSequences.LongSequence{A}, AbstractVector{&lt;:Integer}, Val{K}}} where {A, K}"><code>Mycelia.qualmers_fw</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">qualmers_fw(
    sequence::BioSequences.LongSequence{A},
    quality::AbstractVector{&lt;:Integer},
    _::Val{K}
) -&gt; Base.Generator{I, F} where {I&lt;:(Base.Iterators.Enumerate{I} where I&lt;:(Kmers.FwKmers{A, _A, S} where {A&lt;:BioSequences.Alphabet, _A, S&lt;:(BioSequences.LongSequence{A} where A)})), F&lt;:(Mycelia.var&quot;#228#229&quot;{_A, &lt;:AbstractVector{var&quot;#s34&quot;}} where {_A, var&quot;#s34&quot;&lt;:Integer})}
</code></pre><p>Create an iterator that yields DNA qualmers from the given sequence and quality scores.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/qualmer-analysis.jl#LL48">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.qualmers_unambiguous-Tuple{FASTX.FASTQ.Record, Int64}" href="#Mycelia.qualmers_unambiguous-Tuple{FASTX.FASTQ.Record, Int64}"><code>Mycelia.qualmers_unambiguous</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">qualmers_unambiguous(
    record::FASTX.FASTQ.Record,
    k::Int64
) -&gt; Base.Generator
</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/qualmer-analysis.jl#LL130">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.qualmers_unambiguous-Union{Tuple{K}, Tuple{BioSequences.LongAA, AbstractVector{&lt;:Integer}, Val{K}}} where K" href="#Mycelia.qualmers_unambiguous-Union{Tuple{K}, Tuple{BioSequences.LongAA, AbstractVector{&lt;:Integer}, Val{K}}} where K"><code>Mycelia.qualmers_unambiguous</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">qualmers_unambiguous(
    sequence::BioSequences.LongAA,
    quality::AbstractVector{&lt;:Integer},
    _::Val{K}
) -&gt; Base.Generator{I, F} where {I&lt;:(Base.Iterators.Enumerate{I} where I&lt;:(Kmers.FwAAMers{_A, BioSequences.LongAA} where _A)), F&lt;:(Mycelia.var&quot;#228#229&quot;{_A, &lt;:AbstractVector{var&quot;#s36&quot;}} where {_A, var&quot;#s36&quot;&lt;:Integer})}
</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/qualmer-analysis.jl#LL86">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.qualmers_unambiguous-Union{Tuple{K}, Tuple{N}, Tuple{BioSequences.LongDNA{N}, AbstractVector{&lt;:Integer}, Val{K}}} where {N, K}" href="#Mycelia.qualmers_unambiguous-Union{Tuple{K}, Tuple{N}, Tuple{BioSequences.LongDNA{N}, AbstractVector{&lt;:Integer}, Val{K}}} where {N, K}"><code>Mycelia.qualmers_unambiguous</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">qualmers_unambiguous(
    sequence::BioSequences.LongSequence{BioSequences.DNAAlphabet{N}},
    quality::AbstractVector{&lt;:Integer},
    _::Val{K}
) -&gt; Base.Generator{I, F} where {I&lt;:(Kmers.UnambiguousDNAMers{_A, S} where {_A, S&lt;:(BioSequences.LongDNA)}), F&lt;:(Mycelia.var&quot;#230#231&quot;{_A, &lt;:AbstractVector{var&quot;#s34&quot;}} where {_A, var&quot;#s34&quot;&lt;:Integer})}
</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/qualmer-analysis.jl#LL62">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.qualmers_unambiguous-Union{Tuple{K}, Tuple{N}, Tuple{BioSequences.LongRNA{N}, AbstractVector{&lt;:Integer}, Val{K}}} where {N, K}" href="#Mycelia.qualmers_unambiguous-Union{Tuple{K}, Tuple{N}, Tuple{BioSequences.LongRNA{N}, AbstractVector{&lt;:Integer}, Val{K}}} where {N, K}"><code>Mycelia.qualmers_unambiguous</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">qualmers_unambiguous(
    sequence::BioSequences.LongSequence{BioSequences.RNAAlphabet{N}},
    quality::AbstractVector{&lt;:Integer},
    _::Val{K}
) -&gt; Base.Generator{I, F} where {I&lt;:(Kmers.UnambiguousRNAMers{_A, S} where {_A, S&lt;:(BioSequences.LongRNA)}), F&lt;:(Mycelia.var&quot;#232#233&quot;{_A, &lt;:AbstractVector{var&quot;#s34&quot;}} where {_A, var&quot;#s34&quot;&lt;:Integer})}
</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/qualmer-analysis.jl#LL74">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.qualmers_unambiguous_canonical-Tuple{FASTX.FASTQ.Record, Int64}" href="#Mycelia.qualmers_unambiguous_canonical-Tuple{FASTX.FASTQ.Record, Int64}"><code>Mycelia.qualmers_unambiguous_canonical</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">qualmers_unambiguous_canonical(
    record::FASTX.FASTQ.Record,
    k::Int64
) -&gt; Base.Generator{I, Mycelia.var&quot;#236#237&quot;} where I
</code></pre><p>Generate unambiguous canonical qualmers from the given FASTQ record.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/qualmer-analysis.jl#LL152">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.rand_ascii_greek_string-Tuple{Int64}" href="#Mycelia.rand_ascii_greek_string-Tuple{Int64}"><code>Mycelia.rand_ascii_greek_string</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">rand_ascii_greek_string(len::Int) -&gt; String</code></pre><p>Generate a random string of printable ASCII and Greek characters of length <code>len</code>.</p><p>The string contains random printable ASCII characters and both uppercase and lowercase Greek letters.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/simulation.jl#LL43-L49">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.rand_bmp_printable_string-Tuple{Int64}" href="#Mycelia.rand_bmp_printable_string-Tuple{Int64}"><code>Mycelia.rand_bmp_printable_string</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">rand_bmp_printable_string(len::Int) -&gt; String</code></pre><p>Generate a random string of printable Basic Multilingual Plane (BMP) characters of length <code>len</code>.</p><p>The string contains random printable BMP characters, excluding surrogate code points.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/simulation.jl#LL77-L83">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.rand_latin1_string-Tuple{Int64}" href="#Mycelia.rand_latin1_string-Tuple{Int64}"><code>Mycelia.rand_latin1_string</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">rand_latin1_string(len::Int) -&gt; String</code></pre><p>Generate a random string of printable Latin-1 characters of length <code>len</code>.</p><p>The string contains random printable characters from the Latin-1 character set.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/simulation.jl#LL55-L61">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.rand_of_each_group-Tuple{DataFrames.GroupedDataFrame{DataFrames.DataFrame}}" href="#Mycelia.rand_of_each_group-Tuple{DataFrames.GroupedDataFrame{DataFrames.DataFrame}}"><code>Mycelia.rand_of_each_group</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">rand_of_each_group(
    gdf::DataFrames.GroupedDataFrame{DataFrames.DataFrame}
) -&gt; Any
</code></pre><p>Select one random row from each group in a grouped DataFrame.</p><p><strong>Arguments</strong></p><ul><li><code>gdf::GroupedDataFrame</code>: A grouped DataFrame created using <code>groupby</code></li></ul><p><strong>Returns</strong></p><ul><li><code>DataFrame</code>: A new DataFrame containing exactly one randomly sampled row from each group</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/utility-functions.jl#LL1671">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.rand_printable_unicode_string-Tuple{Int64}" href="#Mycelia.rand_printable_unicode_string-Tuple{Int64}"><code>Mycelia.rand_printable_unicode_string</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">rand_printable_unicode_string(len::Int) -&gt; String</code></pre><p>Generate a random string of printable Unicode characters of length <code>len</code>.</p><p>The string contains random printable Unicode characters, excluding surrogate code points.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/simulation.jl#LL66-L72">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.random_fasta_record-Tuple{}" href="#Mycelia.random_fasta_record-Tuple{}"><code>Mycelia.random_fasta_record</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">random_fasta_record(
;
    moltype,
    seed,
    L
) -&gt; FASTX.FASTA.Record
</code></pre><p>Generates a random FASTA record with a specified molecular type and sequence length.</p><p><strong>Arguments</strong></p><ul><li><code>moltype::Symbol=:DNA</code>: The type of molecule to generate (<code>:DNA</code>, <code>:RNA</code>, or <code>:AA</code> for amino acids).</li><li><code>seed</code>: The random seed used for sequence generation (default: a random integer).</li><li><code>L</code>: The length of the sequence (default: a random integer up to <code>typemax(UInt16)</code>).</li></ul><p><strong>Returns</strong></p><ul><li>A <code>FASTX.FASTA.Record</code> containing:<ul><li>A randomly generated UUID identifier.</li><li>A randomly generated sequence of the specified type.</li></ul></li></ul><p><strong>Errors</strong></p><ul><li>Throws an error if <code>moltype</code> is not one of <code>:DNA</code>, <code>:RNA</code>, or <code>:AA</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/simulation.jl#LL631">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.random_symmetric_distance_matrix-Tuple{Any}" href="#Mycelia.random_symmetric_distance_matrix-Tuple{Any}"><code>Mycelia.random_symmetric_distance_matrix</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">random_symmetric_distance_matrix(n) -&gt; Any
</code></pre><p>Generate a random symmetric distance matrix of size n×n with zeros on the diagonal.</p><p><strong>Arguments</strong></p><ul><li><code>n</code>: Positive integer specifying the matrix dimensions</li></ul><p><strong>Returns</strong></p><ul><li>A symmetric n×n matrix with random values in [0,1), zeros on the diagonal</li></ul><p><strong>Details</strong></p><ul><li>The matrix is symmetric, meaning M[i,j] = M[j,i]</li><li>Diagonal elements M[i,i] are set to 0.0</li><li>Off-diagonal elements are uniformly distributed random values</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/utility-functions.jl#LL1689">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.rclone_copy-Tuple{Any, Any}" href="#Mycelia.rclone_copy-Tuple{Any, Any}"><code>Mycelia.rclone_copy</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">rclone_copy(source, dest; config, max_attempts, sleep_timer)
</code></pre><p>Copy files between local and remote storage using rclone with automated retry logic.</p><p><strong>Arguments</strong></p><ul><li><code>source::String</code>: Source path or remote (e.g. &quot;local/path&quot; or &quot;gdrive:folder&quot;)</li><li><code>dest::String</code>: Destination path or remote (e.g. &quot;gdrive:folder&quot; or &quot;local/path&quot;)</li></ul><p><strong>Keywords</strong></p><ul><li><code>config::String=&quot;&quot;</code>: Optional path to rclone config file</li><li><code>max_attempts::Int=3</code>: Maximum number of retry attempts</li><li><code>sleep_timer::Int=60</code>: Initial sleep duration between retries in seconds (doubles after each attempt)</li></ul><p><strong>Details</strong></p><p>Uses optimized rclone settings for large files:</p><ul><li>2GB chunk size</li><li>1TB upload cutoff</li><li>Rate limited to 1 transaction per second</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/rclone.jl#LL55">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.rclone_copy2-Tuple{Any, Any}" href="#Mycelia.rclone_copy2-Tuple{Any, Any}"><code>Mycelia.rclone_copy2</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">rclone_copy2(
    source,
    dest;
    config,
    max_attempts,
    sleep_timer,
    includes,
    excludes,
    recursive
)
</code></pre><p>Copy files between local and remote storage using rclone with automated retry logic.</p><p><strong>Arguments</strong></p><ul><li><code>source::String</code>: Source path or remote (e.g. &quot;local/path&quot; or &quot;gdrive:folder&quot;)</li><li><code>dest::String</code>: Destination path or remote (e.g. &quot;gdrive:folder&quot; or &quot;local/path&quot;)</li></ul><p><strong>Keywords</strong></p><ul><li><code>config::String=&quot;&quot;</code>: Optional path to rclone config file</li><li><code>max_attempts::Int=3</code>: Maximum number of retry attempts</li><li><code>sleep_timer::Int=60</code>: Initial sleep duration between retries in seconds (doubles after each attempt)</li><li><code>includes::Vector{String}=[]</code>: One or more include patterns (each will be passed using <code>--include</code>)</li><li><code>excludes::Vector{String}=[]</code>: One or more exclude patterns (each will be passed using <code>--exclude</code>)</li><li><code>recursive::Bool=false</code>: If true, adds the flag for recursive traversal</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/rclone.jl#LL104">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.rclone_list_directories-Tuple{Any}" href="#Mycelia.rclone_list_directories-Tuple{Any}"><code>Mycelia.rclone_list_directories</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">rclone_list_directories(path) -&gt; Any
</code></pre><p>List all directories at the specified rclone path.</p><p><strong>Arguments</strong></p><ul><li><code>path::String</code>: Remote path to list directories from (e.g. &quot;remote:/path/to/dir&quot;)</li></ul><p><strong>Returns</strong></p><ul><li><code>Vector{String}</code>: Full paths to all directories found at the specified location</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/rclone.jl#LL1">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.read_fastani-Tuple{String}" href="#Mycelia.read_fastani-Tuple{String}"><code>Mycelia.read_fastani</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">read_fastani(path::String) -&gt; DataFrames.DataFrame
</code></pre><p>Imports results of fastani</p><p>Reads and processes FastANI output results from a tab-delimited file.</p><p><strong>Arguments</strong></p><ul><li><code>path::String</code>: Path to the FastANI output file</li></ul><p><strong>Returns</strong></p><p>DataFrame with columns:</p><ul><li><code>query</code>: Original query filepath</li><li><code>query_identifier</code>: Extracted filename without extension</li><li><code>reference</code>: Original reference filepath</li><li><code>reference_identifier</code>: Extracted filename without extension</li><li><code>%_identity</code>: ANI percentage identity</li><li><code>fragments_mapped</code>: Number of fragments mapped</li><li><code>total_query_fragments</code>: Total number of query fragments</li></ul><p><strong>Notes</strong></p><ul><li>Expects tab-delimited input file from FastANI</li><li>Automatically strips .fasta, .fna, or .fa extensions from filenames</li><li>Column order is preserved as listed above</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/alignments-and-mapping.jl#LL1354">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.read_gfa_next" href="#Mycelia.read_gfa_next"><code>Mycelia.read_gfa_next</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">read_gfa_next(
    gfa_file::AbstractString;
    ...
) -&gt; MetaGraphsNext.MetaGraph{Int64, Graphs.SimpleGraphs.SimpleDiGraph{Int64}, Label, VertexData, EdgeData, Nothing, WeightFunction, Float64} where {Label, VertexData, EdgeData, WeightFunction}
read_gfa_next(
    gfa_file::AbstractString,
    graph_mode::Mycelia.GraphMode;
    force_biosequence_graph
) -&gt; MetaGraphsNext.MetaGraph{Int64, Graphs.SimpleGraphs.SimpleDiGraph{Int64}, Label, VertexData, EdgeData, Nothing, WeightFunction, Float64} where {Label, VertexData, EdgeData, WeightFunction}
</code></pre><p>Read a GFA file and auto-detect whether to create a k-mer graph or BioSequence graph.</p><p>This function parses GFA format files and intelligently chooses between:</p><ol><li><strong>Fixed-length k-mer graph</strong> (if all segments have the same length)</li><li><strong>Variable-length BioSequence graph</strong> (if segments have different lengths)</li></ol><p><strong>Arguments</strong></p><ul><li><code>gfa_file</code>: Path to input GFA file</li><li><code>graph_mode</code>: GraphMode (SingleStrand or DoubleStrand, default: DoubleStrand)</li><li><code>force_biosequence_graph</code>: Force creation of variable-length BioSequence graph (default: false)</li></ul><p><strong>Returns</strong></p><ul><li>MetaGraphsNext.MetaGraph with either k-mer vertices or BioSequence vertices</li></ul><p><strong>Auto-Detection Logic</strong></p><ul><li><strong>Fixed-length detection</strong>: If all segments are the same length k, creates <code>DNAKmer{k}</code>/<code>RNAKmer{k}</code>/<code>AAKmer{k}</code> graph</li><li><strong>Variable-length fallback</strong>: If segments have different lengths, creates <code>BioSequence</code> graph</li><li><strong>Override</strong>: Use <code>force_biosequence_graph=true</code> to force variable-length graph</li></ul><p><strong>GFA Format Support</strong></p><p>Supports GFA v1.0 with:</p><ul><li>Header (H) lines (ignored)</li><li>Segment (S) lines: parsed as vertices (k-mer or BioSequence)</li><li>Link (L) lines: parsed as strand-aware edges</li><li>Path (P) lines: stored as metadata (future use)</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia hljs"># Auto-detect graph type
graph = read_gfa_next(&quot;assembly.gfa&quot;)

# Force variable-length BioSequence graph
graph = read_gfa_next(&quot;assembly.gfa&quot;, force_biosequence_graph=true)

# SingleStrand mode with auto-detection
graph = read_gfa_next(&quot;assembly.gfa&quot;, SingleStrand)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/sequence-graphs-next.jl#LL752">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.read_gfa_next" href="#Mycelia.read_gfa_next"><code>Mycelia.read_gfa_next</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">read_gfa_next(
    gfa_file::AbstractString,
    kmer_type::Type
) -&gt; MetaGraphsNext.MetaGraph{Int64, Graphs.SimpleGraphs.SimpleDiGraph{Int64}, _A, _B, _C, Nothing, Mycelia.var&quot;#151#152&quot;, Float64} where {_A, _B, _C}
read_gfa_next(
    gfa_file::AbstractString,
    kmer_type::Type,
    graph_mode::Mycelia.GraphMode
) -&gt; MetaGraphsNext.MetaGraph{Int64, Graphs.SimpleGraphs.SimpleDiGraph{Int64}, _A, _B, _C, Nothing, Mycelia.var&quot;#151#152&quot;, Float64} where {_A, _B, _C}
</code></pre><p>Read a GFA file and convert it to a MetaGraphsNext k-mer graph with fixed-length vertices.</p><p>This function parses GFA format files and creates a strand-aware k-mer graph compatible with the next-generation implementation using fixed-length k-mer vertices.</p><p><strong>Arguments</strong></p><ul><li><code>gfa_file</code>: Path to input GFA file</li><li><code>kmer_type</code>: Type of k-mer to use (e.g., Kmers.DNAKmer{31})</li><li><code>graph_mode</code>: GraphMode (SingleStrand or DoubleStrand, default: DoubleStrand)</li></ul><p><strong>Returns</strong></p><ul><li>MetaGraphsNext.MetaGraph with k-mer vertices and strand-aware edges</li></ul><p><strong>GFA Format Support</strong></p><p>Supports GFA v1.0 with:</p><ul><li>Header (H) lines (ignored)</li><li>Segment (S) lines: parsed as fixed-length k-mer vertices</li><li>Link (L) lines: parsed as strand-aware edges</li><li>Path (P) lines: stored as metadata (future use)</li></ul><p><strong>Example</strong></p><pre><code class="language-julia hljs"># Fixed-length k-mer graph
graph = read_gfa_next(&quot;assembly.gfa&quot;, Kmers.DNAKmer{31})
# Or with specific mode
graph = read_gfa_next(&quot;assembly.gfa&quot;, Kmers.DNAKmer{31}, SingleStrand)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/sequence-graphs-next.jl#LL606">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.read_gff-Tuple{AbstractString}" href="#Mycelia.read_gff-Tuple{AbstractString}"><code>Mycelia.read_gff</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">read_gff(gff::AbstractString) -&gt; DataFrames.DataFrame
</code></pre><p>Reads a GFF (General Feature Format) file and parses it into a DataFrame.</p><p><strong>Arguments</strong></p><ul><li><code>gff::AbstractString</code>: Path to the GFF file</li></ul><p><strong>Returns</strong></p><ul><li><code>DataFrame</code>: A DataFrame containing the parsed GFF data with standard columns: seqid, source, type, start, end, score, strand, phase, and attributes</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/genome-features.jl#LL127">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.read_gff-Tuple{Any}" href="#Mycelia.read_gff-Tuple{Any}"><code>Mycelia.read_gff</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">read_gff(gff_io) -&gt; DataFrames.DataFrame
</code></pre><p>Read a GFF (General Feature Format) file into a DataFrame.</p><p><strong>Arguments</strong></p><ul><li><code>gff_io</code>: An IO stream containing GFF formatted data</li></ul><p><strong>Returns</strong></p><ul><li><code>DataFrame</code>: A DataFrame with standard GFF columns:<ul><li>seqid: sequence identifier</li><li>source: feature source</li><li>type: feature type</li><li>start: start position (1-based)</li><li>end: end position</li><li>score: numeric score</li><li>strand: strand (+, -, or .)</li><li>phase: phase (0, 1, 2 or .)</li><li>attributes: semicolon-separated key-value pairs</li></ul></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/genome-features.jl#LL143">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.read_kraken_report-Tuple{Any}" href="#Mycelia.read_kraken_report-Tuple{Any}"><code>Mycelia.read_kraken_report</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">read_kraken_report(kraken_report) -&gt; DataFrames.DataFrame
</code></pre><p>Parse a Kraken taxonomic classification report into a structured DataFrame.</p><p><strong>Arguments</strong></p><ul><li><code>kraken_report::AbstractString</code>: Path to a tab-delimited Kraken report file</li></ul><p><strong>Returns</strong></p><ul><li><code>DataFrame</code>: A DataFrame with the following columns:<ul><li><code>percentage_of_fragments_at_or_below_taxon</code>: Percentage of fragments covered</li><li><code>number_of_fragments_at_or_below_taxon</code>: Count of fragments at/below taxon</li><li><code>number_of_fragments_assigned_directly_to_taxon</code>: Direct fragment assignments</li><li><code>rank</code>: Taxonomic rank</li><li><code>ncbi_taxonid</code>: NCBI taxonomy identifier</li><li><code>scientific_name</code>: Scientific name (whitespace-trimmed)</li></ul></li></ul><p><strong>Notes</strong></p><ul><li>Scientific names are automatically stripped of leading/trailing whitespace</li><li>Input file must be tab-delimited</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/alignments-and-mapping.jl#LL1404">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.read_mmseqs_easy_search-Tuple{String}" href="#Mycelia.read_mmseqs_easy_search-Tuple{String}"><code>Mycelia.read_mmseqs_easy_search</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">read_mmseqs_easy_search(
    mmseqs_file::String
) -&gt; DataFrames.DataFrame
</code></pre><p>Read results from MMSeqs2 easy-search output file (plain or gzipped) into a DataFrame with optimized memory usage. Automatically detects if the file is gzipped based on the &#39;.gz&#39; extension.</p><p><strong>Arguments</strong></p><ul><li><code>mmseqs_file::String</code>: Path to the tab-delimited output file from MMSeqs2 easy-search.                        Can be a plain text file or a gzipped file (ending in .gz).</li></ul><p><strong>Returns</strong></p><ul><li><code>DataFrame</code>: Contains search results with columns:<ul><li><code>query::String</code>: Query sequence identifier (pooled)</li><li><code>target::String</code>: Target sequence identifier (pooled)</li><li><code>seqIdentity::Float64</code>: Sequence identity (0.0-1.0)</li><li><code>alnLen::Int</code>: Alignment length</li><li><code>mismatch::Int</code>: Number of mismatches</li><li><code>gapOpen::Int</code>: Number of gap openings</li><li><code>qStart::Int</code>: Query start position</li><li><code>qEnd::Int</code>: Query end position</li><li><code>tStart::Int</code>: Target start position</li><li><code>tEnd::Int</code>: Target end position</li><li><code>evalue::Float64</code>: Expected value</li><li><code>bits::Float64</code>: Bit score</li></ul></li></ul><p><strong>Remarks</strong></p><ul><li>Ensure the <code>CodecZlib.jl</code> package is installed for gzipped file support.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/alignments-and-mapping.jl#LL1568">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.read_tsvgz-Tuple{String}" href="#Mycelia.read_tsvgz-Tuple{String}"><code>Mycelia.read_tsvgz</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">read_tsvgz(filename::String; buffer_in_memory::Bool=false, threaded::Bool=true, bufsize::Int=10*1024*1024) -&gt; DataFrames.DataFrame</code></pre><p>Read a DataFrame from a gzipped TSV file.</p><p><strong>Arguments</strong></p><ul><li><code>filename</code>: Path to the gzipped TSV file (must have .tsv.gz extension)</li><li><code>buffer_in_memory</code>: If false, uses temporary files for large data (default: false)</li><li><code>bufsize</code>: Buffer size in bytes for decompression stream (default: 10MB)</li></ul><p><strong>Returns</strong></p><ul><li>The loaded DataFrame</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/utility-functions.jl#LL64-L76">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.regions_overlap-Tuple{Mycelia.RepeatRegion, Mycelia.RepeatRegion}" href="#Mycelia.regions_overlap-Tuple{Mycelia.RepeatRegion, Mycelia.RepeatRegion}"><code>Mycelia.regions_overlap</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Check if two repeat regions overlap.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/sequence-graphs-next.jl#LL1701-L1703">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.remove_duplicate_bubbles-Tuple{Vector{Mycelia.BubbleStructure}}" href="#Mycelia.remove_duplicate_bubbles-Tuple{Vector{Mycelia.BubbleStructure}}"><code>Mycelia.remove_duplicate_bubbles</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Remove duplicate bubbles.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/sequence-graphs-next.jl#LL1438-L1440">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.remove_isolated_vertices!-Tuple{MetaGraphsNext.MetaGraph{&lt;:Integer, String, Mycelia.KmerVertexData, Mycelia.KmerEdgeData}}" href="#Mycelia.remove_isolated_vertices!-Tuple{MetaGraphsNext.MetaGraph{&lt;:Integer, String, Mycelia.KmerVertexData, Mycelia.KmerEdgeData}}"><code>Mycelia.remove_isolated_vertices!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Remove all isolated vertices from the graph.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/sequence-graphs-next.jl#LL1949-L1951">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.remove_path_from_graph!-Tuple{MetaGraphsNext.MetaGraph{&lt;:Integer, String, Mycelia.KmerVertexData, Mycelia.KmerEdgeData}, Vector{String}, String, String}" href="#Mycelia.remove_path_from_graph!-Tuple{MetaGraphsNext.MetaGraph{&lt;:Integer, String, Mycelia.KmerVertexData, Mycelia.KmerEdgeData}, Vector{String}, String, String}"><code>Mycelia.remove_path_from_graph!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Remove a path from the graph.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/sequence-graphs-next.jl#LL1915-L1917">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.repr_long-Tuple{Any}" href="#Mycelia.repr_long-Tuple{Any}"><code>Mycelia.repr_long</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">repr_long(v) -&gt; String
</code></pre><p>Return a string representation of the vector <code>v</code> with each element on a new line, mimicking valid Julia syntax. The output encloses the elements in square brackets and separates them with a comma followed by a newline.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/utility-functions.jl#LL592">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.reset_environment!" href="#Mycelia.reset_environment!"><code>Mycelia.reset_environment!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">reset_environment!(env::AssemblyEnvironment, dataset_idx::Int=1)</code></pre><p>Reset the RL environment to start a new training episode.</p><p><strong>Arguments</strong></p><ul><li><code>env::AssemblyEnvironment</code>: Environment to reset</li><li><code>dataset_idx::Int</code>: Index of training dataset to use (default: 1)</li></ul><p><strong>Returns</strong></p><ul><li><code>AssemblyState</code>: Initial state for new episode</li></ul><p><strong>Example</strong></p><pre><code class="language-julia hljs">initial_state = reset_environment!(env, 2)  # Use second training dataset</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/reinforcement-learning.jl#LL189-L205">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.resolve_repeats_next-Tuple{MetaGraphsNext.MetaGraph{&lt;:Integer, String, Mycelia.KmerVertexData, Mycelia.KmerEdgeData}}" href="#Mycelia.resolve_repeats_next-Tuple{MetaGraphsNext.MetaGraph{&lt;:Integer, String, Mycelia.KmerVertexData, Mycelia.KmerEdgeData}}"><code>Mycelia.resolve_repeats_next</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">resolve_repeats_next(graph::MetaGraphsNext.MetaGraph, min_repeat_length::Int=10) -&gt; Vector{RepeatRegion}</code></pre><p>Identify and characterize repetitive regions in the assembly graph.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/sequence-graphs-next.jl#LL1471-L1475">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.reverse_complement-Tuple{String}" href="#Mycelia.reverse_complement-Tuple{String}"><code>Mycelia.reverse_complement</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Helper function to reverse complement a DNA string.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/viterbi-next.jl#LL480-L482">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.reverse_translate-Tuple{BioSequences.LongAA}" href="#Mycelia.reverse_translate-Tuple{BioSequences.LongAA}"><code>Mycelia.reverse_translate</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">reverse_translate(
    protein_sequence::BioSequences.LongAA
) -&gt; BioSequences.LongSequence{BioSequences.DNAAlphabet{2}}
</code></pre><p>Convert a protein sequence back to a possible DNA coding sequence using weighted random codon selection.</p><p><strong>Arguments</strong></p><ul><li><code>protein_sequence::BioSequences.LongAA</code>: The amino acid sequence to reverse translate</li></ul><p><strong>Returns</strong></p><ul><li><code>BioSequences.LongDNA{2}</code>: A DNA sequence that would translate to the input protein sequence</li></ul><p><strong>Details</strong></p><p>Uses codon usage frequencies to randomly select codons for each amino acid, weighted by their  natural occurrence. Each selected codon is guaranteed to translate back to the original amino acid.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/codon-optimization.jl#LL30">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.rolling_centered_avg-Union{Tuple{AbstractVector{T}}, Tuple{T}} where T" href="#Mycelia.rolling_centered_avg-Union{Tuple{AbstractVector{T}}, Tuple{T}} where T"><code>Mycelia.rolling_centered_avg</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">rolling_centered_avg(data::AbstractArray{T, 1}; window_size)
</code></pre><p>Compute a centered moving average over a vector using a sliding window.</p><p><strong>Arguments</strong></p><ul><li><code>data::AbstractVector{T}</code>: Input vector to be averaged</li><li><code>window_size::Int</code>: Size of the sliding window (odd number recommended)</li></ul><p><strong>Returns</strong></p><ul><li><code>Vector{Float64}</code>: Vector of same length as input containing moving averages</li></ul><p><strong>Details</strong></p><ul><li>For points near the edges, the window is truncated to available data</li><li>Window is centered on each point, using floor(window_size/2) points on each side</li><li>Result type is always Float64 regardless of input type T</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/utility-functions.jl#LL1643">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.run_amrfinderplus-Tuple{}" href="#Mycelia.run_amrfinderplus-Tuple{}"><code>Mycelia.run_amrfinderplus</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">run_amrfinderplus(; fasta, output_dir, force)
</code></pre><p>Run AMRFinderPlus on FASTA input to identify antimicrobial resistance genes.</p><p><strong>Arguments</strong></p><ul><li><code>fasta::String</code>: Path to input FASTA file (must match Mycelia.FASTA_REGEX pattern)</li><li><code>output_dir::String</code>: Output directory path (default: input filename + &quot;_amrfinderplus&quot;)</li><li><code>force::Bool</code>: Force rerun even if output files already exist (default: false)</li></ul><p><strong>Returns</strong></p><p>Path to the output directory containing AMRFinderPlus results</p><p><strong>Details</strong></p><ul><li>For nucleotide FASTA files, automatically runs Mycelia.run_pyrodigal to generate protein sequences</li><li>For protein FASTA files, runs AMRFinderPlus directly  </li><li>Validates input file extension against Mycelia.FASTA_REGEX</li><li>Creates output directory if it doesn&#39;t exist</li><li>Skips processing if results already exist in output directory unless force=true</li><li>Uses –plus flag for enhanced detection capabilities</li></ul><p><strong>Files Generated</strong></p><ul><li><code>&lt;basename&gt;.amrfinderplus.tsv</code>: AMRFinderPlus results table</li><li>For nucleotide inputs: intermediate pyrodigal outputs in subdirectory</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/annotation.jl#LL939">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.run_blast-Tuple{}" href="#Mycelia.run_blast-Tuple{}"><code>Mycelia.run_blast</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">run_blast(
;
    out_dir,
    fasta,
    blast_db,
    blast_command,
    force,
    remote,
    wait
)
</code></pre><p>Run a BLAST (Basic Local Alignment Search Tool) command with the specified parameters.</p><p><strong>Arguments</strong></p><ul><li><code>out_dir::String</code>: The output directory where the BLAST results will be stored.</li><li><code>fasta::String</code>: The path to the input FASTA file.</li><li><code>blast_db::String</code>: The path to the BLAST database.</li><li><code>blast_command::String</code>: The BLAST command to be executed (e.g., <code>blastn</code>, <code>blastp</code>).</li><li><code>force::Bool</code>: If <code>true</code>, forces the BLAST command to run even if the output file already exists. Default is <code>false</code>.</li><li><code>remote::Bool</code>: If <code>true</code>, runs the BLAST command remotely. Default is <code>false</code>.</li><li><code>wait::Bool</code>: If <code>true</code>, waits for the BLAST command to complete before returning. Default is <code>true</code>.</li></ul><p><strong>Returns</strong></p><ul><li><code>outfile::String</code>: The path to the output file containing the BLAST results.</li></ul><p><strong>Description</strong></p><p>This function constructs and runs a BLAST command based on the provided parameters. It creates the necessary output directory, constructs the output file name, and determines whether the BLAST command needs to be run based on the existence and size of the output file. The function supports both local and remote execution of the BLAST command.</p><p>If <code>force</code> is set to <code>true</code> or the output file does not exist or is empty, the BLAST command is executed. The function logs the command being run and measures the time taken for execution. The output file path is returned upon completion.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/alignments-and-mapping.jl#LL1128">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.run_blastn-Tuple{}" href="#Mycelia.run_blastn-Tuple{}"><code>Mycelia.run_blastn</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">run_blastn(
;
    outdir,
    fasta,
    blastdb,
    threads,
    task,
    force,
    remote,
    wait
)
</code></pre><p>Run the BLASTN (Basic Local Alignment Search Tool for Nucleotides) command with specified parameters.</p><p><strong>Arguments</strong></p><ul><li><code>outdir::String</code>: The output directory where the BLASTN results will be saved.</li><li><code>fasta::String</code>: The path to the input FASTA file containing the query sequences.</li><li><code>blastdb::String</code>: The path to the BLAST database to search against.</li><li><code>task::String</code>: The BLASTN task to perform. Default is &quot;megablast&quot;.</li><li><code>force::Bool</code>: If true, forces the BLASTN command to run even if the output file already exists. Default is false.</li><li><code>remote::Bool</code>: If true, runs the BLASTN command remotely. Default is false.</li><li><code>wait::Bool</code>: If true, waits for the BLASTN command to complete before returning. Default is true.</li></ul><p><strong>Returns</strong></p><ul><li><code>outfile::String</code>: The path to the output file containing the BLASTN results.</li></ul><p><strong>Description</strong></p><p>This function constructs and runs a BLASTN command based on the provided parameters. It creates an output directory if it doesn&#39;t exist, constructs the output file path, and checks if the BLASTN command needs to be run based on the existence and size of the output file. The function supports running the BLASTN command locally or remotely, with options to force re-running and to wait for completion.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/alignments-and-mapping.jl#LL1075">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.run_blastp_search-Tuple{}" href="#Mycelia.run_blastp_search-Tuple{}"><code>Mycelia.run_blastp_search</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">run_blastp_search(
;
    query_fasta,
    reference_fasta,
    output_dir,
    threads,
    evalue,
    max_target_seqs
)
</code></pre><p>Perform BLASTP search between query and reference protein FASTA files.</p><p><strong>Arguments</strong></p><ul><li><code>query_fasta::String</code>: Path to query protein FASTA file</li><li><code>reference_fasta::String</code>: Path to reference protein FASTA file</li><li><code>output_dir::String</code>: Output directory (defaults to query filename + &quot;_blastp&quot;)</li><li><code>threads::Int</code>: Number of threads (defaults to system CPU count)</li><li><code>evalue::Float64</code>: E-value threshold (default: 1e-3)</li><li><code>max_target_seqs::Int</code>: Maximum target sequences (default: 500)</li></ul><p><strong>Returns</strong></p><ul><li><code>String</code>: Path to the BLASTP results file (.tsv format)</li></ul><p><strong>Throws</strong></p><ul><li><code>AssertionError</code>: If input files don&#39;t exist or are invalid</li><li><code>SystemError</code>: If BLAST execution fails</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/alignments-and-mapping.jl#LL105">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.run_busco-Tuple{String}" href="#Mycelia.run_busco-Tuple{String}"><code>Mycelia.run_busco</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">run_busco(assembly_file::String; kwargs...)</code></pre><p>Run BUSCO on a single assembly file. See <code>run_busco(::Vector{String})</code> for details.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/quality-control-and-benchmarking.jl#LL944-L948">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.run_busco-Tuple{Vector{String}}" href="#Mycelia.run_busco-Tuple{Vector{String}}"><code>Mycelia.run_busco</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">run_busco(assembly_files::Vector{String}; outdir::String=&quot;busco_results&quot;, lineage::String=&quot;auto&quot;, mode::String=&quot;genome&quot;, threads::Int=Sys.CPU_THREADS, force::Bool=false)</code></pre><p>Run BUSCO (Benchmarking Universal Single-Copy Orthologs) to assess genome assembly completeness.</p><p><strong>Arguments</strong></p><ul><li><code>assembly_files::Vector{String}</code>: Vector of paths to assembly FASTA files to evaluate</li><li><code>outdir::String=&quot;busco_results&quot;</code>: Output directory for BUSCO results</li><li><code>lineage::String=&quot;auto&quot;</code>: BUSCO lineage dataset to use (e.g., &quot;bacteria<em>odb10&quot;, &quot;eukaryota</em>odb10&quot;, &quot;auto&quot;)</li><li><code>mode::String=&quot;genome&quot;</code>: BUSCO mode (&quot;genome&quot;, &quot;transcriptome&quot;, &quot;proteins&quot;)</li><li><code>threads::Int=Sys.CPU_THREADS</code>: Number of threads to use</li><li><code>force::Bool=false</code>: Force overwrite existing results</li></ul><p><strong>Returns</strong></p><ul><li><code>String</code>: Path to the output directory containing BUSCO results</li></ul><p><strong>Output Files</strong></p><ul><li><code>short_summary.specific.lineage.txt</code>: Summary statistics</li><li><code>full_table.tsv</code>: Complete BUSCO results table</li><li><code>missing_busco_list.tsv</code>: List of missing BUSCOs</li><li><code>run_lineage/</code>: Detailed results directory</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia hljs"># Basic completeness assessment
assemblies = [&quot;assembly1.fasta&quot;, &quot;assembly2.fasta&quot;]
busco_dir = Mycelia.run_busco(assemblies)

# Specific lineage
busco_dir = Mycelia.run_busco(assemblies, lineage=&quot;bacteria_odb10&quot;)

# Custom parameters
busco_dir = Mycelia.run_busco(assemblies,
                             outdir=&quot;my_busco_results&quot;,
                             lineage=&quot;enterobacterales_odb10&quot;,
                             threads=8)</code></pre><p><strong>Notes</strong></p><ul><li>Requires BUSCO to be installed via Bioconda</li><li>Auto lineage detection requires internet connection for first run</li><li>Available lineages: bacteria<em>odb10, archaea</em>odb10, eukaryota<em>odb10, fungi</em>odb10, etc.</li><li>Results provide Complete, Fragmented, and Missing BUSCO counts</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/quality-control-and-benchmarking.jl#LL814-L857">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.run_canu-Tuple{}" href="#Mycelia.run_canu-Tuple{}"><code>Mycelia.run_canu</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">run_canu(; fastq, outdir, genome_size, read_type)
</code></pre><p>Run Canu assembler for long read assembly.</p><p><strong>Arguments</strong></p><ul><li><code>fastq::String</code>: Path to input FASTQ file containing long reads</li><li><code>outdir::String</code>: Output directory path (default: &quot;canu_output&quot;)</li><li><code>genome_size::String</code>: Estimated genome size (e.g., &quot;5m&quot;, &quot;1.2g&quot;)</li><li><code>read_type::String</code>: Type of reads (&quot;pacbio&quot;, &quot;nanopore&quot;)</li></ul><p><strong>Returns</strong></p><p>Named tuple containing:</p><ul><li><code>outdir::String</code>: Path to output directory</li><li><code>assembly::String</code>: Path to final assembly file</li></ul><p><strong>Details</strong></p><ul><li>Automatically creates and uses a conda environment with canu</li><li>Includes error correction, trimming, and assembly stages</li><li>Skips assembly if output directory already exists</li><li>Utilizes all available CPU threads</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/assembly.jl#LL107">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.run_checkm-Tuple{String}" href="#Mycelia.run_checkm-Tuple{String}"><code>Mycelia.run_checkm</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">run_checkm(input_path::String; outdir::String=input_path * &quot;_checkm&quot;, db_dir::String=joinpath(homedir(), &quot;workspace&quot;, &quot;.checkm&quot;), extension::String=&quot;fasta&quot;)</code></pre><p>Run CheckM on directory containing FASTA files.</p><p>CheckM requires a directory of genome files as input.</p><p><strong>Arguments</strong></p><ul><li><code>input_path</code>: Path to directory containing FASTA files</li><li><code>outdir</code>: Output directory for CheckM results (default: input<em>path * &quot;</em>checkm&quot;)</li><li><code>db_dir</code>: CheckM database directory (default: ~/.checkm)</li><li><code>extension</code>: File extension for genomes (default: &quot;fasta&quot;)</li><li><code>threads</code>: Number of threads to use (default: all available CPU threads)</li></ul><p><strong>Example</strong></p><pre><code class="language-julia hljs">run_checkm(&quot;./genomes/&quot;)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/quality-control-and-benchmarking.jl#LL376-L394">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.run_checkm2-Tuple{String}" href="#Mycelia.run_checkm2-Tuple{String}"><code>Mycelia.run_checkm2</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">run_checkm2(input_path::String; outdir::String=input_path * &quot;_checkm2&quot;, db_dir::String=joinpath(homedir(), &quot;workspace&quot;, &quot;.checkm2&quot;))</code></pre><p>Run CheckM2 on FASTA file(s) or directory containing FASTA files.</p><p><strong>Arguments</strong></p><ul><li><code>input_path</code>: Path to FASTA file or directory containing FASTA files</li><li><code>outdir</code>: Output directory for CheckM2 results (default: input<em>path * &quot;</em>checkm2&quot;)</li><li><code>threads</code>: Number of threads to use (default: all available CPU threads)</li><li><code>db_dir</code>: CheckM2 database directory (default: ~/.checkm2)</li></ul><p><strong>Returns</strong></p><p>A named tuple with the following fields:</p><ul><li><code>outdir</code>: Output directory path</li><li><code>quality_report</code>: Path to quality_report.tsv</li><li><code>log_file</code>: Path to checkm2.log</li><li><code>diamond_results</code>: Path to DIAMOND_RESULTS.tsv</li><li><code>protein_file</code>: Path to the single .faa file</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/quality-control-and-benchmarking.jl#LL424-L442">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.run_checkm2_list-Tuple{Vector{String}}" href="#Mycelia.run_checkm2_list-Tuple{Vector{String}}"><code>Mycelia.run_checkm2_list</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">run_checkm2_list(fasta_files::Vector{String}; outdir::String=normalized_current_datetime() * &quot;_checkm2&quot;, db_dir::String=joinpath(homedir(), &quot;workspace&quot;, &quot;.checkm2&quot;))</code></pre><p>Run CheckM2 on a list of FASTA files.</p><p>CheckM2 can automatically handle mixed lists of gzipped and non-gzipped files when given a list.</p><p><strong>Arguments</strong></p><ul><li><code>fasta_files</code>: Vector of FASTA file paths (can be mixed gzipped and non-gzipped)</li><li><code>outdir</code>: Output directory for CheckM2 results (default: normalized<em>current</em>datetime() * &quot;_checkm2&quot;)</li><li><code>threads</code>: Number of threads to use (default: all available CPU threads)</li><li><code>db_dir</code>: CheckM2 database directory (default: ~/.checkm2)</li></ul><p><strong>Example</strong></p><pre><code class="language-julia hljs">files = [&quot;genome1.fasta.gz&quot;, &quot;genome2.fasta&quot;, &quot;genome3.fasta.gz&quot;]
run_checkm2_list(files)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/quality-control-and-benchmarking.jl#LL509-L527">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.run_checkv-Tuple{String}" href="#Mycelia.run_checkv-Tuple{String}"><code>Mycelia.run_checkv</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">run_checkv(fasta_file::String; outdir::String=fasta_file * &quot;_checkv&quot;, db_dir::String=joinpath(homedir(), &quot;workspace&quot;, &quot;.checkv&quot;))</code></pre><p>Run CheckV on a single genome FASTA file.</p><p>CheckV assesses the quality and completeness of viral genomes.</p><p><strong>Arguments</strong></p><ul><li><code>fasta_file</code>: Path to single FASTA file (can be gzipped)</li><li><code>outdir</code>: Output directory for CheckV results (default: fasta<em>file * &quot;</em>checkv&quot;)</li><li><code>threads</code>: Number of threads to use (default: all available CPU threads)</li><li><code>db_dir</code>: CheckV database directory (default: ~/.checkv)</li></ul><p><strong>Returns</strong></p><ul><li>Named tuple with fields:<ul><li><code>outdir</code>: Output directory path</li><li><code>complete_genomes</code>: Path to complete_genomes.tsv</li><li><code>completeness</code>: Path to completeness.tsv</li><li><code>contamination</code>: Path to contamination.tsv</li><li><code>proviruses</code>: Path to proviruses.fna</li><li><code>quality_summary</code>: Path to quality_summary.tsv</li><li><code>viruses</code>: Path to viruses.fna</li></ul></li></ul><p><strong>Example</strong></p><pre><code class="language-julia hljs">result = run_checkv(&quot;genome.fasta&quot;)
println(&quot;Quality summary: &quot;, result.quality_summary)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/quality-control-and-benchmarking.jl#LL313-L341">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.run_clustal_omega-Tuple{}" href="#Mycelia.run_clustal_omega-Tuple{}"><code>Mycelia.run_clustal_omega</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">run_clustal_omega(; fasta, outfmt)
</code></pre><p>Run Clustal Omega multiple sequence alignment on a FASTA file.</p><p><strong>Arguments</strong></p><ul><li><code>fasta::String</code>: Path to input FASTA file</li><li><code>outfmt::String=&quot;clustal&quot;</code>: Output format for the alignment</li></ul><p><strong>Returns</strong></p><ul><li><code>String</code>: Path to the output alignment file</li></ul><p><strong>Supported Output Formats</strong></p><ul><li><code>&quot;fasta&quot;</code>: FASTA format</li><li><code>&quot;clustal&quot;</code>: Clustal format</li><li><code>&quot;msf&quot;</code>: MSF format  </li><li><code>&quot;phylip&quot;</code>: PHYLIP format</li><li><code>&quot;selex&quot;</code>: SELEX format</li><li><code>&quot;stockholm&quot;</code>: Stockholm format</li><li><code>&quot;vienna&quot;</code>: Vienna format</li></ul><p><strong>Notes</strong></p><ul><li>Uses Bioconda to manage the Clustal Omega installation</li><li>Caches results - will return existing output file if already generated</li><li>Handles single sequence files gracefully by returning output path without error</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/alignments-and-mapping.jl#LL749">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.run_diamond_search-Tuple{}" href="#Mycelia.run_diamond_search-Tuple{}"><code>Mycelia.run_diamond_search</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">run_diamond_search(
;
    query_fasta,
    reference_fasta,
    output_dir,
    threads,
    evalue,
    block_size,
    sensitivity
)
</code></pre><p>Perform DIAMOND BLASTP search between query and reference protein FASTA files.</p><p><strong>Arguments</strong></p><ul><li><code>query_fasta::String</code>: Path to query protein FASTA file</li><li><code>reference_fasta::String</code>: Path to reference protein FASTA file</li><li><code>output_dir::String</code>: Output directory (defaults to query filename + &quot;_diamond&quot;)</li><li><code>threads::Int</code>: Number of threads (defaults to system CPU count)</li><li><code>evalue::Float64</code>: E-value threshold (default: 1e-3)</li><li><code>block_size::Float64</code>: Block size in GB (default: auto-calculated from system memory)</li><li><code>sensitivity::String</code>: Sensitivity mode (default: &quot;–iterate&quot;)</li></ul><p><strong>Returns</strong></p><ul><li><code>String</code>: Path to the DIAMOND results file (.tsv format)</li></ul><p><strong>Throws</strong></p><ul><li><code>AssertionError</code>: If input files don&#39;t exist or are invalid</li><li><code>SystemError</code>: If DIAMOND execution fails</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/alignments-and-mapping.jl#LL1">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.run_ectyper-Tuple{Any}" href="#Mycelia.run_ectyper-Tuple{Any}"><code>Mycelia.run_ectyper</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">run_ectyper(fasta_file) -&gt; Any
</code></pre><p>Run ECTyper for serotyping E. coli genome assemblies.</p><p><strong>Arguments</strong></p><ul><li><code>fasta_file::String</code>: Path to input FASTA file containing assembled genome(s)</li></ul><p><strong>Returns</strong></p><ul><li><code>String</code>: Path to output directory containing ECTyper results</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/annotation.jl#LL1492">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.run_fastqc-Tuple{}" href="#Mycelia.run_fastqc-Tuple{}"><code>Mycelia.run_fastqc</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">run_fastqc(; forward, reverse, outdir)
</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/fastx.jl#LL105">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.run_flye-Tuple{}" href="#Mycelia.run_flye-Tuple{}"><code>Mycelia.run_flye</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">run_flye(; fastq, outdir, genome_size, read_type)
</code></pre><p>Run Flye assembler for long read assembly.</p><p><strong>Arguments</strong></p><ul><li><code>fastq::String</code>: Path to input FASTQ file containing long reads</li><li><code>outdir::String</code>: Output directory path (default: &quot;flye_output&quot;)</li><li><code>genome_size::String</code>: Estimated genome size (e.g., &quot;5m&quot;, &quot;1.2g&quot;)</li><li><code>read_type::String</code>: Type of reads (&quot;pacbio-raw&quot;, &quot;pacbio-corr&quot;, &quot;pacbio-hifi&quot;, &quot;nano-raw&quot;, &quot;nano-corr&quot;, &quot;nano-hq&quot;)</li></ul><p><strong>Returns</strong></p><p>Named tuple containing:</p><ul><li><code>outdir::String</code>: Path to output directory</li><li><code>assembly::String</code>: Path to final assembly file</li></ul><p><strong>Details</strong></p><ul><li>Automatically creates and uses a conda environment with flye</li><li>Supports various long read technologies and quality levels</li><li>Skips assembly if output directory already exists</li><li>Utilizes all available CPU threads</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/assembly.jl#LL75">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.run_full_benchmark_suite" href="#Mycelia.run_full_benchmark_suite"><code>Mycelia.run_full_benchmark_suite</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">run_full_benchmark_suite()
run_full_benchmark_suite(config::Mycelia.BenchmarkConfig)
</code></pre><p>Run comprehensive performance benchmark suite.</p><p>Executes all benchmark tests and provides a summary report against our targets:</p><ul><li>Memory Usage: 50% reduction through type-stable metadata</li><li>Construction Speed: 2x faster graph building  </li><li>Type Stability: Zero allocations in hot paths</li></ul><p><strong>Arguments</strong></p><ul><li><code>config</code>: BenchmarkConfig for test parameters</li></ul><p><strong>Returns</strong></p><ul><li>NamedTuple with comprehensive results</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/performance-benchmarks.jl#LL268">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.run_genomad-Tuple{}" href="#Mycelia.run_genomad-Tuple{}"><code>Mycelia.run_genomad</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Run geNomad mobile genetic element identification tool.</p><p>geNomad identifies viruses and plasmids in genomic and metagenomic data using machine learning and database comparisons.</p><p><strong>Arguments</strong></p><ul><li><code>input_fasta</code>: Path to input FASTA file</li><li><code>output_directory</code>: Output directory path</li><li><code>genomad_dbpath</code>: Path to geNomad database directory</li><li><code>threads</code>: Number of CPU threads to use</li><li><code>cleanup</code>: Remove intermediate files after completion</li><li><code>splits</code>: Number of splits for memory management</li><li><code>force</code>: Force rerun even if output files already exist</li></ul><p><strong>Returns</strong></p><p>NamedTuple containing paths to all generated output files and directories</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/annotation.jl#LL267-L284">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.run_hifiasm-Tuple{}" href="#Mycelia.run_hifiasm-Tuple{}"><code>Mycelia.run_hifiasm</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">run_hifiasm(; fastq, outdir)
</code></pre><p>Run the hifiasm genome assembler on PacBio HiFi reads.</p><p><strong>Arguments</strong></p><ul><li><code>fastq::String</code>: Path to input FASTQ file containing HiFi reads</li><li><code>outdir::String</code>: Output directory path (default: &quot;{basename(fastq)}_hifiasm&quot;)</li></ul><p><strong>Returns</strong></p><p>Named tuple containing:</p><ul><li><code>outdir::String</code>: Path to output directory</li><li><code>hifiasm_outprefix::String</code>: Prefix used for hifiasm output files</li></ul><p><strong>Details</strong></p><ul><li>Automatically creates and uses a conda environment with hifiasm</li><li>Uses primary assembly mode (–primary) optimized for inbred samples</li><li>Skips assembly if output files already exist at the specified prefix</li><li>Utilizes all available CPU threads</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/assembly.jl#LL146">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.run_mash_comparison-Tuple{String, String}" href="#Mycelia.run_mash_comparison-Tuple{String, String}"><code>Mycelia.run_mash_comparison</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">run_mash_comparison(fasta1::String, fasta2::String; k::Int=21, s::Int=10000, mash_path::String=&quot;mash&quot;)</code></pre><p>Runs a genome-by-genome comparison using the <code>mash</code> command-line tool.</p><p>This function first creates sketch files for each FASTA input and then calculates the distance between them, capturing and parsing the result.</p><p><strong>Arguments</strong></p><ul><li><code>fasta1::String</code>: Path to the first FASTA file.</li><li><code>fasta2::String</code>: Path to the second FASTA file.</li></ul><p><strong>Keyword Arguments</strong></p><ul><li><code>k::Int=21</code>: The k-mer size to use for sketching. Default is 21.</li><li><code>s::Int=10000</code>: The sketch size (number of hashes to keep). Default is 10000.</li><li><code>mash_path::String=&quot;mash&quot;</code>: The path to the mash executable if not in the system PATH.</li></ul><p><strong>Returns</strong></p><ul><li><code>NamedTuple</code>: A named tuple containing the parsed results, e.g., <code>(reference=..., query=..., distance=..., p_value=..., shared_hashes=...)</code></li><li><code>nothing</code>: Returns <code>nothing</code> if the <code>mash</code> command fails.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/sequence-comparison.jl#LL137-L158">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.run_megahit-Tuple{}" href="#Mycelia.run_megahit-Tuple{}"><code>Mycelia.run_megahit</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">run_megahit(
;
    fastq1,
    fastq2,
    outdir,
    min_contig_len,
    k_list
)
</code></pre><p>Run MEGAHIT assembler for metagenomic short read assembly.</p><p><strong>Arguments</strong></p><ul><li><code>fastq1::String</code>: Path to first paired-end FASTQ file</li><li><code>fastq2::String</code>: Path to second paired-end FASTQ file (optional for single-end)</li><li><code>outdir::String</code>: Output directory path (default: &quot;megahit_output&quot;)</li><li><code>min_contig_len::Int</code>: Minimum contig length (default: 200)</li><li><code>k_list::String</code>: k-mer sizes to use (default: &quot;21,29,39,59,79,99,119,141&quot;)</li></ul><p><strong>Returns</strong></p><p>Named tuple containing:</p><ul><li><code>outdir::String</code>: Path to output directory</li><li><code>contigs::String</code>: Path to final contigs file</li></ul><p><strong>Details</strong></p><ul><li>Automatically creates and uses a conda environment with megahit</li><li>Optimized for metagenomic assemblies with varying coverage</li><li>Skips assembly if output directory already exists</li><li>Utilizes all available CPU threads</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/assembly.jl#LL1">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.run_metaspades-Tuple{}" href="#Mycelia.run_metaspades-Tuple{}"><code>Mycelia.run_metaspades</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">run_metaspades(; fastq1, fastq2, outdir, k_list)
</code></pre><p>Run metaSPAdes assembler for metagenomic short read assembly.</p><p><strong>Arguments</strong></p><ul><li><code>fastq1::String</code>: Path to first paired-end FASTQ file</li><li><code>fastq2::String</code>: Path to second paired-end FASTQ file (optional for single-end)</li><li><code>outdir::String</code>: Output directory path (default: &quot;metaspades_output&quot;)</li><li><code>k_list::String</code>: k-mer sizes to use (default: &quot;21,33,55,77&quot;)</li></ul><p><strong>Returns</strong></p><p>Named tuple containing:</p><ul><li><code>outdir::String</code>: Path to output directory</li><li><code>contigs::String</code>: Path to contigs file</li><li><code>scaffolds::String</code>: Path to scaffolds file</li></ul><p><strong>Details</strong></p><ul><li>Automatically creates and uses a conda environment with spades</li><li>Designed for metagenomic datasets with uneven coverage</li><li>Skips assembly if output directory already exists</li><li>Utilizes all available CPU threads</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/assembly.jl#LL38">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.run_mlst-Tuple{Any}" href="#Mycelia.run_mlst-Tuple{Any}"><code>Mycelia.run_mlst</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">run_mlst(fasta_file) -&gt; String
</code></pre><p>Run Multi-Locus Sequence Typing (MLST) analysis on a genome assembly.</p><p><strong>Arguments</strong></p><ul><li><code>fasta_file::String</code>: Path to input FASTA file containing the genome assembly</li></ul><p><strong>Returns</strong></p><ul><li>Path to the output file containing MLST results (<code>&lt;input&gt;.mlst.out</code>)</li></ul><p><strong>Details</strong></p><p>Uses the <code>mlst</code> tool from PubMLST to identify sequence types by comparing allelic  profiles of housekeeping genes against curated MLST schemes.</p><p><strong>Dependencies</strong></p><ul><li>Requires Bioconda and the <code>mlst</code> package</li><li>Automatically sets up conda environment if not present</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/annotation.jl#LL1461">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.run_mmseqs_easy_search-Tuple{}" href="#Mycelia.run_mmseqs_easy_search-Tuple{}"><code>Mycelia.run_mmseqs_easy_search</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">run_mmseqs_easy_search(
;
    query_fasta,
    target_database,
    out_dir,
    outfile,
    format_output,
    threads,
    force
)
</code></pre><p>Runs the MMseqs2 easy-search command on the given query FASTA file against the target database.</p><p><strong>Arguments</strong></p><ul><li><code>query_fasta::String</code>: Path to the query FASTA file.</li><li><code>target_database::String</code>: Path to the target database.</li><li><code>out_dir::String</code>: Directory to store the output file. Defaults to the directory of the query FASTA file.</li><li><code>outfile::String</code>: Name of the output file. Defaults to a combination of the query FASTA and target database filenames.</li><li><code>format_output::String</code>: Format of the output. Defaults to a predefined set of fields.</li><li><code>threads::Int</code>: Number of CPU threads to use. Defaults to the number of CPU threads available.</li><li><code>force::Bool</code>: If true, forces the re-generation of the output file even if it already exists. Defaults to false.</li></ul><p><strong>Returns</strong></p><ul><li><code>outfile_path::String</code>: Path to the generated output file.</li></ul><p><strong>Notes</strong></p><ul><li>Adds the <code>mmseqs2</code> environment using Bioconda if not already present.</li><li>Removes temporary files created during the process.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/alignments-and-mapping.jl#LL973">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.run_mmseqs_search-Tuple{}" href="#Mycelia.run_mmseqs_search-Tuple{}"><code>Mycelia.run_mmseqs_search</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">run_mmseqs_search(
;
    query_fasta,
    reference_fasta,
    output_dir,
    threads,
    evalue,
    sensitivity
)
</code></pre><p>Perform MMseqs2 easy-search between query and reference FASTA files.</p><p><strong>Arguments</strong></p><ul><li><code>query_fasta::String</code>: Path to query FASTA file</li><li><code>reference_fasta::String</code>: Path to reference FASTA file  </li><li><code>output_dir::String</code>: Output directory (defaults to query filename + &quot;_mmseqs&quot;)</li><li><code>threads::Int</code>: Number of threads (defaults to system CPU count)</li><li><code>evalue::Float64</code>: E-value threshold (default: 1e-3)</li><li><code>sensitivity::Float64</code>: Sensitivity parameter (default: 4.0)</li></ul><p><strong>Returns</strong></p><ul><li><code>String</code>: Path to the MMseqs2 results file (.tsv format)</li></ul><p><strong>Throws</strong></p><ul><li><code>AssertionError</code>: If input files don&#39;t exist or are invalid</li><li><code>SystemError</code>: If MMseqs2 execution fails</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/alignments-and-mapping.jl#LL183">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.run_mummer-Tuple{String, String}" href="#Mycelia.run_mummer-Tuple{String, String}"><code>Mycelia.run_mummer</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">run_mummer(reference::String, query::String; outdir::String=&quot;mummer_results&quot;, prefix::String=&quot;out&quot;, mincluster::Int=65, minmatch::Int=20, threads::Int=1)</code></pre><p>Run MUMmer for genome comparison and alignment between reference and query sequences.</p><p><strong>Arguments</strong></p><ul><li><code>reference::String</code>: Path to reference genome FASTA file</li><li><code>query::String</code>: Path to query genome FASTA file  </li><li><code>outdir::String=&quot;mummer_results&quot;</code>: Output directory for MUMmer results</li><li><code>prefix::String=&quot;out&quot;</code>: Prefix for output files</li><li><code>mincluster::Int=65</code>: Minimum cluster length for nucmer</li><li><code>minmatch::Int=20</code>: Minimum match length for nucmer</li><li><code>threads::Int=1</code>: Number of threads (note: MUMmer has limited multithreading)</li></ul><p><strong>Returns</strong></p><ul><li><code>String</code>: Path to the output directory containing MUMmer results</li></ul><p><strong>Output Files</strong></p><ul><li><code>prefix.delta</code>: Delta alignment file (main output)</li><li><code>prefix.coords</code>: Human-readable coordinates file</li><li><code>prefix.snps</code>: SNP/indel report (if show-snps is run)</li><li><code>prefix.plot.png</code>: Dot plot visualization (if mummerplot is run)</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia hljs"># Basic genome comparison
ref_genome = &quot;reference.fasta&quot;
query_genome = &quot;assembly.fasta&quot;
mummer_dir = Mycelia.run_mummer(ref_genome, query_genome)

# Custom parameters
mummer_dir = Mycelia.run_mummer(ref_genome, query_genome,
                               outdir=&quot;comparison_results&quot;,
                               prefix=&quot;comparison&quot;,
                               mincluster=100,
                               minmatch=30)</code></pre><p><strong>Notes</strong></p><ul><li>Requires MUMmer to be installed via Bioconda</li><li>nucmer is used for DNA sequence alignment</li><li>show-coords generates human-readable coordinate output</li><li>Results include alignment coordinates, percent identity, and coverage</li><li>For visualization, use mummerplot (requires gnuplot)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/quality-control-and-benchmarking.jl#LL953-L997">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.run_mummer_plot-Tuple{String}" href="#Mycelia.run_mummer_plot-Tuple{String}"><code>Mycelia.run_mummer_plot</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">run_mummer_plot(delta_file::String; outdir::String=&quot;&quot;, prefix::String=&quot;plot&quot;, plot_type::String=&quot;png&quot;)</code></pre><p>Generate dot plot visualization from MUMmer delta file using mummerplot.</p><p><strong>Arguments</strong></p><ul><li><code>delta_file::String</code>: Path to MUMmer delta file</li><li><code>outdir::String=&quot;&quot;</code>: Output directory (defaults to same as delta file)</li><li><code>prefix::String=&quot;plot&quot;</code>: Prefix for plot files</li><li><code>plot_type::String=&quot;png&quot;</code>: Plot format (&quot;png&quot;, &quot;ps&quot;, &quot;x11&quot;)</li></ul><p><strong>Returns</strong></p><ul><li><code>String</code>: Path to the generated plot file</li></ul><p><strong>Notes</strong></p><ul><li>Requires gnuplot to be installed</li><li>Useful for visualizing genome alignments and rearrangements</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/quality-control-and-benchmarking.jl#LL1076-L1093">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.run_padloc-Tuple{}" href="#Mycelia.run_padloc-Tuple{}"><code>Mycelia.run_padloc</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">run_padloc(; fasta_file, outdir, threads)
</code></pre><p>Run the &#39;padloc&#39; tool from the &#39;padlocbio&#39; conda environment on a given FASTA file.</p><p>https://doi.org/10.1093/nar/gkab883</p><p>https://github.com/padlocbio/padloc</p><p>This function first ensures that the &#39;padloc&#39; environment is available via Bioconda.  It then attempts to update the &#39;padloc&#39; database.  If a &#39;padloc&#39; output file (with a &#39;_padloc.csv&#39; suffix) does not already exist for the input FASTA file,  it runs &#39;padloc&#39; with the specified FASTA file as input.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/annotation.jl#LL1430">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.run_parallel_progress-Tuple{Function, AbstractVector}" href="#Mycelia.run_parallel_progress-Tuple{Function, AbstractVector}"><code>Mycelia.run_parallel_progress</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">run_parallel_progress(
    f::Function,
    items::AbstractVector
) -&gt; Any
</code></pre><p>Run a function <code>f</code> in parallel over a collection of <code>items</code> with a progress meter.</p><p><strong>Arguments</strong></p><ul><li><code>f::Function</code>: The function to be applied to each item in the collection.</li><li><code>items::AbstractVector</code>: A collection of items to be processed.</li></ul><p><strong>Description</strong></p><p>This function creates a progress meter to track the progress of processing each item in the <code>items</code> collection.  It uses multithreading to run the function <code>f</code> on each item in parallel, updating the progress meter after each item is processed.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/utility-functions.jl#LL889">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.run_phageboost-Tuple{}" href="#Mycelia.run_phageboost-Tuple{}"><code>Mycelia.run_phageboost</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">run_phageboost(input_fasta::AbstractString, output_dir::AbstractString; force_reinstall::Bool=false)</code></pre><p>Run PhageBoost on the provided FASTA file, automatically handling conda environment setup.</p><p>This function will:</p><ol><li>Check if the phageboost_env conda environment exists</li><li>Create and set up the environment if it doesn&#39;t exist</li><li>Validate that PhageBoost is properly installed</li><li>Run PhageBoost on the input FASTA file</li><li>Return the output directory path and list of generated files</li></ol><p><strong>Arguments</strong></p><ul><li><code>input_fasta::AbstractString</code>: Path to the input FASTA file</li><li><code>output_dir::AbstractString</code>: Directory where PhageBoost outputs will be saved</li><li><code>force_reinstall::Bool=false</code>: If true, recreate the environment even if it exists</li></ul><p><strong>Returns</strong></p><ul><li><code>NamedTuple</code> with fields:<ul><li><code>output_dir::String</code>: Path to the output directory</li><li><code>files::Vector{String}</code>: List of files generated in the output directory</li></ul></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/annotation.jl#LL1082-L1103">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.run_phispy-Tuple{String}" href="#Mycelia.run_phispy-Tuple{String}"><code>Mycelia.run_phispy</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">run_phispy(input_file::String; output_dir::String=&quot;&quot;, 
       phage_genes::Int=2, color::Bool=false, prefix::String=&quot;&quot;,
       phmms::String=&quot;&quot;, threads::Int=1, metrics::Vector{String}=String[],
       expand_slope::Bool=false, window_size::Int=30, 
       min_contig_size::Int=5000, skip_search::Bool=false,
       output_choice::Int=3, training_set::String=&quot;&quot;, 
       prokka_args::NamedTuple=NamedTuple(), force::Bool=false)</code></pre><p>Run PhiSpy to identify prophages in bacterial genomes.</p><p>PhiSpy identifies prophage regions in bacterial (and archaeal) genomes using multiple approaches including gene composition, AT/GC skew, and optional HMM searches.</p><p><strong>Arguments</strong></p><ul><li><code>input_file::String</code>: Path to input file (FASTA or GenBank format)</li><li><code>output_dir::String</code>: Output directory (default: input<em>file * &quot;</em>phispy&quot;)  </li><li><code>phage_genes::Int</code>: Minimum phage genes required per prophage region (default: 2, set to 0 for mobile elements)</li><li><code>color::Bool</code>: Add color annotations for CDS based on function (default: false)</li><li><code>prefix::String</code>: Prefix for output filenames (default: basename of input)</li><li><code>phmms::String</code>: Path to HMM database for additional phage gene detection</li><li><code>threads::Int</code>: Number of threads for HMM searches (default: 1)</li><li><code>metrics::Vector{String}</code>: Metrics to use for prediction (default: all standard metrics)</li><li><code>expand_slope::Bool</code>: Expand Shannon slope calculations (default: false)</li><li><code>window_size::Int</code>: Window size for calculations (default: 30)</li><li><code>min_contig_size::Int</code>: Minimum contig size to analyze (default: 5000)</li><li><code>skip_search::Bool</code>: Skip HMM search if already done (default: false)</li><li><code>output_choice::Int</code>: Bitmask for output files (default: 3 for coordinates + GenBank)</li><li><code>training_set::String</code>: Path to custom training set</li><li><code>prokka_args::NamedTuple</code>: Additional arguments to pass to Prokka if FASTA input is provided</li><li><code>force::Bool</code>: Force rerun even if output files already exist (default: false)</li></ul><p><strong>Output Choice Codes (add values for multiple outputs)</strong></p><ul><li>1: prophage_coordinates.tsv</li><li>2: GenBank format output  </li><li>4: prophage and bacterial sequences</li><li>8: prophage_information.tsv</li><li>16: prophage.tsv</li><li>32: GFF3 format (prophages only)</li><li>64: prophage.tbl</li><li>128: test data used in random forest</li><li>256: GFF3 format (full genome)</li><li>512: all output files</li></ul><p><strong>Returns</strong></p><p>A NamedTuple with paths to generated output files (contents depend on output_choice):</p><ul><li><code>prophage_coordinates</code>: prophage_coordinates.tsv file path</li><li><code>genbank_output</code>: Updated GenBank file with prophage annotations</li><li><code>prophage_sequences</code>: Prophage and bacterial sequence files</li><li><code>prophage_information</code>: prophage_information.tsv file path</li><li><code>prophage_simple</code>: prophage.tsv file path</li><li><code>gff3_prophages</code>: GFF3 file with prophage regions only</li><li><code>prophage_table</code>: prophage.tbl file path</li><li><code>test_data</code>: Random forest test data file path</li><li><code>gff3_genome</code>: GFF3 file with full genome annotations</li><li><code>output_dir</code>: Path to output directory</li><li><code>input_genbank</code>: Path to GenBank file used (original or generated by Prokka)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/annotation.jl#LL447-L504">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.run_prodigal-Tuple{}" href="#Mycelia.run_prodigal-Tuple{}"><code>Mycelia.run_prodigal</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">run_prodigal(; fasta_file, out_dir)
</code></pre><p>Run Prodigal gene prediction software on input FASTA file to identify protein-coding genes in metagenomes or single genomes.</p><p><strong>Arguments</strong></p><ul><li><code>fasta_file::String</code>: Path to input FASTA file containing genomic sequences</li><li><code>out_dir::String=dirname(fasta_file)</code>: Directory for output files. Defaults to input file&#39;s directory</li></ul><p><strong>Returns</strong></p><p>Named tuple containing paths to all output files:</p><ul><li><code>fasta_file</code>: Input FASTA file path</li><li><code>out_dir</code>: Output directory path  </li><li><code>gff</code>: Path to GFF format gene predictions</li><li><code>gene_scores</code>: Path to all potential genes and their scores</li><li><code>fna</code>: Path to nucleotide sequences of predicted genes</li><li><code>faa</code>: Path to protein translations of predicted genes</li><li><code>std_out</code>: Path to captured stdout</li><li><code>std_err</code>: Path to captured stderr</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/annotation.jl#LL1917">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.run_prokka-Tuple{String}" href="#Mycelia.run_prokka-Tuple{String}"><code>Mycelia.run_prokka</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">run_prokka(input_fasta::String; output_dir::String=&quot;&quot;, prefix::String=&quot;&quot;, 
       cpus::Int=0, kingdom::String=&quot;Bacteria&quot;, genus::String=&quot;&quot;, 
       species::String=&quot;&quot;, strain::String=&quot;&quot;, force_overwrite::Bool=false,
       addgenes::Bool=false, compliant::Bool=false, fast::Bool=false,
       evalue::Float64=1e-06, mincontiglen::Int=1, force::Bool=false)</code></pre><p>Run Prokka for rapid prokaryotic genome annotation.</p><p>Prokka annotates bacterial, archaeal and viral genomes quickly and produces  standards-compliant output files including GFF3, GenBank, and FASTA formats.</p><p><strong>Arguments</strong></p><ul><li><code>input_fasta::String</code>: Path to input FASTA file containing contigs</li><li><code>output_dir::String</code>: Output directory (default: input<em>fasta * &quot;</em>prokka&quot;)</li><li><code>prefix::String</code>: Output file prefix (default: basename of input file)</li><li><code>cpus::Int</code>: Number of CPUs to use, 0 for all available (default: 0)</li><li><code>kingdom::String</code>: Annotation mode - &quot;Bacteria&quot;, &quot;Archaea&quot;, &quot;Viruses&quot;, or &quot;Mitochondria&quot; (default: &quot;Bacteria&quot;)</li><li><code>genus::String</code>: Genus name for annotation</li><li><code>species::String</code>: Species name for annotation  </li><li><code>strain::String</code>: Strain name for annotation</li><li><code>force_overwrite::Bool</code>: Force overwrite existing output directory (default: false)</li><li><code>addgenes::Bool</code>: Add &#39;gene&#39; features for each &#39;CDS&#39; feature (default: false)</li><li><code>compliant::Bool</code>: Force GenBank/ENA/DDJB compliance (default: false)</li><li><code>fast::Bool</code>: Fast mode - skip CDS product searching (default: false)</li><li><code>evalue::Float64</code>: Similarity e-value cut-off (default: 1e-06)</li><li><code>mincontiglen::Int</code>: Minimum contig size (default: 1, NCBI needs 200)</li><li><code>force::Bool</code>: Force rerun even if output files already exist (default: false)</li></ul><p><strong>Returns</strong></p><p>A NamedTuple with paths to all generated output files:</p><ul><li><code>gff</code>: Master annotation in GFF3 format</li><li><code>gbk</code>: Standard GenBank file  </li><li><code>fna</code>: Nucleotide FASTA of input contigs</li><li><code>faa</code>: Protein FASTA of translated CDS sequences</li><li><code>ffn</code>: Nucleotide FASTA of all transcripts</li><li><code>sqn</code>: ASN1 Sequin file for GenBank submission</li><li><code>fsa</code>: Nucleotide FASTA for tbl2asn</li><li><code>tbl</code>: Feature table file</li><li><code>err</code>: NCBI discrepancy report</li><li><code>log</code>: Complete run log</li><li><code>txt</code>: Annotation statistics</li><li><code>tsv</code>: Tab-separated feature table</li><li><code>output_dir</code>: Path to output directory</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/annotation.jl#LL742-L786">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.run_pyrodigal-Tuple{}" href="#Mycelia.run_pyrodigal-Tuple{}"><code>Mycelia.run_pyrodigal</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">run_pyrodigal(; fasta_file, out_dir)
</code></pre><p>Run Pyrodigal gene prediction on a FASTA file using the meta procedure optimized for metagenomic sequences.</p><p>Pyrodigal is a reimplementation of the Prodigal gene finder, which identifies protein-coding sequences in bacterial and archaeal genomes.</p><p><strong>Arguments</strong></p><ul><li><code>fasta_file::String</code>: Path to input FASTA file containing genomic sequences</li><li><code>out_dir::String</code>: Output directory path (default: input filename + &quot;_pyrodigal&quot;)</li></ul><p><strong>Returns</strong></p><p>Named tuple containing:</p><ul><li><code>fasta_file</code>: Input FASTA file path</li><li><code>out_dir</code>: Output directory path</li><li><code>gff</code>: Path to GFF output file with gene predictions</li><li><code>faa</code>: Path to FASTA file with predicted protein sequences </li><li><code>fna</code>: Path to FASTA file with nucleotide sequences</li></ul><p><strong>Notes</strong></p><ul><li>Uses metagenomic mode (<code>-p meta</code>) optimized for mixed communities</li><li>Masks runs of N nucleotides (<code>-m</code> flag)</li><li>Minimum gene length set to 33bp</li><li>Maximum overlap between genes set to 31bp</li><li>Requires Pyrodigal to be available in a Conda environment</li><li>Skips processing if output files already exist</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/annotation.jl#LL2000">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.run_quast-Tuple{String}" href="#Mycelia.run_quast-Tuple{String}"><code>Mycelia.run_quast</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">run_quast(assembly_file::String; kwargs...)</code></pre><p>Run QUAST on a single assembly file. See <code>run_quast(::Vector{String})</code> for details.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/quality-control-and-benchmarking.jl#LL805-L809">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.run_quast-Tuple{Vector{String}}" href="#Mycelia.run_quast-Tuple{Vector{String}}"><code>Mycelia.run_quast</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">run_quast(assembly_files::Vector{String}; outdir::String=&quot;quast_results&quot;, reference::Union{String,Nothing}=nothing, threads::Int=Sys.CPU_THREADS, min_contig::Int=500, gene_finding::Bool=false)</code></pre><p>Run QUAST (Quality Assessment Tool for Genome Assemblies) to evaluate assembly quality.</p><p><strong>Arguments</strong></p><ul><li><code>assembly_files::Vector{String}</code>: Vector of paths to assembly FASTA files to evaluate</li><li><code>outdir::String=&quot;quast_results&quot;</code>: Output directory for QUAST results</li><li><code>reference::Union{String,Nothing}=nothing</code>: Optional reference genome for reference-based metrics</li><li><code>threads::Int=Sys.CPU_THREADS</code>: Number of threads to use</li><li><code>min_contig::Int=500</code>: Minimum contig length to consider</li><li><code>gene_finding::Bool=false</code>: Whether to run gene finding (requires GeneMark-ES/ET)</li></ul><p><strong>Returns</strong></p><ul><li><code>String</code>: Path to the output directory containing QUAST results</li></ul><p><strong>Output Files</strong></p><ul><li><code>report.html</code>: Interactive HTML report</li><li><code>report.txt</code>: Text summary report</li><li><code>report.tsv</code>: Tab-separated values report for programmatic access</li><li><code>transposed_report.tsv</code>: Transposed TSV format</li><li><code>icarus.html</code>: Icarus contig browser (if reference provided)</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia hljs"># Basic assembly evaluation
assemblies = [&quot;assembly1.fasta&quot;, &quot;assembly2.fasta&quot;]
quast_dir = Mycelia.run_quast(assemblies)

# With reference genome
ref_genome = &quot;reference.fasta&quot;
quast_dir = Mycelia.run_quast(assemblies, reference=ref_genome)

# Custom parameters
quast_dir = Mycelia.run_quast(assemblies, 
                             outdir=&quot;my_quast_results&quot;,
                             min_contig=1000,
                             threads=8)</code></pre><p><strong>Notes</strong></p><ul><li>Requires QUAST to be installed via Bioconda</li><li>Without reference: provides basic metrics (N50, total length, # contigs, etc.)</li><li>With reference: adds reference-based metrics (genome fraction, misassemblies, etc.)</li><li>Gene finding requires additional dependencies and is disabled by default</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/quality-control-and-benchmarking.jl#LL685-L730">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.run_samtools_flagstat" href="#Mycelia.run_samtools_flagstat"><code>Mycelia.run_samtools_flagstat</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">run_samtools_flagstat(xam) -&gt; Any
run_samtools_flagstat(xam, samtools_flagstat) -&gt; Any
</code></pre><p>Generate alignment statistics for a SAM/BAM/CRAM file using samtools flagstat.</p><p><strong>Arguments</strong></p><ul><li><code>xam::AbstractString</code>: Path to input SAM/BAM/CRAM alignment file</li><li><code>samtools_flagstat::AbstractString</code>: Output path for flagstat results (default: input_path.samtools-flagstat.txt)</li></ul><p><strong>Returns</strong></p><ul><li><code>String</code>: Path to the generated flagstat output file</li></ul><p><strong>Details</strong></p><p>Runs samtools flagstat to calculate statistics on the alignment file, including:</p><ul><li>Total reads</li><li>Secondary alignments</li><li>Supplementary alignments  </li><li>Duplicates</li><li>Mapped/unmapped reads</li><li>Proper pairs</li><li>Read 1/2 counts</li></ul><p><strong>Requirements</strong></p><ul><li>Requires samtools to be available via Bioconda</li><li>Input file must be in SAM, BAM or CRAM format</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/xam.jl#LL241">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.run_transterm-Tuple{}" href="#Mycelia.run_transterm-Tuple{}"><code>Mycelia.run_transterm</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">run_transterm(; fasta, gff)
</code></pre><p>Run TransTermHP to predict rho-independent transcription terminators in DNA sequences.</p><p><strong>Arguments</strong></p><ul><li><code>fasta</code>: Path to input FASTA file containing DNA sequences</li><li><code>gff</code>: Optional path to GFF annotation file. If provided, improves prediction accuracy</li></ul><p><strong>Returns</strong></p><ul><li><code>String</code>: Path to output file containing TransTermHP predictions</li></ul><p><strong>Details</strong></p><ul><li>Uses Conda environment &#39;transtermhp&#39; for execution</li><li>Automatically generates coordinate file from FASTA or GFF input</li><li>Removes temporary coordinate file after completion</li><li>Requires Mycelia&#39;s Conda setup</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/annotation.jl#LL1514">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.run_trnascan-Tuple{}" href="#Mycelia.run_trnascan-Tuple{}"><code>Mycelia.run_trnascan</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">run_trnascan(; fna_file, outdir)
</code></pre><p>Run tRNAscan-SE to identify and annotate transfer RNA genes in the provided sequence file.</p><p><strong>Arguments</strong></p><ul><li><code>fna_file::String</code>: Path to input FASTA nucleotide file</li><li><code>outdir::String</code>: Output directory path (default: input<em>file</em>path + &quot;_trnascan&quot;)</li></ul><p><strong>Returns</strong></p><ul><li><code>String</code>: Path to the output directory containing tRNAscan-SE results</li></ul><p><strong>Output Files</strong></p><p>Creates the following files in <code>outdir</code>:</p><ul><li><code>*.trnascan.out</code>: Main output with tRNA predictions</li><li><code>*.trnascan.bed</code>: BED format coordinates</li><li><code>*.trnascan.fasta</code>: FASTA sequences of predicted tRNAs</li><li><code>*.trnascan.struct</code>: Secondary structure predictions</li><li><code>*.trnascan.stats</code>: Summary statistics</li><li><code>*.trnascan.log</code>: Program execution log</li></ul><p><strong>Notes</strong></p><ul><li>Uses the general tRNA model (-G flag) suitable for all domains of life</li><li>Automatically sets up tRNAscan-SE via Bioconda</li><li>Skips processing if output directory contains files</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/annotation.jl#LL1749">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.run_unicycler-Tuple{}" href="#Mycelia.run_unicycler-Tuple{}"><code>Mycelia.run_unicycler</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">run_unicycler(; short_1, short_2, long_reads, outdir)
</code></pre><p>Run hybrid assembly combining short and long reads using Unicycler.</p><p><strong>Arguments</strong></p><ul><li><code>short_1::String</code>: Path to first short read FASTQ file</li><li><code>short_2::String</code>: Path to second short read FASTQ file (optional)</li><li><code>long_reads::String</code>: Path to long read FASTQ file</li><li><code>outdir::String</code>: Output directory path (default: &quot;unicycler_output&quot;)</li></ul><p><strong>Returns</strong></p><p>Named tuple containing:</p><ul><li><code>outdir::String</code>: Path to output directory</li><li><code>assembly::String</code>: Path to final assembly file</li></ul><p><strong>Details</strong></p><ul><li>Automatically creates and uses a conda environment with unicycler</li><li>Combines short read accuracy with long read scaffolding</li><li>Skips assembly if output directory already exists</li><li>Utilizes all available CPU threads</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/assembly.jl#LL177">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.run_virsorter2-Tuple{}" href="#Mycelia.run_virsorter2-Tuple{}"><code>Mycelia.run_virsorter2</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Run VirSorter2 viral sequence identification tool.</p><p>VirSorter2 identifies viral sequences in genomic and metagenomic data using machine learning models and database comparisons.</p><p><strong>Arguments</strong></p><ul><li><code>input_fasta</code>: Path to input FASTA file</li><li><code>output_directory</code>: Output directory path</li><li><code>database_path</code>: Path to VirSorter2 database directory</li><li><code>include_groups</code>: Comma-separated viral groups to include<ul><li>full set = <code>dsDNAphage,NCLDV,RNA,ssDNA,lavidaviridae</code></li><li>tools original default set = <code>dsDNAphage,ssDNA</code></li><li>Lavidaviridae = A family of small double‑stranded DNA &quot;virophages&quot; that parasitize the replication machinery of certain NCLDVs</li><li>NCLDV = Nucleocytoplasmic Large DNA Viruses = An informal clade of large double‑stranded DNA viruses that replicate (at least in part) in the cytoplasm of eukaryotic cells.</li></ul></li><li><code>min_score</code>: Minimum score threshold for viral sequences</li><li><code>min_length</code>: Minimum sequence length threshold</li><li><code>threads</code>: Number of CPU threads to use</li><li><code>provirus_off</code>: Disable provirus detection</li><li><code>max_orf_per_seq</code>: Maximum ORFs per sequence</li><li><code>prep_for_dramv</code>: Prepare output for DRAMv annotation</li><li><code>label</code>: Label for output files</li><li><code>forceall</code>: Force rerun all steps</li><li><code>force</code>: Force rerun even if output files already exist</li></ul><p><strong>Returns</strong></p><p>NamedTuple containing paths to all generated output files and directories</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/annotation.jl#LL1-L28">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.samtools_index_fasta-Tuple{}" href="#Mycelia.samtools_index_fasta-Tuple{}"><code>Mycelia.samtools_index_fasta</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">samtools_index_fasta(; fasta)
</code></pre><p>Creates an index file (.fai) for a FASTA reference sequence using samtools.</p><p>The FASTA index allows efficient random access to the reference sequence. This is  required by many bioinformatics tools that need to quickly fetch subsequences  from the reference.</p><p><strong>Arguments</strong></p><ul><li><code>fasta</code>: Path to the input FASTA file</li></ul><p><strong>Side Effects</strong></p><ul><li>Creates a <code>{fasta}.fai</code> index file in the same directory as input</li><li>Installs samtools via conda if not already present</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/fastx.jl#LL1297">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.sanitize_inline_strings!-Tuple{DataFrames.DataFrame}" href="#Mycelia.sanitize_inline_strings!-Tuple{DataFrames.DataFrame}"><code>Mycelia.sanitize_inline_strings!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">sanitize_inline_strings!(
    df::DataFrames.DataFrame
) -&gt; DataFrames.DataFrame
</code></pre><p>Convert all InlineString columns in a DataFrame to standard Strings. Modifies the dataframe in-place and returns it.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/utility-functions.jl#LL550">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.sanitize_inline_strings-Tuple{AbstractVector}" href="#Mycelia.sanitize_inline_strings-Tuple{AbstractVector}"><code>Mycelia.sanitize_inline_strings</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">sanitize_inline_strings(v::AbstractVector) -&gt; Any
</code></pre><p>Convert a column to standard Strings if it contains InlineStrings, otherwise return the original column unchanged.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/utility-functions.jl#LL565">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.sanity_check_matrix-Tuple{AbstractMatrix}" href="#Mycelia.sanity_check_matrix-Tuple{AbstractMatrix}"><code>Mycelia.sanity_check_matrix</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">sanity_check_matrix(M::AbstractMatrix)</code></pre><p>Checks matrix shape, value types, and distributional properties. Suggests the most appropriate ePCA function and distance metric.</p><p>Returns a NamedTuple with fields:</p><ul><li><code>n_features</code>, <code>n_samples</code></li><li><code>value_type</code></li><li><code>range</code></li><li><code>is_binary</code></li><li><code>is_integer</code></li><li><code>is_nonnegative</code></li><li><code>is_strictly_positive</code></li><li><code>is_in_01</code></li><li><code>is_centered</code></li><li><code>is_overdispersed</code></li><li><code>suggested_epca</code></li><li><code>suggested_distance</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/dimensionality-reduction.jl#LL1-L20">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.save_consensus_analysis-Tuple{Dict, String}" href="#Mycelia.save_consensus_analysis-Tuple{Dict, String}"><code>Mycelia.save_consensus_analysis</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Save consensus analysis to JSON file.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/cross-validation.jl#LL509-L511">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.save_df_jld2-Tuple{}" href="#Mycelia.save_df_jld2-Tuple{}"><code>Mycelia.save_df_jld2</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">save_df_jld2(;df::DataFrames.DataFrame, filename::String, key::String=&quot;dataframe&quot;)</code></pre><p>Save a DataFrame to a JLD2 file.</p><p><strong>Arguments</strong></p><ul><li><code>df</code>: The DataFrame to save</li><li><code>filename</code>: Path to the JLD2 file (will add .jld2 extension if not present)</li><li><code>key</code>: The name of the dataset within the JLD2 file (defaults to &quot;dataframe&quot;)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/utility-functions.jl#LL808-L817">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.save_genome_as_fasta-Tuple{Any, Any}" href="#Mycelia.save_genome_as_fasta-Tuple{Any, Any}"><code>Mycelia.save_genome_as_fasta</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">save_genome_as_fasta(genome, filename)</code></pre><p>Save a genome sequence as a FASTA file.</p><p>Convenience function for saving a single genome sequence to FASTA format for annotation benchmarking.</p><p><strong>Arguments</strong></p><ul><li><code>genome</code>: DNA sequence (BioSequences.LongDNA{4})</li><li><code>filename</code>: Output FASTA filename</li></ul><p><strong>See Also</strong></p><ul><li><code>write_fasta</code>: For more flexible FASTA writing with multiple records</li><li><code>random_fasta_record</code>: For generating random FASTA records</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/simulation.jl#LL912-L927">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.save_graph-Tuple{Graphs.AbstractGraph, String}" href="#Mycelia.save_graph-Tuple{Graphs.AbstractGraph, String}"><code>Mycelia.save_graph</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">save_graph(
    graph::Graphs.AbstractGraph,
    outfile::String
) -&gt; String
</code></pre><p>Saves the given graph to a file in JLD2 format.</p><p><strong>Arguments</strong></p><ul><li><code>graph::Graphs.AbstractGraph</code>: The graph to be saved.</li><li><code>outfile::String</code>: The name of the output file. If the file extension is not <code>.jld2</code>, it will be appended automatically.</li></ul><p><strong>Returns</strong></p><ul><li><code>String</code>: The name of the output file with the <code>.jld2</code> extension.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/sequence-graphs.jl#LL705">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.save_kmer_results-Tuple{}" href="#Mycelia.save_kmer_results-Tuple{}"><code>Mycelia.save_kmer_results</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">save_kmer_results(
;
    filename,
    kmers,
    counts,
    fasta_list,
    k,
    alphabet
)
</code></pre><p>Save the kmer counting results (kmers vector, counts sparse matrix) and the input FASTA file list to a JLD2 file for long-term storage and reproducibility.</p><p><strong>Arguments</strong></p><ul><li><code>filename::AbstractString</code>: Path to the output JLD2 file.</li><li><code>kmers::AbstractVector{&lt;:Kmers.Kmer}</code>: The sorted vector of unique kmer objects.</li><li><code>counts::AbstractMatrix</code>: The (sparse or dense) matrix of kmer counts.</li><li><code>fasta_list::AbstractVector{&lt;:AbstractString}</code>: The list of FASTA file paths used as input.</li><li><code>k::Integer</code>: The kmer size used.</li><li><code>alphabet::Symbol</code>: The alphabet used (:AA, :DNA, :RNA).</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/kmer-analysis.jl#LL1">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.save_matrix_jld2-Tuple{}" href="#Mycelia.save_matrix_jld2-Tuple{}"><code>Mycelia.save_matrix_jld2</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">save_matrix_jld2(; matrix, filename)
</code></pre><p>Saves a matrix to a JLD2 file format.</p><p><strong>Arguments</strong></p><ul><li><code>matrix</code>: The matrix to be saved</li><li><code>filename</code>: String path where the file should be saved</li></ul><p><strong>Returns</strong></p><ul><li>The filename string that was used to save the matrix</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/utility-functions.jl#LL1827">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.save_reads_as_fastq" href="#Mycelia.save_reads_as_fastq"><code>Mycelia.save_reads_as_fastq</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">save_reads_as_fastq(reads, filename, base_quality=30)</code></pre><p>Save DNA reads as a FASTQ file with specified quality scores.</p><p>Converts a vector of DNA sequences to FASTQ format with uniform quality scores.</p><p><strong>Arguments</strong></p><ul><li><code>reads</code>: Vector of DNA sequences (BioSequences.LongDNA{4})</li><li><code>filename</code>: Output FASTQ filename</li><li><code>base_quality</code>: Base quality score for all positions (default: 30)</li></ul><p><strong>See Also</strong></p><ul><li><code>write_fastq</code>: For more flexible FASTQ writing with records</li><li><code>fastq_record</code>: For creating individual FASTQ records</li><li><code>generate_test_fastq_data</code>: For generating test FASTQ data with variable quality scores</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/simulation.jl#LL838-L854">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.save_validation_report-Tuple{Dict, String}" href="#Mycelia.save_validation_report-Tuple{Dict, String}"><code>Mycelia.save_validation_report</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Save validation report to JSON file.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/cross-validation.jl#LL500-L502">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.scg_sbatch-Tuple{}" href="#Mycelia.scg_sbatch-Tuple{}"><code>Mycelia.scg_sbatch</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">scg_sbatch(
;
    job_name,
    mail_user,
    mail_type,
    logdir,
    partition,
    account,
    nodes,
    ntasks,
    time,
    cpus_per_task,
    mem_gb,
    cmd
)
</code></pre><p>Submit a job to SLURM using sbatch with specified parameters.</p><p><strong>Arguments</strong></p><ul><li><code>job_name::String</code>: Name identifier for the SLURM job</li><li><code>mail_user::String</code>: Email address for job notifications</li><li><code>mail_type::String</code>: Type of mail notifications (default: &quot;ALL&quot;)</li><li><code>logdir::String</code>: Directory for error and output logs (default: &quot;~/workspace/slurmlogs&quot;)</li><li><code>partition::String</code>: SLURM partition to submit job to</li><li><code>account::String</code>: Account to charge for compute resources</li><li><code>nodes::Int</code>: Number of nodes to allocate (default: 1)</li><li><code>ntasks::Int</code>: Number of tasks to run (default: 1)</li><li><code>time::String</code>: Maximum wall time in format &quot;days-hours:minutes:seconds&quot; (default: &quot;1-00:00:00&quot;)</li><li><code>cpus_per_task::Int</code>: CPUs per task (default: 12)</li><li><code>mem_gb::Int</code>: Memory in GB, defaults to 96GB</li><li><code>cmd::String</code>: Command to execute</li></ul><p><strong>Returns</strong></p><ul><li><code>Bool</code>: Returns true if submission succeeds</li></ul><p><strong>Notes</strong></p><ul><li>Function includes 5-second delays before and after submission</li><li>Memory is automatically scaled with CPU count</li><li>Log files are named with job ID (%j) and job name (%x)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/slurm-sbatch.jl#LL65">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.search_viroid_sequences" href="#Mycelia.search_viroid_sequences"><code>Mycelia.search_viroid_sequences</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">search_viroid_sequences(
;
    ...
) -&gt; Union{Vector{String}, Vector{T} where T&lt;:(SubString{_A} where _A)}
search_viroid_sequences(
    query::String;
    taxon,
    database,
    max_results
) -&gt; Union{Vector{String}, Vector{T} where T&lt;:(SubString{_A} where _A)}
</code></pre><p>Search for viroid sequences in NCBI databases using taxonomic and keyword filtering.</p><p><strong>Arguments</strong></p><ul><li><code>query::String</code>: Search query terms (default: &quot;viroid&quot;)</li><li><code>taxon::String</code>: Taxonomic restriction (default: &quot;viruses[organism]&quot;)</li><li><code>database::String</code>: NCBI database to search (&quot;nuccore&quot;, &quot;protein&quot;, etc.)</li><li><code>max_results::Int</code>: Maximum number of results to return (default: 100)</li></ul><p><strong>Returns</strong></p><ul><li><code>Vector{String}</code>: Vector of NCBI accession numbers matching the search criteria</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia hljs"># Find all viroid genome sequences
accessions = search_viroid_sequences(&quot;viroid&quot;, &quot;viruses[organism]&quot;, &quot;nuccore&quot;)

# Find specific viroid species
pstv_accessions = search_viroid_sequences(&quot;Potato spindle tuber viroid&quot;, &quot;viruses[organism]&quot;, &quot;nuccore&quot;)

# Find viroid proteins
protein_accessions = search_viroid_sequences(&quot;viroid&quot;, &quot;viruses[organism]&quot;, &quot;protein&quot;)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/reference-databases.jl#LL2821">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.select_action-Tuple{Mycelia.DQNPolicy, Mycelia.AssemblyState}" href="#Mycelia.select_action-Tuple{Mycelia.DQNPolicy, Mycelia.AssemblyState}"><code>Mycelia.select_action</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">select_action(policy::DQNPolicy, state::AssemblyState)</code></pre><p>Select an action using the DQN policy with epsilon-greedy exploration.</p><p>This is a placeholder implementation that will be replaced with actual neural network inference once the ML framework is integrated.</p><p><strong>Arguments</strong></p><ul><li><code>policy::DQNPolicy</code>: Trained policy network</li><li><code>state::AssemblyState</code>: Current environment state</li></ul><p><strong>Returns</strong></p><ul><li><code>AssemblyAction</code>: Selected action for the given state</li></ul><p><strong>Example</strong></p><pre><code class="language-julia hljs">action = select_action(policy, current_state)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/reinforcement-learning.jl#LL633-L652">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.seq2sha256-Tuple{AbstractString}" href="#Mycelia.seq2sha256-Tuple{AbstractString}"><code>Mycelia.seq2sha256</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">seq2sha256(seq::AbstractString) -&gt; String
</code></pre><p>Compute the SHA-256 hash of a sequence string.</p><p><strong>Arguments</strong></p><ul><li><code>seq::AbstractString</code>: Input sequence to be hashed</li></ul><p><strong>Returns</strong></p><ul><li><code>String</code>: Hexadecimal representation of the SHA-256 hash</li></ul><p><strong>Details</strong></p><p>The input sequence is converted to uppercase before hashing.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/sequence-comparison.jl#LL361">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.seq2sha256-Tuple{BioSequences.BioSequence}" href="#Mycelia.seq2sha256-Tuple{BioSequences.BioSequence}"><code>Mycelia.seq2sha256</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">seq2sha256(seq::BioSequences.BioSequence) -&gt; String
</code></pre><p>Convert a biological sequence to its SHA256 hash value.</p><p>Calculates a cryptographic hash of the sequence by first converting it to a string representation. This method dispatches to the string version of <code>seq2sha256</code>.</p><p><strong>Arguments</strong></p><ul><li><code>seq::BioSequences.BioSequence</code>: The biological sequence to hash</li></ul><p><strong>Returns</strong></p><ul><li><code>String</code>: A 64-character hexadecimal string representing the SHA256 hash</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/sequence-comparison.jl#LL379">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.sequence_to_kmer_path-Tuple{String, Int64}" href="#Mycelia.sequence_to_kmer_path-Tuple{String, Int64}"><code>Mycelia.sequence_to_kmer_path</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Convert sequence to k-mer path representation (simplified version for backward compatibility).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/iterative-assembly.jl#LL1190-L1192">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.sequence_to_qualmer_path-Tuple{String, String, Any, Int64}" href="#Mycelia.sequence_to_qualmer_path-Tuple{String, String, Any, Int64}"><code>Mycelia.sequence_to_qualmer_path</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Convert sequence with quality to qualmer path representation using graph vertices.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/iterative-assembly.jl#LL1158-L1160">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.sequence_to_stranded_path-Tuple{Any, Any}" href="#Mycelia.sequence_to_stranded_path-Tuple{Any, Any}"><code>Mycelia.sequence_to_stranded_path</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">sequence_to_stranded_path(
    stranded_kmers,
    sequence
) -&gt; Vector{Pair{Int64, Bool}}
</code></pre><p>Convert a DNA sequence into a path through a collection of stranded k-mers.</p><p><strong>Arguments</strong></p><ul><li><code>stranded_kmers</code>: Collection of unique k-mers representing possible path vertices</li><li><code>sequence</code>: Input DNA sequence to convert to a path</li></ul><p><strong>Returns</strong></p><p>Vector of <code>Pair{Int,Bool}</code> where:</p><ul><li>First element (Int) is the index of the k-mer in <code>stranded_kmers</code></li><li>Second element (Bool) indicates orientation (true=forward, false=reverse)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/sequence-graphs.jl#LL115">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.setup_checkm-Tuple{}" href="#Mycelia.setup_checkm-Tuple{}"><code>Mycelia.setup_checkm</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">setup_checkm(; db_dir::String=joinpath(homedir(), &quot;workspace&quot;, &quot;.checkm&quot;))</code></pre><p>Install CheckM via Bioconda and set up its database.</p><p>CheckM is a tool for assessing the quality and completeness of bacterial genomes.</p><p><strong>Arguments</strong></p><ul><li><code>db_dir</code>: Directory to store CheckM database (default: ~/.checkm)</li></ul><p><strong>Example</strong></p><pre><code class="language-julia hljs">setup_checkm()</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/quality-control-and-benchmarking.jl#LL265-L279">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.setup_checkm2-Tuple{}" href="#Mycelia.setup_checkm2-Tuple{}"><code>Mycelia.setup_checkm2</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">setup_checkm2(; db_dir::String=joinpath(homedir(), &quot;workspace&quot;, &quot;.checkm2&quot;))</code></pre><p>Install CheckM2 via Bioconda and set up its database.</p><p>CheckM2 is a rapid tool for assessing the quality and completeness of bacterial genomes.</p><p><strong>Arguments</strong></p><ul><li><code>db_dir</code>: Directory to store CheckM2 database (default: ~/.checkm2)</li></ul><p><strong>Example</strong></p><pre><code class="language-julia hljs">setup_checkm2()</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/quality-control-and-benchmarking.jl#LL289-L303">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.setup_checkv-Tuple{}" href="#Mycelia.setup_checkv-Tuple{}"><code>Mycelia.setup_checkv</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">setup_checkv(; db_dir::String=joinpath(homedir(), &quot;workspace&quot;, &quot;.checkv&quot;))</code></pre><p>Install CheckV via Bioconda and set up its database.</p><p>CheckV is a tool for assessing the quality and completeness of viral genomes.</p><p><strong>Arguments</strong></p><ul><li><code>db_dir</code>: Directory to store CheckV database (default: ~/.checkv)</li></ul><p><strong>Example</strong></p><pre><code class="language-julia hljs">setup_checkv()</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/quality-control-and-benchmarking.jl#LL241-L255">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.setup_padloc-Tuple{}" href="#Mycelia.setup_padloc-Tuple{}"><code>Mycelia.setup_padloc</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">setup_padloc() -&gt; Union{Nothing, Base.Process}
</code></pre><p>Ensure the <code>padloc</code> environment and database are installed.</p><p>Downloads the environment if missing and updates the padloc database.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/annotation.jl#LL1415">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.setup_taxonkit_taxonomy-Tuple{}" href="#Mycelia.setup_taxonkit_taxonomy-Tuple{}"><code>Mycelia.setup_taxonkit_taxonomy</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">setup_taxonkit_taxonomy(; force_update, max_age_days)
</code></pre><p>Downloads and extracts the NCBI taxonomy database required for taxonkit operations.</p><p>Downloads <code>taxdump.tar.gz</code> from NCBI FTP server and extracts it to <code>~/.taxonkit/</code>. This is a prerequisite for using taxonkit-based taxonomy functions.</p><p><strong>Arguments</strong></p><ul><li><code>force_update::Bool=false</code>: Force download even if taxdump already exists</li><li><code>max_age_days::Int=30</code>: Maximum age in days before warning about stale data</li></ul><p><strong>Requirements</strong></p><ul><li>Working internet connection</li><li>Sufficient disk space (~100MB)</li><li><code>taxonkit</code> must be installed separately</li></ul><p><strong>Returns</strong></p><ul><li>Nothing</li></ul><p><strong>Throws</strong></p><ul><li><code>SystemError</code> if download fails or if unable to create directory</li><li><code>ErrorException</code> if tar extraction fails</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/reference-databases.jl#LL2379">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.sha256_file-Tuple{AbstractString}" href="#Mycelia.sha256_file-Tuple{AbstractString}"><code>Mycelia.sha256_file</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">sha256_file(file::AbstractString) -&gt; String
</code></pre><p>Compute the SHA-256 hash of the contents of a file.</p><p><strong>Arguments</strong></p><ul><li><code>file::AbstractString</code>: The path to the file for which the SHA-256 hash is to be computed.</li></ul><p><strong>Returns</strong></p><ul><li><code>String</code>: The SHA-256 hash of the file contents, represented as a hexadecimal string.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/utility-functions.jl#LL873">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.shortest_probability_path_next-Tuple{MetaGraphsNext.MetaGraph, String, String}" href="#Mycelia.shortest_probability_path_next-Tuple{MetaGraphsNext.MetaGraph, String, String}"><code>Mycelia.shortest_probability_path_next</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">shortest_probability_path_next(
    graph::MetaGraphsNext.MetaGraph,
    source::String,
    target::String
) -&gt; Union{Nothing, Mycelia.GraphPath}
</code></pre><p>Find the shortest path in probability space between two vertices.</p><p>Uses Dijkstra&#39;s algorithm where edge distances are -log(probability), so the shortest path corresponds to the highest probability path.</p><p><strong>Arguments</strong></p><ul><li><code>graph</code>: MetaGraphsNext k-mer graph</li><li><code>source</code>: Source vertex label</li><li><code>target</code>: Target vertex label</li></ul><p><strong>Returns</strong></p><ul><li><code>Union{GraphPath, Nothing}</code>: Shortest probability path, or nothing if no path exists</li></ul><p><strong>Algorithm</strong></p><ol><li>Convert edge weights to -log(probability) distances</li><li>Run Dijkstra&#39;s algorithm with strand-aware edge traversal</li><li>Reconstruct path maintaining strand information</li><li>Convert back to probability space for final result</li></ol></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/sequence-graphs-next.jl#LL2088">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.should_continue_k-Tuple{Any, Int64, Int64}" href="#Mycelia.should_continue_k-Tuple{Any, Int64, Int64}"><code>Mycelia.should_continue_k</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Determine if we should continue processing the current k-mer size or move to the next. Uses accuracy-prioritized reward function for decision making.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/intelligent-assembly.jl#LL341-L344">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.should_continue_k_advanced-Tuple{Any, Int64, Int64, Vector{Float64}}" href="#Mycelia.should_continue_k_advanced-Tuple{Any, Int64, Int64, Vector{Float64}}"><code>Mycelia.should_continue_k_advanced</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Advanced decision making with reward history tracking. This function maintains state across iterations for better decisions.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/intelligent-assembly.jl#LL368-L371">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.should_continue_k_progression-Tuple{Vector{Dict{Symbol, Any}}, Int64, Int64}" href="#Mycelia.should_continue_k_progression-Tuple{Vector{Dict{Symbol, Any}}, Int64, Int64}"><code>Mycelia.should_continue_k_progression</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Enhanced convergence detection for k-mer progression. Determines if we should move to the next k-mer size based on multiple criteria.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/iterative-assembly.jl#LL711-L714">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.simple_edit_distance-Tuple{String, String}" href="#Mycelia.simple_edit_distance-Tuple{String, String}"><code>Mycelia.simple_edit_distance</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">simple_edit_distance(s1::String, s2::String) -&gt; Int</code></pre><p>Simple edit distance calculation for k-mers.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/viterbi-next.jl#LL327-L331">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.simplify_graph_next-Tuple{MetaGraphsNext.MetaGraph{&lt;:Integer, String, Mycelia.KmerVertexData, Mycelia.KmerEdgeData}, Vector{Mycelia.BubbleStructure}}" href="#Mycelia.simplify_graph_next-Tuple{MetaGraphsNext.MetaGraph{&lt;:Integer, String, Mycelia.KmerVertexData, Mycelia.KmerEdgeData}, Vector{Mycelia.BubbleStructure}}"><code>Mycelia.simplify_graph_next</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">simplify_graph_next(graph::MetaGraphsNext.MetaGraph, bubbles::Vector{BubbleStructure}) -&gt; MetaGraphsNext.MetaGraph</code></pre><p>Simplify the graph by resolving bubbles and removing low-confidence paths.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/sequence-graphs-next.jl#LL1884-L1888">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.simulate_illumina_paired_reads-Tuple{}" href="#Mycelia.simulate_illumina_paired_reads-Tuple{}"><code>Mycelia.simulate_illumina_paired_reads</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">simulate_illumina_paired_reads(
;
    in_fasta,
    coverage,
    read_count,
    outbase,
    read_length,
    mflen,
    sdev,
    seqSys,
    amplicon,
    errfree,
    rndSeed
)
</code></pre><p>Simulate Illumina short reads from a FASTA file using the ART Illumina simulator.</p><p>This function wraps ART (installed via Bioconda) to simulate reads from an input reference FASTA. It supports paired-end (or optionally single-end/mate-pair) simulation, with options to choose either fold coverage (<code>--fcov</code>) or an absolute read count (<code>--rcount</code>), to enable amplicon mode, and to optionally generate a zero-error SAM file.</p><p><strong>Arguments</strong></p><ul><li><code>in_fasta::String</code>: Path to the input FASTA file.</li><li><code>coverage::Union{Nothing,Number}</code>: Desired fold coverage (used with <code>--fcov</code>); if <code>nothing</code> and <code>read_count</code> is provided then fold coverage is ignored. (Default: 20)</li><li><code>read_count::Union{Nothing,Number}</code>: Total number of reads (or read pairs) to generate (used with <code>--rcount</code> instead of fold coverage). (Default: <code>nothing</code>)</li><li><code>outbase::String</code>: Output file prefix (default: &quot;<span>$(in_fasta).art.$</span>(coverage)x.&quot;).</li><li><code>read_length::Int</code>: Length of reads to simulate (default: 150).</li><li><code>mflen::Int</code>: Mean fragment length for paired-end simulations (default: 500).</li><li><code>sdev::Int</code>: Standard deviation of fragment lengths (default: 10).</li><li><code>seqSys::String</code>: Illumina sequencing system ID (e.g. &quot;HS25&quot; for HiSeq 2500) (default: &quot;HS25&quot;).</li><li><code>paired::Bool</code>: Whether to simulate paired-end reads (default: true).</li><li><code>amplicon::Bool</code>: Enable amplicon sequencing simulation mode (default: false).</li><li><code>errfree::Bool</code>: Generate an extra SAM file with zero sequencing errors (default: false).</li><li><code>rndSeed::Union{Nothing,Int}</code>: Optional seed for reproducibility (default: nothing).</li></ul><p><strong>Outputs</strong></p><p>Generates gzipped FASTQ files in the working directory:</p><ul><li>For paired-end: <code>$(outbase)1.fq.gz</code> (forward) and <code>$(outbase)2.fq.gz</code> (reverse).</li><li>For single-end: <code>$(outbase)1.fq.gz</code>.</li></ul><p>Additional SAM files may be produced if <code>--errfree</code> is enabled and/or if the ART <code>--samout</code> option is specified.</p><p><strong>Details</strong></p><p>This function calls ART with the provided options. Note that if <code>read_count</code> is supplied, the function uses the <code>--rcount</code> option; otherwise, it uses <code>--fcov</code> with the given coverage. Amplicon mode (via <code>--amplicon</code>) restricts the simulation to the amplicon regions, which is important for targeted sequencing studies.</p><p><strong>Dependencies</strong></p><p>Requires ART simulator (installed via Bioconda) and the Mycelia environment helper.</p><p>See also: <code>simulate_nanopore_reads</code>, <code>simulate_nearly_perfect_long_reads</code>, <code>simulate_pacbio_reads</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/simulation.jl#LL89">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.simulate_nanopore_reads-Tuple{}" href="#Mycelia.simulate_nanopore_reads-Tuple{}"><code>Mycelia.simulate_nanopore_reads</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">simulate_nanopore_reads(; fasta, quantity, outfile)
</code></pre><p>Simulate Oxford Nanopore sequencing reads using the Badread tool with 2023 error models.</p><p><strong>Arguments</strong></p><ul><li><code>fasta::String</code>: Path to input reference FASTA file</li><li><code>quantity::String</code>: Either fold coverage (e.g. &quot;50x&quot;) or total bases to sequence (e.g. &quot;1000000&quot;)</li><li><code>outfile::String</code>: Output path for gzipped FASTQ file. Defaults to input filename with modified extension</li></ul><p><strong>Returns</strong></p><ul><li><code>String</code>: Path to the generated output FASTQ file</li></ul><p>See also: <code>simulate_pacbio_reads</code>, <code>simulate_nearly_perfect_long_reads</code>, <code>simulate_short_reads</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/simulation.jl#LL267">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.simulate_nearly_perfect_long_reads-Tuple{}" href="#Mycelia.simulate_nearly_perfect_long_reads-Tuple{}"><code>Mycelia.simulate_nearly_perfect_long_reads</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">simulate_nearly_perfect_long_reads()
</code></pre><p>Simulate high-quality long reads with minimal errors using Badread.</p><p><strong>Arguments</strong></p><ul><li><code>reference::String</code>: Path to reference FASTA file</li><li><code>quantity::String</code>: Coverage depth (e.g. &quot;50x&quot;) or total bases (e.g. &quot;1000000&quot;)</li><li><code>length_mean::Int=40000</code>: Mean read length</li><li><code>length_sd::Int=20000</code>: Standard deviation of read length</li></ul><p><strong>Returns</strong></p><p>Vector of simulated reads in FASTQ format</p><p><strong>Details</strong></p><p>Generates nearly perfect long reads by setting error rates and artifacts to minimum values. Uses ideal quality scores and disables common sequencing artifacts like chimeras and adapters.</p><p>See also: <code>simulate_pacbio_reads</code>, <code>simulate_nanopore_reads</code>, <code>simulate_short_reads</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/simulation.jl#LL294">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.simulate_pacbio_reads-Tuple{}" href="#Mycelia.simulate_pacbio_reads-Tuple{}"><code>Mycelia.simulate_pacbio_reads</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">simulate_pacbio_reads(; fasta, quantity, outfile)
</code></pre><p>Simulate PacBio HiFi reads using the Badread error model.</p><p><strong>Arguments</strong></p><ul><li><code>fasta::String</code>: Path to input FASTA file containing reference sequence</li><li><code>quantity::String</code>: Coverage depth (e.g. &quot;50x&quot;) or total bases (e.g. &quot;1000000&quot;) - NOT TOTAL READS</li><li><code>outfile::String</code>: Output filepath for simulated reads. Defaults to input filename with &quot;.badread.pacbio2021.{quantity}.fq.gz&quot; suffix</li></ul><p><strong>Returns</strong></p><ul><li><code>String</code>: Path to the generated output file</li></ul><p><strong>Notes</strong></p><ul><li>Requires Badread tool from Bioconda</li><li>Uses PacBio 2021 error and quality score models</li><li>Average read length ~15kb</li><li>Output is gzipped FASTQ format</li></ul><p>See also: <code>simulate_nanopore_reads</code>, <code>simulate_nearly_perfect_long_reads</code>, <code>simulate_short_reads</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/simulation.jl#LL235">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.simulate_variants-Tuple{FASTX.FASTA.Record}" href="#Mycelia.simulate_variants-Tuple{FASTX.FASTA.Record}"><code>Mycelia.simulate_variants</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">simulate_variants(
    fasta_record::FASTX.FASTA.Record;
    n_variants,
    window_size,
    variant_size_disbribution,
    variant_type_likelihoods
) -&gt; Any
</code></pre><p>Simulates genetic variants (substitutions, insertions, deletions, inversions) in a DNA sequence.</p><p><strong>Arguments</strong></p><ul><li><code>fasta_record</code>: Input DNA sequence in FASTA format</li></ul><p><strong>Keywords</strong></p><ul><li><code>n_variants=√(sequence_length)</code>: Number of variants to generate</li><li><code>window_size=sequence_length/n_variants</code>: Size of windows for variant placement</li><li><code>variant_size_disbribution=Geometric(1/√window_size)</code>: Distribution for variant sizes</li><li><code>variant_type_likelihoods</code>: Vector of pairs mapping variant types to probabilities<ul><li><code>:substitution =&gt; 10⁻¹</code></li><li><code>:insertion =&gt; 10⁻²</code> </li><li><code>:deletion =&gt; 10⁻²</code></li><li><code>:inversion =&gt; 10⁻²</code></li></ul></li></ul><p><strong>Returns</strong></p><p>DataFrame in VCF format containing simulated variants with columns: CHROM, POS, ID, REF, ALT, QUAL, FILTER, INFO, FORMAT, SAMPLE</p><p><strong>Notes</strong></p><ul><li>Variants are distributed across sequence windows to ensure spread</li><li>Variant sizes are capped by window size</li><li>Equivalent variants are filtered out</li><li>FILTER column indicates variant type</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/simulation.jl#LL381">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.simulate_variants-Tuple{String}" href="#Mycelia.simulate_variants-Tuple{String}"><code>Mycelia.simulate_variants</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">simulate_variants(fasta_file::String) -&gt; String
</code></pre><p>Simulates genetic variants from sequences in a FASTA file and generates corresponding VCF records.</p><p><strong>Arguments</strong></p><ul><li><code>fasta_file::String</code>: Path to input FASTA file containing sequences to analyze</li></ul><p><strong>Details</strong></p><ol><li>Processes each record in the input FASTA file</li><li>Generates simulated variants for each sequence</li><li>Creates a VCF file with the same base name as input file (.vcf extension)</li><li>Updates sequences with simulated variants in a new FASTA file (.vcf.fna extension)</li></ol><p><strong>Returns</strong></p><p>Path to the modified FASTA file containing sequences with simulated variants</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/simulation.jl#LL353">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.sort_contigs_by_length-Tuple{Vector{Mycelia.ContigPath}}" href="#Mycelia.sort_contigs_by_length-Tuple{Vector{Mycelia.ContigPath}}"><code>Mycelia.sort_contigs_by_length</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Sort contigs by length (descending).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/sequence-graphs-next.jl#LL1877-L1879">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.sort_fastq" href="#Mycelia.sort_fastq"><code>Mycelia.sort_fastq</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">sort_fastq(input_fastq) -&gt; String
sort_fastq(input_fastq, output_fastq) -&gt; Any
</code></pre><p>This turns a 4-line FASTQ entry into a single tab separated line, adds a column with the length of each read, passes it to Unix sort, removes the length column, and converts it back into a FASTQ file.</p><p>sorts longest to shortest!!</p><p>http://thegenomefactory.blogspot.com/2012/11/sorting-fastq-files-by-sequence-length.html</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/fastx.jl#LL1099">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.split_gff_attributes_into_columns-Tuple{Any}" href="#Mycelia.split_gff_attributes_into_columns-Tuple{Any}"><code>Mycelia.split_gff_attributes_into_columns</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">split_gff_attributes_into_columns(gff_df) -&gt; Any
</code></pre><p>Takes a GFF (General Feature Format) DataFrame and expands the attributes column into separate columns.</p><p><strong>Arguments</strong></p><ul><li><code>gff_df::DataFrame</code>: A DataFrame containing GFF data with an &#39;attributes&#39; column formatted as key-value pairs separated by semicolons (e.g., &quot;ID=gene1;Name=BRCA1;Type=gene&quot;)</li></ul><p><strong>Returns</strong></p><ul><li><code>DataFrame</code>: The input DataFrame with additional columns for each attribute key found in the &#39;attributes&#39; column</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/genome-features.jl#LL190">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.step_environment!-Tuple{Mycelia.AssemblyEnvironment, Mycelia.AssemblyAction}" href="#Mycelia.step_environment!-Tuple{Mycelia.AssemblyEnvironment, Mycelia.AssemblyAction}"><code>Mycelia.step_environment!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">step_environment!(env::AssemblyEnvironment, action::AssemblyAction)</code></pre><p>Execute an action in the RL environment and return the resulting state and reward.</p><p><strong>Arguments</strong></p><ul><li><code>env::AssemblyEnvironment</code>: Environment to step</li><li><code>action::AssemblyAction</code>: Action to execute</li></ul><p><strong>Returns</strong></p><ul><li><code>Tuple{AssemblyState, RewardComponents, Bool}</code>: (next_state, reward, done)<ul><li><code>next_state</code>: State after action execution</li><li><code>reward</code>: Reward components for the action</li><li><code>done</code>: Whether episode is complete</li></ul></li></ul><p><strong>Example</strong></p><pre><code class="language-julia hljs">action = AssemblyAction(:continue_k, Dict(), 0.95, 1000, 5)
next_state, reward, done = step_environment!(env, action)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/reinforcement-learning.jl#LL249-L269">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.subsample_reads_seqkit-Tuple{}" href="#Mycelia.subsample_reads_seqkit-Tuple{}"><code>Mycelia.subsample_reads_seqkit</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">subsample_reads_seqkit(
;
    in_fastq,
    out_fastq,
    n_reads,
    proportion_reads
)
</code></pre><p>Subsample reads from a FASTQ file using seqkit.</p><p><strong>Arguments</strong></p><ul><li><code>in_fastq::String</code>: Path to input FASTQ file</li><li><code>out_fastq::String=&quot;&quot;</code>: Path to output FASTQ file. If empty, auto-generated based on input filename</li><li><code>n_reads::Union{Missing,Int}=missing</code>: Number of reads to sample</li><li><code>proportion_reads::Union{Missing,Float64}=missing</code>: Proportion of reads to sample (0.0-1.0)</li></ul><p><strong>Returns</strong></p><ul><li><code>String</code>: Path to the output FASTQ file</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/fastx.jl#LL1234">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.sufficient_improvements" href="#Mycelia.sufficient_improvements"><code>Mycelia.sufficient_improvements</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Determine if sufficient improvements were made to continue with current k. Enhanced with convergence detection and adaptive thresholds.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/iterative-assembly.jl#LL669-L672">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.system_mem_to_minimap_index_size-Tuple{}" href="#Mycelia.system_mem_to_minimap_index_size-Tuple{}"><code>Mycelia.system_mem_to_minimap_index_size</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">system_mem_to_minimap_index_size(
;
    system_mem_gb,
    denominator
) -&gt; String
</code></pre><p>Compute the minimap2 index size string based on available system memory.</p><p><strong>Arguments</strong></p><ul><li><code>system_mem_gb::Real</code>: Amount of memory (GB) to allocate for indexing.</li><li><code>denominator::Real</code>: Factor to scale the memory usage (default <code>Mycelia.DEFAULT_MINIMAP_DENOMINATOR</code>).</li></ul><p><strong>Returns</strong></p><ul><li><code>String</code>: Value such as <code>&quot;4G&quot;</code> suitable for the minimap2 <code>-I</code> option.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/alignments-and-mapping.jl#LL461">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.system_overview-Tuple{}" href="#Mycelia.system_overview-Tuple{}"><code>Mycelia.system_overview</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">system_overview(
;
    path
) -&gt; @NamedTuple{system_threads::Int64, julia_threads::Int64, total_memory::String, available_memory::String, occupied_memory::String, total_storage::String, available_storage::String, occupied_storage::String}
</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/utility-functions.jl#LL1505">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.tar_extract-Tuple{}" href="#Mycelia.tar_extract-Tuple{}"><code>Mycelia.tar_extract</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">tar_extract(; tarchive, directory)
</code></pre><p>Extract contents of a gzipped tar archive file to a specified directory.</p><p><strong>Arguments</strong></p><ul><li><code>tarchive::AbstractString</code>: Path to the .tar.gz file to extract</li><li><code>directory::AbstractString=dirname(tarchive)</code>: Target directory for extraction (defaults to the archive&#39;s directory)</li></ul><p><strong>Returns</strong></p><ul><li><code>AbstractString</code>: Path to the directory where contents were extracted</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/utility-functions.jl#LL1252">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.tar_gz_files-Tuple{String, Vector{String}}" href="#Mycelia.tar_gz_files-Tuple{String, Vector{String}}"><code>Mycelia.tar_gz_files</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">tar_gz_files(output_file::String, input_files::Vector{String})</code></pre><p>Creates a tar.gz archive from input_files. Handles many files by writing a file list and using <code>tar -czf ... -T filelist</code>. Appends <code>.tar.gz</code> if missing.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/utility-functions.jl#LL309-L315">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.taxids2lca-Tuple{Vector{Int64}}" href="#Mycelia.taxids2lca-Tuple{Vector{Int64}}"><code>Mycelia.taxids2lca</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">taxids2lca(ids::Vector{Int64}) -&gt; Int64
</code></pre><p>Calculate the Lowest Common Ancestor (LCA) taxonomic ID for a set of input taxonomic IDs.</p><p><strong>Arguments</strong></p><ul><li><code>ids::Vector{Int}</code>: Vector of NCBI taxonomic IDs</li></ul><p><strong>Returns</strong></p><ul><li><code>Int</code>: The taxonomic ID of the lowest common ancestor</li></ul><p><strong>Details</strong></p><p>Uses taxonkit to compute the LCA. Automatically sets up the required taxonomy database  if not already present in <code>~/.taxonkit/</code>.</p><p><strong>Dependencies</strong></p><ul><li>Requires taxonkit (installed via Bioconda)</li><li>Requires taxonomy database (downloaded automatically if missing)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/taxonomy-and-trees.jl#LL1054">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.taxids2ncbi_taxonomy_table-Tuple{AbstractVector{Int64}}" href="#Mycelia.taxids2ncbi_taxonomy_table-Tuple{AbstractVector{Int64}}"><code>Mycelia.taxids2ncbi_taxonomy_table</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">taxids2ncbi_taxonomy_table(
    taxids::AbstractVector{Int64}
) -&gt; DataFrames.DataFrame
</code></pre><p>Convert a vector of NCBI taxonomy IDs into a detailed taxonomy table using NCBI Datasets CLI.</p><p><strong>Arguments</strong></p><ul><li><code>taxids::AbstractVector{Int}</code>: Vector of NCBI taxonomy IDs to query</li></ul><p><strong>Returns</strong></p><ul><li><code>DataFrame</code>: Table containing taxonomy information with columns including:<ul><li>tax_id</li><li>species</li><li>genus</li><li>family</li><li>order</li><li>class</li><li>phylum</li><li>kingdom</li></ul></li></ul><p><strong>Dependencies</strong></p><p>Requires ncbi-datasets-cli Conda package (automatically installed if missing)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/taxonomy-and-trees.jl#LL880">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.taxids2taxonkit_summarized_lineage_table-Tuple{AbstractVector{Int64}}" href="#Mycelia.taxids2taxonkit_summarized_lineage_table-Tuple{AbstractVector{Int64}}"><code>Mycelia.taxids2taxonkit_summarized_lineage_table</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">taxids2taxonkit_summarized_lineage_table(
    taxids::AbstractVector{Int64}
) -&gt; DataFrames.DataFrame
</code></pre><p>Convert a vector of taxonomy IDs to a summarized lineage table using taxonkit.</p><p><strong>Arguments</strong></p><ul><li><code>taxids::AbstractVector{Int}</code>: Vector of NCBI taxonomy IDs</li></ul><p><strong>Returns</strong></p><p>DataFrame with the following columns:</p><ul><li><code>taxid</code>: Original input taxonomy ID</li><li><code>species_taxid</code>, <code>species</code>: Species level taxonomy ID and name</li><li><code>genus_taxid</code>, <code>genus</code>: Genus level taxonomy ID and name  </li><li><code>family_taxid</code>, <code>family</code>: Family level taxonomy ID and name</li><li><code>superkingdom_taxid</code>, <code>superkingdom</code>: Superkingdom level taxonomy ID and name</li></ul><p>Missing values are used when a taxonomic rank is not available.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/taxonomy-and-trees.jl#LL996">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.taxids2taxonkit_taxid2lineage_ranks-Tuple{AbstractVector{Int64}}" href="#Mycelia.taxids2taxonkit_taxid2lineage_ranks-Tuple{AbstractVector{Int64}}"><code>Mycelia.taxids2taxonkit_taxid2lineage_ranks</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">taxids2taxonkit_taxid2lineage_ranks(
    taxids::AbstractVector{Int64}
) -&gt; Dict{Int64, Dict{String, @NamedTuple{lineage::String, taxid::Union{Missing, Int64}}}}
</code></pre><p>Convert taxonomic IDs to a structured lineage rank mapping.</p><p>Takes a vector of taxonomic IDs and returns a nested dictionary mapping each input taxid  to its complete taxonomic lineage information. For each taxid, creates a dictionary where:</p><ul><li>Keys are taxonomic ranks (e.g., &quot;species&quot;, &quot;genus&quot;, &quot;family&quot;)</li><li>Values are NamedTuples containing:<ul><li><code>lineage::String</code>: The taxonomic name at that rank</li><li><code>taxid::Union{Int, Missing}</code>: The corresponding taxonomic ID (if available)</li></ul></li></ul><p>Excludes &quot;no rank&quot; entries from the final output.</p><p>Returns:     Dict{Int, Dict{String, NamedTuple{(:lineage, :taxid), Tuple{String, Union{Int, Missing}}}}}</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/taxonomy-and-trees.jl#LL963">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.taxonomic_id_to_children-Tuple{Any}" href="#Mycelia.taxonomic_id_to_children-Tuple{Any}"><code>Mycelia.taxonomic_id_to_children</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">taxonomic_id_to_children(
    tax_id;
    DATABASE_ID,
    USERNAME,
    PASSWORD
)
</code></pre><p>Query Neo4j database to find all descendant taxonomic IDs for a given taxonomic ID.</p><p><strong>Arguments</strong></p><ul><li><code>tax_id</code>: Source taxonomic ID to find children for</li><li><code>DATABASE_ID</code>: Neo4j database identifier (required)</li><li><code>USERNAME</code>: Neo4j database username (default: &quot;neo4j&quot;)</li><li><code>PASSWORD</code>: Neo4j database password (required)</li></ul><p><strong>Returns</strong></p><p><code>Vector{Int}</code>: Sorted array of unique child taxonomic IDs</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/neo4jl.jl#LL554">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.test_cross_validation-Tuple{}" href="#Mycelia.test_cross_validation-Tuple{}"><code>Mycelia.test_cross_validation</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Test function for cross-validation with sample data.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/cross-validation.jl#LL590-L592">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.test_intelligent_assembly-Tuple{}" href="#Mycelia.test_intelligent_assembly-Tuple{}"><code>Mycelia.test_intelligent_assembly</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Test function to verify the implementation with sample data.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/intelligent-assembly.jl#LL622-L624">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.test_iterative_assembly-Tuple{}" href="#Mycelia.test_iterative_assembly-Tuple{}"><code>Mycelia.test_iterative_assembly</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Test function for iterative assembly with sample data.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/iterative-assembly.jl#LL841-L843">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.test_rl_framework-Tuple{}" href="#Mycelia.test_rl_framework-Tuple{}"><code>Mycelia.test_rl_framework</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">test_rl_framework()</code></pre><p>Test the reinforcement learning framework with minimal examples.</p><p>This function provides a comprehensive test of the RL infrastructure using small synthetic datasets.</p><p><strong>Returns</strong></p><ul><li><code>Bool</code>: Whether all tests passed</li></ul><p><strong>Example</strong></p><pre><code class="language-julia hljs">success = test_rl_framework()</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/reinforcement-learning.jl#LL1085-L1100">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.train_assembly_agent-Tuple{Vector{String}, Vector{String}}" href="#Mycelia.train_assembly_agent-Tuple{Vector{String}, Vector{String}}"><code>Mycelia.train_assembly_agent</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">train_assembly_agent(training_data::Vector{String}, validation_data::Vector{String}; 
                    episodes=1000, episode_length=100)</code></pre><p>Train a reinforcement learning agent for assembly optimization.</p><p>This function implements the complete training loop for the hierarchical RL system.</p><p><strong>Arguments</strong></p><ul><li><code>training_data::Vector{String}</code>: Paths to training FASTQ files</li><li><code>validation_data::Vector{String}</code>: Paths to validation FASTQ files</li><li><code>episodes::Int</code>: Number of training episodes (default: 1000)</li><li><code>episode_length::Int</code>: Maximum steps per episode (default: 100)</li></ul><p><strong>Returns</strong></p><ul><li><code>Tuple{DQNPolicy, Vector{Float64}}</code>: (trained<em>policy, training</em>rewards)</li></ul><p><strong>Example</strong></p><pre><code class="language-julia hljs">training_files = [&quot;train1.fastq&quot;, &quot;train2.fastq&quot;, &quot;train3.fastq&quot;]
validation_files = [&quot;val1.fastq&quot;, &quot;val2.fastq&quot;]
policy, rewards = train_assembly_agent(training_files, validation_files, episodes=500)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/reinforcement-learning.jl#LL683-L706">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.train_with_curriculum-Tuple{Vector{Dict}, Vector{String}}" href="#Mycelia.train_with_curriculum-Tuple{Vector{Dict}, Vector{String}}"><code>Mycelia.train_with_curriculum</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">train_with_curriculum(curriculum_schedule::Vector{Dict}, validation_data::Vector{String})</code></pre><p>Train the RL agent using curriculum learning.</p><p><strong>Arguments</strong></p><ul><li><code>curriculum_schedule::Vector{Dict}</code>: Curriculum stages</li><li><code>validation_data::Vector{String}</code>: Validation datasets</li></ul><p><strong>Returns</strong></p><ul><li><code>Tuple{DQNPolicy, Vector{Float64}}</code>: (trained<em>policy, stage</em>rewards)</li></ul><p><strong>Example</strong></p><pre><code class="language-julia hljs">curriculum = create_curriculum_schedule()
policy, rewards = train_with_curriculum(curriculum, validation_files)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/reinforcement-learning.jl#LL1012-L1029">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.translate_nucleic_acid_fasta-Tuple{Any, Any}" href="#Mycelia.translate_nucleic_acid_fasta-Tuple{Any, Any}"><code>Mycelia.translate_nucleic_acid_fasta</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">translate_nucleic_acid_fasta(
    fasta_nucleic_acid_file,
    fasta_amino_acid_file
) -&gt; Any
</code></pre><p>Translates nucleic acid sequences from a FASTA file into amino acid sequences.</p><p><strong>Arguments</strong></p><ul><li><code>fasta_nucleic_acid_file::String</code>: Path to input FASTA file containing nucleic acid sequences</li><li><code>fasta_amino_acid_file::String</code>: Path where the translated amino acid sequences will be written</li></ul><p><strong>Returns</strong></p><ul><li><code>String</code>: Path to the output FASTA file containing translated amino acid sequences</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/fastx.jl#LL1023">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.transterm_output_to_gff-Tuple{Any}" href="#Mycelia.transterm_output_to_gff-Tuple{Any}"><code>Mycelia.transterm_output_to_gff</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">transterm_output_to_gff(transterm_output) -&gt; Any
</code></pre><p>Convert TransTerm terminator predictions output to GFF3 format.</p><p>Parses TransTerm output and generates a standardized GFF3 file with the following transformations:</p><ul><li>Sets source field to &quot;transterm&quot;</li><li>Sets feature type to &quot;terminator&quot;  </li><li>Converts terminator IDs to GFF attributes</li><li>Renames fields to match GFF3 spec</li></ul><p><strong>Arguments</strong></p><ul><li><code>transterm_output::String</code>: Path to the TransTerm output file</li></ul><p><strong>Returns</strong></p><ul><li><code>String</code>: Path to the generated GFF3 file (original filename with .gff extension)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/annotation.jl#LL2191">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.trim_galore_paired-Tuple{}" href="#Mycelia.trim_galore_paired-Tuple{}"><code>Mycelia.trim_galore_paired</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">trim_galore_paired(; forward_reads, reverse_reads, outdir)
</code></pre><p>Trim paired-end FASTQ reads using Trim Galore, a wrapper around Cutadapt and FastQC.</p><p><strong>Arguments</strong></p><ul><li><code>forward_reads::String</code>: Path to forward reads FASTQ file</li><li><code>reverse_reads::String</code>: Path to reverse reads FASTQ file</li><li><code>outdir::String</code>: Output directory for trimmed files</li></ul><p><strong>Returns</strong></p><ul><li><code>Tuple{String, String}</code>: Paths to trimmed forward and reverse read files</li></ul><p><strong>Dependencies</strong></p><p>Requires trim_galore conda environment:</p><ul><li><code>mamba create -n trim_galore -c bioconda trim_galore</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/fastx.jl#LL257">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.try_local_path_improvements-Tuple{FASTX.FASTQ.Record, Any, Int64, Float64}" href="#Mycelia.try_local_path_improvements-Tuple{FASTX.FASTQ.Record, Any, Int64, Float64}"><code>Mycelia.try_local_path_improvements</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Local heuristic improvements (fallback method). Returns (improved<em>read, likelihood</em>improvement).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/iterative-assembly.jl#LL1009-L1012">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.try_statistical_path_resampling-Tuple{FASTX.FASTQ.Record, Any, Int64}" href="#Mycelia.try_statistical_path_resampling-Tuple{FASTX.FASTQ.Record, Any, Int64}"><code>Mycelia.try_statistical_path_resampling</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Try statistical path resampling for alternative high-likelihood paths. Returns (improved_read, likelihood) or nothing if no improvement.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/iterative-assembly.jl#LL952-L955">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.try_viterbi_path_improvement-Tuple{FASTX.FASTQ.Record, Any, Int64}" href="#Mycelia.try_viterbi_path_improvement-Tuple{FASTX.FASTQ.Record, Any, Int64}"><code>Mycelia.try_viterbi_path_improvement</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Try to improve FASTQ read using Viterbi algorithm from viterbi-next.jl. Returns (improved_read, likelihood) or nothing if no improvement.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/iterative-assembly.jl#LL893-L896">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.type_to_string-Tuple{AbstractString}" href="#Mycelia.type_to_string-Tuple{AbstractString}"><code>Mycelia.type_to_string</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">type_to_string(T::AbstractString) -&gt; Any
</code></pre><p>Converts an AbstractString type to its string representation.</p><p><strong>Arguments</strong></p><ul><li><code>T::AbstractString</code>: The string type to convert</li></ul><p><strong>Returns</strong></p><p>A string representation of the input type</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/utility-functions.jl#LL1756">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.type_to_string-Tuple{Any}" href="#Mycelia.type_to_string-Tuple{Any}"><code>Mycelia.type_to_string</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">type_to_string(T) -&gt; Any
</code></pre><p>Convert a type to its string representation, with special handling for Kmer types.</p><p><strong>Arguments</strong></p><ul><li><code>T</code>: The type to convert to string</li></ul><p><strong>Returns</strong></p><ul><li>String representation of the type<ul><li>For Kmer types: Returns &quot;Kmers.DNAKmer{K}&quot; where K is the kmer length</li><li>For other types: Returns the standard string representation</li></ul></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/utility-functions.jl#LL1735">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.umap_embed-Tuple{AbstractMatrix{&lt;:Real}}" href="#Mycelia.umap_embed-Tuple{AbstractMatrix{&lt;:Real}}"><code>Mycelia.umap_embed</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">umap_embed(
    X::AbstractMatrix{&lt;:Real};
    n_neighbors,
    min_dist,
    n_components
) -&gt; UMAP.UMAP_{S, M, N, D, Matrix{Int64}, I} where {S&lt;:Real, M&lt;:AbstractMatrix{S}, N&lt;:AbstractMatrix{S}, D&lt;:AbstractMatrix{S}, I&lt;:AbstractMatrix{S}}
</code></pre><pre><code class="nohighlight hljs">umap_embed(scores::AbstractMatrix{&lt;:Real};
           n_neighbors::Int=15,
           min_dist::Float64=0.1,
           n_components::Int=2)</code></pre><p>Embed your PC/EPCA scores (k×n<em>samples) into `n</em>components` via UMAP.</p><p><strong>When to use</strong></p><p>Use for visualizing high-dimensional data in 2 or 3 dimensions, especially when the data may have nonlinear structure. UMAP is suitable for both continuous and discrete data, and is robust to non-Gaussian distributions. Input should be a matrix of features or dimensionally-reduced scores (e.g., from PCA or EPCA).</p><p><strong>Arguments</strong></p><ul><li><code>scores</code>      : (components × samples) matrix  </li><li><code>n_neighbors</code> : UMAP neighborhood size  </li><li><code>min_dist</code>    : UMAP min_dist  </li><li><code>n_components</code>: output dimension (2 or 3)</li></ul><p><strong>Returns</strong></p><ul><li><code>model</code>        : the trained UMAP.UMAP model  </li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/dimensionality-reduction.jl#LL352">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.update_bioconda_env-Tuple{Any}" href="#Mycelia.update_bioconda_env-Tuple{Any}"><code>Mycelia.update_bioconda_env</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">update_bioconda_env(pkg) -&gt; Base.Process
</code></pre><p>Update a package and its dependencies in its dedicated Conda environment.</p><p><strong>Arguments</strong></p><ul><li><code>pkg::String</code>: Name of the package/environment to update</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/bioconda.jl#LL184">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.update_fasta_with_vcf-Tuple{}" href="#Mycelia.update_fasta_with_vcf-Tuple{}"><code>Mycelia.update_fasta_with_vcf</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">update_fasta_with_vcf(; in_fasta, vcf_file, out_fasta)
</code></pre><p>Apply variants from a VCF file to a reference FASTA sequence.</p><p><strong>Arguments</strong></p><ul><li><code>in_fasta</code>: Path to input reference FASTA file</li><li><code>vcf_file</code>: Path to input VCF file containing variants</li><li><code>out_fasta</code>: Optional output path for modified FASTA. Defaults to replacing &#39;.vcf&#39; with &#39;.normalized.vcf.fna&#39;</li></ul><p><strong>Details</strong></p><ol><li>Normalizes indels in the VCF using bcftools norm</li><li>Applies variants to the reference sequence using bcftools consensus</li><li>Handles temporary files and compression with bgzip/tabix</li></ol><p><strong>Requirements</strong></p><p>Requires bioconda packages: htslib, tabix, bcftools</p><p><strong>Returns</strong></p><p>Path to the output FASTA file containing the modified sequence</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/variant-analysis.jl#LL44">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.update_gff_with_mmseqs-Tuple{Any, Any}" href="#Mycelia.update_gff_with_mmseqs-Tuple{Any, Any}"><code>Mycelia.update_gff_with_mmseqs</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">update_gff_with_mmseqs(
    gff_file,
    mmseqs_file
) -&gt; DataFrames.DataFrame
</code></pre><p>Update GFF annotations with protein descriptions from MMseqs2 search results.</p><p><strong>Arguments</strong></p><ul><li><code>gff_file::String</code>: Path to input GFF3 format file</li><li><code>mmseqs_file::String</code>: Path to MMseqs2 easy-search output file</li></ul><p><strong>Returns</strong></p><ul><li><code>DataFrame</code>: Modified GFF table with updated attribute columns containing protein descriptions</li></ul><p><strong>Details</strong></p><p>Takes sequence matches from MMseqs2 and adds their descriptions as &#39;label&#39; and &#39;product&#39;  attributes in the GFF file. Only considers top hits from MMseqs2 results. Preserves existing  GFF attributes while prepending new annotations.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/genome-features.jl#LL60">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.upload_edge_type_over_url_from_graph-Tuple{}" href="#Mycelia.upload_edge_type_over_url_from_graph-Tuple{}"><code>Mycelia.upload_edge_type_over_url_from_graph</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">upload_edge_type_over_url_from_graph(
;
    src_type,
    dst_type,
    edge_type,
    graph,
    ADDRESS,
    USERNAME,
    PASSWORD,
    DATABASE,
    window_size
)
</code></pre><p>Upload edges of a specific type from a MetaGraph to a Neo4j database, batching uploads in windows.</p><p><strong>Arguments</strong></p><ul><li><code>src_type</code>: Type of source nodes to filter</li><li><code>dst_type</code>: Type of destination nodes to filter  </li><li><code>edge_type</code>: Type of edges to upload</li><li><code>graph</code>: MetaGraph containing the nodes and edges</li><li><code>ADDRESS</code>: Neo4j server URL</li><li><code>USERNAME</code>: Neo4j username (default: &quot;neo4j&quot;)</li><li><code>PASSWORD</code>: Neo4j password</li><li><code>DATABASE</code>: Neo4j database name (default: &quot;neo4j&quot;)</li><li><code>window_size</code>: Number of edges to upload in each batch (default: 100)</li></ul><p><strong>Details</strong></p><ul><li>Filters edges based on source, destination and edge types</li><li>Preserves all edge properties except :TYPE when uploading</li><li>Uses MERGE operations to avoid duplicate nodes/relationships</li><li>Uploads are performed in batches for better performance</li><li>Progress is shown via ProgressMeter</li></ul><p><strong>Returns</strong></p><p>Nothing</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/neo4jl.jl#LL388">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.upload_node_over_api-Tuple{Any, Any}" href="#Mycelia.upload_node_over_api-Tuple{Any, Any}"><code>Mycelia.upload_node_over_api</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">upload_node_over_api(
    graph,
    v;
    ADDRESS,
    USERNAME,
    PASSWORD,
    DATABASE
)
</code></pre><p>Upload a single node from a MetaGraph to a Neo4j database using the HTTP API.</p><p><strong>Arguments</strong></p><ul><li><code>graph</code>: MetaGraph containing the node to be uploaded</li><li><code>v</code>: Vertex identifier in the graph</li><li><code>ADDRESS</code>: Neo4j server address (e.g. &quot;http://localhost:7474&quot;)</li><li><code>USERNAME</code>: Neo4j authentication username (default: &quot;neo4j&quot;)</li><li><code>PASSWORD</code>: Neo4j authentication password</li><li><code>DATABASE</code>: Target Neo4j database name (default: &quot;neo4j&quot;)</li></ul><p><strong>Details</strong></p><p>Generates and executes a Cypher MERGE command using the node&#39;s properties. The node&#39;s :TYPE  and :identifier properties are used for node labeling, while other non-empty properties  are added as node properties.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/neo4jl.jl#LL192">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.upload_node_table-Tuple{}" href="#Mycelia.upload_node_table-Tuple{}"><code>Mycelia.upload_node_table</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">upload_node_table(
;
    table,
    window_size,
    address,
    password,
    username,
    database,
    neo4j_import_dir
)
</code></pre><p>Upload a DataFrame to Neo4j as nodes in batched windows.</p><p><strong>Arguments</strong></p><ul><li><code>table::DataFrame</code>: Input DataFrame where each row becomes a node. Must contain a &quot;TYPE&quot; column.</li><li><code>address::String</code>: Neo4j server address (e.g. &quot;bolt://localhost:7687&quot;)</li><li><code>password::String</code>: Neo4j database password</li><li><code>neo4j_import_dir::String</code>: Directory path accessible to Neo4j for importing files</li><li><code>window_size::Int=1000</code>: Number of rows to process in each batch</li><li><code>username::String=&quot;neo4j&quot;</code>: Neo4j database username</li><li><code>database::String=&quot;neo4j&quot;</code>: Target Neo4j database name</li></ul><p><strong>Notes</strong></p><ul><li>All rows must have the same node type (specified in &quot;TYPE&quot; column)</li><li>Column names become node properties</li><li>Requires write permissions on neo4j<em>import</em>dir</li><li>Large tables are processed in batches of size window_size</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/neo4jl.jl#LL144">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.upload_node_type_over_url_from_graph-Tuple{}" href="#Mycelia.upload_node_type_over_url_from_graph-Tuple{}"><code>Mycelia.upload_node_type_over_url_from_graph</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">upload_node_type_over_url_from_graph(
;
    node_type,
    graph,
    ADDRESS,
    USERNAME,
    PASSWORD,
    DATABASE,
    window_size
)
</code></pre><p>Upload nodes of a specific type from a graph to a Neo4j database using MERGE operations.</p><p><strong>Arguments</strong></p><ul><li><code>node_type</code>: The type label for the nodes to upload</li><li><code>graph</code>: Source MetaGraph containing the nodes</li><li><code>ADDRESS</code>: Neo4j server address (e.g. &quot;bolt://localhost:7687&quot;)</li><li><code>PASSWORD</code>: Neo4j database password</li><li><code>USERNAME=&quot;neo4j&quot;</code>: Neo4j username (defaults to &quot;neo4j&quot;)</li><li><code>DATABASE=&quot;neo4j&quot;</code>: Target Neo4j database name (defaults to &quot;neo4j&quot;)</li><li><code>window_size=100</code>: Number of nodes to upload in each batch (defaults to 100)</li></ul><p><strong>Details</strong></p><p>Performs batched uploads of nodes using Neo4j MERGE operations. Node properties are  automatically extracted from the graph vertex properties, excluding the &#39;TYPE&#39; property.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/neo4jl.jl#LL347">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.upload_nodes_over_api-Tuple{Any}" href="#Mycelia.upload_nodes_over_api-Tuple{Any}"><code>Mycelia.upload_nodes_over_api</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">upload_nodes_over_api(
    graph;
    ADDRESS,
    USERNAME,
    PASSWORD,
    DATABASE
)
</code></pre><p>Uploads all nodes from the given graph to a specified API endpoint.</p><p><strong>Arguments</strong></p><ul><li><code>graph</code>: The graph containing the nodes to be uploaded.</li><li><code>ADDRESS</code>: The API endpoint address.</li><li><code>USERNAME</code>: The username for authentication (default: &quot;neo4j&quot;).</li><li><code>PASSWORD</code>: The password for authentication.</li><li><code>DATABASE</code>: The database name (default: &quot;neo4j&quot;).</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/neo4jl.jl#LL229">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.upload_nodes_to_neo4j-Tuple{}" href="#Mycelia.upload_nodes_to_neo4j-Tuple{}"><code>Mycelia.upload_nodes_to_neo4j</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">upload_nodes_to_neo4j(
;
    graph,
    address,
    username,
    password,
    format,
    database,
    neo4j_import_directory
)
</code></pre><p>Upload all nodes from a MetaGraph to a Neo4j database, processing each unique node type separately.</p><p><strong>Arguments</strong></p><ul><li><code>graph</code>: A MetaGraph containing nodes to be uploaded</li><li><code>address</code>: Neo4j server address (e.g., &quot;bolt://localhost:7687&quot;)</li><li><code>username</code>: Neo4j authentication username (default: &quot;neo4j&quot;)</li><li><code>password</code>: Neo4j authentication password</li><li><code>format</code>: Data format for upload (default: &quot;auto&quot;)</li><li><code>database</code>: Target Neo4j database name (default: &quot;neo4j&quot;)</li><li><code>neo4j_import_directory</code>: Path to Neo4j&#39;s import directory for bulk loading</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/neo4jl.jl#LL72">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.validate_assemblies_against_holdout-Tuple{Dict, Dict, Vector{&lt;:FASTX.FASTQ.Record}, Int64, String}" href="#Mycelia.validate_assemblies_against_holdout-Tuple{Dict, Dict, Vector{&lt;:FASTX.FASTQ.Record}, Int64, String}"><code>Mycelia.validate_assemblies_against_holdout</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Validate assemblies against holdout validation data through read mapping.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/cross-validation.jl#LL207-L209">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.validate_assembly-Tuple{Mycelia.AssemblyResult}" href="#Mycelia.validate_assembly-Tuple{Mycelia.AssemblyResult}"><code>Mycelia.validate_assembly</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">validate_assembly(assembly::AssemblyResult; reference=nothing) -&gt; Dict{String, Any}</code></pre><p>Validate assembly quality using various metrics and optional reference comparison.</p><p><strong>Arguments</strong></p><ul><li><code>assembly</code>: Assembly result to validate</li><li><code>reference</code>: Optional reference sequence for comparison</li></ul><p><strong>Returns</strong></p><ul><li><code>Dict{String, Any}</code>: Comprehensive validation metrics</li></ul><p><strong>Details</strong></p><p>Computes assembly quality metrics including:</p><ul><li>N50, N90 statistics</li><li>Total assembly length and number of contigs</li><li>Coverage uniformity (if reference provided)</li><li>Structural variant detection (if reference provided)</li><li>Gap analysis and repeat characterization</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/assembly.jl#LL436-L455">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.vcat_with_missing-Tuple{Vararg{DataFrames.AbstractDataFrame}}" href="#Mycelia.vcat_with_missing-Tuple{Vararg{DataFrames.AbstractDataFrame}}"><code>Mycelia.vcat_with_missing</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">vcat_with_missing(
    dfs::DataFrames.AbstractDataFrame...
) -&gt; Union{DataFrames.DataFrame, Vector{Any}}
</code></pre><p>Vertically concatenate DataFrames with different column structures by automatically handling missing values.</p><p><strong>Arguments</strong></p><ul><li><code>dfs</code>: Variable number of DataFrames to concatenate vertically</li></ul><p><strong>Returns</strong></p><ul><li><code>DataFrame</code>: Combined DataFrame containing all rows and columns from input DataFrames,  with <code>missing</code> values where columns didn&#39;t exist in original DataFrames</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/utility-functions.jl#LL1528">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.viroid_assembly_workflow-Tuple{String}" href="#Mycelia.viroid_assembly_workflow-Tuple{String}"><code>Mycelia.viroid_assembly_workflow</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">viroid_assembly_workflow(
    viroid_name::String;
    outdir,
    k,
    simulate_coverage,
    read_length,
    error_rate,
    download_references,
    run_assembly
) -&gt; NamedTuple{(:viroid_name, :output_directory, :reference_data, :observations, :assembly_results, :workflow_summary), &lt;:Tuple{String, String, Any, Any, Any, String}}
</code></pre><p>Complete viroid assembly workflow that downloads reference data and performs  quality-aware assembly using Rhizomorph algorithms.</p><p>This function implements the complete workflow requested:</p><ol><li>Downloads viroid reference data from NCBI (genome, CDS transcript, FAA protein)</li><li>Generates simulated FASTQ observations for DNA, RNA, and amino acid sequences</li><li>Uses Rhizomorph Qualmer assembly workflows with quality score propagation</li><li>Outputs FASTQ files with consensus quality scores</li><li>Performs iterative Viterbi, probabilistic walks, and heaviest path algorithms</li></ol><p><strong>Arguments</strong></p><ul><li><code>viroid_name::String</code>: Name of viroid to study (e.g., &quot;Potato spindle tuber viroid&quot;)</li><li><code>outdir::String</code>: Output directory for all results (default: &quot;viroid<em>assembly</em>workflow/&quot;)</li><li><code>k::Int</code>: K-mer size for assembly (default: 21)</li><li><code>simulate_coverage::Int</code>: Coverage depth for simulated reads (default: 10)</li><li><code>read_length::Int</code>: Length of simulated reads (default: 150)</li><li><code>error_rate::Float64</code>: Simulated sequencing error rate (default: 0.01)</li><li><code>download_references::Bool</code>: Whether to download reference data (default: true)</li><li><code>run_assembly::Bool</code>: Whether to run assembly analysis (default: true)</li></ul><p><strong>Returns</strong></p><ul><li><code>NamedTuple</code>: Comprehensive results including reference files, simulated data, and assembly results</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia hljs"># Complete viroid assembly workflow for PSTV
results = viroid_assembly_workflow(&quot;Potato spindle tuber viroid&quot;, &quot;pstv_analysis/&quot;)

# Quick analysis with existing reference data
results = viroid_assembly_workflow(&quot;Hop stunt viroid&quot;, &quot;hsv_analysis/&quot;;
                                 download_references=false)</code></pre><p><strong>Workflow Details</strong></p><p>This function demonstrates the novel quality-aware assembly capabilities:</p><ul><li><strong>Quality Propagation</strong>: Per-base PHRED scores maintained throughout assembly</li><li><strong>Consensus Scoring</strong>: Multiple observations combined using weighted averages</li><li><strong>Advanced Algorithms</strong>: Iterative Viterbi, probabilistic walks, heaviest path finding</li><li><strong>Multi-sequence Types</strong>: Handles DNA, RNA, and amino acid sequences</li><li><strong>FASTQ Output</strong>: Final assemblies include quality scores for downstream analysis</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/reference-databases.jl#LL3278">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.visualize_genome_coverage-Tuple{Any}" href="#Mycelia.visualize_genome_coverage-Tuple{Any}"><code>Mycelia.visualize_genome_coverage</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">visualize_genome_coverage(coverage_table) -&gt; Any
</code></pre><p>Creates a multi-panel visualization of genome coverage across chromosomes.</p><p><strong>Arguments</strong></p><ul><li><code>coverage_table</code>: DataFrame containing columns &quot;chromosome&quot; and &quot;coverage&quot; with genomic coverage data</li></ul><p><strong>Returns</strong></p><ul><li><code>Plots.Figure</code>: A composite figure with coverage plots for each chromosome</li></ul><p><strong>Details</strong></p><p>Generates one subplot per chromosome, arranged vertically. Each subplot shows the coverage  distribution across genomic positions for that chromosome.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/plotting-and-visualization.jl#LL1331">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.viterbi_batch_process" href="#Mycelia.viterbi_batch_process"><code>Mycelia.viterbi_batch_process</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">viterbi_batch_process(graph::MetaGraph, sequences::Vector, config::ViterbiConfig) -&gt; Vector{ViterbiPath}</code></pre><p>Process multiple sequences in batches for memory efficiency.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/viterbi-next.jl#LL383-L387">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.viterbi_decode_next" href="#Mycelia.viterbi_decode_next"><code>Mycelia.viterbi_decode_next</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">viterbi_decode_next(graph::MetaGraph, observations::Vector, config::ViterbiConfig) -&gt; ViterbiPath</code></pre><p>Enhanced Viterbi decoding with strand awareness and memory efficiency.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/viterbi-next.jl#LL209-L213">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.viterbi_maximum_likelihood_traversals-Tuple{Any}" href="#Mycelia.viterbi_maximum_likelihood_traversals-Tuple{Any}"><code>Mycelia.viterbi_maximum_likelihood_traversals</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">viterbi_maximum_likelihood_traversals(
    stranded_kmer_graph;
    error_rate,
    verbosity
) -&gt; Vector{FASTX.FASTA.Record}
</code></pre><p>Finds maximum likelihood paths through a stranded k-mer graph using the Viterbi algorithm to correct sequencing errors.</p><p><strong>Arguments</strong></p><ul><li><code>stranded_kmer_graph</code>: A directed graph where vertices represent k-mers and edges represent overlaps</li><li><code>error_rate::Float64</code>: Expected per-base error rate (default: 1/(k+1)). Must be &lt; 0.5</li><li><code>verbosity::String</code>: Output detail level (&quot;debug&quot;, &quot;reads&quot;, or &quot;dataset&quot;)</li></ul><p><strong>Returns</strong></p><p>Vector of FASTX.FASTA.Record containing error-corrected sequences</p><p><strong>Details</strong></p><ul><li>Uses dynamic programming to find most likely path through k-mer graph</li><li>Accounts for matches, mismatches, insertions and deletions</li><li>State likelihoods based on k-mer coverage counts</li><li>Transition probabilities derived from error rate</li><li>Progress tracking based on verbosity level</li></ul><p><strong>Notes</strong></p><ul><li>Error rate should be probability of error (e.g. 0.01 for 1%), not accuracy</li><li>Higher verbosity levels (&quot;debug&quot;, &quot;reads&quot;) provide detailed path finding information</li><li>&quot;dataset&quot; verbosity shows only summary statistics</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/viterbi-polishing-and-error-correction.jl#LL489">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.wcss-Tuple{Any}" href="#Mycelia.wcss-Tuple{Any}"><code>Mycelia.wcss</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">wcss(clustering_result) -&gt; Any
</code></pre><p>Calculate the Within-Cluster Sum of Squares (WCSS) for a clustering result.</p><p><strong>Arguments</strong></p><ul><li><code>clustering_result</code>: A clustering result object containing:<ul><li><code>counts</code>: Vector with number of points in each cluster</li><li><code>assignments</code>: Vector of cluster assignments for each point</li><li><code>costs</code>: Vector of distances/costs from each point to its cluster center</li></ul></li></ul><p><strong>Returns</strong></p><ul><li><code>Float64</code>: The total within-cluster sum of squared distances</li></ul><p><strong>Description</strong></p><p>WCSS measures the compactness of clusters by summing the squared distances  between each data point and its assigned cluster center.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/clustering.jl#LL417">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.write_biosequence_gfa-Tuple{MetaGraphsNext.MetaGraph, AbstractString}" href="#Mycelia.write_biosequence_gfa-Tuple{MetaGraphsNext.MetaGraph, AbstractString}"><code>Mycelia.write_biosequence_gfa</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">write_biosequence_gfa(
    graph::MetaGraphsNext.MetaGraph,
    output_file::AbstractString
)
</code></pre><p>Write a BioSequence graph to GFA format.</p><p><strong>Arguments</strong></p><ul><li><code>graph</code>: MetaGraphsNext BioSequence graph</li><li><code>output_file</code>: Path to output GFA file</li></ul><p><strong>Example</strong></p><pre><code class="language-julia hljs">write_biosequence_gfa(graph, &quot;assembly.gfa&quot;)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/fasta-graphs.jl#LL203">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.write_fasta-Tuple{}" href="#Mycelia.write_fasta-Tuple{}"><code>Mycelia.write_fasta</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">write_fasta(; outfile, records, gzip)
</code></pre><p>Writes FASTA records to a file, optionally gzipped.</p><p><strong>Arguments</strong></p><ul><li><code>outfile::AbstractString</code>: Path to the output FASTA file.  Will append &quot;.gz&quot; if <code>gzip</code> is true and &quot;.gz&quot; isn&#39;t already the extension.</li><li><code>records::Vector{FASTX.FASTA.Record}</code>: A vector of FASTA records.</li><li><code>gzip::Bool</code>: Optionally force compression of the output with gzip. By default will use the file name to infer.</li></ul><p><strong>Returns</strong></p><ul><li><code>outfile::String</code>: The path to the output FASTA file (including &quot;.gz&quot; if applicable).</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/fastx.jl#LL1414">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.write_fastas_from_normalized_fastx_tables-Tuple{Vector{String}}" href="#Mycelia.write_fastas_from_normalized_fastx_tables-Tuple{Vector{String}}"><code>Mycelia.write_fastas_from_normalized_fastx_tables</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">write_fastas_from_normalized_fastx_tables(
    table_paths::Vector{String};
    output_dir::String = pwd(),
    show_progress::Bool = true,
    overwrite::Bool = false,
    error_handler = (e, table_path)-&gt;display((e, table_path))
) -&gt; NamedTuple</code></pre><p>Given a vector of normalized fastx table paths, writes out gzipped FASTA files in parallel. Each table must have columns: &quot;fastx<em>sha256&quot;, &quot;record</em>sha256&quot;, &quot;record_sequence&quot;. Automatically decompresses input files if they end with &quot;.gz&quot;. Returns a summary NamedTuple with successes, failures, failed tables, and output files.</p><p><strong>Keyword Arguments</strong></p><ul><li><code>output_dir</code>: Directory to write .fna.gz files to.</li><li><code>show_progress</code>: Show a progress bar (default: true).</li><li><code>overwrite</code>: Overwrite existing files (default: false).</li><li><code>error_handler</code>: Function called with (exception, table_path) on error.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/fastx.jl#LL751-L771">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.write_fastq-Tuple{}" href="#Mycelia.write_fastq-Tuple{}"><code>Mycelia.write_fastq</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">write_fastq(;records, filename, gzip=false)</code></pre><pre><code class="language-julia hljs">write_fastq(; records, filename, gzip)
</code></pre><p>Write FASTQ records to file using FASTX.jl. Validates extension: .fastq, .fq, .fastq.gz, or .fq.gz. If <code>gzip</code> is true or filename endswith .gz, output is gzipped. <code>records</code> must be an iterable of FASTX.FASTQ.Record.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/fastx.jl#LL713-L722">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.write_fastq_contigs-Tuple{Mycelia.AssemblyResult, String}" href="#Mycelia.write_fastq_contigs-Tuple{Mycelia.AssemblyResult, String}"><code>Mycelia.write_fastq_contigs</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">write_fastq_contigs(result::AssemblyResult, output_file::String)</code></pre><p>Write quality-aware contigs to a FASTQ file if quality information is available.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/assembly.jl#LL301-L305">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.write_gfa_next-Tuple{MetaGraphsNext.MetaGraph, AbstractString}" href="#Mycelia.write_gfa_next-Tuple{MetaGraphsNext.MetaGraph, AbstractString}"><code>Mycelia.write_gfa_next</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">write_gfa_next(
    graph::MetaGraphsNext.MetaGraph,
    outfile::AbstractString
) -&gt; AbstractString
</code></pre><p>Write a MetaGraphsNext k-mer graph to GFA (Graphical Fragment Assembly) format.</p><p>This function exports strand-aware k-mer graphs to standard GFA format, handling:</p><ul><li>Canonical k-mer vertices as segments (S lines)</li><li>Strand-aware edges as links (L lines) with proper orientations</li><li>Coverage information as depth annotations</li></ul><p><strong>Arguments</strong></p><ul><li><code>graph</code>: MetaGraphsNext k-mer graph with strand-aware edges</li><li><code>outfile</code>: Path where the GFA file should be written</li></ul><p><strong>Returns</strong></p><ul><li>Path to the written GFA file</li></ul><p><strong>GFA Format</strong></p><p>The output follows GFA v1.0 specification:</p><ul><li>Header (H) line with version</li><li>Segment (S) lines: vertex<em>id, canonical</em>k-mer_sequence, depth</li><li>Link (L) lines: source<em>id, source</em>orientation, target<em>id, target</em>orientation, overlap</li></ul><p><strong>Example</strong></p><pre><code class="language-julia hljs">graph = build_kmer_graph_next(DNAKmer{3}, observations)
write_gfa_next(graph, &quot;assembly.gfa&quot;)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/sequence-graphs-next.jl#LL528">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.write_gff-Tuple{}" href="#Mycelia.write_gff-Tuple{}"><code>Mycelia.write_gff</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">write_gff(; gff, outfile)
</code></pre><p>Write GFF (General Feature Format) data to a tab-delimited file.</p><p><strong>Arguments</strong></p><ul><li><code>gff</code>: DataFrame/Table containing GFF formatted data</li><li><code>outfile</code>: String path where the output file should be written</li></ul><p><strong>Returns</strong></p><ul><li><code>String</code>: Path to the written output file</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/genome-features.jl#LL236">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.write_quality_biosequence_gfa-Tuple{MetaGraphsNext.MetaGraph, AbstractString}" href="#Mycelia.write_quality_biosequence_gfa-Tuple{MetaGraphsNext.MetaGraph, AbstractString}"><code>Mycelia.write_quality_biosequence_gfa</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">write_quality_biosequence_gfa(
    graph::MetaGraphsNext.MetaGraph,
    output_file::AbstractString
)
</code></pre><p>Write a quality-aware BioSequence graph to GFA format with quality information.</p><p><strong>Arguments</strong></p><ul><li><code>graph</code>: Quality-aware BioSequence graph</li><li><code>output_file</code>: Path to output GFA file</li></ul><p><strong>Example</strong></p><pre><code class="language-julia hljs">write_quality_biosequence_gfa(graph, &quot;assembly_with_quality.gfa&quot;)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/fastq-graphs.jl#LL297">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.write_tsvgz-Tuple{}" href="#Mycelia.write_tsvgz-Tuple{}"><code>Mycelia.write_tsvgz</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">write_tsvgz(df::DataFrames.DataFrame, filename::String; buffer_in_memory::Bool=false, threaded::Bool=true, bufsize::Int=10*1024*1024, force::Bool=false)</code></pre><p>Write a DataFrame to a gzipped TSV file.</p><p><strong>Arguments</strong></p><ul><li><code>df</code>: The DataFrame to write</li><li><code>filename</code>: Path to the output file (will add .tsv.gz extension as needed)</li><li><code>buffer_in_memory</code>: If false, uses temporary files for large data (default: false)</li><li><code>bufsize</code>: Buffer size in bytes for compression stream (default: 10MB)</li><li><code>force</code>: If true, overwrite existing non-empty files (default: false)</li></ul><p><strong>Returns</strong></p><ul><li><code>String</code>: The final filename with proper extension</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/utility-functions.jl#LL21-L35">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.write_vcf_table-Tuple{}" href="#Mycelia.write_vcf_table-Tuple{}"><code>Mycelia.write_vcf_table</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">write_vcf_table(; vcf_file, vcf_table, fasta_file)
</code></pre><p>Write variant data to a VCF v4.3 format file.</p><p><strong>Arguments</strong></p><ul><li><code>vcf_file::String</code>: Output path for the VCF file</li><li><code>vcf_table::DataFrame</code>: Table containing variant data with standard VCF columns</li><li><code>fasta_file::String</code>: Path to the reference genome FASTA file</li></ul><p><strong>Details</strong></p><p>Automatically filters out equivalent variants where REF == ALT. Includes standard VCF headers for substitutions, insertions, deletions, and inversions. Adds GT (Genotype) and GQ (Genotype Quality) format fields.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/variant-analysis.jl#LL86">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.xam_to_contig_mapping_stats-Tuple{Any}" href="#Mycelia.xam_to_contig_mapping_stats-Tuple{Any}"><code>Mycelia.xam_to_contig_mapping_stats</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">xam_to_contig_mapping_stats(xam) -&gt; Any
</code></pre><p>Generate detailed mapping statistics for each reference sequence/contig in a XAM (SAM/BAM/CRAM) file.</p><p><strong>Arguments</strong></p><ul><li><code>xam</code>: Path to XAM file or XAM object</li></ul><p><strong>Returns</strong></p><p>A DataFrame with per-contig statistics including:</p><ul><li><code>n_aligned_reads</code>: Number of aligned reads</li><li><code>total_aligned_bases</code>: Sum of alignment lengths</li><li><code>total_alignment_score</code>: Sum of alignment scores</li><li>Mapping quality statistics (mean, std, median)</li><li>Alignment length statistics (mean, std, median)</li><li>Alignment score statistics (mean, std, median)</li><li>Percent mismatches statistics (mean, std, median)</li></ul><p>Note: Only primary alignments (isprimary=true) and mapped reads (ismapped=true) are considered.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/xam.jl#LL302">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.xam_to_dataframe-Tuple{String}" href="#Mycelia.xam_to_dataframe-Tuple{String}"><code>Mycelia.xam_to_dataframe</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">xam_to_dataframe(xam_path::String) -&gt; DataFrames.DataFrame
</code></pre><p>Convert a SAM/BAM file to a DataFrame using the open_xam function.</p><p>Parameters:</p><ul><li><code>xam_path</code>: Path to the SAM/BAM file</li><li><code>header</code>: Whether to include the header (default: false)</li></ul><p>Returns:</p><ul><li>A DataFrame containing the parsed data</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/xam.jl#LL215">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Mycelia.xam_to_dataframe-Tuple{XAM.SAM.Reader}" href="#Mycelia.xam_to_dataframe-Tuple{XAM.SAM.Reader}"><code>Mycelia.xam_to_dataframe</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">xam_to_dataframe(
    reader::XAM.SAM.Reader
) -&gt; DataFrames.DataFrame
</code></pre><p>Convert SAM/BAM records from a XAM.SAM.Reader into a DataFrame.</p><p>Parameters:</p><ul><li><code>reader</code>: A XAM.SAM.Reader object for iterating over records</li></ul><p>Returns:</p><ul><li>A DataFrame containing all record data in a structured format</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/cjprybol/Mycelia/blob/b2218a807a136d3f22c8b7649dd9cecb15733f7d/src/xam.jl#LL1">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-nextpage" href="getting-started/">Getting Started »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Wednesday 23 July 2025 03:24">Wednesday 23 July 2025</span>. Using Julia version 1.10.10.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
