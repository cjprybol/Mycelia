<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Metagenomic Workflow · Mycelia</title><meta name="title" content="Metagenomic Workflow · Mycelia"/><meta property="og:title" content="Metagenomic Workflow · Mycelia"/><meta property="twitter:title" content="Metagenomic Workflow · Mycelia"/><meta name="description" content="Documentation for Mycelia."/><meta property="og:description" content="Documentation for Mycelia."/><meta property="twitter:description" content="Documentation for Mycelia."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">Mycelia</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../installation/">Installation</a></li><li><a class="tocitem" href="../getting-started/">Getting Started</a></li><li><a class="tocitem" href="../concepts/">Concepts</a></li><li><a class="tocitem" href="../probabilistic-assembly-hub/">Probabilistic Assembly</a></li><li><a class="tocitem" href="../tutorials/">Tutorials</a></li><li><span class="tocitem">Documentation</span><ul><li><a class="tocitem" href="../architecture/">Architecture Overview</a></li><li><a class="tocitem" href="../assembly-method-selection/">Assembly Method Selection</a></li><li><a class="tocitem" href="../workflow-map/">Workflow &amp; Tool Map</a></li><li class="is-active"><a class="tocitem" href>Metagenomic Workflow</a><ul class="internal"><li><a class="tocitem" href="#Overview"><span>Overview</span></a></li><li><a class="tocitem" href="#Full-Workflow"><span>Full Workflow</span></a></li><li><a class="tocitem" href="#Workflow-Variants-(Short,-Long,-Hybrid)"><span>Workflow Variants (Short, Long, Hybrid)</span></a></li><li><a class="tocitem" href="#Workflow-Components"><span>Workflow Components</span></a></li><li><a class="tocitem" href="#Tool-Inputs-Outputs-(Quick-Reference)"><span>Tool Inputs → Outputs (Quick Reference)</span></a></li><li><a class="tocitem" href="#Integration-with-Rhizomorph"><span>Integration with Rhizomorph</span></a></li><li><a class="tocitem" href="#Tool-Status"><span>Tool Status</span></a></li></ul></li><li><a class="tocitem" href="../api/function-coverage/">Function Coverage Audit</a></li><li><a class="tocitem" href="../performance/">Performance Guide</a></li><li><a class="tocitem" href="../faq/">FAQ</a></li></ul></li><li><span class="tocitem">API Reference</span><ul><li><a class="tocitem" href="../api-reference/">Complete API Reference</a></li><li><a class="tocitem" href="../api/all-functions/">Complete API Surface</a></li><li><input class="collapse-toggle" id="menuitem-8-3" type="checkbox"/><label class="tocitem" for="menuitem-8-3"><span class="docs-label">Workflows</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../api/workflows/assembly-suite/">Assembly Suite</a></li><li><a class="tocitem" href="../api/workflows/data-acquisition/">Data Acquisition</a></li><li><a class="tocitem" href="../api/workflows/quality-control/">Quality Control</a></li><li><a class="tocitem" href="../api/workflows/sequence-analysis/">Sequence Analysis</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-8-4" type="checkbox"/><label class="tocitem" for="menuitem-8-4"><span class="docs-label">Quick Reference</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../api/quick-reference/function-index/">Function Index</a></li><li><a class="tocitem" href="../api/quick-reference/parameter-guide/">Parameter Guide</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-8-5" type="checkbox"/><label class="tocitem" for="menuitem-8-5"><span class="docs-label">Examples</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../api/examples/basic-workflows/">Basic Workflows</a></li></ul></li><li><a class="tocitem" href="../api/">Legacy API Documentation</a></li><li><a class="tocitem" href="../related-projects/">Related Projects</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Documentation</a></li><li class="is-active"><a href>Metagenomic Workflow</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Metagenomic Workflow</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/cjprybol/Mycelia" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/cjprybol/Mycelia/blob/master/docs/src/metagenomic-workflow.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Metagenomic-Analysis-Workflow"><a class="docs-heading-anchor" href="#Metagenomic-Analysis-Workflow">Metagenomic Analysis Workflow</a><a id="Metagenomic-Analysis-Workflow-1"></a><a class="docs-heading-anchor-permalink" href="#Metagenomic-Analysis-Workflow" title="Permalink"></a></h1><p>This document describes the metagenomic analysis workflow implemented in Mycelia, including read-level classification, assembly, taxonomy assignment, and validation strategies.</p><h2 id="Overview"><a class="docs-heading-anchor" href="#Overview">Overview</a><a id="Overview-1"></a><a class="docs-heading-anchor-permalink" href="#Overview" title="Permalink"></a></h2><p>The Mycelia metagenomic workflow implements a triangulated approach to taxonomic classification, combining evidence from multiple sources:</p><ol><li><strong>Read-level classification</strong> - Direct mapping of reads to reference databases</li><li><strong>Contig-level DNA taxonomy</strong> - BLAST-based classification of assembled contigs</li><li><strong>Contig-level protein taxonomy</strong> - MMseqs2-based classification against UniRef databases</li></ol><pre><code class="language-mermaid hljs">flowchart TD
  R[Sequencing reads]

  R --&gt; E1[Read level mapping&lt;br/&gt;to reference databases]

  R --&gt; Asm[Assembly into contigs]
  Asm --&gt; E2[Contig DNA taxonomy&lt;br/&gt;BLAST to NCBI and others]
  Asm --&gt; E3[Contig protein taxonomy&lt;br/&gt;mmseqs2 to UniRef sets]

  R --&gt; MapAsm[Reads mapped to contigs]
  MapAsm --&gt; E2
  MapAsm --&gt; E3

  E1 --&gt; Tri[Triangulated taxonomic assignment]
  E2 --&gt; Tri
  E3 --&gt; Tri

  Tri --&gt; Bench[Benchmark against other tools&lt;br/&gt;kmer marker gene protein based]</code></pre><h2 id="Full-Workflow"><a class="docs-heading-anchor" href="#Full-Workflow">Full Workflow</a><a id="Full-Workflow-1"></a><a class="docs-heading-anchor-permalink" href="#Full-Workflow" title="Permalink"></a></h2><p>The complete metagenomic workflow includes quality control, multiple assembly strategies, variant calling, and pangenome analysis:</p><pre><code class="language-mermaid hljs">flowchart TD
  R[Raw reads] --&gt; Q[QC&lt;br/&gt;FastQC&lt;br/&gt;fastp (short)&lt;br/&gt;fastplong (long)&lt;br/&gt;filtlong / chopper (long)&lt;br/&gt;trim_galore (Illumina PE)]

  Q --&gt; DBs[Reference databases&lt;br/&gt;NCBI Core Nucleotide&lt;br/&gt;IMG VR v5 and others]

  Q --&gt; RL_map
  subgraph RL [Read level classification]
    direction TB
    RL_map[Minimap2 mapping&lt;br/&gt;short and long reads] --&gt; RL_score[Weighted scoring and LCA&lt;br/&gt;top hit vs next hit&lt;br/&gt;coverage threshold]
  end
  DBs --&gt; RL_map

  Q --&gt; RL_val[Validation tools / profiling&lt;br/&gt;sourmash&lt;br/&gt;MetaPhlAn&lt;br/&gt;Metabuli&lt;br/&gt;Sylph&lt;br/&gt;Kraken / Kraken2&lt;br/&gt;CoverM]

  Q --&gt; SR_asm
  Q --&gt; LR_asm
  subgraph ASM [Metagenomic assembly]
    direction LR
    SR_asm[Short read assembly&lt;br/&gt;MEGAHIT&lt;br/&gt;metaSPAdes&lt;br/&gt;MetaVelvet&lt;br/&gt;Penguinn]
    LR_asm[Long read assembly&lt;br/&gt;myloasm&lt;br/&gt;hifiasm meta (hifiasm-meta)&lt;br/&gt;metaMDBG (metamdbg)&lt;br/&gt;metaFlye (metaflye)]
  end

  SR_asm --&gt; Bin[Binning]
  LR_asm --&gt; Bin
  subgraph BIN [Binning &amp; Refinement]
    direction TB
    Bin --&gt; B1[MetaBAT / MetaBAT2]
    Bin --&gt; B2[MaxBin]
    Bin --&gt; B3[VAMB / GenomeFace]
    B1 --&gt; Cons[DAS Tool Refinement]
    B2 --&gt; Cons
    B3 --&gt; Cons
  end
  Cons --&gt; MAGs[MAGs]
  MAGs --&gt; Drep[De-replication&lt;br/&gt;dRep, galah]
  MAGs --&gt; MAGtax[Bin taxonomy assignment&lt;br/&gt;(BLAST / mmseqs2)]
  MAGtax --&gt; MAGqc_micro[Microbial MAG QC&lt;br/&gt;CheckM2]
  MAGtax --&gt; MAGqc_viral[Viral MAG QC&lt;br/&gt;CheckV, geNomad]
  MAGqc_micro --&gt; Drep
  MAGqc_viral --&gt; Drep
  Drep --&gt; Clust[Similarity / clustering&lt;br/&gt;FastANI, skani&lt;br/&gt;mash, dashing2&lt;br/&gt;BLAST]

  SR_asm --&gt; Phasing[Strain Phasing]
  LR_asm --&gt; Phasing
  subgraph STR [Strain Resolution]
    direction TB
    Phasing --&gt; S1[Floria / Strainy]
    Phasing --&gt; S2[STRONG / HyLight]
  end

  SR_asm --&gt; DNA_tax
  LR_asm --&gt; DNA_tax
  DBs --&gt; DNA_tax
  DNA_tax[DNA level taxonomy&lt;br/&gt;BLAST vs CoreNT and others]

  SR_asm --&gt; Prot_tax
  LR_asm --&gt; Prot_tax
  Prot_tax[Protein level taxonomy&lt;br/&gt;mmseqs2 vs UniRef 50 90 100]

  Q --&gt; MapAsm[Reads mapped to contigs&lt;br/&gt;minimap2]
  MapAsm --&gt; CovQC[Coverage QC&lt;br/&gt;mosdepth, qualimap&lt;br/&gt;CoverM]
  MapAsm --&gt; Pangraph[Pangenome and graph alignment&lt;br/&gt;metapangenomes]
  Pangraph --&gt; VarPan[Variant calling graph based&lt;br/&gt;PGGB&lt;br/&gt;VG&lt;br/&gt;Cactus]
  Pangraph --&gt; VarAlign[Variant calling alignment based&lt;br/&gt;short reads GATK FreeBayes BCFtools&lt;br/&gt;long reads Clair3]

  MapAsm --&gt; DNA_tax
  MapAsm --&gt; Prot_tax

  SR_asm --&gt; QCcontig
  LR_asm --&gt; QCcontig
  QCcontig[Assembly QC (contigs)&lt;br/&gt;QUAST / metaQUAST, BUSCO&lt;br/&gt;viral CheckV, geNomad&lt;br/&gt;microbial CheckM / CheckM2]
  CovQC --&gt; QCcontig

  RL_score --&gt; Tri[Triangulated taxonomic assignment]
  DNA_tax --&gt; Tri
  Prot_tax --&gt; Tri

  Tri --&gt; Bench[Benchmark against other tools&lt;br/&gt;kmer marker gene protein based]
  Bench --&gt; RL_val

  Tri --&gt; C[Classifications]
  VarPan --&gt; V[Variants]
  VarAlign --&gt; V[Variants]
  Pangraph --&gt; P[Pangenomes]</code></pre><h2 id="Workflow-Variants-(Short,-Long,-Hybrid)"><a class="docs-heading-anchor" href="#Workflow-Variants-(Short,-Long,-Hybrid)">Workflow Variants (Short, Long, Hybrid)</a><a id="Workflow-Variants-(Short,-Long,-Hybrid)-1"></a><a class="docs-heading-anchor-permalink" href="#Workflow-Variants-(Short,-Long,-Hybrid)" title="Permalink"></a></h2><p>The &quot;Full Workflow&quot; diagram above shows all major components. In practice, users typically follow one of the read-type-specific variants below, then optionally converge on common downstream steps (assembly QC, binning, post-binning QC, dereplication, strain resolution, variants/pangenomes).</p><h3 id="Short-Read-Only-(Illumina)"><a class="docs-heading-anchor" href="#Short-Read-Only-(Illumina)">Short-Read Only (Illumina)</a><a id="Short-Read-Only-(Illumina)-1"></a><a class="docs-heading-anchor-permalink" href="#Short-Read-Only-(Illumina)" title="Permalink"></a></h3><pre><code class="language-mermaid hljs">flowchart TD
  SR[Short reads (Illumina)] --&gt; QC[QC&lt;br/&gt;FastQC&lt;br/&gt;fastp / trim_galore]
  QC --&gt; Prof[Profiling / validation (reads)&lt;br/&gt;sourmash, MetaPhlAn, Metabuli, Sylph, Kraken]
  QC --&gt; Asm[Short-read assembly&lt;br/&gt;MEGAHIT, metaSPAdes, MetaVelvet]

  Asm --&gt; Contigs[Contigs]
  QC --&gt; Map[Map reads&lt;br/&gt;to contigs or references&lt;br/&gt;minimap2]
  Map --&gt; Cov[Coverage QC&lt;br/&gt;mosdepth, qualimap, CoverM]
  Contigs --&gt; Assess[Assembly assessment&lt;br/&gt;QUAST / metaQUAST, BUSCO]
  Cov --&gt; Assess

  Map --&gt; Var[Variant calling (short)&lt;br/&gt;GATK, FreeBayes, BCFtools]
  Var --&gt; VCF[VCF]

  Assess --&gt; Bin[Binning&lt;br/&gt;MetaBAT2, MaxBin, VAMB, GenomeFace,&lt;br/&gt;MetaCoAG, COMEBin, TaxVAMB]
  Bin --&gt; MAGs[MAGs]
  MAGs --&gt; Tax[Bin taxonomy&lt;br/&gt;BLAST / mmseqs2]
  Tax --&gt; Micro[Microbial QC&lt;br/&gt;CheckM2]
  Tax --&gt; Viral[Viral QC&lt;br/&gt;CheckV, geNomad]
  Micro --&gt; Catalog[Curated MAG set]
  Viral --&gt; Catalog
  Catalog --&gt; Drep[De-replication/merging&lt;br/&gt;dRep, MAGmax]
  Drep --&gt; Clust[Similarity/clustering&lt;br/&gt;skani, FastANI, mash]</code></pre><h3 id="Long-Read-Only-(ONT-/-PacBio)"><a class="docs-heading-anchor" href="#Long-Read-Only-(ONT-/-PacBio)">Long-Read Only (ONT / PacBio)</a><a id="Long-Read-Only-(ONT-/-PacBio)-1"></a><a class="docs-heading-anchor-permalink" href="#Long-Read-Only-(ONT-/-PacBio)" title="Permalink"></a></h3><pre><code class="language-mermaid hljs">flowchart TD
  LR[Long reads (ONT / PacBio)] --&gt; QC[QC&lt;br/&gt;FastQC&lt;br/&gt;fastplong / filtlong / chopper]
  QC --&gt; Prof[Profiling / validation (reads)&lt;br/&gt;sourmash, MetaPhlAn, Metabuli, Sylph, Kraken]
  QC --&gt; Asm[Long-read assembly&lt;br/&gt;metaflye, metamdbg, hifiasm-meta, myloasm]

  Asm --&gt; Contigs[Contigs]
  QC --&gt; Map[Map reads&lt;br/&gt;to contigs or references&lt;br/&gt;minimap2]
  Map --&gt; Cov[Coverage QC&lt;br/&gt;mosdepth, qualimap, CoverM]
  Contigs --&gt; Assess[Assembly assessment&lt;br/&gt;QUAST / metaQUAST, BUSCO]
  Cov --&gt; Assess

  Map --&gt; Var[Variant calling (long)&lt;br/&gt;Clair3]
  Var --&gt; VCF[VCF]

  Assess --&gt; Bin[Binning&lt;br/&gt;MetaBAT2, MaxBin, VAMB, GenomeFace,&lt;br/&gt;MetaCoAG, COMEBin, TaxVAMB]
  Bin --&gt; MAGs[MAGs]
  MAGs --&gt; Tax[Bin taxonomy&lt;br/&gt;BLAST / mmseqs2]
  Tax --&gt; Micro[Microbial QC&lt;br/&gt;CheckM2]
  Tax --&gt; Viral[Viral QC&lt;br/&gt;CheckV, geNomad]
  Micro --&gt; Catalog[Curated MAG set]
  Viral --&gt; Catalog
  Catalog --&gt; Drep[De-replication/merging&lt;br/&gt;dRep, MAGmax]
  Drep --&gt; Clust[Similarity/clustering&lt;br/&gt;skani, FastANI, mash]</code></pre><h3 id="Hybrid-(Short-Long)"><a class="docs-heading-anchor" href="#Hybrid-(Short-Long)">Hybrid (Short + Long)</a><a id="Hybrid-(Short-Long)-1"></a><a class="docs-heading-anchor-permalink" href="#Hybrid-(Short-Long)" title="Permalink"></a></h3><pre><code class="language-mermaid hljs">flowchart TD
  SR[Short reads] --&gt; QC1[QC (short)&lt;br/&gt;FastQC&lt;br/&gt;fastp / trim_galore]
  LR[Long reads] --&gt; QC2[QC (long)&lt;br/&gt;FastQC&lt;br/&gt;fastplong / filtlong / chopper]
  QC1 --&gt; Asm[Hybrid or combined assembly&lt;br/&gt;unicycler (hybrid)&lt;br/&gt;or separate SR/LR assembly]
  QC2 --&gt; Asm

  Asm --&gt; Contigs[Contigs]
  QC1 --&gt; Map[Map reads&lt;br/&gt;to contigs or references&lt;br/&gt;minimap2]
  QC2 --&gt; Map
  Map --&gt; Cov[Coverage QC&lt;br/&gt;mosdepth, qualimap, CoverM]
  Contigs --&gt; Assess[Assembly assessment&lt;br/&gt;QUAST / metaQUAST, BUSCO]
  Cov --&gt; Assess

  Map --&gt; VarSR[Variant calling (short)&lt;br/&gt;GATK, FreeBayes, BCFtools]
  Map --&gt; VarLR[Variant calling (long)&lt;br/&gt;Clair3]
  VarSR --&gt; VCF[VCF]
  VarLR --&gt; VCF</code></pre><h2 id="Workflow-Components"><a class="docs-heading-anchor" href="#Workflow-Components">Workflow Components</a><a id="Workflow-Components-1"></a><a class="docs-heading-anchor-permalink" href="#Workflow-Components" title="Permalink"></a></h2><h3 id="Quality-Control"><a class="docs-heading-anchor" href="#Quality-Control">Quality Control</a><a id="Quality-Control-1"></a><a class="docs-heading-anchor-permalink" href="#Quality-Control" title="Permalink"></a></h3><p>Initial read quality assessment and filtering using:</p><ul><li>FastQC for quality metrics</li><li>Adapter trimming and quality filtering</li><li><code>fastp</code> - Short-read QC, trimming, filtering, reports</li><li><code>fastplong</code> - Long-read QC, trimming, filtering, reports (fastp-long)</li><li><code>filtlong</code> - Long-read filtering</li><li><code>chopper</code> - Long-read filtering</li><li><code>trim_galore</code> - Illumina adapter trimming for paired-end reads</li></ul><h3 id="Read-Level-Classification"><a class="docs-heading-anchor" href="#Read-Level-Classification">Read-Level Classification</a><a id="Read-Level-Classification-1"></a><a class="docs-heading-anchor-permalink" href="#Read-Level-Classification" title="Permalink"></a></h3><p>Direct classification of reads using minimap2 mapping against reference databases, with weighted scoring based on:</p><ul><li>Top hit vs next hit ratio</li><li>Coverage thresholds</li><li>LCA (Lowest Common Ancestor) assignment for ambiguous mappings</li></ul><h3 id="Taxonomic-Profiling"><a class="docs-heading-anchor" href="#Taxonomic-Profiling">Taxonomic Profiling</a><a id="Taxonomic-Profiling-1"></a><a class="docs-heading-anchor-permalink" href="#Taxonomic-Profiling" title="Permalink"></a></h3><p><strong>Containment &amp; Estimation:</strong></p><ul><li><code>sourmash</code> - Fast search and containment estimation using MinHash sketches</li></ul><p><strong>Profiling &amp; Classification:</strong></p><ul><li><code>CoverM</code> - Read coverage calculator</li><li><code>MetaPhlAn</code> - Marker gene-based profiling</li><li><code>Sylph</code> - Precision profiling for metagenomes</li><li><code>Metabuli</code> - DNA/Amino acid joint analysis</li><li><code>Kraken</code> - Exact k-mer classification</li></ul><h3 id="Assembly-Strategies"><a class="docs-heading-anchor" href="#Assembly-Strategies">Assembly Strategies</a><a id="Assembly-Strategies-1"></a><a class="docs-heading-anchor-permalink" href="#Assembly-Strategies" title="Permalink"></a></h3><p><strong>Short Read Assembly:</strong></p><ul><li>MEGAHIT - memory-efficient assembly (iterative de Bruijn graph)</li><li>metaSPAdes - metagenome-specific assembly (high-quality short-read assembly)</li><li>Penguinn - guided assembly with protein references</li><li>MetaVelvet - extension of Velvet for metagenomics</li></ul><p><strong>Long Read Assembly:</strong></p><ul><li>myloasm - plasmid-aware assembly</li><li>hifiasm-meta - HiFi metagenome assembly</li><li>metaMDBG / metamdbg - minimizer-space de Bruijn graph assembly</li><li>metaFlye / metaflye - long-read metagenome assembly</li></ul><p><strong>Hybrid / Other Assemblers (also available in Mycelia, depending on your inputs):</strong></p><ul><li>Unicycler (hybrid short+long)</li><li>SPAdes, SKESA, Velvet</li><li>Flye, Canu, Hifiasm</li></ul><h3 id="Taxonomy-Assignment"><a class="docs-heading-anchor" href="#Taxonomy-Assignment">Taxonomy Assignment</a><a id="Taxonomy-Assignment-1"></a><a class="docs-heading-anchor-permalink" href="#Taxonomy-Assignment" title="Permalink"></a></h3><p><strong>DNA-level:</strong></p><ul><li>BLAST against NCBI Core Nucleotide</li><li>Custom reference databases</li></ul><p><strong>Protein-level:</strong></p><ul><li>MMseqs2 against UniRef50, UniRef90, UniRef100</li><li>DIAMOND as a fast protein search alternative (where appropriate)</li><li>Sensitive homology detection for divergent sequences</li></ul><h3 id="Quality-Control-and-Validation"><a class="docs-heading-anchor" href="#Quality-Control-and-Validation">Quality Control and Validation</a><a id="Quality-Control-and-Validation-1"></a><a class="docs-heading-anchor-permalink" href="#Quality-Control-and-Validation" title="Permalink"></a></h3><p><strong>Assembly QC by read mapping:</strong></p><ul><li>Map reads back to contigs with <code>minimap2</code> and compute coverage</li><li><code>mosdepth</code> - Depth/coverage summaries from BAM/CRAM</li><li><code>qualimap</code> - Alignment/QC reports from BAM</li><li><code>CoverM</code> - Per-contig and per-genome/bin coverage/abundance tables</li></ul><p><strong>Assembly assessment:</strong></p><ul><li>QUAST / metaQUAST for assembly statistics (metagenome mode when appropriate)</li><li>BUSCO for completeness assessment</li></ul><p><strong>Viral contigs:</strong></p><ul><li>CheckV for completeness and contamination</li><li>geNomad for viral/mobile element identification (viruses/plasmids)</li></ul><p><strong>Microbial contigs:</strong></p><ul><li>CheckM/CheckM2 for completeness and contamination</li></ul><p><strong>General:</strong></p><ul><li>QUAST for assembly statistics</li><li>BUSCO for completeness assessment</li></ul><h3 id="Binning-and-Refinement"><a class="docs-heading-anchor" href="#Binning-and-Refinement">Binning &amp; Refinement</a><a id="Binning-and-Refinement-1"></a><a class="docs-heading-anchor-permalink" href="#Binning-and-Refinement" title="Permalink"></a></h3><ul><li><code>DAS Tool</code> - Consensus binning refinement</li><li><code>MetaBAT</code> / <code>MetaBAT2</code> - Tetranucleotide frequency binning</li><li><code>GenomeFace</code> - Deep learning-based binning</li><li><code>MaxBin</code> - Expectation-maximization algorithm</li><li><code>MetaCoAG</code> - Graph- and coverage-aware binning</li><li><code>COMEBin</code> - Ensemble binning / refinement</li><li><code>TaxVAMB</code> - Taxonomy-guided VAMB variant</li><li><code>Taxometer</code> - Taxonomy-aware binning support</li><li><code>VAMB</code> - Variational Autoencoder Microbial Binner</li></ul><h3 id="Post-binning-QC-(MAGs)"><a class="docs-heading-anchor" href="#Post-binning-QC-(MAGs)">Post-binning QC (MAGs)</a><a id="Post-binning-QC-(MAGs)-1"></a><a class="docs-heading-anchor-permalink" href="#Post-binning-QC-(MAGs)" title="Permalink"></a></h3><p>After binning, apply QC based on the bin’s classification/expected biology:</p><ul><li><strong>Microbial MAGs</strong>: <code>CheckM2</code> (and optionally legacy <code>CheckM</code>)</li><li><strong>Viral MAGs / viral contigs</strong>: <code>CheckV</code> and <code>geNomad</code></li></ul><h3 id="Reference-Databases"><a class="docs-heading-anchor" href="#Reference-Databases">Reference Databases</a><a id="Reference-Databases-1"></a><a class="docs-heading-anchor-permalink" href="#Reference-Databases" title="Permalink"></a></h3><p>Mycelia integrates with high-quality public registries for taxonomic assignment:</p><ul><li><strong>Microbial</strong>: GTDB, NCBI RefSeq Prokaryota (<code>ref_prok_rep_genomes</code>)</li><li><strong>Viral</strong>: IMG/VR v5, NCBI RefSeq Viral (<code>ref_viruses_rep_genomes</code>)</li><li><strong>Plasmids</strong>: <a href="https://ccb-microbe.cs.uni-saarland.de/plsdb2025/">PLSDB</a>, NCBI Plasmid RefSeq</li><li><strong>Protein</strong>: UniProt (SwissProt/TrEMBL), UniRef100/90/50</li></ul><h3 id="Similarity,-Clustering-and-De-replication"><a class="docs-heading-anchor" href="#Similarity,-Clustering-and-De-replication">Similarity, Clustering &amp; De-replication</a><a id="Similarity,-Clustering-and-De-replication-1"></a><a class="docs-heading-anchor-permalink" href="#Similarity,-Clustering-and-De-replication" title="Permalink"></a></h3><ul><li><code>FastANI</code> - Fast Whole-Genome Similarity (ANI)</li><li><code>skani</code> - Fast ANI for metagenomic-assembled genomes (MAGs)</li><li><code>dashing2</code> - HyperLogLog sketching for distance estimation</li><li><code>galah</code> - Representative genome selection (dereplication)</li><li><code>dRep</code> - Genome de-replication pipeline</li><li><code>mash</code> - MinHash distance estimation</li><li><code>Blast</code> - Pairwise Blast-based ANI</li></ul><h3 id="Strain-Level-Phasing"><a class="docs-heading-anchor" href="#Strain-Level-Phasing">Strain-Level Phasing</a><a id="Strain-Level-Phasing-1"></a><a class="docs-heading-anchor-permalink" href="#Strain-Level-Phasing" title="Permalink"></a></h3><ul><li><code>Floria</code> - Strain-aware assembly/phasing</li><li><code>Strainy</code> - Phasing from metagenomic reads</li><li><code>STRONG</code> - Strain Resolution ON Graphs</li><li><code>HyLight</code> - Hybrid assembly graph phasing</li></ul><h3 id="Variant-Calling"><a class="docs-heading-anchor" href="#Variant-Calling">Variant Calling</a><a id="Variant-Calling-1"></a><a class="docs-heading-anchor-permalink" href="#Variant-Calling" title="Permalink"></a></h3><p><strong>Graph-based:</strong></p><ul><li>PGGB (PanGenome Graph Builder)</li><li>VG toolkit</li><li>Cactus</li></ul><p><strong>Alignment-based:</strong></p><ul><li>Short reads: GATK HaplotypeCaller, FreeBayes, BCFtools</li><li>Long reads: Clair3</li></ul><h2 id="Tool-Inputs-Outputs-(Quick-Reference)"><a class="docs-heading-anchor" href="#Tool-Inputs-Outputs-(Quick-Reference)">Tool Inputs → Outputs (Quick Reference)</a><a id="Tool-Inputs-Outputs-(Quick-Reference)-1"></a><a class="docs-heading-anchor-permalink" href="#Tool-Inputs-Outputs-(Quick-Reference)" title="Permalink"></a></h2><p>This section answers: “what does a tool consume (reads/contigs/bins/BAM) and what does it produce?” For the broader repository-wide inventory (including many non-metagenomic utilities), see <code>docs/src/workflow-map.md</code>.</p><table><tr><th style="text-align: right">Stage</th><th style="text-align: right">Tool(s)</th><th style="text-align: right">Input</th><th style="text-align: right">Output</th><th style="text-align: right">Notes</th></tr><tr><td style="text-align: right">Read QC (short)</td><td style="text-align: right">FastQC, fastp, Trim Galore</td><td style="text-align: right">Illumina FASTQ</td><td style="text-align: right">Filtered/trimmed FASTQ + HTML/JSON</td><td style="text-align: right">Wrapped: <code>run_fastqc</code>, <code>qc_filter_short_reads_fastp</code>, <code>trim_galore_paired</code></td></tr><tr><td style="text-align: right">Read QC (long)</td><td style="text-align: right">FastQC, fastplong, Filtlong, Chopper</td><td style="text-align: right">ONT/PacBio FASTQ</td><td style="text-align: right">Filtered FASTQ + QC reports</td><td style="text-align: right">Wrapped: <code>qc_filter_long_reads_fastplong</code>, <code>qc_filter_long_reads_filtlong</code>, <code>qc_filter_long_reads_chopper</code></td></tr><tr><td style="text-align: right">Read profiling</td><td style="text-align: right">sourmash, MetaPhlAn, Metabuli, Sylph</td><td style="text-align: right">FASTQ reads</td><td style="text-align: right">Taxonomic profiles/reports</td><td style="text-align: right">Wrapped: <code>run_sourmash_*</code>, <code>run_metaphlan</code>, <code>run_metabuli_classify</code>, <code>run_sylph_profile</code></td></tr><tr><td style="text-align: right">Read profiling (k-mer exact)</td><td style="text-align: right">Kraken / Kraken2</td><td style="text-align: right">FASTQ reads</td><td style="text-align: right">Classification reports</td><td style="text-align: right">Parser exists (<code>parse_kraken_report</code>); runner wrapper not present in <code>src/</code> yet</td></tr><tr><td style="text-align: right">Read/contig mapping</td><td style="text-align: right">minimap2</td><td style="text-align: right">Reads + contigs/reference</td><td style="text-align: right">SAM/BAM</td><td style="text-align: right">Wrapped: <code>minimap_map*</code> helpers</td></tr><tr><td style="text-align: right">Coverage QC</td><td style="text-align: right">mosdepth, Qualimap, CoverM</td><td style="text-align: right">BAM/CRAM</td><td style="text-align: right">Coverage tables + reports</td><td style="text-align: right">Wrapped: <code>run_mosdepth</code>, <code>run_qualimap_bamqc</code>, <code>run_coverm_contig</code>, <code>run_coverm_genome</code></td></tr><tr><td style="text-align: right">Assembly assessment</td><td style="text-align: right">QUAST / metaQUAST, BUSCO</td><td style="text-align: right">Assembly FASTA</td><td style="text-align: right">QC summary tables + reports</td><td style="text-align: right">Wrapped: <code>run_quast</code>, <code>run_busco</code></td></tr><tr><td style="text-align: right">Assembly QC (microbial)</td><td style="text-align: right">CheckM2</td><td style="text-align: right">Microbial assemblies/bins</td><td style="text-align: right">Completeness/contamination metrics</td><td style="text-align: right">Wrapped: <code>run_checkm2</code></td></tr><tr><td style="text-align: right">Assembly QC (viral)</td><td style="text-align: right">CheckV, geNomad</td><td style="text-align: right">Viral contigs/bins</td><td style="text-align: right">Viral QC + viral/mobile element calls</td><td style="text-align: right">Wrapped: <code>run_checkv</code>, <code>run_genomad</code></td></tr><tr><td style="text-align: right">Assembly (short)</td><td style="text-align: right">MEGAHIT, metaSPAdes, MetaVelvet</td><td style="text-align: right">Short reads</td><td style="text-align: right">Contigs FASTA</td><td style="text-align: right">Wrapped: <code>run_megahit</code>, <code>run_metaspades</code>, <code>run_metavelvet</code></td></tr><tr><td style="text-align: right">Assembly (short, option)</td><td style="text-align: right">Penguinn</td><td style="text-align: right">Short reads</td><td style="text-align: right">Contigs FASTA</td><td style="text-align: right">Mentioned as an option; runner wrapper not present in <code>src/</code> yet</td></tr><tr><td style="text-align: right">Assembly (long)</td><td style="text-align: right">metaFlye, metaMDBG, hifiasm-meta</td><td style="text-align: right">Long reads</td><td style="text-align: right">Contigs FASTA</td><td style="text-align: right">Wrapped: <code>run_metaflye</code>, <code>run_metamdbg</code>, <code>run_hifiasm_meta</code></td></tr><tr><td style="text-align: right">Assembly (long, option)</td><td style="text-align: right">myloasm</td><td style="text-align: right">Long reads</td><td style="text-align: right">Contigs FASTA</td><td style="text-align: right">Mentioned as an option; runner wrapper not present in <code>src/</code> yet</td></tr><tr><td style="text-align: right">Assembly (hybrid)</td><td style="text-align: right">Unicycler</td><td style="text-align: right">Short + long reads</td><td style="text-align: right">Contigs FASTA</td><td style="text-align: right">Wrapped: <code>run_unicycler</code></td></tr><tr><td style="text-align: right">Polishing / error correction</td><td style="text-align: right">Apollo, Homopolish</td><td style="text-align: right">Assembly FASTA + reads</td><td style="text-align: right">Polished assembly FASTA</td><td style="text-align: right">Wrapped: <code>run_apollo</code>, <code>run_homopolish</code></td></tr><tr><td style="text-align: right">Contig/MAG taxonomy</td><td style="text-align: right">BLAST, MMseqs2, DIAMOND</td><td style="text-align: right">Contigs/MAGs + databases</td><td style="text-align: right">Hit tables + assignments</td><td style="text-align: right">Wrapped: <code>run_mmseqs_search</code>, <code>run_blast*</code>, <code>run_diamond_search</code> (see <code>docs/src/workflow-map.md</code>)</td></tr><tr><td style="text-align: right">Binning</td><td style="text-align: right">MetaBAT2, MaxBin, VAMB, GenomeFace, MetaCoAG, COMEBin, TaxVAMB, Taxometer</td><td style="text-align: right">Contigs + depth/coverage tables</td><td style="text-align: right">MAG/bin FASTAs + bin tables</td><td style="text-align: right">Wrapped: <code>src/binning.jl</code> runners</td></tr><tr><td style="text-align: right">Post-binning</td><td style="text-align: right">dRep, MAGmax</td><td style="text-align: right">MAG/bin FASTAs / bin sets</td><td style="text-align: right">Dereplicated/merged catalogs</td><td style="text-align: right">Wrapped: <code>run_drep_dereplicate</code>, <code>run_magmax_merge</code></td></tr><tr><td style="text-align: right">Similarity/clustering</td><td style="text-align: right">skani, FastANI, mash</td><td style="text-align: right">Assemblies/MAGs</td><td style="text-align: right">Distance/ANI tables</td><td style="text-align: right">Wrapped: <code>skani_dist</code>, <code>skani_triangle</code>, <code>fastani_*</code>, <code>run_mash_comparison</code></td></tr><tr><td style="text-align: right">Similarity/clustering (options)</td><td style="text-align: right">dashing2, galah</td><td style="text-align: right">Assemblies/MAGs</td><td style="text-align: right">Distance tables / representative sets</td><td style="text-align: right">Mentioned as options; runner wrappers not present in <code>src/</code> yet</td></tr><tr><td style="text-align: right">Strain resolution</td><td style="text-align: right">Floria, Strainy, STRONG, HyLight</td><td style="text-align: right">Reads + contigs/graphs (tool-specific)</td><td style="text-align: right">Strain-resolved assemblies/paths</td><td style="text-align: right">Runner wrappers exist in <code>src/assembly.jl</code> (tests may be opt-in/commented)</td></tr><tr><td style="text-align: right">Variants (short)</td><td style="text-align: right">GATK, FreeBayes, BCFtools</td><td style="text-align: right">BAM + reference FASTA</td><td style="text-align: right">VCF</td><td style="text-align: right">Wrapped in <code>src/variant-analysis.jl</code></td></tr><tr><td style="text-align: right">Variants (long)</td><td style="text-align: right">Clair3</td><td style="text-align: right">BAM + reference FASTA</td><td style="text-align: right">VCF</td><td style="text-align: right">Wrapped in <code>src/variant-analysis.jl</code></td></tr><tr><td style="text-align: right">Pangenomes</td><td style="text-align: right">PGGB, VG, Cactus</td><td style="text-align: right">Assemblies</td><td style="text-align: right">Pangenome graphs + alignments</td><td style="text-align: right">Wrapped in pangenome modules (see <code>docs/src/workflow-map.md</code>)</td></tr></table><h2 id="Integration-with-Rhizomorph"><a class="docs-heading-anchor" href="#Integration-with-Rhizomorph">Integration with Rhizomorph</a><a id="Integration-with-Rhizomorph-1"></a><a class="docs-heading-anchor-permalink" href="#Integration-with-Rhizomorph" title="Permalink"></a></h2><p>The Mycelia workflow integrates with the Rhizomorph graph-based assembly system to:</p><ul><li>Build k-mer graphs from sequencing reads</li><li>Perform probabilistic assembly</li><li>Validate assemblies through graph traversal</li><li>Compare traditional assembly methods with graph-based approaches</li></ul><h2 id="Tool-Status"><a class="docs-heading-anchor" href="#Tool-Status">Tool Status</a><a id="Tool-Status-1"></a><a class="docs-heading-anchor-permalink" href="#Tool-Status" title="Permalink"></a></h2><p>See the <a href="../planning-docs/TOOL_WRAPPER_STATUS.md">Tool Wrapper Status</a> document for current implementation status of each tool wrapper. See the <a href="https://github.com/cjprybol/Mycelia/blob/main/planning-docs/TOOL_WRAPPER_STATUS.md">Tool Wrapper Status</a> document for current implementation status of each tool wrapper.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../workflow-map/">« Workflow &amp; Tool Map</a><a class="docs-footer-nextpage" href="../api/function-coverage/">Function Coverage Audit »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.1 on <span class="colophon-date" title="Friday 19 December 2025 02:43">Friday 19 December 2025</span>. Using Julia version 1.10.10.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
