<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Metagenomic Analysis Workflow · Mycelia</title><meta name="title" content="Metagenomic Analysis Workflow · Mycelia"/><meta property="og:title" content="Metagenomic Analysis Workflow · Mycelia"/><meta property="twitter:title" content="Metagenomic Analysis Workflow · Mycelia"/><meta name="description" content="Documentation for Mycelia."/><meta property="og:description" content="Documentation for Mycelia."/><meta property="twitter:description" content="Documentation for Mycelia."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">Mycelia</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../installation/">Installation</a></li><li><a class="tocitem" href="../getting-started/">Getting Started</a></li><li><a class="tocitem" href="../concepts/">Concepts</a></li><li><a class="tocitem" href="../probabilistic-assembly-hub/">Probabilistic Assembly</a></li><li><a class="tocitem" href="../tutorials/">Tutorials</a></li><li><span class="tocitem">Documentation</span><ul><li><a class="tocitem" href="../architecture/">Architecture Overview</a></li><li><a class="tocitem" href="../assembly-method-selection/">Assembly Method Selection</a></li><li><a class="tocitem" href="../workflow-map/">Workflow &amp; Tool Map</a></li><li><a class="tocitem" href="../api/function-coverage/">Function Coverage Audit</a></li><li><a class="tocitem" href="../performance/">Performance Guide</a></li><li><a class="tocitem" href="../faq/">FAQ</a></li></ul></li><li><span class="tocitem">API Reference</span><ul><li><a class="tocitem" href="../api-reference/">Complete API Reference</a></li><li><a class="tocitem" href="../api/all-functions/">Complete API Surface</a></li><li><input class="collapse-toggle" id="menuitem-8-3" type="checkbox"/><label class="tocitem" for="menuitem-8-3"><span class="docs-label">Workflows</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../api/workflows/assembly-suite/">Assembly Suite</a></li><li><a class="tocitem" href="../api/workflows/data-acquisition/">Data Acquisition</a></li><li><a class="tocitem" href="../api/workflows/quality-control/">Quality Control</a></li><li><a class="tocitem" href="../api/workflows/sequence-analysis/">Sequence Analysis</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-8-4" type="checkbox"/><label class="tocitem" for="menuitem-8-4"><span class="docs-label">Quick Reference</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../api/quick-reference/function-index/">Function Index</a></li><li><a class="tocitem" href="../api/quick-reference/parameter-guide/">Parameter Guide</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-8-5" type="checkbox"/><label class="tocitem" for="menuitem-8-5"><span class="docs-label">Examples</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../api/examples/basic-workflows/">Basic Workflows</a></li></ul></li><li><a class="tocitem" href="../api/">Legacy API Documentation</a></li><li><a class="tocitem" href="../related-projects/">Related Projects</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Metagenomic Analysis Workflow</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Metagenomic Analysis Workflow</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/cjprybol/Mycelia" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/cjprybol/Mycelia/blob/master/docs/src/metagenomic-workflow.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Metagenomic-Analysis-Workflow"><a class="docs-heading-anchor" href="#Metagenomic-Analysis-Workflow">Metagenomic Analysis Workflow</a><a id="Metagenomic-Analysis-Workflow-1"></a><a class="docs-heading-anchor-permalink" href="#Metagenomic-Analysis-Workflow" title="Permalink"></a></h1><p>This document describes the metagenomic analysis workflow implemented in Mycelia, including read-level classification, assembly, taxonomy assignment, and validation strategies.</p><h2 id="Overview"><a class="docs-heading-anchor" href="#Overview">Overview</a><a id="Overview-1"></a><a class="docs-heading-anchor-permalink" href="#Overview" title="Permalink"></a></h2><p>The Mycelia metagenomic workflow implements a triangulated approach to taxonomic classification, combining evidence from multiple sources:</p><ol><li><strong>Read-level classification</strong> - Direct mapping of reads to reference databases</li><li><strong>Contig-level DNA taxonomy</strong> - BLAST-based classification of assembled contigs</li><li><strong>Contig-level protein taxonomy</strong> - MMseqs2-based classification against UniRef databases</li></ol><pre><code class="language-mermaid hljs">flowchart TD
  R[Sequencing reads]

  R --&gt; E1[Read level mapping&lt;br/&gt;to reference databases]

  R --&gt; Asm[Assembly into contigs]
  Asm --&gt; E2[Contig DNA taxonomy&lt;br/&gt;BLAST to NCBI and others]
  Asm --&gt; E3[Contig protein taxonomy&lt;br/&gt;mmseqs2 to UniRef sets]

  R --&gt; MapAsm[Reads mapped to contigs]
  MapAsm --&gt; E2
  MapAsm --&gt; E3

  E1 --&gt; Tri[Triangulated taxonomic assignment]
  E2 --&gt; Tri
  E3 --&gt; Tri

  Tri --&gt; Bench[Benchmark against other tools&lt;br/&gt;kmer marker gene protein based]</code></pre><h2 id="Full-Workflow"><a class="docs-heading-anchor" href="#Full-Workflow">Full Workflow</a><a id="Full-Workflow-1"></a><a class="docs-heading-anchor-permalink" href="#Full-Workflow" title="Permalink"></a></h2><p>The complete metagenomic workflow includes quality control, multiple assembly strategies, variant calling, and pangenome analysis:</p><pre><code class="language-mermaid hljs">flowchart TD
  R[Raw reads] --&gt; Q[QC]

  Q --&gt; DBs[Reference databases&lt;br/&gt;NCBI Core Nucleotide&lt;br/&gt;IMG VR v5 and others]

  Q --&gt; RL_map
  subgraph RL [Read level classification]
    direction TB
    RL_map[Minimap2 mapping&lt;br/&gt;short and long reads] --&gt; RL_score[Weighted scoring and LCA&lt;br/&gt;top hit vs next hit&lt;br/&gt;coverage threshold]
  end
  DBs --&gt; RL_map

  Q --&gt; RL_val[Validation tools&lt;br/&gt;MetaPhlAn&lt;br/&gt;metabuli&lt;br/&gt;Sylph or Kraken2]

  Q --&gt; SR_asm
  Q --&gt; LR_asm
  subgraph ASM [Metagenomic assembly]
    direction LR
    SR_asm[Short read assembly&lt;br/&gt;MEGAHIT&lt;br/&gt;metaSPAdes&lt;br/&gt;Penguinn]
    LR_asm[Long read assembly&lt;br/&gt;hifiasm meta&lt;br/&gt;metaMDBG&lt;br/&gt;metaFlye]
  end

  SR_asm --&gt; DNA_tax
  LR_asm --&gt; DNA_tax
  DBs --&gt; DNA_tax
  DNA_tax[DNA level taxonomy&lt;br/&gt;BLAST vs CoreNT and others]

  SR_asm --&gt; Prot_tax
  LR_asm --&gt; Prot_tax
  Prot_tax[Protein level taxonomy&lt;br/&gt;mmseqs2 vs UniRef 50 90 100]

  Q --&gt; MapAsm[Reads mapped to contigs&lt;br/&gt;minimap2]
  MapAsm --&gt; Pangraph[Pangenome and graph alignment&lt;br/&gt;metapangenomes]
  Pangraph --&gt; VarPan[Variant calling graph based&lt;br/&gt;PGGB&lt;br/&gt;VG&lt;br/&gt;Cactus]
  Pangraph --&gt; VarAlign[Variant calling alignment based&lt;br/&gt;short reads GATK FreeBayes BCFtools&lt;br/&gt;long reads Clair3]

  MapAsm --&gt; DNA_tax
  MapAsm --&gt; Prot_tax

  SR_asm --&gt; QCcontig
  LR_asm --&gt; QCcontig
  QCcontig[Contig QC&lt;br/&gt;viral CheckV&lt;br/&gt;microbial CheckM&lt;br/&gt;all QUAST BUSCO]

  RL_score --&gt; Tri[Triangulated taxonomic assignment]
  DNA_tax --&gt; Tri
  Prot_tax --&gt; Tri

  Tri --&gt; Bench[Benchmark against other tools&lt;br/&gt;kmer marker gene protein based]
  Bench --&gt; RL_val

  Tri --&gt; C[Classifications]
  VarPan --&gt; V[Variants]
  VarAlign --&gt; V[Variants]
  Pangraph --&gt; P[Pangenomes]</code></pre><h2 id="Workflow-Components"><a class="docs-heading-anchor" href="#Workflow-Components">Workflow Components</a><a id="Workflow-Components-1"></a><a class="docs-heading-anchor-permalink" href="#Workflow-Components" title="Permalink"></a></h2><h3 id="Quality-Control"><a class="docs-heading-anchor" href="#Quality-Control">Quality Control</a><a id="Quality-Control-1"></a><a class="docs-heading-anchor-permalink" href="#Quality-Control" title="Permalink"></a></h3><p>Initial read quality assessment and filtering using:</p><ul><li>FastQC for quality metrics</li><li>Adapter trimming and quality filtering</li></ul><h3 id="Read-Level-Classification"><a class="docs-heading-anchor" href="#Read-Level-Classification">Read-Level Classification</a><a id="Read-Level-Classification-1"></a><a class="docs-heading-anchor-permalink" href="#Read-Level-Classification" title="Permalink"></a></h3><p>Direct classification of reads using minimap2 mapping against reference databases, with weighted scoring based on:</p><ul><li>Top hit vs next hit ratio</li><li>Coverage thresholds</li><li>LCA (Lowest Common Ancestor) assignment for ambiguous mappings</li></ul><h3 id="Assembly-Strategies"><a class="docs-heading-anchor" href="#Assembly-Strategies">Assembly Strategies</a><a id="Assembly-Strategies-1"></a><a class="docs-heading-anchor-permalink" href="#Assembly-Strategies" title="Permalink"></a></h3><p><strong>Short Read Assembly:</strong></p><ul><li>MEGAHIT - memory-efficient assembly</li><li>metaSPAdes - metagenome-specific assembly</li><li>Penguinn - guided assembly with protein references</li></ul><p><strong>Long Read Assembly:</strong></p><ul><li>hifiasm-meta - HiFi metagenome assembly</li><li>metaMDBG - minimizer-based assembly</li><li>metaFlye - long-read metagenome assembly</li></ul><h3 id="Taxonomy-Assignment"><a class="docs-heading-anchor" href="#Taxonomy-Assignment">Taxonomy Assignment</a><a id="Taxonomy-Assignment-1"></a><a class="docs-heading-anchor-permalink" href="#Taxonomy-Assignment" title="Permalink"></a></h3><p><strong>DNA-level:</strong></p><ul><li>BLAST against NCBI Core Nucleotide</li><li>Custom reference databases</li></ul><p><strong>Protein-level:</strong></p><ul><li>MMseqs2 against UniRef50, UniRef90, UniRef100</li><li>Sensitive homology detection for divergent sequences</li></ul><h3 id="Quality-Control-and-Validation"><a class="docs-heading-anchor" href="#Quality-Control-and-Validation">Quality Control and Validation</a><a id="Quality-Control-and-Validation-1"></a><a class="docs-heading-anchor-permalink" href="#Quality-Control-and-Validation" title="Permalink"></a></h3><p><strong>Viral contigs:</strong></p><ul><li>CheckV for completeness and contamination</li></ul><p><strong>Microbial contigs:</strong></p><ul><li>CheckM/CheckM2 for completeness and contamination</li></ul><p><strong>General:</strong></p><ul><li>QUAST for assembly statistics</li><li>BUSCO for completeness assessment</li></ul><h3 id="Variant-Calling"><a class="docs-heading-anchor" href="#Variant-Calling">Variant Calling</a><a id="Variant-Calling-1"></a><a class="docs-heading-anchor-permalink" href="#Variant-Calling" title="Permalink"></a></h3><p><strong>Graph-based:</strong></p><ul><li>PGGB (PanGenome Graph Builder)</li><li>VG toolkit</li><li>Cactus</li></ul><p><strong>Alignment-based:</strong></p><ul><li>Short reads: GATK HaplotypeCaller, FreeBayes, BCFtools</li><li>Long reads: Clair3</li></ul><h2 id="Integration-with-Rhizomorph"><a class="docs-heading-anchor" href="#Integration-with-Rhizomorph">Integration with Rhizomorph</a><a id="Integration-with-Rhizomorph-1"></a><a class="docs-heading-anchor-permalink" href="#Integration-with-Rhizomorph" title="Permalink"></a></h2><p>The Mycelia workflow integrates with the Rhizomorph graph-based assembly system to:</p><ul><li>Build k-mer graphs from sequencing reads</li><li>Perform probabilistic assembly</li><li>Validate assemblies through graph traversal</li><li>Compare traditional assembly methods with graph-based approaches</li></ul><h2 id="Tool-Status"><a class="docs-heading-anchor" href="#Tool-Status">Tool Status</a><a id="Tool-Status-1"></a><a class="docs-heading-anchor-permalink" href="#Tool-Status" title="Permalink"></a></h2><p>See the <a href="../planning-docs/TOOL_WRAPPER_STATUS.md">Tool Wrapper Status</a> document for current implementation status of each tool wrapper. See the <a href="https://github.com/cjprybol/Mycelia/blob/main/planning-docs/TOOL_WRAPPER_STATUS.md">Tool Wrapper Status</a> document for current implementation status of each tool wrapper.</p></article><nav class="docs-footer"><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.1 on <span class="colophon-date" title="Saturday 13 December 2025 23:17">Saturday 13 December 2025</span>. Using Julia version 1.10.10.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
